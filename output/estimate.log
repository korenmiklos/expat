--------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/estimate.log
  log type:  text
 opened on:  28 Nov 2018, 16:51:23

. 
. use temp/analysis_sample

. 
. local sample_baseline expat!=.

. local sample_manufacturing `sample_baseline' & manufacturing==1

. local sample_acquisitions `sample_baseline' & ever_foreign==1

. 
. local samples baseline manufacturing acquisitions

. 
. local scale lnL lnK lnQ

. local intensity lnKL lnQL exporter inv

. 
. egen person_tag = tag(frame_id manager_id)

. egen N = sum(person_tag), by(frame_id)

. gen inverse_weight = 1/N

. 
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. foreach sample in `samples' {
  2.         foreach group in scale intensity {
  3.                 foreach X of var ``group'' {
  4.                         xtreg `X' foreign during after during_expat after_expat i.ind_year i.age_cat if `sample_`sample'' [
> aw=inverse_weight], i(firm_person ) fe vce(cluster id)
  5.                         local r2_w = `e(r2_w)'
  6.                         do regram output/regression/`sample'_`group' `X' `X' R2_within "`r2_w'"
  7.                 }
  8.         }
  9. }

Fixed-effects (within) regression               Number of obs      =    688154
Group variable: firm_person                     Number of groups   =     41071

R-sq:  within  = 0.1385                         Obs per group: min =         1
       between = 0.0563                                        avg =      16.8
       overall = 0.0771                                        max =        25

                                                F(78,13202)        =     62.13
corr(u_i, Xb)  = -0.1250                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0105768   .0340835    -0.31   0.756    -.0773854    .0562317
      during |  -.1323221   .0103373   -12.80   0.000    -.1525847   -.1120594
       after |  -.2789441   .0179493   -15.54   0.000    -.3141274   -.2437608
during_expat |   .1667949   .0217789     7.66   0.000     .1241051    .2094847
 after_expat |   .3355205   .0336413     9.97   0.000     .2695787    .4014624
             |
    ind_year |
          2  |  -.1463907   .0173511    -8.44   0.000    -.1804013   -.1123802
          3  |  -.3055597   .0223956   -13.64   0.000    -.3494582   -.2616612
          4  |  -.4448139   .0255664   -17.40   0.000    -.4949277   -.3947001
          5  |  -.5609859   .0289936   -19.35   0.000    -.6178174   -.5041543
          6  |  -.6633729   .0318774   -20.81   0.000    -.7258571   -.6008886
          7  |  -.7388436   .0348384   -21.21   0.000     -.807132   -.6705553
          8  |  -.8062408   .0383714   -21.01   0.000    -.8814542   -.7310274
          9  |  -.8856696   .0418151   -21.18   0.000    -.9676331   -.8037061
         10  |  -.9623946   .0451003   -21.34   0.000    -1.050798   -.8739914
         11  |  -1.058021   .0480714   -22.01   0.000    -1.152248   -.9637944
         12  |  -1.120015   .0509007   -22.00   0.000    -1.219788   -1.020242
         13  |  -1.180917   .0537551   -21.97   0.000    -1.286285   -1.075549
         14  |  -1.227613   .0566511   -21.67   0.000    -1.338657   -1.116569
         15  |  -1.255042    .059641   -21.04   0.000    -1.371947   -1.138137
         16  |  -1.291781   .0625751   -20.64   0.000    -1.414437   -1.169124
         17  |  -1.337781   .0656079   -20.39   0.000    -1.466382   -1.209181
         18  |  -1.411407   .0686077   -20.57   0.000    -1.545888   -1.276927
         19  |  -1.462868    .071657   -20.41   0.000    -1.603326    -1.32241
         20  |  -1.512603   .0743591   -20.34   0.000    -1.658358   -1.366849
         21  |  -1.571274   .0770029   -20.41   0.000    -1.722211   -1.420338
         22  |  -1.616074   .0796285   -20.30   0.000    -1.772157    -1.45999
         23  |  -1.641952   .0821517   -19.99   0.000    -1.802981   -1.480923
         24  |  -1.663927   .0853412   -19.50   0.000    -1.831208   -1.496646
         25  |  -1.659405   .0884857   -18.75   0.000    -1.832849    -1.48596
         26  |   .6059546   .0598903    10.12   0.000     .4885609    .7233482
         27  |   .4175206    .058456     7.14   0.000     .3029386    .5321027
         28  |    .289206   .0571866     5.06   0.000     .1771119       .4013
         29  |   .1574438   .0566609     2.78   0.005     .0463804    .2685073
         30  |   .0575515   .0560387     1.03   0.304    -.0522925    .1673955
         31  |  -.0369847   .0564441    -0.66   0.512    -.1476232    .0736537
         32  |  -.1059281   .0566677    -1.87   0.062    -.2170048    .0051487
         33  |   -.190675    .057514    -3.32   0.001    -.3034107   -.0779392
         34  |  -.2533603   .0586659    -4.32   0.000    -.3683539   -.1383666
         35  |  -.3283373   .0603646    -5.44   0.000    -.4466606   -.2100139
         36  |  -.4333868   .0622282    -6.96   0.000    -.5553631   -.3114105
         37  |  -.5046326   .0639771    -7.89   0.000     -.630037   -.3792282
         38  |  -.5975507    .066268    -9.02   0.000    -.7274456   -.4676559
         39  |  -.6603933   .0686173    -9.62   0.000    -.7948931   -.5258936
         40  |  -.7106666   .0710363   -10.00   0.000    -.8499079   -.5714253
         41  |  -.7475132   .0733061   -10.20   0.000    -.8912036   -.6038228
         42  |  -.7938864   .0760051   -10.45   0.000    -.9428672   -.6449055
         43  |  -.9444957   .0789911   -11.96   0.000     -1.09933   -.7896619
         44  |  -.9964896   .0821563   -12.13   0.000    -1.157528   -.8354513
         45  |  -.9971761   .0847414   -11.77   0.000    -1.163281   -.8310707
         46  |  -1.026506   .0874262   -11.74   0.000    -1.197874   -.8551379
         47  |  -1.041548   .0897162   -11.61   0.000    -1.217405   -.8656917
         48  |   -1.04937    .092086   -11.40   0.000    -1.229872   -.8688682
         49  |  -1.040063   .0950216   -10.95   0.000    -1.226319   -.8538074
         50  |  -1.025382   .0975263   -10.51   0.000    -1.216547   -.8342161
             |
     age_cat |
          1  |   .4356323   .0171333    25.43   0.000     .4020486    .4692161
          2  |   .7795283   .0200047    38.97   0.000     .7403161    .8187404
          3  |   1.022084   .0227402    44.95   0.000     .9775105    1.066659
          4  |   1.223395   .0257052    47.59   0.000     1.173009    1.273781
          5  |   1.400262   .0287023    48.79   0.000     1.344002    1.456523
          6  |   1.544049   .0316649    48.76   0.000     1.481981    1.606116
          7  |   1.666344   .0346567    48.08   0.000     1.598412    1.734276
          8  |   1.774434   .0379448    46.76   0.000     1.700056    1.848811
          9  |   1.864954   .0412004    45.27   0.000     1.784195    1.945712
         10  |   1.936498   .0444421    43.57   0.000     1.849385     2.02361
         11  |   2.016932   .0477106    42.27   0.000     1.923412    2.110451
         12  |   2.088449   .0509728    40.97   0.000     1.988535    2.188363
         13  |   2.159122    .054179    39.85   0.000     2.052924    2.265321
         14  |   2.205198   .0574375    38.39   0.000     2.092612    2.317784
         15  |   2.250425   .0607339    37.05   0.000     2.131378    2.369472
         16  |   2.303408   .0641404    35.91   0.000     2.177683    2.429132
         17  |   2.351259   .0675784    34.79   0.000     2.218796    2.483722
         18  |   2.406746   .0708488    33.97   0.000     2.267872    2.545619
         19  |   2.433175   .0742678    32.76   0.000     2.287599     2.57875
         20  |   2.475532   .0815709    30.35   0.000     2.315642    2.635423
         25  |   2.494269   .0953059    26.17   0.000     2.307456    2.681082
         30  |   2.251471   .1242626    18.12   0.000     2.007898    2.495043
         40  |   2.126936   .1493317    14.24   0.000     1.834224    2.419647
         50  |   2.068163    .164377    12.58   0.000      1.74596    2.390365
             |
       _cons |   3.083947   .0356192    86.58   0.000     3.014128    3.153765
-------------+----------------------------------------------------------------
     sigma_u |  1.2635287
     sigma_e |  .78581512
         rho |  .72109187   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1385163760661985

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    688,154
Group variable: firm_person                     Number of groups  =     41,071

R-sq:                                           Obs per group:
     within  = 0.1385                                         min =          1
     between = 0.0563                                         avg =       16.8
     overall = 0.0771                                         max =         25

                                                F(78,13202)       =      62.13
corr(u_i, Xb)  = -0.1250                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0105768   .0340835    -0.31   0.756    -.0773854    .0562317
      during |  -.1323221   .0103373   -12.80   0.000    -.1525847   -.1120594
       after |  -.2789441   .0179493   -15.54   0.000    -.3141274   -.2437608
during_expat |   .1667949   .0217789     7.66   0.000     .1241051    .2094847
 after_expat |   .3355205   .0336413     9.97   0.000     .2695787    .4014624
             |
    ind_year |
          2  |  -.1463907   .0173511    -8.44   0.000    -.1804013   -.1123802
          3  |  -.3055597   .0223956   -13.64   0.000    -.3494582   -.2616612
          4  |  -.4448139   .0255664   -17.40   0.000    -.4949277   -.3947001
          5  |  -.5609859   .0289936   -19.35   0.000    -.6178174   -.5041543
          6  |  -.6633729   .0318774   -20.81   0.000    -.7258571   -.6008886
          7  |  -.7388436   .0348384   -21.21   0.000     -.807132   -.6705553
          8  |  -.8062408   .0383714   -21.01   0.000    -.8814542   -.7310274
          9  |  -.8856696   .0418151   -21.18   0.000    -.9676331   -.8037061
         10  |  -.9623946   .0451003   -21.34   0.000    -1.050798   -.8739914
         11  |  -1.058021   .0480714   -22.01   0.000    -1.152248   -.9637944
         12  |  -1.120015   .0509007   -22.00   0.000    -1.219788   -1.020242
         13  |  -1.180917   .0537551   -21.97   0.000    -1.286285   -1.075549
         14  |  -1.227613   .0566511   -21.67   0.000    -1.338657   -1.116569
         15  |  -1.255042    .059641   -21.04   0.000    -1.371947   -1.138137
         16  |  -1.291781   .0625751   -20.64   0.000    -1.414437   -1.169124
         17  |  -1.337781   .0656079   -20.39   0.000    -1.466382   -1.209181
         18  |  -1.411407   .0686077   -20.57   0.000    -1.545888   -1.276927
         19  |  -1.462868    .071657   -20.41   0.000    -1.603326    -1.32241
         20  |  -1.512603   .0743591   -20.34   0.000    -1.658358   -1.366849
         21  |  -1.571274   .0770029   -20.41   0.000    -1.722211   -1.420338
         22  |  -1.616074   .0796285   -20.30   0.000    -1.772157    -1.45999
         23  |  -1.641952   .0821517   -19.99   0.000    -1.802981   -1.480923
         24  |  -1.663927   .0853412   -19.50   0.000    -1.831208   -1.496646
         25  |  -1.659405   .0884857   -18.75   0.000    -1.832849    -1.48596
         26  |   .6059546   .0598903    10.12   0.000     .4885609    .7233482
         27  |   .4175206    .058456     7.14   0.000     .3029386    .5321027
         28  |    .289206   .0571866     5.06   0.000     .1771119       .4013
         29  |   .1574438   .0566609     2.78   0.005     .0463804    .2685073
         30  |   .0575515   .0560387     1.03   0.304    -.0522925    .1673955
         31  |  -.0369847   .0564441    -0.66   0.512    -.1476232    .0736537
         32  |  -.1059281   .0566677    -1.87   0.062    -.2170048    .0051487
         33  |   -.190675    .057514    -3.32   0.001    -.3034107   -.0779392
         34  |  -.2533603   .0586659    -4.32   0.000    -.3683539   -.1383666
         35  |  -.3283373   .0603646    -5.44   0.000    -.4466606   -.2100139
         36  |  -.4333868   .0622282    -6.96   0.000    -.5553631   -.3114105
         37  |  -.5046326   .0639771    -7.89   0.000     -.630037   -.3792282
         38  |  -.5975507    .066268    -9.02   0.000    -.7274456   -.4676559
         39  |  -.6603933   .0686173    -9.62   0.000    -.7948931   -.5258936
         40  |  -.7106666   .0710363   -10.00   0.000    -.8499079   -.5714253
         41  |  -.7475132   .0733061   -10.20   0.000    -.8912036   -.6038228
         42  |  -.7938864   .0760051   -10.45   0.000    -.9428672   -.6449055
         43  |  -.9444957   .0789911   -11.96   0.000     -1.09933   -.7896619
         44  |  -.9964896   .0821563   -12.13   0.000    -1.157528   -.8354513
         45  |  -.9971761   .0847414   -11.77   0.000    -1.163281   -.8310707
         46  |  -1.026506   .0874262   -11.74   0.000    -1.197874   -.8551379
         47  |  -1.041548   .0897162   -11.61   0.000    -1.217405   -.8656917
         48  |   -1.04937    .092086   -11.40   0.000    -1.229872   -.8688682
         49  |  -1.040063   .0950216   -10.95   0.000    -1.226319   -.8538074
         50  |  -1.025382   .0975263   -10.51   0.000    -1.216547   -.8342161
             |
     age_cat |
          1  |   .4356323   .0171333    25.43   0.000     .4020486    .4692161
          2  |   .7795283   .0200047    38.97   0.000     .7403161    .8187404
          3  |   1.022084   .0227402    44.95   0.000     .9775105    1.066659
          4  |   1.223395   .0257052    47.59   0.000     1.173009    1.273781
          5  |   1.400262   .0287023    48.79   0.000     1.344002    1.456523
          6  |   1.544049   .0316649    48.76   0.000     1.481981    1.606116
          7  |   1.666344   .0346567    48.08   0.000     1.598412    1.734276
          8  |   1.774434   .0379448    46.76   0.000     1.700056    1.848811
          9  |   1.864954   .0412004    45.27   0.000     1.784195    1.945712
         10  |   1.936498   .0444421    43.57   0.000     1.849385     2.02361
         11  |   2.016932   .0477106    42.27   0.000     1.923412    2.110451
         12  |   2.088449   .0509728    40.97   0.000     1.988535    2.188363
         13  |   2.159122    .054179    39.85   0.000     2.052924    2.265321
         14  |   2.205198   .0574375    38.39   0.000     2.092612    2.317784
         15  |   2.250425   .0607339    37.05   0.000     2.131378    2.369472
         16  |   2.303408   .0641404    35.91   0.000     2.177683    2.429132
         17  |   2.351259   .0675784    34.79   0.000     2.218796    2.483722
         18  |   2.406746   .0708488    33.97   0.000     2.267872    2.545619
         19  |   2.433175   .0742678    32.76   0.000     2.287599     2.57875
         20  |   2.475532   .0815709    30.35   0.000     2.315642    2.635423
         25  |   2.494269   .0953059    26.17   0.000     2.307456    2.681082
         30  |   2.251471   .1242626    18.12   0.000     2.007898    2.495043
         40  |   2.126936   .1493317    14.24   0.000     1.834224    2.419647
         50  |   2.068163    .164377    12.58   0.000      1.74596    2.390365
             |
       _cons |   3.083947   .0356192    86.58   0.000     3.014128    3.153765
-------------+----------------------------------------------------------------
     sigma_u |  1.2635287
     sigma_e |  .78581512
         rho |  .72109187   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    633552
Group variable: firm_person                     Number of groups   =     40512

R-sq:  within  = 0.2039                         Obs per group: min =         1
       between = 0.1207                                        avg =      15.6
       overall = 0.0968                                        max =        25

                                                F(78,12829)        =     97.64
corr(u_i, Xb)  = 0.0770                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 12,830 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .103602   .0499604     2.07   0.038     .0056722    .2015319
      during |  -.1103665   .0143993    -7.66   0.000    -.1385912   -.0821417
       after |  -.2402549   .0239867   -10.02   0.000    -.2872725   -.1932374
during_expat |  -.1042338   .0306205    -3.40   0.001    -.1642544   -.0442132
 after_expat |  -.1750628   .0442025    -3.96   0.000    -.2617063   -.0884193
             |
    ind_year |
          2  |  -.0714754   .0285676    -2.50   0.012    -.1274722   -.0154787
          3  |   .3054559   .0353444     8.64   0.000     .2361756    .3747363
          4  |   .3363489    .039736     8.46   0.000     .2584605    .4142373
          5  |   .4060979    .044383     9.15   0.000     .3191006    .4930952
          6  |   .5429208   .0484632    11.20   0.000     .4479257    .6379159
          7  |   .6994815   .0527606    13.26   0.000     .5960629    .8029001
          8  |   .7977321   .0575209    13.87   0.000     .6849826    .9104816
          9  |   .8704811   .0620022    14.04   0.000     .7489475    .9920146
         10  |    .925012   .0665718    13.89   0.000     .7945214    1.055503
         11  |   .9717771   .0712889    13.63   0.000     .8320403    1.111514
         12  |    .991673   .0761943    13.02   0.000     .8423208    1.141025
         13  |   1.023746   .0809978    12.64   0.000     .8649784    1.182514
         14  |   1.025528   .0855934    11.98   0.000      .857752    1.193304
         15  |   .9896603   .0902132    10.97   0.000     .8128291    1.166491
         16  |   1.008701    .094996    10.62   0.000     .8224949    1.194907
         17  |   1.019557   .0995849    10.24   0.000     .8243554    1.214758
         18  |    .986325   .1045776     9.43   0.000     .7813374    1.191313
         19  |   .9132758   .1096288     8.33   0.000      .698387    1.128165
         20  |   .8788089   .1141446     7.70   0.000     .6550684    1.102549
         21  |    .876404   .1183904     7.40   0.000     .6443411    1.108467
         22  |   .8782339   .1227144     7.16   0.000     .6376955    1.118772
         23  |   .9564035   .1273109     7.51   0.000     .7068553    1.205952
         24  |   .5479483   .1350302     4.06   0.000      .283269    .8126276
         25  |   .6240321   .1422772     4.39   0.000     .3451476    .9029167
         26  |   .9129855   .0823038    11.09   0.000     .7516578    1.074313
         27  |    .843967   .0774824    10.89   0.000     .6920899    .9958441
         28  |   .9787642   .0735982    13.30   0.000     .8345009    1.123028
         29  |   .9767091   .0734624    13.30   0.000     .8327117    1.120706
         30  |   1.008181   .0738751    13.65   0.000     .8633747    1.152987
         31  |   1.067468   .0749963    14.23   0.000     .9204637    1.214472
         32  |   1.237205   .0757651    16.33   0.000     1.088694    1.385716
         33  |   1.293468   .0776205    16.66   0.000     1.141321    1.445616
         34  |   1.347237   .0800504    16.83   0.000     1.190327    1.504148
         35  |   1.379267    .083206    16.58   0.000     1.216171    1.542363
         36  |   1.404733   .0867033    16.20   0.000     1.234781    1.574684
         37  |   1.436709    .090005    15.96   0.000     1.260285    1.613132
         38  |   1.433451   .0938473    15.27   0.000     1.249496    1.617405
         39  |   1.423525   .0978615    14.55   0.000     1.231702    1.615348
         40  |   1.418437   .1019648    13.91   0.000     1.218571    1.618303
         41  |   1.454057   .1066259    13.64   0.000     1.245054     1.66306
         42  |   1.486165   .1110002    13.39   0.000     1.268589    1.703742
         43  |    1.42265   .1156956    12.30   0.000     1.195869     1.64943
         44  |     1.3808   .1207572    11.43   0.000     1.144098    1.617502
         45  |   1.446518    .125139    11.56   0.000     1.201227    1.691809
         46  |   1.437583   .1293961    11.11   0.000     1.183948    1.691219
         47  |   1.493398   .1332764    11.21   0.000     1.232156     1.75464
         48  |   1.569378   .1375862    11.41   0.000     1.299689    1.839067
         49  |   1.501139   .1435954    10.45   0.000     1.219671    1.782608
         50  |    1.62777   .1486746    10.95   0.000     1.336346    1.919194
             |
     age_cat |
          1  |   .4846107   .0283599    17.09   0.000      .429021    .5402004
          2  |    .821994   .0322544    25.48   0.000     .7587704    .8852175
          3  |   1.055641   .0358873    29.42   0.000     .9852971    1.125986
          4  |   1.255103   .0398397    31.50   0.000     1.177011    1.333195
          5  |   1.383745   .0441723    31.33   0.000      1.29716    1.470329
          6  |   1.493285   .0486156    30.72   0.000     1.397991    1.588579
          7  |   1.581574   .0531395    29.76   0.000     1.477413    1.685735
          8  |   1.659862   .0578448    28.70   0.000     1.546478    1.773247
          9  |   1.723889   .0627425    27.48   0.000     1.600904    1.846873
         10  |   1.766583   .0677683    26.07   0.000     1.633747    1.899419
         11  |   1.839684   .0726421    25.33   0.000     1.697295    1.982074
         12  |   1.900596   .0776863    24.47   0.000     1.748319    2.052873
         13  |   1.927854    .082745    23.30   0.000     1.765662    2.090047
         14  |    1.95622   .0879507    22.24   0.000     1.783824    2.128617
         15  |   1.988099   .0931326    21.35   0.000     1.805545    2.170653
         16  |   2.039979   .0983787    20.74   0.000     1.847142    2.232816
         17  |   2.048749   .1038716    19.72   0.000     1.845146    2.252353
         18  |   2.072213   .1093907    18.94   0.000     1.857791    2.286635
         19  |   2.090197   .1148112    18.21   0.000      1.86515    2.315244
         20  |   2.067674   .1260465    16.40   0.000     1.820604    2.314744
         25  |    1.90812   .1501555    12.71   0.000     1.613793    2.202447
         30  |   1.699033   .1910481     8.89   0.000      1.32455    2.073515
         40  |   1.624795   .2286367     7.11   0.000     1.176633    2.072957
         50  |   1.534455   .2518866     6.09   0.000      1.04072     2.02819
             |
       _cons |   7.814683   .0532905   146.64   0.000     7.710226     7.91914
-------------+----------------------------------------------------------------
     sigma_u |  2.1094136
     sigma_e |  1.0860138
         rho |  .79047518   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2038644576121554

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    633,552
Group variable: firm_person                     Number of groups  =     40,512

R-sq:                                           Obs per group:
     within  = 0.2039                                         min =          1
     between = 0.1207                                         avg =       15.6
     overall = 0.0968                                         max =         25

                                                F(78,12829)       =      97.64
corr(u_i, Xb)  = 0.0770                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 12,830 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .103602   .0499604     2.07   0.038     .0056722    .2015319
      during |  -.1103665   .0143993    -7.66   0.000    -.1385912   -.0821417
       after |  -.2402549   .0239867   -10.02   0.000    -.2872725   -.1932374
during_expat |  -.1042338   .0306205    -3.40   0.001    -.1642544   -.0442132
 after_expat |  -.1750628   .0442025    -3.96   0.000    -.2617063   -.0884193
             |
    ind_year |
          2  |  -.0714754   .0285676    -2.50   0.012    -.1274722   -.0154787
          3  |   .3054559   .0353444     8.64   0.000     .2361756    .3747363
          4  |   .3363489    .039736     8.46   0.000     .2584605    .4142373
          5  |   .4060979    .044383     9.15   0.000     .3191006    .4930952
          6  |   .5429208   .0484632    11.20   0.000     .4479257    .6379159
          7  |   .6994815   .0527606    13.26   0.000     .5960629    .8029001
          8  |   .7977321   .0575209    13.87   0.000     .6849826    .9104816
          9  |   .8704811   .0620022    14.04   0.000     .7489475    .9920146
         10  |    .925012   .0665718    13.89   0.000     .7945214    1.055503
         11  |   .9717771   .0712889    13.63   0.000     .8320403    1.111514
         12  |    .991673   .0761943    13.02   0.000     .8423208    1.141025
         13  |   1.023746   .0809978    12.64   0.000     .8649784    1.182514
         14  |   1.025528   .0855934    11.98   0.000      .857752    1.193304
         15  |   .9896603   .0902132    10.97   0.000     .8128291    1.166491
         16  |   1.008701    .094996    10.62   0.000     .8224949    1.194907
         17  |   1.019557   .0995849    10.24   0.000     .8243554    1.214758
         18  |    .986325   .1045776     9.43   0.000     .7813374    1.191313
         19  |   .9132758   .1096288     8.33   0.000      .698387    1.128165
         20  |   .8788089   .1141446     7.70   0.000     .6550684    1.102549
         21  |    .876404   .1183904     7.40   0.000     .6443411    1.108467
         22  |   .8782339   .1227144     7.16   0.000     .6376955    1.118772
         23  |   .9564035   .1273109     7.51   0.000     .7068553    1.205952
         24  |   .5479483   .1350302     4.06   0.000      .283269    .8126276
         25  |   .6240321   .1422772     4.39   0.000     .3451476    .9029167
         26  |   .9129855   .0823038    11.09   0.000     .7516578    1.074313
         27  |    .843967   .0774824    10.89   0.000     .6920899    .9958441
         28  |   .9787642   .0735982    13.30   0.000     .8345009    1.123028
         29  |   .9767091   .0734624    13.30   0.000     .8327117    1.120706
         30  |   1.008181   .0738751    13.65   0.000     .8633747    1.152987
         31  |   1.067468   .0749963    14.23   0.000     .9204637    1.214472
         32  |   1.237205   .0757651    16.33   0.000     1.088694    1.385716
         33  |   1.293468   .0776205    16.66   0.000     1.141321    1.445616
         34  |   1.347237   .0800504    16.83   0.000     1.190327    1.504148
         35  |   1.379267    .083206    16.58   0.000     1.216171    1.542363
         36  |   1.404733   .0867033    16.20   0.000     1.234781    1.574684
         37  |   1.436709    .090005    15.96   0.000     1.260285    1.613132
         38  |   1.433451   .0938473    15.27   0.000     1.249496    1.617405
         39  |   1.423525   .0978615    14.55   0.000     1.231702    1.615348
         40  |   1.418437   .1019648    13.91   0.000     1.218571    1.618303
         41  |   1.454057   .1066259    13.64   0.000     1.245054     1.66306
         42  |   1.486165   .1110002    13.39   0.000     1.268589    1.703742
         43  |    1.42265   .1156956    12.30   0.000     1.195869     1.64943
         44  |     1.3808   .1207572    11.43   0.000     1.144098    1.617502
         45  |   1.446518    .125139    11.56   0.000     1.201227    1.691809
         46  |   1.437583   .1293961    11.11   0.000     1.183948    1.691219
         47  |   1.493398   .1332764    11.21   0.000     1.232156     1.75464
         48  |   1.569378   .1375862    11.41   0.000     1.299689    1.839067
         49  |   1.501139   .1435954    10.45   0.000     1.219671    1.782608
         50  |    1.62777   .1486746    10.95   0.000     1.336346    1.919194
             |
     age_cat |
          1  |   .4846107   .0283599    17.09   0.000      .429021    .5402004
          2  |    .821994   .0322544    25.48   0.000     .7587704    .8852175
          3  |   1.055641   .0358873    29.42   0.000     .9852971    1.125986
          4  |   1.255103   .0398397    31.50   0.000     1.177011    1.333195
          5  |   1.383745   .0441723    31.33   0.000      1.29716    1.470329
          6  |   1.493285   .0486156    30.72   0.000     1.397991    1.588579
          7  |   1.581574   .0531395    29.76   0.000     1.477413    1.685735
          8  |   1.659862   .0578448    28.70   0.000     1.546478    1.773247
          9  |   1.723889   .0627425    27.48   0.000     1.600904    1.846873
         10  |   1.766583   .0677683    26.07   0.000     1.633747    1.899419
         11  |   1.839684   .0726421    25.33   0.000     1.697295    1.982074
         12  |   1.900596   .0776863    24.47   0.000     1.748319    2.052873
         13  |   1.927854    .082745    23.30   0.000     1.765662    2.090047
         14  |    1.95622   .0879507    22.24   0.000     1.783824    2.128617
         15  |   1.988099   .0931326    21.35   0.000     1.805545    2.170653
         16  |   2.039979   .0983787    20.74   0.000     1.847142    2.232816
         17  |   2.048749   .1038716    19.72   0.000     1.845146    2.252353
         18  |   2.072213   .1093907    18.94   0.000     1.857791    2.286635
         19  |   2.090197   .1148112    18.21   0.000      1.86515    2.315244
         20  |   2.067674   .1260465    16.40   0.000     1.820604    2.314744
         25  |    1.90812   .1501555    12.71   0.000     1.613793    2.202447
         30  |   1.699033   .1910481     8.89   0.000      1.32455    2.073515
         40  |   1.624795   .2286367     7.11   0.000     1.176633    2.072957
         50  |   1.534455   .2518866     6.09   0.000      1.04072     2.02819
             |
       _cons |   7.814683   .0532905   146.64   0.000     7.710226     7.91914
-------------+----------------------------------------------------------------
     sigma_u |  2.1094136
     sigma_e |  1.0860138
         rho |  .79047518   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    688154
Group variable: firm_person                     Number of groups   =     41071

R-sq:  within  = 0.3057                         Obs per group: min =         1
       between = 0.0956                                        avg =      16.8
       overall = 0.1295                                        max =        25

                                                F(78,13202)        =    182.68
corr(u_i, Xb)  = 0.0343                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0708774   .0359778     1.97   0.049     .0003558     .141399
      during |  -.1684001   .0115694   -14.56   0.000    -.1910778   -.1457224
       after |  -.2999188   .0194126   -15.45   0.000    -.3379704   -.2618673
during_expat |   .2748049   .0239215    11.49   0.000     .2279154    .3216944
 after_expat |   .4619973   .0365939    12.62   0.000      .390268    .5337266
             |
    ind_year |
          2  |   .0035713   .0208457     0.17   0.864    -.0372893    .0444318
          3  |   .0403609   .0255721     1.58   0.115     -.009764    .0904859
          4  |   .0990739   .0294114     3.37   0.001     .0414233    .1567245
          5  |    .169534   .0332536     5.10   0.000     .1043521    .2347159
          6  |    .258545   .0365751     7.07   0.000     .1868525    .3302374
          7  |   .3231954   .0400653     8.07   0.000     .2446617    .4017291
          8  |   .3483419   .0441974     7.88   0.000     .2617086    .4349752
          9  |   .3975387   .0482034     8.25   0.000      .303053    .4920243
         10  |   .4415776   .0523445     8.44   0.000      .338975    .5441803
         11  |   .4340153   .0559267     7.76   0.000      .324391    .5436396
         12  |   .4116758   .0597988     6.88   0.000     .2944615      .52889
         13  |   .4214066   .0632133     6.67   0.000     .2974993    .5453138
         14  |   .4256326   .0669366     6.36   0.000     .2944273     .556838
         15  |   .4692933   .0706969     6.64   0.000     .3307173    .6078693
         16  |   .4701438   .0744888     6.31   0.000      .324135    .6161526
         17  |   .4872533   .0782209     6.23   0.000     .3339291    .6405775
         18  |   .3748777   .0820569     4.57   0.000     .2140344     .535721
         19  |   .3698356   .0859372     4.30   0.000     .2013863    .5382848
         20  |   .3775048   .0893411     4.23   0.000     .2023835    .5526262
         21  |   .3454632   .0925045     3.73   0.000      .164141    .5267854
         22  |    .365867   .0957227     3.82   0.000     .1782368    .5534971
         23  |   .4002236   .0987596     4.05   0.000     .2066407    .5938066
         24  |    .413864   .1023269     4.04   0.000     .2132886    .6144394
         25  |   .4259951   .1059872     4.02   0.000     .2182449    .6337452
         26  |   .2487131   .0646167     3.85   0.000     .1220551    .3753711
         27  |   .2030028   .0613786     3.31   0.001      .082692    .3233137
         28  |   .3029697   .0590373     5.13   0.000     .1872483    .4186912
         29  |   .4230912   .0585094     7.23   0.000     .3084044     .537778
         30  |   .5218976   .0582441     8.96   0.000     .4077308    .6360643
         31  |   .6082292    .059182    10.28   0.000     .4922239    .7242344
         32  |   .7102434   .0599531    11.85   0.000     .5927267      .82776
         33  |   .7306252    .061718    11.84   0.000     .6096491    .8516013
         34  |   .8225677   .0632646    13.00   0.000     .6985601    .9465753
         35  |   .8427433   .0656225    12.84   0.000     .7141138    .9713728
         36  |   .8117876   .0679153    11.95   0.000     .6786639    .9449114
         37  |   .8264187   .0703794    11.74   0.000      .688465    .9643724
         38  |   .8220841   .0736479    11.16   0.000     .6777236    .9664446
         39  |   .8396596   .0767541    10.94   0.000     .6892106    .9901086
         40  |   .9042748   .0803487    11.25   0.000     .7467798     1.06177
         41  |   .9497882   .0831376    11.42   0.000     .7868266     1.11275
         42  |   .9755883   .0864879    11.28   0.000     .8060596    1.145117
         43  |   .8202528   .0902705     9.09   0.000     .6433096     .997196
         44  |   .8410946   .0944224     8.91   0.000     .6560131    1.026176
         45  |   .9316562   .0978065     9.53   0.000     .7399414    1.123371
         46  |   .9282256   .1012783     9.17   0.000     .7297056    1.126746
         47  |    .958068   .1040086     9.21   0.000     .7541962     1.16194
         48  |   .9996282   .1071833     9.33   0.000     .7895336    1.209723
         49  |   1.015142   .1111172     9.14   0.000     .7973364    1.232948
         50  |   1.066764   .1142528     9.34   0.000     .8428117    1.290715
             |
     age_cat |
          1  |   1.054061   .0242657    43.44   0.000     1.006497    1.101625
          2  |    1.45862    .026583    54.87   0.000     1.406514    1.510727
          3  |   1.701682    .029419    57.84   0.000     1.644016    1.759347
          4  |   1.902922   .0322918    58.93   0.000     1.839625    1.966218
          5  |   2.055779   .0356845    57.61   0.000     1.985832    2.125726
          6  |   2.177423   .0390904    55.70   0.000       2.1008    2.254045
          7  |   2.293269   .0424872    53.98   0.000     2.209988     2.37655
          8  |   2.382852   .0462306    51.54   0.000     2.292233     2.47347
          9  |   2.467196   .0499897    49.35   0.000     2.369209    2.565183
         10  |   2.528176   .0538925    46.91   0.000     2.422539    2.633813
         11  |   2.602515   .0577443    45.07   0.000     2.489328    2.715703
         12  |   2.660909   .0617298    43.11   0.000      2.53991    2.781908
         13  |   2.711396   .0655276    41.38   0.000     2.582952    2.839839
         14  |   2.756713   .0695599    39.63   0.000     2.620366    2.893061
         15  |   2.803688   .0735518    38.12   0.000     2.659516     2.94786
         16  |   2.828748   .0776336    36.44   0.000     2.676575    2.980921
         17  |   2.855219   .0817664    34.92   0.000     2.694946    3.015493
         18  |   2.897896   .0857223    33.81   0.000     2.729868    3.065924
         19  |   2.894232   .0899871    32.16   0.000     2.717845     3.07062
         20  |   2.898953    .098734    29.36   0.000     2.705421    3.092486
         25  |   2.866911   .1152053    24.89   0.000     2.641092     3.09273
         30  |    2.69647   .1505915    17.91   0.000     2.401289    2.991651
         40  |   2.671228   .1800771    14.83   0.000     2.318251    3.024205
         50  |   2.567313   .1939194    13.24   0.000     2.187203    2.947422
             |
       _cons |   10.23396   .0413227   247.66   0.000     10.15296    10.31496
-------------+----------------------------------------------------------------
     sigma_u |  1.8150249
     sigma_e |  .91714677
         rho |   .7965993   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .3056764895869826

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    688,154
Group variable: firm_person                     Number of groups  =     41,071

R-sq:                                           Obs per group:
     within  = 0.3057                                         min =          1
     between = 0.0956                                         avg =       16.8
     overall = 0.1295                                         max =         25

                                                F(78,13202)       =     182.68
corr(u_i, Xb)  = 0.0343                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0708774   .0359778     1.97   0.049     .0003558     .141399
      during |  -.1684001   .0115694   -14.56   0.000    -.1910778   -.1457224
       after |  -.2999188   .0194126   -15.45   0.000    -.3379704   -.2618673
during_expat |   .2748049   .0239215    11.49   0.000     .2279154    .3216944
 after_expat |   .4619973   .0365939    12.62   0.000      .390268    .5337266
             |
    ind_year |
          2  |   .0035713   .0208457     0.17   0.864    -.0372893    .0444318
          3  |   .0403609   .0255721     1.58   0.115     -.009764    .0904859
          4  |   .0990739   .0294114     3.37   0.001     .0414233    .1567245
          5  |    .169534   .0332536     5.10   0.000     .1043521    .2347159
          6  |    .258545   .0365751     7.07   0.000     .1868525    .3302374
          7  |   .3231954   .0400653     8.07   0.000     .2446617    .4017291
          8  |   .3483419   .0441974     7.88   0.000     .2617086    .4349752
          9  |   .3975387   .0482034     8.25   0.000      .303053    .4920243
         10  |   .4415776   .0523445     8.44   0.000      .338975    .5441803
         11  |   .4340153   .0559267     7.76   0.000      .324391    .5436396
         12  |   .4116758   .0597988     6.88   0.000     .2944615      .52889
         13  |   .4214066   .0632133     6.67   0.000     .2974993    .5453138
         14  |   .4256326   .0669366     6.36   0.000     .2944273     .556838
         15  |   .4692933   .0706969     6.64   0.000     .3307173    .6078693
         16  |   .4701438   .0744888     6.31   0.000      .324135    .6161526
         17  |   .4872533   .0782209     6.23   0.000     .3339291    .6405775
         18  |   .3748777   .0820569     4.57   0.000     .2140344     .535721
         19  |   .3698356   .0859372     4.30   0.000     .2013863    .5382848
         20  |   .3775048   .0893411     4.23   0.000     .2023835    .5526262
         21  |   .3454632   .0925045     3.73   0.000      .164141    .5267854
         22  |    .365867   .0957227     3.82   0.000     .1782368    .5534971
         23  |   .4002236   .0987596     4.05   0.000     .2066407    .5938066
         24  |    .413864   .1023269     4.04   0.000     .2132886    .6144394
         25  |   .4259951   .1059872     4.02   0.000     .2182449    .6337452
         26  |   .2487131   .0646167     3.85   0.000     .1220551    .3753711
         27  |   .2030028   .0613786     3.31   0.001      .082692    .3233137
         28  |   .3029697   .0590373     5.13   0.000     .1872483    .4186912
         29  |   .4230912   .0585094     7.23   0.000     .3084044     .537778
         30  |   .5218976   .0582441     8.96   0.000     .4077308    .6360643
         31  |   .6082292    .059182    10.28   0.000     .4922239    .7242344
         32  |   .7102434   .0599531    11.85   0.000     .5927267      .82776
         33  |   .7306252    .061718    11.84   0.000     .6096491    .8516013
         34  |   .8225677   .0632646    13.00   0.000     .6985601    .9465753
         35  |   .8427433   .0656225    12.84   0.000     .7141138    .9713728
         36  |   .8117876   .0679153    11.95   0.000     .6786639    .9449114
         37  |   .8264187   .0703794    11.74   0.000      .688465    .9643724
         38  |   .8220841   .0736479    11.16   0.000     .6777236    .9664446
         39  |   .8396596   .0767541    10.94   0.000     .6892106    .9901086
         40  |   .9042748   .0803487    11.25   0.000     .7467798     1.06177
         41  |   .9497882   .0831376    11.42   0.000     .7868266     1.11275
         42  |   .9755883   .0864879    11.28   0.000     .8060596    1.145117
         43  |   .8202528   .0902705     9.09   0.000     .6433096     .997196
         44  |   .8410946   .0944224     8.91   0.000     .6560131    1.026176
         45  |   .9316562   .0978065     9.53   0.000     .7399414    1.123371
         46  |   .9282256   .1012783     9.17   0.000     .7297056    1.126746
         47  |    .958068   .1040086     9.21   0.000     .7541962     1.16194
         48  |   .9996282   .1071833     9.33   0.000     .7895336    1.209723
         49  |   1.015142   .1111172     9.14   0.000     .7973364    1.232948
         50  |   1.066764   .1142528     9.34   0.000     .8428117    1.290715
             |
     age_cat |
          1  |   1.054061   .0242657    43.44   0.000     1.006497    1.101625
          2  |    1.45862    .026583    54.87   0.000     1.406514    1.510727
          3  |   1.701682    .029419    57.84   0.000     1.644016    1.759347
          4  |   1.902922   .0322918    58.93   0.000     1.839625    1.966218
          5  |   2.055779   .0356845    57.61   0.000     1.985832    2.125726
          6  |   2.177423   .0390904    55.70   0.000       2.1008    2.254045
          7  |   2.293269   .0424872    53.98   0.000     2.209988     2.37655
          8  |   2.382852   .0462306    51.54   0.000     2.292233     2.47347
          9  |   2.467196   .0499897    49.35   0.000     2.369209    2.565183
         10  |   2.528176   .0538925    46.91   0.000     2.422539    2.633813
         11  |   2.602515   .0577443    45.07   0.000     2.489328    2.715703
         12  |   2.660909   .0617298    43.11   0.000      2.53991    2.781908
         13  |   2.711396   .0655276    41.38   0.000     2.582952    2.839839
         14  |   2.756713   .0695599    39.63   0.000     2.620366    2.893061
         15  |   2.803688   .0735518    38.12   0.000     2.659516     2.94786
         16  |   2.828748   .0776336    36.44   0.000     2.676575    2.980921
         17  |   2.855219   .0817664    34.92   0.000     2.694946    3.015493
         18  |   2.897896   .0857223    33.81   0.000     2.729868    3.065924
         19  |   2.894232   .0899871    32.16   0.000     2.717845     3.07062
         20  |   2.898953    .098734    29.36   0.000     2.705421    3.092486
         25  |   2.866911   .1152053    24.89   0.000     2.641092     3.09273
         30  |    2.69647   .1505915    17.91   0.000     2.401289    2.991651
         40  |   2.671228   .1800771    14.83   0.000     2.318251    3.024205
         50  |   2.567313   .1939194    13.24   0.000     2.187203    2.947422
             |
       _cons |   10.23396   .0413227   247.66   0.000     10.15296    10.31496
-------------+----------------------------------------------------------------
     sigma_u |  1.8150249
     sigma_e |  .91714677
         rho |   .7965993   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    633552
Group variable: firm_person                     Number of groups   =     40512

R-sq:  within  = 0.2002                         Obs per group: min =         1
       between = 0.0291                                        avg =      15.6
       overall = 0.0863                                        max =        25

                                                F(78,12829)        =    105.94
corr(u_i, Xb)  = -0.0395                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 12,830 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1153134   .0403191     2.86   0.004      .036282    .1943447
      during |    .023082   .0119294     1.93   0.053    -.0003013    .0464653
       after |   .0265047   .0190663     1.39   0.165    -.0108682    .0638775
during_expat |  -.2922445   .0246055   -11.88   0.000     -.340475    -.244014
 after_expat |  -.5366238   .0345382   -15.54   0.000    -.6043238   -.4689238
             |
    ind_year |
          2  |    .098883   .0244493     4.04   0.000     .0509588    .1468073
          3  |   .6374482   .0292021    21.83   0.000     .5802078    .6946887
          4  |   .7986775   .0321951    24.81   0.000     .7355704    .8617847
          5  |   .9824023     .03521    27.90   0.000     .9133855    1.051419
          6  |   1.226318   .0379756    32.29   0.000      1.15188    1.300756
          7  |   1.457959   .0407399    35.79   0.000     1.378103    1.537816
          8  |   1.616977   .0444128    36.41   0.000     1.529921    1.704032
          9  |   1.759473    .047308    37.19   0.000     1.666742    1.852204
         10  |   1.888498   .0506449    37.29   0.000     1.789227     1.98777
         11  |   2.029357   .0539272    37.63   0.000     1.923651    2.135062
         12  |   2.100826   .0575526    36.50   0.000     1.988015    2.213638
         13  |   2.188154    .061251    35.72   0.000     2.068093    2.308215
         14  |   2.224736    .064791    34.34   0.000     2.097736    2.351736
         15  |   2.208566   .0686118    32.19   0.000     2.074077    2.343055
         16  |   2.258103   .0721219    31.31   0.000     2.116733    2.399473
         17  |   2.310171   .0756689    30.53   0.000     2.161849    2.458494
         18  |   2.353662    .079803    29.49   0.000     2.197236    2.510088
         19  |   2.325945   .0837808    27.76   0.000     2.161722    2.490168
         20  |   2.326254    .087535    26.58   0.000     2.154673    2.497836
         21  |   2.373081   .0910137    26.07   0.000      2.19468    2.551481
         22  |   2.414252   .0941891    25.63   0.000     2.229627    2.598876
         23  |   2.498945   .0979452    25.51   0.000     2.306957    2.690932
         24  |   1.948192   .1051357    18.53   0.000      1.74211    2.154274
         25  |   2.014191   .1112825    18.10   0.000     1.796061    2.232321
         26  |   .3655663   .0618687     5.91   0.000     .2442945    .4868381
         27  |   .4849746   .0575441     8.43   0.000     .3721795    .5977697
         28  |   .7489895   .0550108    13.62   0.000     .6411602    .8568188
         29  |   .8790808   .0549113    16.01   0.000     .7714464    .9867152
         30  |   1.006432   .0551597    18.25   0.000     .8983104    1.114553
         31  |    1.14867   .0564148    20.36   0.000     1.038088    1.259251
         32  |   1.392574   .0568748    24.48   0.000     1.281091    1.504057
         33  |   1.530227    .058533    26.14   0.000     1.415494     1.64496
         34  |   1.646735   .0605251    27.21   0.000     1.528097    1.765374
         35  |   1.745473   .0628893    27.75   0.000     1.622201    1.868746
         36  |   1.871823   .0655199    28.57   0.000     1.743394    2.000252
         37  |   1.974271   .0682524    28.93   0.000     1.840486    2.108055
         38  |   2.049609     .07126    28.76   0.000     1.909929     2.18929
         39  |   2.099016   .0744022    28.21   0.000     1.953176    2.244855
         40  |   2.140282   .0774536    27.63   0.000     1.988462    2.292103
         41  |   2.201206   .0809657    27.19   0.000     2.042501    2.359911
         42  |   2.275201   .0843804    26.96   0.000     2.109803    2.440599
         43  |   2.355814   .0883405    26.67   0.000     2.182654    2.528975
         44  |   2.357895   .0921242    25.59   0.000     2.177318    2.538472
         45  |   2.418459   .0957172    25.27   0.000     2.230839    2.606078
         46  |   2.439869   .0988077    24.69   0.000     2.246191    2.633547
         47  |   2.502804   .1021052    24.51   0.000     2.302663    2.702945
         48  |   2.571201   .1054934    24.37   0.000     2.364419    2.777984
         49  |   2.368015   .1100593    21.52   0.000     2.152282    2.583748
         50  |   2.470251   .1141135    21.65   0.000     2.246572    2.693931
             |
     age_cat |
          1  |   .0803932   .0261073     3.08   0.002     .0292189    .1315675
          2  |   .0995953   .0288331     3.45   0.001     .0430781    .1561125
          3  |   .1079161   .0312127     3.46   0.001     .0467347    .1690976
          4  |   .1212282   .0339261     3.57   0.000     .0547279    .1877285
          5  |   .0838573   .0370379     2.26   0.024     .0112575    .1564572
          6  |    .056607   .0402281     1.41   0.159    -.0222461    .1354601
          7  |   .0269474    .043562     0.62   0.536    -.0584407    .1123354
          8  |   .0017141   .0470786     0.04   0.971     -.090567    .0939952
          9  |  -.0173376   .0507612    -0.34   0.733    -.1168371     .082162
         10  |  -.0487929   .0545878    -0.89   0.371    -.1557931    .0582072
         11  |   -.045816   .0581952    -0.79   0.431    -.1598872    .0682551
         12  |  -.0515603   .0619248    -0.83   0.405    -.1729422    .0698215
         13  |  -.0852216   .0658169    -1.29   0.195    -.2142325    .0437894
         14  |  -.0955128   .0698056    -1.37   0.171    -.2323421    .0413165
         15  |  -.1079134   .0737457    -1.46   0.143    -.2524661    .0366392
         16  |  -.1136053   .0777469    -1.46   0.144    -.2660008    .0387901
         17  |  -.1341619   .0818479    -1.64   0.101     -.294596    .0262722
         18  |  -.1644095   .0861478    -1.91   0.056    -.3332721    .0044531
         19  |  -.1770314   .0904939    -1.96   0.050     -.354413    .0003501
         20  |  -.2328592   .0988724    -2.36   0.019    -.4266639   -.0390545
         25  |  -.3889913   .1178612    -3.30   0.001    -.6200168   -.1579659
         30  |  -.3425127   .1493633    -2.29   0.022    -.6352869   -.0497384
         40  |  -.3022623    .179899    -1.68   0.093    -.6548911    .0503665
         50  |  -.3512628   .2043071    -1.72   0.086    -.7517351    .0492095
             |
       _cons |   4.589678   .0420219   109.22   0.000     4.507308    4.672047
-------------+----------------------------------------------------------------
     sigma_u |   1.583209
     sigma_e |  .94364372
         rho |  .73786879   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2002353830503273

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    633,552
Group variable: firm_person                     Number of groups  =     40,512

R-sq:                                           Obs per group:
     within  = 0.2002                                         min =          1
     between = 0.0291                                         avg =       15.6
     overall = 0.0863                                         max =         25

                                                F(78,12829)       =     105.94
corr(u_i, Xb)  = -0.0395                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 12,830 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1153134   .0403191     2.86   0.004      .036282    .1943447
      during |    .023082   .0119294     1.93   0.053    -.0003013    .0464653
       after |   .0265047   .0190663     1.39   0.165    -.0108682    .0638775
during_expat |  -.2922445   .0246055   -11.88   0.000     -.340475    -.244014
 after_expat |  -.5366238   .0345382   -15.54   0.000    -.6043238   -.4689238
             |
    ind_year |
          2  |    .098883   .0244493     4.04   0.000     .0509588    .1468073
          3  |   .6374482   .0292021    21.83   0.000     .5802078    .6946887
          4  |   .7986775   .0321951    24.81   0.000     .7355704    .8617847
          5  |   .9824023     .03521    27.90   0.000     .9133855    1.051419
          6  |   1.226318   .0379756    32.29   0.000      1.15188    1.300756
          7  |   1.457959   .0407399    35.79   0.000     1.378103    1.537816
          8  |   1.616977   .0444128    36.41   0.000     1.529921    1.704032
          9  |   1.759473    .047308    37.19   0.000     1.666742    1.852204
         10  |   1.888498   .0506449    37.29   0.000     1.789227     1.98777
         11  |   2.029357   .0539272    37.63   0.000     1.923651    2.135062
         12  |   2.100826   .0575526    36.50   0.000     1.988015    2.213638
         13  |   2.188154    .061251    35.72   0.000     2.068093    2.308215
         14  |   2.224736    .064791    34.34   0.000     2.097736    2.351736
         15  |   2.208566   .0686118    32.19   0.000     2.074077    2.343055
         16  |   2.258103   .0721219    31.31   0.000     2.116733    2.399473
         17  |   2.310171   .0756689    30.53   0.000     2.161849    2.458494
         18  |   2.353662    .079803    29.49   0.000     2.197236    2.510088
         19  |   2.325945   .0837808    27.76   0.000     2.161722    2.490168
         20  |   2.326254    .087535    26.58   0.000     2.154673    2.497836
         21  |   2.373081   .0910137    26.07   0.000      2.19468    2.551481
         22  |   2.414252   .0941891    25.63   0.000     2.229627    2.598876
         23  |   2.498945   .0979452    25.51   0.000     2.306957    2.690932
         24  |   1.948192   .1051357    18.53   0.000      1.74211    2.154274
         25  |   2.014191   .1112825    18.10   0.000     1.796061    2.232321
         26  |   .3655663   .0618687     5.91   0.000     .2442945    .4868381
         27  |   .4849746   .0575441     8.43   0.000     .3721795    .5977697
         28  |   .7489895   .0550108    13.62   0.000     .6411602    .8568188
         29  |   .8790808   .0549113    16.01   0.000     .7714464    .9867152
         30  |   1.006432   .0551597    18.25   0.000     .8983104    1.114553
         31  |    1.14867   .0564148    20.36   0.000     1.038088    1.259251
         32  |   1.392574   .0568748    24.48   0.000     1.281091    1.504057
         33  |   1.530227    .058533    26.14   0.000     1.415494     1.64496
         34  |   1.646735   .0605251    27.21   0.000     1.528097    1.765374
         35  |   1.745473   .0628893    27.75   0.000     1.622201    1.868746
         36  |   1.871823   .0655199    28.57   0.000     1.743394    2.000252
         37  |   1.974271   .0682524    28.93   0.000     1.840486    2.108055
         38  |   2.049609     .07126    28.76   0.000     1.909929     2.18929
         39  |   2.099016   .0744022    28.21   0.000     1.953176    2.244855
         40  |   2.140282   .0774536    27.63   0.000     1.988462    2.292103
         41  |   2.201206   .0809657    27.19   0.000     2.042501    2.359911
         42  |   2.275201   .0843804    26.96   0.000     2.109803    2.440599
         43  |   2.355814   .0883405    26.67   0.000     2.182654    2.528975
         44  |   2.357895   .0921242    25.59   0.000     2.177318    2.538472
         45  |   2.418459   .0957172    25.27   0.000     2.230839    2.606078
         46  |   2.439869   .0988077    24.69   0.000     2.246191    2.633547
         47  |   2.502804   .1021052    24.51   0.000     2.302663    2.702945
         48  |   2.571201   .1054934    24.37   0.000     2.364419    2.777984
         49  |   2.368015   .1100593    21.52   0.000     2.152282    2.583748
         50  |   2.470251   .1141135    21.65   0.000     2.246572    2.693931
             |
     age_cat |
          1  |   .0803932   .0261073     3.08   0.002     .0292189    .1315675
          2  |   .0995953   .0288331     3.45   0.001     .0430781    .1561125
          3  |   .1079161   .0312127     3.46   0.001     .0467347    .1690976
          4  |   .1212282   .0339261     3.57   0.000     .0547279    .1877285
          5  |   .0838573   .0370379     2.26   0.024     .0112575    .1564572
          6  |    .056607   .0402281     1.41   0.159    -.0222461    .1354601
          7  |   .0269474    .043562     0.62   0.536    -.0584407    .1123354
          8  |   .0017141   .0470786     0.04   0.971     -.090567    .0939952
          9  |  -.0173376   .0507612    -0.34   0.733    -.1168371     .082162
         10  |  -.0487929   .0545878    -0.89   0.371    -.1557931    .0582072
         11  |   -.045816   .0581952    -0.79   0.431    -.1598872    .0682551
         12  |  -.0515603   .0619248    -0.83   0.405    -.1729422    .0698215
         13  |  -.0852216   .0658169    -1.29   0.195    -.2142325    .0437894
         14  |  -.0955128   .0698056    -1.37   0.171    -.2323421    .0413165
         15  |  -.1079134   .0737457    -1.46   0.143    -.2524661    .0366392
         16  |  -.1136053   .0777469    -1.46   0.144    -.2660008    .0387901
         17  |  -.1341619   .0818479    -1.64   0.101     -.294596    .0262722
         18  |  -.1644095   .0861478    -1.91   0.056    -.3332721    .0044531
         19  |  -.1770314   .0904939    -1.96   0.050     -.354413    .0003501
         20  |  -.2328592   .0988724    -2.36   0.019    -.4266639   -.0390545
         25  |  -.3889913   .1178612    -3.30   0.001    -.6200168   -.1579659
         30  |  -.3425127   .1493633    -2.29   0.022    -.6352869   -.0497384
         40  |  -.3022623    .179899    -1.68   0.093    -.6548911    .0503665
         50  |  -.3512628   .2043071    -1.72   0.086    -.7517351    .0492095
             |
       _cons |   4.589678   .0420219   109.22   0.000     4.507308    4.672047
-------------+----------------------------------------------------------------
     sigma_u |   1.583209
     sigma_e |  .94364372
         rho |  .73786879   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    688154
Group variable: firm_person                     Number of groups   =     41071

R-sq:  within  = 0.3712                         Obs per group: min =         1
       between = 0.1260                                        avg =      16.8
       overall = 0.2036                                        max =        25

                                                F(78,13202)        =    271.37
corr(u_i, Xb)  = 0.0411                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0814543   .0229677     3.55   0.000     .0364344    .1264742
      during |   -.036078   .0072083    -5.01   0.000    -.0502072   -.0219488
       after |  -.0209747   .0114906    -1.83   0.068    -.0434979    .0015485
during_expat |     .10801   .0148952     7.25   0.000     .0788133    .1372068
 after_expat |   .1264768   .0221409     5.71   0.000     .0830775     .169876
             |
    ind_year |
          2  |    .149962   .0151824     9.88   0.000     .1202024    .1797216
          3  |   .3459206    .017623    19.63   0.000      .311377    .3804642
          4  |   .5438878   .0196401    27.69   0.000     .5053904    .5823852
          5  |   .7305199   .0211813    34.49   0.000     .6890015    .7720383
          6  |   .9219178   .0228069    40.42   0.000     .8772129    .9666227
          7  |   1.062039   .0242801    43.74   0.000     1.014447    1.109632
          8  |   1.154583   .0260029    44.40   0.000     1.103613    1.205552
          9  |   1.283208   .0278173    46.13   0.000     1.228682    1.337734
         10  |   1.403972   .0299489    46.88   0.000     1.345268    1.462676
         11  |   1.492037   .0316978    47.07   0.000     1.429904    1.554169
         12  |   1.531691     .03352    45.69   0.000     1.465987    1.597395
         13  |   1.602323   .0353573    45.32   0.000     1.533018    1.671629
         14  |   1.653246   .0372717    44.36   0.000     1.580188    1.726303
         15  |   1.724335   .0391985    43.99   0.000     1.647501     1.80117
         16  |   1.761924   .0411812    42.78   0.000     1.681203    1.842646
         17  |   1.825035    .043244    42.20   0.000      1.74027    1.909799
         18  |   1.786285   .0452398    39.48   0.000     1.697609    1.874962
         19  |   1.832704    .047631    38.48   0.000      1.73934    1.926067
         20  |   1.890108   .0494517    38.22   0.000     1.793175     1.98704
         21  |   1.916737   .0513242    37.35   0.000     1.816135     2.01734
         22  |   1.981941   .0530012    37.39   0.000     1.878051    2.085831
         23  |   2.042176   .0546903    37.34   0.000     1.934975    2.149377
         24  |   2.077791   .0565436    36.75   0.000     1.966957    2.188624
         25  |     2.0854   .0583505    35.74   0.000     1.971024    2.199775
         26  |  -.3572415   .0374105    -9.55   0.000    -.4305714   -.2839115
         27  |  -.2145178    .036579    -5.86   0.000    -.2862179   -.1428176
         28  |   .0137638   .0352782     0.39   0.696    -.0553866    .0829142
         29  |   .2656473   .0349647     7.60   0.000     .1971115    .3341832
         30  |   .4643461   .0346512    13.40   0.000     .3964247    .5322675
         31  |   .6452139   .0353302    18.26   0.000     .5759616    .7144662
         32  |   .8161715   .0358032    22.80   0.000      .745992     .886351
         33  |   .9213002   .0364347    25.29   0.000      .849883    .9927174
         34  |   1.075928   .0372486    28.89   0.000     1.002915    1.148941
         35  |   1.171081   .0380845    30.75   0.000      1.09643    1.245732
         36  |   1.245174   .0391276    31.82   0.000     1.168479     1.32187
         37  |   1.331051   .0405521    32.82   0.000     1.251563    1.410539
         38  |   1.419635    .042318    33.55   0.000     1.336685    1.502584
         39  |   1.500053   .0439154    34.16   0.000     1.413973    1.586133
         40  |   1.614941   .0458338    35.23   0.000     1.525101    1.704782
         41  |   1.697301   .0471119    36.03   0.000     1.604955    1.789647
         42  |   1.769475   .0487371    36.31   0.000     1.673943    1.865006
         43  |   1.764749   .0508465    34.71   0.000     1.665082    1.864415
         44  |   1.837584   .0529726    34.69   0.000      1.73375    1.941418
         45  |   1.928832   .0547106    35.26   0.000     1.821592    2.036073
         46  |   1.954731   .0565917    34.54   0.000     1.843804    2.065659
         47  |   1.999616   .0577828    34.61   0.000     1.886354    2.112879
         48  |   2.048998   .0594279    34.48   0.000     1.932511    2.165485
         49  |   2.055205   .0618875    33.21   0.000     1.933897    2.176514
         50  |   2.092145   .0633601    33.02   0.000      1.96795     2.21634
             |
     age_cat |
          1  |   .6184284   .0191394    32.31   0.000     .5809123    .6559444
          2  |   .6790922   .0201999    33.62   0.000     .6394974     .718687
          3  |   .6795971   .0214013    31.76   0.000     .6376475    .7215466
          4  |   .6795271   .0226633    29.98   0.000     .6351037    .7239504
          5  |   .6555171   .0242143    27.07   0.000     .6080536    .7029806
          6  |    .633374   .0257141    24.63   0.000     .5829706    .6837773
          7  |   .6269246   .0272789    22.98   0.000     .5734541    .6803951
          8  |   .6084183   .0289926    20.99   0.000     .5515886     .665248
          9  |   .6022419   .0307651    19.58   0.000     .5419378    .6625459
         10  |   .5916781   .0326439    18.13   0.000     .5276914    .6556649
         11  |   .5855837   .0347072    16.87   0.000     .5175526    .6536148
         12  |   .5724598   .0366105    15.64   0.000      .500698    .6442217
         13  |   .5522733   .0385285    14.33   0.000      .476752    .6277947
         14  |   .5515152   .0405772    13.59   0.000      .471978    .6310525
         15  |   .5532635   .0426871    12.96   0.000     .4695907    .6369363
         16  |   .5253404   .0447731    11.73   0.000     .4375787     .613102
         17  |   .5039605   .0469344    10.74   0.000     .4119623    .5959588
         18  |   .4911506   .0489402    10.04   0.000     .3952207    .5870805
         19  |   .4610576   .0514325     8.96   0.000     .3602426    .5618727
         20  |   .4234211   .0557038     7.60   0.000     .3142337    .5326085
         25  |   .3726417   .0642751     5.80   0.000     .2466534      .49863
         30  |   .4449992   .0824649     5.40   0.000     .2833561    .6066423
         40  |   .5442926   .0980588     5.55   0.000     .3520833     .736502
         50  |   .4991499   .1106767     4.51   0.000     .2822078    .7160921
             |
       _cons |   7.150013     .02739   261.04   0.000     7.096325    7.203701
-------------+----------------------------------------------------------------
     sigma_u |  1.2372594
     sigma_e |  .63700251
         rho |  .79047001   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .3711618186354352

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    688,154
Group variable: firm_person                     Number of groups  =     41,071

R-sq:                                           Obs per group:
     within  = 0.3712                                         min =          1
     between = 0.1260                                         avg =       16.8
     overall = 0.2036                                         max =         25

                                                F(78,13202)       =     271.37
corr(u_i, Xb)  = 0.0411                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0814543   .0229677     3.55   0.000     .0364344    .1264742
      during |   -.036078   .0072083    -5.01   0.000    -.0502072   -.0219488
       after |  -.0209747   .0114906    -1.83   0.068    -.0434979    .0015485
during_expat |     .10801   .0148952     7.25   0.000     .0788133    .1372068
 after_expat |   .1264768   .0221409     5.71   0.000     .0830775     .169876
             |
    ind_year |
          2  |    .149962   .0151824     9.88   0.000     .1202024    .1797216
          3  |   .3459206    .017623    19.63   0.000      .311377    .3804642
          4  |   .5438878   .0196401    27.69   0.000     .5053904    .5823852
          5  |   .7305199   .0211813    34.49   0.000     .6890015    .7720383
          6  |   .9219178   .0228069    40.42   0.000     .8772129    .9666227
          7  |   1.062039   .0242801    43.74   0.000     1.014447    1.109632
          8  |   1.154583   .0260029    44.40   0.000     1.103613    1.205552
          9  |   1.283208   .0278173    46.13   0.000     1.228682    1.337734
         10  |   1.403972   .0299489    46.88   0.000     1.345268    1.462676
         11  |   1.492037   .0316978    47.07   0.000     1.429904    1.554169
         12  |   1.531691     .03352    45.69   0.000     1.465987    1.597395
         13  |   1.602323   .0353573    45.32   0.000     1.533018    1.671629
         14  |   1.653246   .0372717    44.36   0.000     1.580188    1.726303
         15  |   1.724335   .0391985    43.99   0.000     1.647501     1.80117
         16  |   1.761924   .0411812    42.78   0.000     1.681203    1.842646
         17  |   1.825035    .043244    42.20   0.000      1.74027    1.909799
         18  |   1.786285   .0452398    39.48   0.000     1.697609    1.874962
         19  |   1.832704    .047631    38.48   0.000      1.73934    1.926067
         20  |   1.890108   .0494517    38.22   0.000     1.793175     1.98704
         21  |   1.916737   .0513242    37.35   0.000     1.816135     2.01734
         22  |   1.981941   .0530012    37.39   0.000     1.878051    2.085831
         23  |   2.042176   .0546903    37.34   0.000     1.934975    2.149377
         24  |   2.077791   .0565436    36.75   0.000     1.966957    2.188624
         25  |     2.0854   .0583505    35.74   0.000     1.971024    2.199775
         26  |  -.3572415   .0374105    -9.55   0.000    -.4305714   -.2839115
         27  |  -.2145178    .036579    -5.86   0.000    -.2862179   -.1428176
         28  |   .0137638   .0352782     0.39   0.696    -.0553866    .0829142
         29  |   .2656473   .0349647     7.60   0.000     .1971115    .3341832
         30  |   .4643461   .0346512    13.40   0.000     .3964247    .5322675
         31  |   .6452139   .0353302    18.26   0.000     .5759616    .7144662
         32  |   .8161715   .0358032    22.80   0.000      .745992     .886351
         33  |   .9213002   .0364347    25.29   0.000      .849883    .9927174
         34  |   1.075928   .0372486    28.89   0.000     1.002915    1.148941
         35  |   1.171081   .0380845    30.75   0.000      1.09643    1.245732
         36  |   1.245174   .0391276    31.82   0.000     1.168479     1.32187
         37  |   1.331051   .0405521    32.82   0.000     1.251563    1.410539
         38  |   1.419635    .042318    33.55   0.000     1.336685    1.502584
         39  |   1.500053   .0439154    34.16   0.000     1.413973    1.586133
         40  |   1.614941   .0458338    35.23   0.000     1.525101    1.704782
         41  |   1.697301   .0471119    36.03   0.000     1.604955    1.789647
         42  |   1.769475   .0487371    36.31   0.000     1.673943    1.865006
         43  |   1.764749   .0508465    34.71   0.000     1.665082    1.864415
         44  |   1.837584   .0529726    34.69   0.000      1.73375    1.941418
         45  |   1.928832   .0547106    35.26   0.000     1.821592    2.036073
         46  |   1.954731   .0565917    34.54   0.000     1.843804    2.065659
         47  |   1.999616   .0577828    34.61   0.000     1.886354    2.112879
         48  |   2.048998   .0594279    34.48   0.000     1.932511    2.165485
         49  |   2.055205   .0618875    33.21   0.000     1.933897    2.176514
         50  |   2.092145   .0633601    33.02   0.000      1.96795     2.21634
             |
     age_cat |
          1  |   .6184284   .0191394    32.31   0.000     .5809123    .6559444
          2  |   .6790922   .0201999    33.62   0.000     .6394974     .718687
          3  |   .6795971   .0214013    31.76   0.000     .6376475    .7215466
          4  |   .6795271   .0226633    29.98   0.000     .6351037    .7239504
          5  |   .6555171   .0242143    27.07   0.000     .6080536    .7029806
          6  |    .633374   .0257141    24.63   0.000     .5829706    .6837773
          7  |   .6269246   .0272789    22.98   0.000     .5734541    .6803951
          8  |   .6084183   .0289926    20.99   0.000     .5515886     .665248
          9  |   .6022419   .0307651    19.58   0.000     .5419378    .6625459
         10  |   .5916781   .0326439    18.13   0.000     .5276914    .6556649
         11  |   .5855837   .0347072    16.87   0.000     .5175526    .6536148
         12  |   .5724598   .0366105    15.64   0.000      .500698    .6442217
         13  |   .5522733   .0385285    14.33   0.000      .476752    .6277947
         14  |   .5515152   .0405772    13.59   0.000      .471978    .6310525
         15  |   .5532635   .0426871    12.96   0.000     .4695907    .6369363
         16  |   .5253404   .0447731    11.73   0.000     .4375787     .613102
         17  |   .5039605   .0469344    10.74   0.000     .4119623    .5959588
         18  |   .4911506   .0489402    10.04   0.000     .3952207    .5870805
         19  |   .4610576   .0514325     8.96   0.000     .3602426    .5618727
         20  |   .4234211   .0557038     7.60   0.000     .3142337    .5326085
         25  |   .3726417   .0642751     5.80   0.000     .2466534      .49863
         30  |   .4449992   .0824649     5.40   0.000     .2833561    .6066423
         40  |   .5442926   .0980588     5.55   0.000     .3520833     .736502
         50  |   .4991499   .1106767     4.51   0.000     .2822078    .7160921
             |
       _cons |   7.150013     .02739   261.04   0.000     7.096325    7.203701
-------------+----------------------------------------------------------------
     sigma_u |  1.2372594
     sigma_e |  .63700251
         rho |  .79047001   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    688154
Group variable: firm_person                     Number of groups   =     41071

R-sq:  within  = 0.0341                         Obs per group: min =         1
       between = 0.1682                                        avg =      16.8
       overall = 0.0867                                        max =        25

                                                F(78,13202)        =     27.42
corr(u_i, Xb)  = 0.1983                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0204366   .0105051     1.95   0.052    -.0001548    .0410281
      during |  -.0182396   .0032591    -5.60   0.000    -.0246279   -.0118513
       after |  -.0359829   .0051835    -6.94   0.000    -.0461432   -.0258225
during_expat |   .0127359   .0061722     2.06   0.039     .0006375    .0248343
 after_expat |    .014207   .0085545     1.66   0.097     -.002561     .030975
             |
    ind_year |
          2  |  -.0138502   .0068632    -2.02   0.044     -.027303   -.0003974
          3  |    -.03053   .0078748    -3.88   0.000    -.0459659   -.0150942
          4  |  -.0453414   .0087613    -5.18   0.000    -.0625149   -.0281679
          5  |  -.0483837   .0093656    -5.17   0.000    -.0667416   -.0300259
          6  |   -.059898   .0100008    -5.99   0.000    -.0795009   -.0402951
          7  |  -.0592795   .0105494    -5.62   0.000    -.0799578   -.0386012
          8  |  -.0776111   .0112605    -6.89   0.000    -.0996833   -.0555389
          9  |  -.0751037   .0120053    -6.26   0.000    -.0986359   -.0515716
         10  |  -.0750811    .012853    -5.84   0.000    -.1002748   -.0498874
         11  |    -.08318   .0138073    -6.02   0.000    -.1102443   -.0561157
         12  |  -.0862529   .0145751    -5.92   0.000    -.1148222   -.0576837
         13  |  -.0815618   .0154459    -5.28   0.000     -.111838   -.0512856
         14  |  -.0701828   .0164327    -4.27   0.000    -.1023933   -.0379724
         15  |  -.0639594   .0173003    -3.70   0.000    -.0978705   -.0300482
         16  |  -.0424731   .0183319    -2.32   0.021    -.0784064   -.0065399
         17  |  -.0259745   .0192508    -1.35   0.177    -.0637089    .0117598
         18  |  -.0191291   .0203807    -0.94   0.348    -.0590782      .02082
         19  |   -.019364   .0213053    -0.91   0.363    -.0611255    .0223975
         20  |  -.0066512   .0223319    -0.30   0.766    -.0504249    .0371225
         21  |  -.0063506   .0232081    -0.27   0.784    -.0518418    .0391405
         22  |    .001753   .0239842     0.07   0.942    -.0452596    .0487655
         23  |  -.0114632   .0247831    -0.46   0.644    -.0600417    .0371153
         24  |  -.0785051   .0256945    -3.06   0.002      -.12887   -.0281403
         25  |  -.1058589   .0266205    -3.98   0.000    -.1580389   -.0536789
         26  |   .0898993   .0162915     5.52   0.000     .0579656     .121833
         27  |   .0649797   .0153629     4.23   0.000     .0348662    .0950932
         28  |   .0716776   .0147014     4.88   0.000     .0428606    .1004945
         29  |   .0694856   .0145089     4.79   0.000      .041046    .0979252
         30  |   .0761972   .0145543     5.24   0.000     .0476687    .1047256
         31  |   .0590047   .0146403     4.03   0.000     .0303076    .0877017
         32  |   .0542129   .0148867     3.64   0.000     .0250328     .083393
         33  |   .0470337      .0152     3.09   0.002     .0172394     .076828
         34  |   .0433337   .0156487     2.77   0.006       .01266    .0740075
         35  |   .0447994   .0160664     2.79   0.005     .0133069    .0762918
         36  |   .0384122   .0167064     2.30   0.022     .0056653    .0711591
         37  |   .0400385   .0172928     2.32   0.021     .0061421    .0739349
         38  |   .0440071   .0180192     2.44   0.015     .0086869    .0793274
         39  |   .0405595   .0187883     2.16   0.031     .0037317    .0773873
         40  |   .0372506   .0195392     1.91   0.057     -.001049    .0755502
         41  |   .0487264   .0203821     2.39   0.017     .0087746    .0886782
         42  |   .0492022   .0212888     2.31   0.021     .0074732    .0909312
         43  |   .0566379   .0222913     2.54   0.011     .0129437     .100332
         44  |   .0642248   .0231967     2.77   0.006     .0187559    .1096937
         45  |   .0736053   .0240162     3.06   0.002     .0265301    .1206805
         46  |   .0783783   .0249623     3.14   0.002     .0294487    .1273079
         47  |   .0832391   .0257757     3.23   0.001      .032715    .1337633
         48  |   .0739155   .0265571     2.78   0.005     .0218598    .1259712
         49  |   -.102768   .0276937    -3.71   0.000    -.1570515   -.0484844
         50  |  -.1415359   .0286201    -4.95   0.000    -.1976354   -.0854364
             |
     age_cat |
          1  |   .0599457   .0055255    10.85   0.000     .0491149    .0707764
          2  |   .0898143     .00619    14.51   0.000     .0776811    .1019475
          3  |   .1099806   .0068105    16.15   0.000      .096631    .1233302
          4  |   .1345361   .0076688    17.54   0.000     .1195041    .1495682
          5  |   .1500245   .0084411    17.77   0.000     .1334788    .1665702
          6  |   .1580083   .0093159    16.96   0.000     .1397478    .1762689
          7  |   .1699668   .0101744    16.71   0.000     .1500235    .1899101
          8  |   .1815298   .0111161    16.33   0.000     .1597407     .203319
          9  |   .1867774   .0120655    15.48   0.000     .1631273    .2104274
         10  |   .1888277    .013044    14.48   0.000     .1632596    .2143959
         11  |   .1966978   .0140409    14.01   0.000     .1691756    .2242201
         12  |   .1994699   .0149839    13.31   0.000     .1700993    .2288405
         13  |   .1969099   .0159922    12.31   0.000     .1655629    .2282568
         14  |   .2045076   .0170444    12.00   0.000      .171098    .2379171
         15  |   .2175431   .0180478    12.05   0.000     .1821669    .2529193
         16  |   .2289606   .0191032    11.99   0.000     .1915155    .2664057
         17  |   .2270101   .0201528    11.26   0.000     .1875076    .2665125
         18  |   .2217654   .0212592    10.43   0.000     .1800943    .2634365
         19  |   .2186662    .022404     9.76   0.000     .1747511    .2625813
         20  |   .2252001   .0245232     9.18   0.000     .1771311    .2732691
         25  |   .2324418   .0289893     8.02   0.000     .1756186     .289265
         30  |   .2333998   .0372048     6.27   0.000      .160473    .3063266
         40  |   .2407364   .0449936     5.35   0.000     .1525425    .3289302
         50  |   .2168175   .0513929     4.22   0.000     .1160801     .317555
             |
       _cons |   .2856374   .0098747    28.93   0.000     .2662815    .3049932
-------------+----------------------------------------------------------------
     sigma_u |  .39252384
     sigma_e |  .29406792
         rho |  .64050878   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0340816022362394

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    688,154
Group variable: firm_person                     Number of groups  =     41,071

R-sq:                                           Obs per group:
     within  = 0.0341                                         min =          1
     between = 0.1682                                         avg =       16.8
     overall = 0.0867                                         max =         25

                                                F(78,13202)       =      27.42
corr(u_i, Xb)  = 0.1983                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,203 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0204366   .0105051     1.95   0.052    -.0001548    .0410281
      during |  -.0182396   .0032591    -5.60   0.000    -.0246279   -.0118513
       after |  -.0359829   .0051835    -6.94   0.000    -.0461432   -.0258225
during_expat |   .0127359   .0061722     2.06   0.039     .0006375    .0248343
 after_expat |    .014207   .0085545     1.66   0.097     -.002561     .030975
             |
    ind_year |
          2  |  -.0138502   .0068632    -2.02   0.044     -.027303   -.0003974
          3  |    -.03053   .0078748    -3.88   0.000    -.0459659   -.0150942
          4  |  -.0453414   .0087613    -5.18   0.000    -.0625149   -.0281679
          5  |  -.0483837   .0093656    -5.17   0.000    -.0667416   -.0300259
          6  |   -.059898   .0100008    -5.99   0.000    -.0795009   -.0402951
          7  |  -.0592795   .0105494    -5.62   0.000    -.0799578   -.0386012
          8  |  -.0776111   .0112605    -6.89   0.000    -.0996833   -.0555389
          9  |  -.0751037   .0120053    -6.26   0.000    -.0986359   -.0515716
         10  |  -.0750811    .012853    -5.84   0.000    -.1002748   -.0498874
         11  |    -.08318   .0138073    -6.02   0.000    -.1102443   -.0561157
         12  |  -.0862529   .0145751    -5.92   0.000    -.1148222   -.0576837
         13  |  -.0815618   .0154459    -5.28   0.000     -.111838   -.0512856
         14  |  -.0701828   .0164327    -4.27   0.000    -.1023933   -.0379724
         15  |  -.0639594   .0173003    -3.70   0.000    -.0978705   -.0300482
         16  |  -.0424731   .0183319    -2.32   0.021    -.0784064   -.0065399
         17  |  -.0259745   .0192508    -1.35   0.177    -.0637089    .0117598
         18  |  -.0191291   .0203807    -0.94   0.348    -.0590782      .02082
         19  |   -.019364   .0213053    -0.91   0.363    -.0611255    .0223975
         20  |  -.0066512   .0223319    -0.30   0.766    -.0504249    .0371225
         21  |  -.0063506   .0232081    -0.27   0.784    -.0518418    .0391405
         22  |    .001753   .0239842     0.07   0.942    -.0452596    .0487655
         23  |  -.0114632   .0247831    -0.46   0.644    -.0600417    .0371153
         24  |  -.0785051   .0256945    -3.06   0.002      -.12887   -.0281403
         25  |  -.1058589   .0266205    -3.98   0.000    -.1580389   -.0536789
         26  |   .0898993   .0162915     5.52   0.000     .0579656     .121833
         27  |   .0649797   .0153629     4.23   0.000     .0348662    .0950932
         28  |   .0716776   .0147014     4.88   0.000     .0428606    .1004945
         29  |   .0694856   .0145089     4.79   0.000      .041046    .0979252
         30  |   .0761972   .0145543     5.24   0.000     .0476687    .1047256
         31  |   .0590047   .0146403     4.03   0.000     .0303076    .0877017
         32  |   .0542129   .0148867     3.64   0.000     .0250328     .083393
         33  |   .0470337      .0152     3.09   0.002     .0172394     .076828
         34  |   .0433337   .0156487     2.77   0.006       .01266    .0740075
         35  |   .0447994   .0160664     2.79   0.005     .0133069    .0762918
         36  |   .0384122   .0167064     2.30   0.022     .0056653    .0711591
         37  |   .0400385   .0172928     2.32   0.021     .0061421    .0739349
         38  |   .0440071   .0180192     2.44   0.015     .0086869    .0793274
         39  |   .0405595   .0187883     2.16   0.031     .0037317    .0773873
         40  |   .0372506   .0195392     1.91   0.057     -.001049    .0755502
         41  |   .0487264   .0203821     2.39   0.017     .0087746    .0886782
         42  |   .0492022   .0212888     2.31   0.021     .0074732    .0909312
         43  |   .0566379   .0222913     2.54   0.011     .0129437     .100332
         44  |   .0642248   .0231967     2.77   0.006     .0187559    .1096937
         45  |   .0736053   .0240162     3.06   0.002     .0265301    .1206805
         46  |   .0783783   .0249623     3.14   0.002     .0294487    .1273079
         47  |   .0832391   .0257757     3.23   0.001      .032715    .1337633
         48  |   .0739155   .0265571     2.78   0.005     .0218598    .1259712
         49  |   -.102768   .0276937    -3.71   0.000    -.1570515   -.0484844
         50  |  -.1415359   .0286201    -4.95   0.000    -.1976354   -.0854364
             |
     age_cat |
          1  |   .0599457   .0055255    10.85   0.000     .0491149    .0707764
          2  |   .0898143     .00619    14.51   0.000     .0776811    .1019475
          3  |   .1099806   .0068105    16.15   0.000      .096631    .1233302
          4  |   .1345361   .0076688    17.54   0.000     .1195041    .1495682
          5  |   .1500245   .0084411    17.77   0.000     .1334788    .1665702
          6  |   .1580083   .0093159    16.96   0.000     .1397478    .1762689
          7  |   .1699668   .0101744    16.71   0.000     .1500235    .1899101
          8  |   .1815298   .0111161    16.33   0.000     .1597407     .203319
          9  |   .1867774   .0120655    15.48   0.000     .1631273    .2104274
         10  |   .1888277    .013044    14.48   0.000     .1632596    .2143959
         11  |   .1966978   .0140409    14.01   0.000     .1691756    .2242201
         12  |   .1994699   .0149839    13.31   0.000     .1700993    .2288405
         13  |   .1969099   .0159922    12.31   0.000     .1655629    .2282568
         14  |   .2045076   .0170444    12.00   0.000      .171098    .2379171
         15  |   .2175431   .0180478    12.05   0.000     .1821669    .2529193
         16  |   .2289606   .0191032    11.99   0.000     .1915155    .2664057
         17  |   .2270101   .0201528    11.26   0.000     .1875076    .2665125
         18  |   .2217654   .0212592    10.43   0.000     .1800943    .2634365
         19  |   .2186662    .022404     9.76   0.000     .1747511    .2625813
         20  |   .2252001   .0245232     9.18   0.000     .1771311    .2732691
         25  |   .2324418   .0289893     8.02   0.000     .1756186     .289265
         30  |   .2333998   .0372048     6.27   0.000      .160473    .3063266
         40  |   .2407364   .0449936     5.35   0.000     .1525425    .3289302
         50  |   .2168175   .0513929     4.22   0.000     .1160801     .317555
             |
       _cons |   .2856374   .0098747    28.93   0.000     .2662815    .3049932
-------------+----------------------------------------------------------------
     sigma_u |  .39252384
     sigma_e |  .29406792
         rho |  .64050878   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    574978
Group variable: firm_person                     Number of groups   =     39895

R-sq:  within  = 0.0341                         Obs per group: min =         1
       between = 0.0122                                        avg =      14.4
       overall = 0.0255                                        max =        24

                                                F(75,12443)        =     72.78
corr(u_i, Xb)  = -0.1439                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 12,444 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0031461    .020328     0.15   0.877       -.0367    .0429922
      during |  -.0135301    .006988    -1.94   0.053    -.0272277    .0001675
       after |  -.0198382   .0097611    -2.03   0.042    -.0389715   -.0007048
during_expat |  -.0089172   .0132067    -0.68   0.500    -.0348044      .01697
 after_expat |   .0155406   .0156965     0.99   0.322    -.0152268    .0463081
             |
    ind_year |
          3  |  -.0434145   .0249374    -1.74   0.082    -.0922957    .0054667
          4  |   -.001469   .0249655    -0.06   0.953    -.0504052    .0474671
          5  |   .0191509   .0256194     0.75   0.455    -.0310671     .069369
          6  |   .0157963   .0260023     0.61   0.544    -.0351722    .0667647
          7  |   .1204858   .0265462     4.54   0.000     .0684512    .1725205
          8  |   .0168217   .0278385     0.60   0.546    -.0377462    .0713896
          9  |   .0424712   .0288683     1.47   0.141     -.014115    .0990575
         10  |   .0083992   .0296804     0.28   0.777    -.0497791    .0665774
         11  |   .0716903   .0311891     2.30   0.022     .0105548    .1328257
         12  |   .0615475   .0325387     1.89   0.059    -.0022333    .1253284
         13  |  -.0320094   .0338861    -0.94   0.345    -.0984314    .0344127
         14  |  -.1140548   .0352573    -3.23   0.001    -.1831647    -.044945
         15  |  -.0008088   .0367197    -0.02   0.982    -.0727851    .0711675
         16  |   .0102809   .0390285     0.26   0.792    -.0662211    .0867828
         17  |  -.0080248   .0404524    -0.20   0.843    -.0873178    .0712681
         18  |   .0352715   .0421829     0.84   0.403    -.0474136    .1179566
         19  |  -.0146582   .0439596    -0.33   0.739    -.1008258    .0715094
         20  |   .0671936   .0460479     1.46   0.145    -.0230673    .1574546
         21  |  -.0581634   .0476304    -1.22   0.222    -.1515264    .0351996
         22  |   .2619724    .049328     5.31   0.000     .1652818     .358663
         23  |  -.0288599   .0510457    -0.57   0.572    -.1289174    .0711976
         24  |  -.3707344   .0538406    -6.89   0.000    -.4762702   -.2651985
         25  |   .0072311   .0589557     0.12   0.902    -.1083311    .1227934
         27  |  -.0412197   .0362473    -1.14   0.255      -.11227    .0298307
         28  |  -.2651843   .0339427    -7.81   0.000    -.3317173   -.1986514
         29  |  -.0848686    .032587    -2.60   0.009    -.1487442   -.0209931
         30  |  -.1950089   .0323699    -6.02   0.000    -.2584588   -.1315589
         31  |  -.0493066   .0325421    -1.52   0.130    -.1130941    .0144809
         32  |  -.1530599   .0330307    -4.63   0.000    -.2178052   -.0883145
         33  |  -.0187519   .0329906    -0.57   0.570    -.0834186    .0459147
         34  |  -.1384501   .0337069    -4.11   0.000    -.2045207   -.0723794
         35  |  -.0742503   .0348992    -2.13   0.033    -.1426582   -.0058425
         36  |  -.0747481    .035962    -2.08   0.038    -.1452393    -.004257
         37  |  -.1347372    .037337    -3.61   0.000    -.2079234    -.061551
         38  |   -.067105   .0384416    -1.75   0.081    -.1424564    .0082464
         39  |  -.1589333   .0396325    -4.01   0.000     -.236619   -.0812475
         40  |  -.1044528   .0409909    -2.55   0.011    -.1848012   -.0241043
         41  |  -.1343084   .0431116    -3.12   0.002    -.2188137    -.049803
         42  |  -.0758945   .0446191    -1.70   0.089    -.1633548    .0115658
         43  |   .0158194   .0459616     0.34   0.731    -.0742725    .1059113
         44  |   -.030823   .0480182    -0.64   0.521    -.1249461       .0633
         45  |  -.2470294   .0494112    -5.00   0.000    -.3438829   -.1501759
         46  |  -.0946732   .0511874    -1.85   0.064    -.1950084    .0056621
         47  |   .1061115    .053194     1.99   0.046     .0018431    .2103799
         48  |  -.2098581   .0543878    -3.86   0.000    -.3164666   -.1032496
         49  |  -.6783862   .0558189   -12.15   0.000    -.7877998   -.5689726
         50  |  -.1156924   .0633757    -1.83   0.068    -.2399186    .0085337
             |
     age_cat |
          2  |  -.1315286   .0191485    -6.87   0.000    -.1690625   -.0939946
          3  |  -.2547747   .0195261   -13.05   0.000    -.2930489   -.2165006
          4  |  -.3121673   .0201192   -15.52   0.000    -.3516041   -.2727305
          5  |  -.3758556   .0211946   -17.73   0.000    -.4174002    -.334311
          6  |  -.3926722   .0222766   -17.63   0.000    -.4363377   -.3490066
          7  |  -.4392834   .0236081   -18.61   0.000    -.4855589   -.3930079
          8  |  -.4493403   .0249922   -17.98   0.000    -.4983287   -.4003518
          9  |  -.4783209   .0266031   -17.98   0.000    -.5304671   -.4261748
         10  |  -.5049582   .0281884   -17.91   0.000    -.5602119   -.4497045
         11  |  -.4937706   .0299755   -16.47   0.000    -.5525272    -.435014
         12  |  -.4971077   .0316828   -15.69   0.000    -.5592109   -.4350044
         13  |  -.5449382   .0334873   -16.27   0.000    -.6105785   -.4792978
         14  |  -.5246367   .0355748   -14.75   0.000    -.5943688   -.4549045
         15  |   -.544882   .0373761   -14.58   0.000     -.618145    -.471619
         16  |  -.5371542   .0393604   -13.65   0.000    -.6143066   -.4600018
         17  |   -.549032   .0412587   -13.31   0.000    -.6299055   -.4681586
         18  |  -.5859329    .043538   -13.46   0.000    -.6712742   -.5005916
         19  |  -.5465926   .0458096   -11.93   0.000    -.6363865   -.4567986
         20  |   -.578991   .0491199   -11.79   0.000    -.6752735   -.4827084
         25  |  -.5833607    .059669    -9.78   0.000    -.7003213   -.4664002
         30  |   -.599957   .0763828    -7.85   0.000    -.7496792   -.4502348
         40  |   -.631154   .0935149    -6.75   0.000    -.8144578   -.4478503
         50  |  -.6170072   .1158449    -5.33   0.000    -.8440811   -.3899334
             |
       _cons |   .3752848   .0266705    14.07   0.000     .3230065    .4275631
-------------+----------------------------------------------------------------
     sigma_u |  .34313234
     sigma_e |  .86302256
         rho |  .13650236   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .034093428136359

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    574,978
Group variable: firm_person                     Number of groups  =     39,895

R-sq:                                           Obs per group:
     within  = 0.0341                                         min =          1
     between = 0.0122                                         avg =       14.4
     overall = 0.0255                                         max =         24

                                                F(75,12443)       =      72.78
corr(u_i, Xb)  = -0.1439                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 12,444 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0031461    .020328     0.15   0.877       -.0367    .0429922
      during |  -.0135301    .006988    -1.94   0.053    -.0272277    .0001675
       after |  -.0198382   .0097611    -2.03   0.042    -.0389715   -.0007048
during_expat |  -.0089172   .0132067    -0.68   0.500    -.0348044      .01697
 after_expat |   .0155406   .0156965     0.99   0.322    -.0152268    .0463081
             |
    ind_year |
          3  |  -.0434145   .0249374    -1.74   0.082    -.0922957    .0054667
          4  |   -.001469   .0249655    -0.06   0.953    -.0504052    .0474671
          5  |   .0191509   .0256194     0.75   0.455    -.0310671     .069369
          6  |   .0157963   .0260023     0.61   0.544    -.0351722    .0667647
          7  |   .1204858   .0265462     4.54   0.000     .0684512    .1725205
          8  |   .0168217   .0278385     0.60   0.546    -.0377462    .0713896
          9  |   .0424712   .0288683     1.47   0.141     -.014115    .0990575
         10  |   .0083992   .0296804     0.28   0.777    -.0497791    .0665774
         11  |   .0716903   .0311891     2.30   0.022     .0105548    .1328257
         12  |   .0615475   .0325387     1.89   0.059    -.0022333    .1253284
         13  |  -.0320094   .0338861    -0.94   0.345    -.0984314    .0344127
         14  |  -.1140548   .0352573    -3.23   0.001    -.1831647    -.044945
         15  |  -.0008088   .0367197    -0.02   0.982    -.0727851    .0711675
         16  |   .0102809   .0390285     0.26   0.792    -.0662211    .0867828
         17  |  -.0080248   .0404524    -0.20   0.843    -.0873178    .0712681
         18  |   .0352715   .0421829     0.84   0.403    -.0474136    .1179566
         19  |  -.0146582   .0439596    -0.33   0.739    -.1008258    .0715094
         20  |   .0671936   .0460479     1.46   0.145    -.0230673    .1574546
         21  |  -.0581634   .0476304    -1.22   0.222    -.1515264    .0351996
         22  |   .2619724    .049328     5.31   0.000     .1652818     .358663
         23  |  -.0288599   .0510457    -0.57   0.572    -.1289174    .0711976
         24  |  -.3707344   .0538406    -6.89   0.000    -.4762702   -.2651985
         25  |   .0072311   .0589557     0.12   0.902    -.1083311    .1227934
         27  |  -.0412197   .0362473    -1.14   0.255      -.11227    .0298307
         28  |  -.2651843   .0339427    -7.81   0.000    -.3317173   -.1986514
         29  |  -.0848686    .032587    -2.60   0.009    -.1487442   -.0209931
         30  |  -.1950089   .0323699    -6.02   0.000    -.2584588   -.1315589
         31  |  -.0493066   .0325421    -1.52   0.130    -.1130941    .0144809
         32  |  -.1530599   .0330307    -4.63   0.000    -.2178052   -.0883145
         33  |  -.0187519   .0329906    -0.57   0.570    -.0834186    .0459147
         34  |  -.1384501   .0337069    -4.11   0.000    -.2045207   -.0723794
         35  |  -.0742503   .0348992    -2.13   0.033    -.1426582   -.0058425
         36  |  -.0747481    .035962    -2.08   0.038    -.1452393    -.004257
         37  |  -.1347372    .037337    -3.61   0.000    -.2079234    -.061551
         38  |   -.067105   .0384416    -1.75   0.081    -.1424564    .0082464
         39  |  -.1589333   .0396325    -4.01   0.000     -.236619   -.0812475
         40  |  -.1044528   .0409909    -2.55   0.011    -.1848012   -.0241043
         41  |  -.1343084   .0431116    -3.12   0.002    -.2188137    -.049803
         42  |  -.0758945   .0446191    -1.70   0.089    -.1633548    .0115658
         43  |   .0158194   .0459616     0.34   0.731    -.0742725    .1059113
         44  |   -.030823   .0480182    -0.64   0.521    -.1249461       .0633
         45  |  -.2470294   .0494112    -5.00   0.000    -.3438829   -.1501759
         46  |  -.0946732   .0511874    -1.85   0.064    -.1950084    .0056621
         47  |   .1061115    .053194     1.99   0.046     .0018431    .2103799
         48  |  -.2098581   .0543878    -3.86   0.000    -.3164666   -.1032496
         49  |  -.6783862   .0558189   -12.15   0.000    -.7877998   -.5689726
         50  |  -.1156924   .0633757    -1.83   0.068    -.2399186    .0085337
             |
     age_cat |
          2  |  -.1315286   .0191485    -6.87   0.000    -.1690625   -.0939946
          3  |  -.2547747   .0195261   -13.05   0.000    -.2930489   -.2165006
          4  |  -.3121673   .0201192   -15.52   0.000    -.3516041   -.2727305
          5  |  -.3758556   .0211946   -17.73   0.000    -.4174002    -.334311
          6  |  -.3926722   .0222766   -17.63   0.000    -.4363377   -.3490066
          7  |  -.4392834   .0236081   -18.61   0.000    -.4855589   -.3930079
          8  |  -.4493403   .0249922   -17.98   0.000    -.4983287   -.4003518
          9  |  -.4783209   .0266031   -17.98   0.000    -.5304671   -.4261748
         10  |  -.5049582   .0281884   -17.91   0.000    -.5602119   -.4497045
         11  |  -.4937706   .0299755   -16.47   0.000    -.5525272    -.435014
         12  |  -.4971077   .0316828   -15.69   0.000    -.5592109   -.4350044
         13  |  -.5449382   .0334873   -16.27   0.000    -.6105785   -.4792978
         14  |  -.5246367   .0355748   -14.75   0.000    -.5943688   -.4549045
         15  |   -.544882   .0373761   -14.58   0.000     -.618145    -.471619
         16  |  -.5371542   .0393604   -13.65   0.000    -.6143066   -.4600018
         17  |   -.549032   .0412587   -13.31   0.000    -.6299055   -.4681586
         18  |  -.5859329    .043538   -13.46   0.000    -.6712742   -.5005916
         19  |  -.5465926   .0458096   -11.93   0.000    -.6363865   -.4567986
         20  |   -.578991   .0491199   -11.79   0.000    -.6752735   -.4827084
         25  |  -.5833607    .059669    -9.78   0.000    -.7003213   -.4664002
         30  |   -.599957   .0763828    -7.85   0.000    -.7496792   -.4502348
         40  |   -.631154   .0935149    -6.75   0.000    -.8144578   -.4478503
         50  |  -.6170072   .1158449    -5.33   0.000    -.8440811   -.3899334
             |
       _cons |   .3752848   .0266705    14.07   0.000     .3230065    .4275631
-------------+----------------------------------------------------------------
     sigma_u |  .34313234
     sigma_e |  .86302256
         rho |  .13650236   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    217554
Group variable: firm_person                     Number of groups   =     15122

R-sq:  within  = 0.0988                         Obs per group: min =         1
       between = 0.0359                                        avg =      14.4
       overall = 0.0425                                        max =        25

                                                F(53,4896)         =     25.71
corr(u_i, Xb)  = -0.0591                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,897 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .000282   .0474448     0.01   0.995    -.0927312    .0932952
      during |  -.1666655   .0158597   -10.51   0.000    -.1977577   -.1355734
       after |  -.3091377   .0292009   -10.59   0.000    -.3663845   -.2518909
during_expat |   .1487308   .0299262     4.97   0.000     .0900619    .2073996
 after_expat |   .2856663   .0463988     6.16   0.000     .1947038    .3766288
             |
    ind_year |
         27  |  -.1643764   .0207004    -7.94   0.000    -.2049584   -.1237944
         28  |  -.2705868   .0271049    -9.98   0.000    -.3237245   -.2174491
         29  |  -.3675267   .0322567   -11.39   0.000    -.4307643   -.3042891
         30  |  -.4273344   .0370964   -11.52   0.000      -.50006   -.3546089
         31  |  -.4960498   .0422378   -11.74   0.000    -.5788549   -.4132447
         32  |  -.5343995   .0470574   -11.36   0.000    -.6266532   -.4421459
         33  |  -.5990135   .0520908   -11.50   0.000    -.7011347   -.4968923
         34  |   -.644311   .0573266   -11.24   0.000     -.756697   -.5319251
         35  |  -.7098842      .0624   -11.38   0.000    -.8322162   -.5875521
         36  |  -.7964276     .06713   -11.86   0.000    -.9280325   -.6648227
         37  |  -.8494675   .0718726   -11.82   0.000      -.99037    -.708565
         38  |  -.9296344   .0771679   -12.05   0.000    -1.080918   -.7783508
         39  |  -.9898448   .0822594   -12.03   0.000     -1.15111   -.8285794
         40  |  -1.027022   .0873313   -11.76   0.000     -1.19823   -.8558129
         41  |  -1.043949    .092282   -11.31   0.000    -1.224863   -.8630345
         42  |  -1.081494    .097243   -11.12   0.000    -1.272134    -.890854
         43  |  -1.234455   .1027555   -12.01   0.000    -1.435902   -1.033008
         44  |  -1.270902   .1082858   -11.74   0.000    -1.483191   -1.058614
         45  |  -1.258087   .1127041   -11.16   0.000    -1.479037   -1.037136
         46  |  -1.275953   .1168568   -10.92   0.000    -1.505045   -1.046861
         47  |   -1.27582   .1207408   -10.57   0.000    -1.512526   -1.039114
         48  |  -1.271696   .1246891   -10.20   0.000    -1.516142   -1.027249
         49  |  -1.240619   .1290987    -9.61   0.000     -1.49371   -.9875272
         50  |   -1.21686   .1332372    -9.13   0.000    -1.478065   -.9556551
             |
     age_cat |
          1  |   .3497252   .0286169    12.22   0.000     .2936232    .4058273
          2  |    .681694   .0328064    20.78   0.000     .6173788    .7460093
          3  |     .89148   .0372524    23.93   0.000     .8184485    .9645115
          4  |   1.042085   .0422928    24.64   0.000      .959172    1.124998
          5  |   1.174283   .0471241    24.92   0.000     1.081898    1.266667
          6  |   1.292942   .0517306    24.99   0.000     1.191527    1.394357
          7  |   1.386687   .0564088    24.58   0.000       1.2761    1.497274
          8  |   1.469719   .0615069    23.90   0.000     1.349138      1.5903
          9  |    1.54528   .0663714    23.28   0.000     1.415163    1.675398
         10  |   1.612139   .0713561    22.59   0.000      1.47225    1.752029
         11  |   1.673949   .0762185    21.96   0.000     1.524527    1.823372
         12  |   1.728286    .081269    21.27   0.000     1.568962    1.887609
         13  |   1.784824    .086271    20.69   0.000     1.615694    1.953954
         14  |   1.824745    .091397    19.97   0.000     1.645566    2.003924
         15  |   1.881487   .0966649    19.46   0.000     1.691981    2.070994
         16  |   1.924244   .1020141    18.86   0.000      1.72425    2.124237
         17  |    1.97051   .1069983    18.42   0.000     1.760746    2.180275
         18  |   1.999737   .1118518    17.88   0.000     1.780457    2.219016
         19  |   2.024191   .1169678    17.31   0.000     1.794882    2.253501
         20  |   2.058847   .1270501    16.20   0.000     1.809772    2.307922
         25  |   2.111211   .1451885    14.54   0.000     1.826576    2.395845
         30  |   2.001993   .2018773     9.92   0.000     1.606223    2.397763
         40  |    1.79655    .233715     7.69   0.000     1.338364    2.254736
         50  |   1.854116   .2588232     7.16   0.000     1.346706    2.361526
             |
       _cons |   3.659576   .0412344    88.75   0.000     3.578738    3.740414
-------------+----------------------------------------------------------------
     sigma_u |  1.3255009
     sigma_e |  .66701758
         rho |  .79793837   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0988485042569861

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    217,554
Group variable: firm_person                     Number of groups  =     15,122

R-sq:                                           Obs per group:
     within  = 0.0988                                         min =          1
     between = 0.0359                                         avg =       14.4
     overall = 0.0425                                         max =         25

                                                F(53,4896)        =      25.71
corr(u_i, Xb)  = -0.0591                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,897 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .000282   .0474448     0.01   0.995    -.0927312    .0932952
      during |  -.1666655   .0158597   -10.51   0.000    -.1977577   -.1355734
       after |  -.3091377   .0292009   -10.59   0.000    -.3663845   -.2518909
during_expat |   .1487308   .0299262     4.97   0.000     .0900619    .2073996
 after_expat |   .2856663   .0463988     6.16   0.000     .1947038    .3766288
             |
    ind_year |
         27  |  -.1643764   .0207004    -7.94   0.000    -.2049584   -.1237944
         28  |  -.2705868   .0271049    -9.98   0.000    -.3237245   -.2174491
         29  |  -.3675267   .0322567   -11.39   0.000    -.4307643   -.3042891
         30  |  -.4273344   .0370964   -11.52   0.000      -.50006   -.3546089
         31  |  -.4960498   .0422378   -11.74   0.000    -.5788549   -.4132447
         32  |  -.5343995   .0470574   -11.36   0.000    -.6266532   -.4421459
         33  |  -.5990135   .0520908   -11.50   0.000    -.7011347   -.4968923
         34  |   -.644311   .0573266   -11.24   0.000     -.756697   -.5319251
         35  |  -.7098842      .0624   -11.38   0.000    -.8322162   -.5875521
         36  |  -.7964276     .06713   -11.86   0.000    -.9280325   -.6648227
         37  |  -.8494675   .0718726   -11.82   0.000      -.99037    -.708565
         38  |  -.9296344   .0771679   -12.05   0.000    -1.080918   -.7783508
         39  |  -.9898448   .0822594   -12.03   0.000     -1.15111   -.8285794
         40  |  -1.027022   .0873313   -11.76   0.000     -1.19823   -.8558129
         41  |  -1.043949    .092282   -11.31   0.000    -1.224863   -.8630345
         42  |  -1.081494    .097243   -11.12   0.000    -1.272134    -.890854
         43  |  -1.234455   .1027555   -12.01   0.000    -1.435902   -1.033008
         44  |  -1.270902   .1082858   -11.74   0.000    -1.483191   -1.058614
         45  |  -1.258087   .1127041   -11.16   0.000    -1.479037   -1.037136
         46  |  -1.275953   .1168568   -10.92   0.000    -1.505045   -1.046861
         47  |   -1.27582   .1207408   -10.57   0.000    -1.512526   -1.039114
         48  |  -1.271696   .1246891   -10.20   0.000    -1.516142   -1.027249
         49  |  -1.240619   .1290987    -9.61   0.000     -1.49371   -.9875272
         50  |   -1.21686   .1332372    -9.13   0.000    -1.478065   -.9556551
             |
     age_cat |
          1  |   .3497252   .0286169    12.22   0.000     .2936232    .4058273
          2  |    .681694   .0328064    20.78   0.000     .6173788    .7460093
          3  |     .89148   .0372524    23.93   0.000     .8184485    .9645115
          4  |   1.042085   .0422928    24.64   0.000      .959172    1.124998
          5  |   1.174283   .0471241    24.92   0.000     1.081898    1.266667
          6  |   1.292942   .0517306    24.99   0.000     1.191527    1.394357
          7  |   1.386687   .0564088    24.58   0.000       1.2761    1.497274
          8  |   1.469719   .0615069    23.90   0.000     1.349138      1.5903
          9  |    1.54528   .0663714    23.28   0.000     1.415163    1.675398
         10  |   1.612139   .0713561    22.59   0.000      1.47225    1.752029
         11  |   1.673949   .0762185    21.96   0.000     1.524527    1.823372
         12  |   1.728286    .081269    21.27   0.000     1.568962    1.887609
         13  |   1.784824    .086271    20.69   0.000     1.615694    1.953954
         14  |   1.824745    .091397    19.97   0.000     1.645566    2.003924
         15  |   1.881487   .0966649    19.46   0.000     1.691981    2.070994
         16  |   1.924244   .1020141    18.86   0.000      1.72425    2.124237
         17  |    1.97051   .1069983    18.42   0.000     1.760746    2.180275
         18  |   1.999737   .1118518    17.88   0.000     1.780457    2.219016
         19  |   2.024191   .1169678    17.31   0.000     1.794882    2.253501
         20  |   2.058847   .1270501    16.20   0.000     1.809772    2.307922
         25  |   2.111211   .1451885    14.54   0.000     1.826576    2.395845
         30  |   2.001993   .2018773     9.92   0.000     1.606223    2.397763
         40  |    1.79655    .233715     7.69   0.000     1.338364    2.254736
         50  |   1.854116   .2588232     7.16   0.000     1.346706    2.361526
             |
       _cons |   3.659576   .0412344    88.75   0.000     3.578738    3.740414
-------------+----------------------------------------------------------------
     sigma_u |  1.3255009
     sigma_e |  .66701758
         rho |  .79793837   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    204053
Group variable: firm_person                     Number of groups   =     14884

R-sq:  within  = 0.1891                         Obs per group: min =         1
       between = 0.0661                                        avg =      13.7
       overall = 0.0604                                        max =        25

                                                F(53,4768)         =     40.92
corr(u_i, Xb)  = 0.0366                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,769 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0780512   .0747667     1.04   0.297    -.0685261    .2246285
      during |  -.1569072   .0251838    -6.23   0.000    -.2062792   -.1075353
       after |  -.2849892   .0402592    -7.08   0.000    -.3639157   -.2060626
during_expat |   .0054415   .0440574     0.12   0.902    -.0809314    .0918144
 after_expat |  -.0094981   .0624732    -0.15   0.879    -.1319744    .1129783
             |
    ind_year |
         27  |  -.0620164   .0374785    -1.65   0.098    -.1354914    .0114587
         28  |   .0559723   .0474761     1.18   0.238    -.0371027    .1490473
         29  |   .0591226   .0574842     1.03   0.304    -.0535729    .1718181
         30  |   .0973937    .067493     1.44   0.149    -.0349238    .2297111
         31  |   .1647577   .0779228     2.11   0.035      .011993    .3175223
         32  |   .3378485   .0880839     3.84   0.000     .1651634    .5105336
         33  |   .3902724   .0985171     3.96   0.000     .1971334    .5834115
         34  |   .4391453   .1092957     4.02   0.000     .2248752    .6534154
         35  |   .4627149   .1202216     3.85   0.000      .227025    .6984047
         36  |   .4859873   .1313149     3.70   0.000     .2285495     .743425
         37  |   .5059121   .1422128     3.56   0.000     .2271092    .7847149
         38  |   .4920949   .1532108     3.21   0.001     .1917309    .7924589
         39  |   .4724782   .1642777     2.88   0.004     .1504182    .7945382
         40  |   .4530788   .1754779     2.58   0.010     .1090611    .7970966
         41  |   .4911357   .1875193     2.62   0.009     .1235114    .8587601
         42  |   .5176575   .1990955     2.60   0.009     .1273384    .9079766
         43  |   .4348758   .2110883     2.06   0.039     .0210454    .8487063
         44  |    .390192   .2240011     1.74   0.082    -.0489536    .8293375
         45  |   .4482611   .2349251     1.91   0.056    -.0123005    .9088228
         46  |    .432968   .2446897     1.77   0.077    -.0467367    .9126727
         47  |   .5051691   .2542214     1.99   0.047     .0067778     1.00356
         48  |   .5619802    .264748     2.12   0.034      .042952    1.081008
         49  |   .4705594   .2754531     1.71   0.088    -.0694559    1.010575
         50  |   .5722834   .2839197     2.02   0.044     .0156697    1.128897
             |
     age_cat |
          1  |   .4660281   .0493693     9.44   0.000     .3692414    .5628148
          2  |   .8415421    .057589    14.61   0.000     .7286412    .9544431
          3  |   1.080641   .0656735    16.45   0.000     .9518909    1.209392
          4  |   1.271201   .0749026    16.97   0.000     1.124357    1.418045
          5  |   1.370458   .0845989    16.20   0.000     1.204605    1.536311
          6  |   1.476413   .0945485    15.62   0.000     1.291055    1.661772
          7  |   1.551422   .1049281    14.79   0.000     1.345715     1.75713
          8  |   1.634824   .1155663    14.15   0.000     1.408261    1.861388
          9  |   1.705965    .126013    13.54   0.000     1.458922    1.953009
         10  |   1.745959   .1369826    12.75   0.000      1.47741    2.014508
         11  |   1.795761   .1480576    12.13   0.000       1.5055    2.086023
         12  |   1.858757   .1592189    11.67   0.000     1.546614    2.170899
         13  |   1.900643   .1705124    11.15   0.000      1.56636    2.234926
         14  |   1.969424   .1815649    10.85   0.000     1.613473    2.325375
         15  |   2.007248   .1930089    10.40   0.000     1.628861    2.385634
         16  |   2.031358    .204925     9.91   0.000      1.62961    2.433105
         17  |   2.035696   .2167157     9.39   0.000     1.610833    2.460559
         18  |   2.070638   .2288814     9.05   0.000     1.621925    2.519351
         19  |   2.102938   .2407481     8.74   0.000     1.630961    2.574916
         20  |   2.138424   .2666691     8.02   0.000     1.615629    2.661218
         25  |   2.253343   .3121972     7.22   0.000     1.641293    2.865394
         30  |   2.002151    .400701     5.00   0.000     1.216592     2.78771
         40  |   1.567307   .4826935     3.25   0.001     .6210049    2.513609
         50  |   1.461122   .5355548     2.73   0.006     .4111875    2.511057
             |
       _cons |    8.85458   .0691804   127.99   0.000     8.718955    8.990206
-------------+----------------------------------------------------------------
     sigma_u |  2.2241925
     sigma_e |  .99380157
         rho |  .83358116   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1890864471813191

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    204,053
Group variable: firm_person                     Number of groups  =     14,884

R-sq:                                           Obs per group:
     within  = 0.1891                                         min =          1
     between = 0.0661                                         avg =       13.7
     overall = 0.0604                                         max =         25

                                                F(53,4768)        =      40.92
corr(u_i, Xb)  = 0.0366                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,769 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0780512   .0747667     1.04   0.297    -.0685261    .2246285
      during |  -.1569072   .0251838    -6.23   0.000    -.2062792   -.1075353
       after |  -.2849892   .0402592    -7.08   0.000    -.3639157   -.2060626
during_expat |   .0054415   .0440574     0.12   0.902    -.0809314    .0918144
 after_expat |  -.0094981   .0624732    -0.15   0.879    -.1319744    .1129783
             |
    ind_year |
         27  |  -.0620164   .0374785    -1.65   0.098    -.1354914    .0114587
         28  |   .0559723   .0474761     1.18   0.238    -.0371027    .1490473
         29  |   .0591226   .0574842     1.03   0.304    -.0535729    .1718181
         30  |   .0973937    .067493     1.44   0.149    -.0349238    .2297111
         31  |   .1647577   .0779228     2.11   0.035      .011993    .3175223
         32  |   .3378485   .0880839     3.84   0.000     .1651634    .5105336
         33  |   .3902724   .0985171     3.96   0.000     .1971334    .5834115
         34  |   .4391453   .1092957     4.02   0.000     .2248752    .6534154
         35  |   .4627149   .1202216     3.85   0.000      .227025    .6984047
         36  |   .4859873   .1313149     3.70   0.000     .2285495     .743425
         37  |   .5059121   .1422128     3.56   0.000     .2271092    .7847149
         38  |   .4920949   .1532108     3.21   0.001     .1917309    .7924589
         39  |   .4724782   .1642777     2.88   0.004     .1504182    .7945382
         40  |   .4530788   .1754779     2.58   0.010     .1090611    .7970966
         41  |   .4911357   .1875193     2.62   0.009     .1235114    .8587601
         42  |   .5176575   .1990955     2.60   0.009     .1273384    .9079766
         43  |   .4348758   .2110883     2.06   0.039     .0210454    .8487063
         44  |    .390192   .2240011     1.74   0.082    -.0489536    .8293375
         45  |   .4482611   .2349251     1.91   0.056    -.0123005    .9088228
         46  |    .432968   .2446897     1.77   0.077    -.0467367    .9126727
         47  |   .5051691   .2542214     1.99   0.047     .0067778     1.00356
         48  |   .5619802    .264748     2.12   0.034      .042952    1.081008
         49  |   .4705594   .2754531     1.71   0.088    -.0694559    1.010575
         50  |   .5722834   .2839197     2.02   0.044     .0156697    1.128897
             |
     age_cat |
          1  |   .4660281   .0493693     9.44   0.000     .3692414    .5628148
          2  |   .8415421    .057589    14.61   0.000     .7286412    .9544431
          3  |   1.080641   .0656735    16.45   0.000     .9518909    1.209392
          4  |   1.271201   .0749026    16.97   0.000     1.124357    1.418045
          5  |   1.370458   .0845989    16.20   0.000     1.204605    1.536311
          6  |   1.476413   .0945485    15.62   0.000     1.291055    1.661772
          7  |   1.551422   .1049281    14.79   0.000     1.345715     1.75713
          8  |   1.634824   .1155663    14.15   0.000     1.408261    1.861388
          9  |   1.705965    .126013    13.54   0.000     1.458922    1.953009
         10  |   1.745959   .1369826    12.75   0.000      1.47741    2.014508
         11  |   1.795761   .1480576    12.13   0.000       1.5055    2.086023
         12  |   1.858757   .1592189    11.67   0.000     1.546614    2.170899
         13  |   1.900643   .1705124    11.15   0.000      1.56636    2.234926
         14  |   1.969424   .1815649    10.85   0.000     1.613473    2.325375
         15  |   2.007248   .1930089    10.40   0.000     1.628861    2.385634
         16  |   2.031358    .204925     9.91   0.000      1.62961    2.433105
         17  |   2.035696   .2167157     9.39   0.000     1.610833    2.460559
         18  |   2.070638   .2288814     9.05   0.000     1.621925    2.519351
         19  |   2.102938   .2407481     8.74   0.000     1.630961    2.574916
         20  |   2.138424   .2666691     8.02   0.000     1.615629    2.661218
         25  |   2.253343   .3121972     7.22   0.000     1.641293    2.865394
         30  |   2.002151    .400701     5.00   0.000     1.216592     2.78771
         40  |   1.567307   .4826935     3.25   0.001     .6210049    2.513609
         50  |   1.461122   .5355548     2.73   0.006     .4111875    2.511057
             |
       _cons |    8.85458   .0691804   127.99   0.000     8.718955    8.990206
-------------+----------------------------------------------------------------
     sigma_u |  2.2241925
     sigma_e |  .99380157
         rho |  .83358116   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    217554
Group variable: firm_person                     Number of groups   =     15122

R-sq:  within  = 0.3770                         Obs per group: min =         1
       between = 0.1324                                        avg =      14.4
       overall = 0.1484                                        max =        25

                                                F(53,4896)         =    111.61
corr(u_i, Xb)  = 0.0516                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,897 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0640283   .0562748     1.14   0.255    -.0462955    .1743521
      during |  -.2353498   .0183008   -12.86   0.000    -.2712275   -.1994721
       after |  -.3324943   .0313812   -10.60   0.000    -.3940155   -.2709731
during_expat |   .3373655   .0338807     9.96   0.000     .2709442    .4037869
 after_expat |   .4998789   .0523101     9.56   0.000     .3973277    .6024301
             |
    ind_year |
         27  |  -.0236806   .0293557    -0.81   0.420     -.081231    .0338697
         28  |   .0881679   .0355099     2.48   0.013     .0185526    .1577832
         29  |   .2302748   .0422869     5.45   0.000     .1473734    .3131761
         30  |   .3419173   .0488111     7.00   0.000     .2462257    .4376089
         31  |   .4369189   .0555788     7.86   0.000     .3279595    .5458784
         32  |    .545366     .06243     8.74   0.000     .4229752    .6677567
         33  |   .5654675   .0695947     8.13   0.000     .4290307    .7019043
         34  |   .6640419   .0767671     8.65   0.000     .5135439      .81454
         35  |   .6800351   .0842061     8.08   0.000     .5149533    .8451169
         36  |   .6433215   .0913683     7.04   0.000     .4641988    .8224443
         37  |   .6596829   .0984823     6.70   0.000     .4666134    .8527524
         38  |   .6500092   .1063513     6.11   0.000     .4415128    .8585055
         39  |   .6495137   .1137297     5.71   0.000     .4265525     .872475
         40  |   .7161867   .1218888     5.88   0.000     .4772299    .9551435
         41  |   .7583548   .1284175     5.91   0.000     .5065989    1.010111
         42  |    .772063   .1359195     5.68   0.000     .5055997    1.038526
         43  |   .5909202   .1435395     4.12   0.000     .3095184     .872322
         44  |   .6104267   .1516307     4.03   0.000     .3131624     .907691
         45  |   .7076864   .1584906     4.47   0.000     .3969737    1.018399
         46  |    .698682   .1647941     4.24   0.000     .3756117    1.021752
         47  |   .7398462   .1705887     4.34   0.000     .4054158    1.074277
         48  |   .7893666   .1771275     4.46   0.000     .4421173    1.136616
         49  |   .8126723   .1840645     4.42   0.000     .4518233    1.173521
         50  |   .8717713   .1902145     4.58   0.000     .4988656    1.244677
             |
     age_cat |
          1  |   .9875632   .0426891    23.13   0.000     .9038735    1.071253
          2  |   1.421773   .0463126    30.70   0.000      1.33098    1.512566
          3  |   1.653666   .0513584    32.20   0.000      1.55298    1.754351
          4  |   1.834753   .0567174    32.35   0.000     1.723562    1.945945
          5  |   1.959161   .0630413    31.08   0.000     1.835571     2.08275
          6  |   2.082856   .0690842    30.15   0.000      1.94742    2.218292
          7  |    2.17868   .0755781    28.83   0.000     2.030513    2.326847
          8  |    2.26607    .082671    27.41   0.000     2.103998    2.428143
          9  |   2.355959   .0893615    26.36   0.000      2.18077    2.531148
         10  |   2.419342    .096486    25.07   0.000     2.230186    2.608498
         11  |   2.493276   .1035023    24.09   0.000     2.290365    2.696187
         12  |   2.541183   .1107797    22.94   0.000     2.324005    2.758361
         13  |   2.602014   .1177598    22.10   0.000     2.371152    2.832876
         14  |   2.639585   .1252928    21.07   0.000     2.393955    2.885215
         15  |    2.69991   .1328987    20.32   0.000     2.439369    2.960451
         16  |   2.746468   .1403694    19.57   0.000     2.471281    3.021655
         17  |   2.786535   .1477251    18.86   0.000     2.496927    3.076142
         18  |   2.840607   .1548241    18.35   0.000     2.537082    3.144132
         19  |   2.848495   .1621447    17.57   0.000     2.530618    3.166371
         20  |   2.880172   .1784288    16.14   0.000     2.530371    3.229972
         25  |   2.902554   .2065636    14.05   0.000     2.497597    3.307512
         30  |   2.804451   .2672529    10.49   0.000     2.280515    3.328386
         40  |   2.547862   .3241498     7.86   0.000     1.912383    3.183341
         50  |   2.567651   .3605759     7.12   0.000     1.860761    3.274542
             |
       _cons |   10.36698   .0538326   192.58   0.000     10.26145    10.47252
-------------+----------------------------------------------------------------
     sigma_u |  1.8455054
     sigma_e |  .80732833
         rho |  .83937108   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .3770338966604659

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    217,554
Group variable: firm_person                     Number of groups  =     15,122

R-sq:                                           Obs per group:
     within  = 0.3770                                         min =          1
     between = 0.1324                                         avg =       14.4
     overall = 0.1484                                         max =         25

                                                F(53,4896)        =     111.61
corr(u_i, Xb)  = 0.0516                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,897 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0640283   .0562748     1.14   0.255    -.0462955    .1743521
      during |  -.2353498   .0183008   -12.86   0.000    -.2712275   -.1994721
       after |  -.3324943   .0313812   -10.60   0.000    -.3940155   -.2709731
during_expat |   .3373655   .0338807     9.96   0.000     .2709442    .4037869
 after_expat |   .4998789   .0523101     9.56   0.000     .3973277    .6024301
             |
    ind_year |
         27  |  -.0236806   .0293557    -0.81   0.420     -.081231    .0338697
         28  |   .0881679   .0355099     2.48   0.013     .0185526    .1577832
         29  |   .2302748   .0422869     5.45   0.000     .1473734    .3131761
         30  |   .3419173   .0488111     7.00   0.000     .2462257    .4376089
         31  |   .4369189   .0555788     7.86   0.000     .3279595    .5458784
         32  |    .545366     .06243     8.74   0.000     .4229752    .6677567
         33  |   .5654675   .0695947     8.13   0.000     .4290307    .7019043
         34  |   .6640419   .0767671     8.65   0.000     .5135439      .81454
         35  |   .6800351   .0842061     8.08   0.000     .5149533    .8451169
         36  |   .6433215   .0913683     7.04   0.000     .4641988    .8224443
         37  |   .6596829   .0984823     6.70   0.000     .4666134    .8527524
         38  |   .6500092   .1063513     6.11   0.000     .4415128    .8585055
         39  |   .6495137   .1137297     5.71   0.000     .4265525     .872475
         40  |   .7161867   .1218888     5.88   0.000     .4772299    .9551435
         41  |   .7583548   .1284175     5.91   0.000     .5065989    1.010111
         42  |    .772063   .1359195     5.68   0.000     .5055997    1.038526
         43  |   .5909202   .1435395     4.12   0.000     .3095184     .872322
         44  |   .6104267   .1516307     4.03   0.000     .3131624     .907691
         45  |   .7076864   .1584906     4.47   0.000     .3969737    1.018399
         46  |    .698682   .1647941     4.24   0.000     .3756117    1.021752
         47  |   .7398462   .1705887     4.34   0.000     .4054158    1.074277
         48  |   .7893666   .1771275     4.46   0.000     .4421173    1.136616
         49  |   .8126723   .1840645     4.42   0.000     .4518233    1.173521
         50  |   .8717713   .1902145     4.58   0.000     .4988656    1.244677
             |
     age_cat |
          1  |   .9875632   .0426891    23.13   0.000     .9038735    1.071253
          2  |   1.421773   .0463126    30.70   0.000      1.33098    1.512566
          3  |   1.653666   .0513584    32.20   0.000      1.55298    1.754351
          4  |   1.834753   .0567174    32.35   0.000     1.723562    1.945945
          5  |   1.959161   .0630413    31.08   0.000     1.835571     2.08275
          6  |   2.082856   .0690842    30.15   0.000      1.94742    2.218292
          7  |    2.17868   .0755781    28.83   0.000     2.030513    2.326847
          8  |    2.26607    .082671    27.41   0.000     2.103998    2.428143
          9  |   2.355959   .0893615    26.36   0.000      2.18077    2.531148
         10  |   2.419342    .096486    25.07   0.000     2.230186    2.608498
         11  |   2.493276   .1035023    24.09   0.000     2.290365    2.696187
         12  |   2.541183   .1107797    22.94   0.000     2.324005    2.758361
         13  |   2.602014   .1177598    22.10   0.000     2.371152    2.832876
         14  |   2.639585   .1252928    21.07   0.000     2.393955    2.885215
         15  |    2.69991   .1328987    20.32   0.000     2.439369    2.960451
         16  |   2.746468   .1403694    19.57   0.000     2.471281    3.021655
         17  |   2.786535   .1477251    18.86   0.000     2.496927    3.076142
         18  |   2.840607   .1548241    18.35   0.000     2.537082    3.144132
         19  |   2.848495   .1621447    17.57   0.000     2.530618    3.166371
         20  |   2.880172   .1784288    16.14   0.000     2.530371    3.229972
         25  |   2.902554   .2065636    14.05   0.000     2.497597    3.307512
         30  |   2.804451   .2672529    10.49   0.000     2.280515    3.328386
         40  |   2.547862   .3241498     7.86   0.000     1.912383    3.183341
         50  |   2.567651   .3605759     7.12   0.000     1.860761    3.274542
             |
       _cons |   10.36698   .0538326   192.58   0.000     10.26145    10.47252
-------------+----------------------------------------------------------------
     sigma_u |  1.8455054
     sigma_e |  .80732833
         rho |  .83937108   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    204053
Group variable: firm_person                     Number of groups   =     14884

R-sq:  within  = 0.1699                         Obs per group: min =         1
       between = 0.0837                                        avg =      13.7
       overall = 0.0976                                        max =        25

                                                F(53,4768)         =     38.66
corr(u_i, Xb)  = 0.0437                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,769 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .052582   .0603489     0.87   0.384    -.0657298    .1708938
      during |   .0024224   .0208561     0.12   0.908    -.0384651      .04331
       after |     .01901   .0319995     0.59   0.552    -.0437238    .0817437
during_expat |  -.1468825   .0358416    -4.10   0.000    -.2171485   -.0766166
 after_expat |  -.3117152   .0472585    -6.60   0.000    -.4043636   -.2190668
             |
    ind_year |
         27  |   .1069475   .0325742     3.28   0.001      .043087    .1708081
         28  |   .3380153   .0400094     8.45   0.000     .2595785    .4164521
         29  |    .443812   .0475585     9.33   0.000     .3505754    .5370485
         30  |   .5354064   .0548175     9.77   0.000     .4279387    .6428741
         31  |   .6655475   .0626675    10.62   0.000     .5426903    .7884046
         32  |     .88063   .0704767    12.50   0.000      .742463    1.018797
         33  |   .9961794   .0783784    12.71   0.000     .8425215    1.149837
         34  |   1.089239   .0867464    12.56   0.000     .9191756    1.259302
         35  |   1.171335   .0953657    12.28   0.000     .9843746    1.358296
         36  |   1.276486   .1039404    12.28   0.000     1.072714    1.480257
         37  |   1.348516   .1126686    11.97   0.000     1.127634    1.569399
         38  |   1.400125   .1212541    11.55   0.000     1.162411    1.637839
         39  |   1.434948   .1300143    11.04   0.000      1.18006    1.689836
         40  |   1.448945    .138582    10.46   0.000      1.17726    1.720629
         41  |   1.494036   .1481333    10.09   0.000     1.203626    1.784445
         42  |   1.550097   .1575103     9.84   0.000     1.241304     1.85889
         43  |   1.614089   .1672634     9.65   0.000     1.286176    1.942003
         44  |   1.594418   .1771256     9.00   0.000      1.24717    1.941666
         45  |   1.631754   .1859047     8.78   0.000     1.267295    1.996213
         46  |    1.63166   .1935698     8.43   0.000     1.252174    2.011146
         47  |   1.700211   .2010164     8.46   0.000     1.306126    2.094296
         48  |   1.736357   .2094678     8.29   0.000     1.325704    2.147011
         49  |   1.490531   .2177881     6.84   0.000     1.063565    1.917496
         50  |   1.572321   .2238268     7.02   0.000     1.133517    2.011124
             |
     age_cat |
          1  |   .1485982   .0462089     3.22   0.001     .0580074     .239189
          2  |   .1983707   .0526299     3.77   0.000     .0951918    .3015496
          3  |   .2404436   .0578076     4.16   0.000      .127114    .3537731
          4  |   .2859568   .0643697     4.44   0.000     .1597625    .4121511
          5  |   .2521844   .0712352     3.54   0.000     .1125305    .3918382
          6  |   .2479795   .0785052     3.16   0.002     .0940731     .401886
          7  |   .2311519   .0865868     2.67   0.008     .0614019    .4009019
          8  |   .2348473   .0944435     2.49   0.013     .0496943    .4200002
          9  |   .2331831   .1023589     2.28   0.023     .0325123    .4338539
         10  |   .2114773   .1108447     1.91   0.056    -.0058294     .428784
         11  |   .2036489   .1194416     1.71   0.088    -.0305117    .4378096
         12  |   .2238299   .1279469     1.75   0.080    -.0270052     .474665
         13  |   .2083809   .1367265     1.52   0.128    -.0596662    .4764281
         14  |   .2502272   .1454221     1.72   0.085    -.0348673    .5353217
         15  |   .2330724   .1542429     1.51   0.131    -.0693149    .5354597
         16  |   .2137956   .1634424     1.31   0.191     -.106627    .5342182
         17  |   .1931471   .1726369     1.12   0.263    -.1453008     .531595
         18  |   .1962859   .1822726     1.08   0.282    -.1610525    .5536244
         19  |    .220015    .191652     1.15   0.251    -.1557113    .5957413
         20  |   .2313879   .2115425     1.09   0.274     -.183333    .6461087
         25  |   .2573432   .2467954     1.04   0.297    -.2264897    .7411761
         30  |   .1921783   .3251497     0.59   0.555    -.4452653    .8296218
         40  |  -.1416019   .3883261    -0.36   0.715    -.9029003    .6196964
         50  |  -.2983926   .4283835    -0.70   0.486    -1.138222    .5414369
             |
       _cons |    5.10781   .0598238    85.38   0.000     4.990527    5.225092
-------------+----------------------------------------------------------------
     sigma_u |  1.5347824
     sigma_e |  .85118613
         rho |  .76477266   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1699279499506714

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    204,053
Group variable: firm_person                     Number of groups  =     14,884

R-sq:                                           Obs per group:
     within  = 0.1699                                         min =          1
     between = 0.0837                                         avg =       13.7
     overall = 0.0976                                         max =         25

                                                F(53,4768)        =      38.66
corr(u_i, Xb)  = 0.0437                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,769 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .052582   .0603489     0.87   0.384    -.0657298    .1708938
      during |   .0024224   .0208561     0.12   0.908    -.0384651      .04331
       after |     .01901   .0319995     0.59   0.552    -.0437238    .0817437
during_expat |  -.1468825   .0358416    -4.10   0.000    -.2171485   -.0766166
 after_expat |  -.3117152   .0472585    -6.60   0.000    -.4043636   -.2190668
             |
    ind_year |
         27  |   .1069475   .0325742     3.28   0.001      .043087    .1708081
         28  |   .3380153   .0400094     8.45   0.000     .2595785    .4164521
         29  |    .443812   .0475585     9.33   0.000     .3505754    .5370485
         30  |   .5354064   .0548175     9.77   0.000     .4279387    .6428741
         31  |   .6655475   .0626675    10.62   0.000     .5426903    .7884046
         32  |     .88063   .0704767    12.50   0.000      .742463    1.018797
         33  |   .9961794   .0783784    12.71   0.000     .8425215    1.149837
         34  |   1.089239   .0867464    12.56   0.000     .9191756    1.259302
         35  |   1.171335   .0953657    12.28   0.000     .9843746    1.358296
         36  |   1.276486   .1039404    12.28   0.000     1.072714    1.480257
         37  |   1.348516   .1126686    11.97   0.000     1.127634    1.569399
         38  |   1.400125   .1212541    11.55   0.000     1.162411    1.637839
         39  |   1.434948   .1300143    11.04   0.000      1.18006    1.689836
         40  |   1.448945    .138582    10.46   0.000      1.17726    1.720629
         41  |   1.494036   .1481333    10.09   0.000     1.203626    1.784445
         42  |   1.550097   .1575103     9.84   0.000     1.241304     1.85889
         43  |   1.614089   .1672634     9.65   0.000     1.286176    1.942003
         44  |   1.594418   .1771256     9.00   0.000      1.24717    1.941666
         45  |   1.631754   .1859047     8.78   0.000     1.267295    1.996213
         46  |    1.63166   .1935698     8.43   0.000     1.252174    2.011146
         47  |   1.700211   .2010164     8.46   0.000     1.306126    2.094296
         48  |   1.736357   .2094678     8.29   0.000     1.325704    2.147011
         49  |   1.490531   .2177881     6.84   0.000     1.063565    1.917496
         50  |   1.572321   .2238268     7.02   0.000     1.133517    2.011124
             |
     age_cat |
          1  |   .1485982   .0462089     3.22   0.001     .0580074     .239189
          2  |   .1983707   .0526299     3.77   0.000     .0951918    .3015496
          3  |   .2404436   .0578076     4.16   0.000      .127114    .3537731
          4  |   .2859568   .0643697     4.44   0.000     .1597625    .4121511
          5  |   .2521844   .0712352     3.54   0.000     .1125305    .3918382
          6  |   .2479795   .0785052     3.16   0.002     .0940731     .401886
          7  |   .2311519   .0865868     2.67   0.008     .0614019    .4009019
          8  |   .2348473   .0944435     2.49   0.013     .0496943    .4200002
          9  |   .2331831   .1023589     2.28   0.023     .0325123    .4338539
         10  |   .2114773   .1108447     1.91   0.056    -.0058294     .428784
         11  |   .2036489   .1194416     1.71   0.088    -.0305117    .4378096
         12  |   .2238299   .1279469     1.75   0.080    -.0270052     .474665
         13  |   .2083809   .1367265     1.52   0.128    -.0596662    .4764281
         14  |   .2502272   .1454221     1.72   0.085    -.0348673    .5353217
         15  |   .2330724   .1542429     1.51   0.131    -.0693149    .5354597
         16  |   .2137956   .1634424     1.31   0.191     -.106627    .5342182
         17  |   .1931471   .1726369     1.12   0.263    -.1453008     .531595
         18  |   .1962859   .1822726     1.08   0.282    -.1610525    .5536244
         19  |    .220015    .191652     1.15   0.251    -.1557113    .5957413
         20  |   .2313879   .2115425     1.09   0.274     -.183333    .6461087
         25  |   .2573432   .2467954     1.04   0.297    -.2264897    .7411761
         30  |   .1921783   .3251497     0.59   0.555    -.4452653    .8296218
         40  |  -.1416019   .3883261    -0.36   0.715    -.9029003    .6196964
         50  |  -.2983926   .4283835    -0.70   0.486    -1.138222    .5414369
             |
       _cons |    5.10781   .0598238    85.38   0.000     4.990527    5.225092
-------------+----------------------------------------------------------------
     sigma_u |  1.5347824
     sigma_e |  .85118613
         rho |  .76477266   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    217554
Group variable: firm_person                     Number of groups   =     15122

R-sq:  within  = 0.4819                         Obs per group: min =         1
       between = 0.2168                                        avg =      14.4
       overall = 0.2882                                        max =        25

                                                F(53,4896)         =    195.88
corr(u_i, Xb)  = 0.0595                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,897 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0637463   .0284248     2.24   0.025      .008021    .1194717
      during |  -.0686843   .0108654    -6.32   0.000    -.0899854   -.0473832
       after |  -.0233567   .0177491    -1.32   0.188    -.0581529    .0114396
during_expat |   .1886348   .0195235     9.66   0.000     .1503599    .2269096
 after_expat |   .2142126   .0294037     7.29   0.000     .1565682     .271857
             |
    ind_year |
         27  |   .1406957   .0209458     6.72   0.000     .0996326    .1817588
         28  |   .3587546   .0232289    15.44   0.000     .3132156    .4042937
         29  |   .5978015   .0272365    21.95   0.000     .5444056    .6511973
         30  |   .7692518   .0294037    26.16   0.000     .7116073    .8268962
         31  |   .9329688   .0323221    28.86   0.000     .8696029    .9963346
         32  |   1.079765   .0355279    30.39   0.000     1.010115    1.149416
         33  |   1.164481   .0383868    30.34   0.000     1.089226    1.239736
         34  |   1.308353   .0417116    31.37   0.000      1.22658    1.390126
         35  |   1.389919   .0452763    30.70   0.000     1.301157    1.478681
         36  |   1.439749   .0485042    29.68   0.000     1.344659    1.534839
         37  |    1.50915   .0520908    28.97   0.000     1.407029    1.611272
         38  |   1.579644   .0562982    28.06   0.000     1.469274    1.690013
         39  |   1.639358   .0600065    27.32   0.000     1.521719    1.756998
         40  |   1.743208   .0643016    27.11   0.000     1.617148    1.869268
         41  |   1.802303   .0672555    26.80   0.000     1.670452    1.934154
         42  |   1.853557   .0710852    26.08   0.000     1.714198    1.992916
         43  |   1.825375   .0747662    24.41   0.000       1.6788    1.971951
         44  |   1.881329   .0788366    23.86   0.000     1.726774    2.035884
         45  |   1.965773   .0820996    23.94   0.000     1.804821    2.126725
         46  |   1.974635   .0853326    23.14   0.000     1.807345    2.141925
         47  |   2.015666    .088232    22.85   0.000     1.842692     2.18864
         48  |   2.061062   .0910854    22.63   0.000     1.882494    2.239631
         49  |   2.053291   .0947586    21.67   0.000     1.867522     2.23906
         50  |   2.088631    .097346    21.46   0.000     1.897789    2.279473
             |
     age_cat |
          1  |    .637838   .0334576    19.06   0.000      .572246    .7034299
          2  |    .740079   .0351007    21.08   0.000     .6712658    .8088921
          3  |   .7621857   .0371855    20.50   0.000     .6892854    .8350859
          4  |   .7926682   .0392854    20.18   0.000     .7156511    .8696853
          5  |   .7848778   .0418564    18.75   0.000     .7028204    .8669351
          6  |   .7899141   .0441724    17.88   0.000     .7033164    .8765118
          7  |   .7919928   .0470298    16.84   0.000     .6997934    .8841923
          8  |   .7963512   .0500783    15.90   0.000     .6981753     .894527
          9  |   .8106786   .0527828    15.36   0.000     .7072006    .9141565
         10  |   .8072026   .0559782    14.42   0.000     .6974601    .9169451
         11  |   .8193269   .0591534    13.85   0.000     .7033597    .9352942
         12  |   .8128975   .0624392    13.02   0.000     .6904886    .9353064
         13  |   .8171899   .0656519    12.45   0.000     .6884828     .945897
         14  |   .8148397   .0691304    11.79   0.000      .679313    .9503664
         15  |    .818423    .072742    11.25   0.000      .675816      .96103
         16  |   .8222236   .0762639    10.78   0.000     .6727122    .9717351
         17  |   .8160243   .0797263    10.24   0.000     .6597249    .9723236
         18  |   .8408702   .0832975    10.09   0.000     .6775696    1.004171
         19  |   .8243034   .0865562     9.52   0.000     .6546143    .9939924
         20  |    .821325   .0939574     8.74   0.000     .6371263    1.005524
         25  |   .7913433   .1072882     7.38   0.000     .5810103    1.001676
         30  |   .8024583    .146769     5.47   0.000     .5147253    1.090191
         40  |   .7513121   .1699946     4.42   0.000     .4180465    1.084578
         50  |   .7135354   .1883225     3.79   0.000     .3443387    1.082732
             |
       _cons |   6.707407    .036822   182.16   0.000     6.635219    6.779594
-------------+----------------------------------------------------------------
     sigma_u |  1.0716396
     sigma_e |  .54143813
         rho |  .79664123   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .4819194451932746

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    217,554
Group variable: firm_person                     Number of groups  =     15,122

R-sq:                                           Obs per group:
     within  = 0.4819                                         min =          1
     between = 0.2168                                         avg =       14.4
     overall = 0.2882                                         max =         25

                                                F(53,4896)        =     195.88
corr(u_i, Xb)  = 0.0595                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,897 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0637463   .0284248     2.24   0.025      .008021    .1194717
      during |  -.0686843   .0108654    -6.32   0.000    -.0899854   -.0473832
       after |  -.0233567   .0177491    -1.32   0.188    -.0581529    .0114396
during_expat |   .1886348   .0195235     9.66   0.000     .1503599    .2269096
 after_expat |   .2142126   .0294037     7.29   0.000     .1565682     .271857
             |
    ind_year |
         27  |   .1406957   .0209458     6.72   0.000     .0996326    .1817588
         28  |   .3587546   .0232289    15.44   0.000     .3132156    .4042937
         29  |   .5978015   .0272365    21.95   0.000     .5444056    .6511973
         30  |   .7692518   .0294037    26.16   0.000     .7116073    .8268962
         31  |   .9329688   .0323221    28.86   0.000     .8696029    .9963346
         32  |   1.079765   .0355279    30.39   0.000     1.010115    1.149416
         33  |   1.164481   .0383868    30.34   0.000     1.089226    1.239736
         34  |   1.308353   .0417116    31.37   0.000      1.22658    1.390126
         35  |   1.389919   .0452763    30.70   0.000     1.301157    1.478681
         36  |   1.439749   .0485042    29.68   0.000     1.344659    1.534839
         37  |    1.50915   .0520908    28.97   0.000     1.407029    1.611272
         38  |   1.579644   .0562982    28.06   0.000     1.469274    1.690013
         39  |   1.639358   .0600065    27.32   0.000     1.521719    1.756998
         40  |   1.743208   .0643016    27.11   0.000     1.617148    1.869268
         41  |   1.802303   .0672555    26.80   0.000     1.670452    1.934154
         42  |   1.853557   .0710852    26.08   0.000     1.714198    1.992916
         43  |   1.825375   .0747662    24.41   0.000       1.6788    1.971951
         44  |   1.881329   .0788366    23.86   0.000     1.726774    2.035884
         45  |   1.965773   .0820996    23.94   0.000     1.804821    2.126725
         46  |   1.974635   .0853326    23.14   0.000     1.807345    2.141925
         47  |   2.015666    .088232    22.85   0.000     1.842692     2.18864
         48  |   2.061062   .0910854    22.63   0.000     1.882494    2.239631
         49  |   2.053291   .0947586    21.67   0.000     1.867522     2.23906
         50  |   2.088631    .097346    21.46   0.000     1.897789    2.279473
             |
     age_cat |
          1  |    .637838   .0334576    19.06   0.000      .572246    .7034299
          2  |    .740079   .0351007    21.08   0.000     .6712658    .8088921
          3  |   .7621857   .0371855    20.50   0.000     .6892854    .8350859
          4  |   .7926682   .0392854    20.18   0.000     .7156511    .8696853
          5  |   .7848778   .0418564    18.75   0.000     .7028204    .8669351
          6  |   .7899141   .0441724    17.88   0.000     .7033164    .8765118
          7  |   .7919928   .0470298    16.84   0.000     .6997934    .8841923
          8  |   .7963512   .0500783    15.90   0.000     .6981753     .894527
          9  |   .8106786   .0527828    15.36   0.000     .7072006    .9141565
         10  |   .8072026   .0559782    14.42   0.000     .6974601    .9169451
         11  |   .8193269   .0591534    13.85   0.000     .7033597    .9352942
         12  |   .8128975   .0624392    13.02   0.000     .6904886    .9353064
         13  |   .8171899   .0656519    12.45   0.000     .6884828     .945897
         14  |   .8148397   .0691304    11.79   0.000      .679313    .9503664
         15  |    .818423    .072742    11.25   0.000      .675816      .96103
         16  |   .8222236   .0762639    10.78   0.000     .6727122    .9717351
         17  |   .8160243   .0797263    10.24   0.000     .6597249    .9723236
         18  |   .8408702   .0832975    10.09   0.000     .6775696    1.004171
         19  |   .8243034   .0865562     9.52   0.000     .6546143    .9939924
         20  |    .821325   .0939574     8.74   0.000     .6371263    1.005524
         25  |   .7913433   .1072882     7.38   0.000     .5810103    1.001676
         30  |   .8024583    .146769     5.47   0.000     .5147253    1.090191
         40  |   .7513121   .1699946     4.42   0.000     .4180465    1.084578
         50  |   .7135354   .1883225     3.79   0.000     .3443387    1.082732
             |
       _cons |   6.707407    .036822   182.16   0.000     6.635219    6.779594
-------------+----------------------------------------------------------------
     sigma_u |  1.0716396
     sigma_e |  .54143813
         rho |  .79664123   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    217554
Group variable: firm_person                     Number of groups   =     15122

R-sq:  within  = 0.0437                         Obs per group: min =         1
       between = 0.0779                                        avg =      14.4
       overall = 0.0306                                        max =        25

                                                F(53,4896)         =     18.29
corr(u_i, Xb)  = 0.0439                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,897 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0319286   .0174881     1.83   0.068    -.0023559    .0662131
      during |  -.0268072   .0063242    -4.24   0.000    -.0392055    -.014409
       after |  -.0462684   .0096676    -4.79   0.000    -.0652212   -.0273156
during_expat |  -.0047906   .0087999    -0.54   0.586    -.0220422    .0124611
 after_expat |  -.0181949   .0121034    -1.50   0.133     -.041923    .0055332
             |
    ind_year |
         27  |  -.0217447   .0099176    -2.19   0.028    -.0411875   -.0023018
         28  |  -.0119456   .0112604    -1.06   0.289    -.0340211    .0101298
         29  |  -.0145409   .0130339    -1.12   0.265    -.0400932    .0110114
         30  |  -.0025251   .0147522    -0.17   0.864     -.031446    .0263958
         31  |  -.0183237   .0159889    -1.15   0.252    -.0496691    .0130217
         32  |  -.0210817   .0175761    -1.20   0.230    -.0555386    .0133753
         33  |  -.0271371   .0192296    -1.41   0.158    -.0648358    .0105616
         34  |  -.0302483    .020853    -1.45   0.147    -.0711294    .0106329
         35  |  -.0259961   .0223628    -1.16   0.245    -.0698372     .017845
         36  |  -.0339989   .0238434    -1.43   0.154    -.0807426    .0127449
         37  |  -.0305423   .0255169    -1.20   0.231    -.0805669    .0194823
         38  |   -.028049   .0273053    -1.03   0.304    -.0815797    .0254818
         39  |  -.0296677   .0289551    -1.02   0.306    -.0864327    .0270974
         40  |   -.035005   .0305874    -1.14   0.253    -.0949699      .02496
         41  |  -.0247039   .0324017    -0.76   0.446    -.0882258     .038818
         42  |  -.0233284   .0340872    -0.68   0.494    -.0901545    .0434978
         43  |  -.0130996   .0359967    -0.36   0.716    -.0836692      .05747
         44  |  -.0090939   .0376869    -0.24   0.809    -.0829772    .0647894
         45  |   .0035234   .0393055     0.09   0.929     -.073533    .0805799
         46  |   .0082552   .0410517     0.20   0.841    -.0722246    .0887349
         47  |   .0158602   .0424789     0.37   0.709    -.0674176    .0991379
         48  |   .0065127   .0440009     0.15   0.882    -.0797488    .0927743
         49  |  -.1796817   .0459605    -3.91   0.000    -.2697848   -.0895786
         50  |  -.2182668   .0475604    -4.59   0.000    -.3115066    -.125027
             |
     age_cat |
          1  |   .0774593   .0109743     7.06   0.000     .0559447    .0989739
          2  |   .1047283   .0120006     8.73   0.000     .0812019    .1282548
          3  |   .1281345   .0130119     9.85   0.000     .1026254    .1536436
          4  |   .1468619   .0146252    10.04   0.000       .11819    .1755339
          5  |   .1589221   .0159123     9.99   0.000     .1277269    .1901174
          6  |   .1732071   .0174975     9.90   0.000     .1389042    .2075099
          7  |   .1858688   .0191117     9.73   0.000     .1484012    .2233363
          8  |   .1867805   .0208927     8.94   0.000     .1458214    .2277396
          9  |   .2052652   .0224035     9.16   0.000     .1613444     .249186
         10  |   .2061074    .024103     8.55   0.000     .1588547    .2533602
         11  |   .2129817   .0257451     8.27   0.000     .1625098    .2634536
         12  |   .2140224   .0274584     7.79   0.000     .1601917    .2678531
         13  |   .2149886    .029169     7.37   0.000     .1578044    .2721729
         14  |   .2256177   .0310044     7.28   0.000     .1648352    .2864002
         15  |   .2537213   .0328131     7.73   0.000      .189393    .3180497
         16  |   .2500529   .0345012     7.25   0.000      .182415    .3176908
         17  |   .2536782   .0363413     6.98   0.000      .182433    .3249235
         18  |   .2456227   .0382266     6.43   0.000     .1706814    .3205641
         19  |   .2338776   .0403354     5.80   0.000     .1548022    .3129531
         20  |   .2381922   .0436431     5.46   0.000     .1526321    .3237524
         25  |   .2228618   .0515382     4.32   0.000     .1218238    .3238997
         30  |   .1803014   .0692284     2.60   0.009     .0445826    .3160202
         40  |   .0907313   .0866505     1.05   0.295    -.0791427    .2606052
         50  |   .0784609   .0958861     0.82   0.413    -.1095189    .2664406
             |
       _cons |    .552511   .0152527    36.22   0.000     .5226089    .5824131
-------------+----------------------------------------------------------------
     sigma_u |  .34349045
     sigma_e |  .28874242
         rho |  .58595022   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .04374929257536

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    217,554
Group variable: firm_person                     Number of groups  =     15,122

R-sq:                                           Obs per group:
     within  = 0.0437                                         min =          1
     between = 0.0779                                         avg =       14.4
     overall = 0.0306                                         max =         25

                                                F(53,4896)        =      18.29
corr(u_i, Xb)  = 0.0439                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,897 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0319286   .0174881     1.83   0.068    -.0023559    .0662131
      during |  -.0268072   .0063242    -4.24   0.000    -.0392055    -.014409
       after |  -.0462684   .0096676    -4.79   0.000    -.0652212   -.0273156
during_expat |  -.0047906   .0087999    -0.54   0.586    -.0220422    .0124611
 after_expat |  -.0181949   .0121034    -1.50   0.133     -.041923    .0055332
             |
    ind_year |
         27  |  -.0217447   .0099176    -2.19   0.028    -.0411875   -.0023018
         28  |  -.0119456   .0112604    -1.06   0.289    -.0340211    .0101298
         29  |  -.0145409   .0130339    -1.12   0.265    -.0400932    .0110114
         30  |  -.0025251   .0147522    -0.17   0.864     -.031446    .0263958
         31  |  -.0183237   .0159889    -1.15   0.252    -.0496691    .0130217
         32  |  -.0210817   .0175761    -1.20   0.230    -.0555386    .0133753
         33  |  -.0271371   .0192296    -1.41   0.158    -.0648358    .0105616
         34  |  -.0302483    .020853    -1.45   0.147    -.0711294    .0106329
         35  |  -.0259961   .0223628    -1.16   0.245    -.0698372     .017845
         36  |  -.0339989   .0238434    -1.43   0.154    -.0807426    .0127449
         37  |  -.0305423   .0255169    -1.20   0.231    -.0805669    .0194823
         38  |   -.028049   .0273053    -1.03   0.304    -.0815797    .0254818
         39  |  -.0296677   .0289551    -1.02   0.306    -.0864327    .0270974
         40  |   -.035005   .0305874    -1.14   0.253    -.0949699      .02496
         41  |  -.0247039   .0324017    -0.76   0.446    -.0882258     .038818
         42  |  -.0233284   .0340872    -0.68   0.494    -.0901545    .0434978
         43  |  -.0130996   .0359967    -0.36   0.716    -.0836692      .05747
         44  |  -.0090939   .0376869    -0.24   0.809    -.0829772    .0647894
         45  |   .0035234   .0393055     0.09   0.929     -.073533    .0805799
         46  |   .0082552   .0410517     0.20   0.841    -.0722246    .0887349
         47  |   .0158602   .0424789     0.37   0.709    -.0674176    .0991379
         48  |   .0065127   .0440009     0.15   0.882    -.0797488    .0927743
         49  |  -.1796817   .0459605    -3.91   0.000    -.2697848   -.0895786
         50  |  -.2182668   .0475604    -4.59   0.000    -.3115066    -.125027
             |
     age_cat |
          1  |   .0774593   .0109743     7.06   0.000     .0559447    .0989739
          2  |   .1047283   .0120006     8.73   0.000     .0812019    .1282548
          3  |   .1281345   .0130119     9.85   0.000     .1026254    .1536436
          4  |   .1468619   .0146252    10.04   0.000       .11819    .1755339
          5  |   .1589221   .0159123     9.99   0.000     .1277269    .1901174
          6  |   .1732071   .0174975     9.90   0.000     .1389042    .2075099
          7  |   .1858688   .0191117     9.73   0.000     .1484012    .2233363
          8  |   .1867805   .0208927     8.94   0.000     .1458214    .2277396
          9  |   .2052652   .0224035     9.16   0.000     .1613444     .249186
         10  |   .2061074    .024103     8.55   0.000     .1588547    .2533602
         11  |   .2129817   .0257451     8.27   0.000     .1625098    .2634536
         12  |   .2140224   .0274584     7.79   0.000     .1601917    .2678531
         13  |   .2149886    .029169     7.37   0.000     .1578044    .2721729
         14  |   .2256177   .0310044     7.28   0.000     .1648352    .2864002
         15  |   .2537213   .0328131     7.73   0.000      .189393    .3180497
         16  |   .2500529   .0345012     7.25   0.000      .182415    .3176908
         17  |   .2536782   .0363413     6.98   0.000      .182433    .3249235
         18  |   .2456227   .0382266     6.43   0.000     .1706814    .3205641
         19  |   .2338776   .0403354     5.80   0.000     .1548022    .3129531
         20  |   .2381922   .0436431     5.46   0.000     .1526321    .3237524
         25  |   .2228618   .0515382     4.32   0.000     .1218238    .3238997
         30  |   .1803014   .0692284     2.60   0.009     .0445826    .3160202
         40  |   .0907313   .0866505     1.05   0.295    -.0791427    .2606052
         50  |   .0784609   .0958861     0.82   0.413    -.1095189    .2664406
             |
       _cons |    .552511   .0152527    36.22   0.000     .5226089    .5824131
-------------+----------------------------------------------------------------
     sigma_u |  .34349045
     sigma_e |  .28874242
         rho |  .58595022   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    185951
Group variable: firm_person                     Number of groups   =     14571

R-sq:  within  = 0.0416                         Obs per group: min =         1
       between = 0.0060                                        avg =      12.8
       overall = 0.0285                                        max =        24

                                                F(51,4623)         =     53.96
corr(u_i, Xb)  = -0.1010                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,624 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0611733   .0372128     1.64   0.100    -.0117816    .1341282
      during |  -.0208812   .0126164    -1.66   0.098    -.0456153     .003853
       after |   .0051039   .0181751     0.28   0.779     -.030528    .0407358
during_expat |   .0455048   .0204216     2.23   0.026     .0054687    .0855409
 after_expat |   .0265891    .024984     1.06   0.287    -.0223914    .0755695
             |
    ind_year |
         28  |   -.218619   .0353458    -6.19   0.000    -.2879136   -.1493243
         29  |  -.0392765   .0346649    -1.13   0.257    -.1072362    .0286833
         30  |  -.1739478   .0359643    -4.84   0.000    -.2444551   -.1034406
         31  |  -.0121851   .0390346    -0.31   0.755    -.0887116    .0643414
         32  |   -.126113   .0404763    -3.12   0.002    -.2054658   -.0467601
         33  |  -.0085557   .0432609    -0.20   0.843    -.0933677    .0762563
         34  |  -.1398193   .0458827    -3.05   0.002    -.2297713   -.0498674
         35  |  -.0970264   .0499998    -1.94   0.052    -.1950498    .0009971
         36  |   -.087531   .0533352    -1.64   0.101    -.1920936    .0170315
         37  |  -.1676271   .0563103    -2.98   0.003    -.2780222    -.057232
         38  |  -.1277447   .0602154    -2.12   0.034    -.2457955   -.0096938
         39  |    -.21206   .0637024    -3.33   0.001    -.3369471   -.0871729
         40  |  -.1629446   .0671602    -2.43   0.015    -.2946107   -.0312785
         41  |  -.1948999   .0715306    -2.72   0.006    -.3351341   -.0546658
         42  |  -.1870034   .0757029    -2.47   0.014    -.3354172   -.0385896
         43  |  -.1000909   .0792306    -1.26   0.207    -.2554206    .0552388
         44  |  -.1785779    .082997    -2.15   0.031    -.3412917   -.0158642
         45  |  -.3622489   .0872754    -4.15   0.000    -.5333504   -.1911475
         46  |  -.2236375    .091408    -2.45   0.014    -.4028408   -.0444342
         47  |  -.0586977   .0940075    -0.62   0.532    -.2429973     .125602
         48  |  -.3568145    .097628    -3.65   0.000     -.548212   -.1654171
         49  |  -.8804188   .1006333    -8.75   0.000    -1.077708   -.6831294
         50  |  -.2223889   .1086256    -2.05   0.041     -.435347   -.0094308
             |
     age_cat |
          2  |  -.1575561   .0324706    -4.85   0.000    -.2212139   -.0938982
          3  |  -.2555343   .0329097    -7.76   0.000     -.320053   -.1910156
          4  |  -.3092953   .0343369    -9.01   0.000     -.376612   -.2419785
          5  |  -.4162017   .0369016   -11.28   0.000    -.4885465   -.3438569
          6  |  -.4136253   .0396775   -10.42   0.000    -.4914122   -.3358384
          7  |  -.4616773   .0426464   -10.83   0.000    -.5452846   -.3780699
          8  |  -.4358679   .0458048    -9.52   0.000    -.5256671   -.3460687
          9  |  -.4582906   .0492069    -9.31   0.000    -.5547596   -.3618216
         10  |  -.4949615    .052661    -9.40   0.000    -.5982021   -.3917208
         11  |  -.4631322   .0563979    -8.21   0.000    -.5736989   -.3525655
         12  |  -.4271534   .0604177    -7.07   0.000    -.5456009   -.3087059
         13  |  -.4432343   .0643482    -6.89   0.000    -.5693875   -.3170811
         14  |  -.4343521   .0680202    -6.39   0.000    -.5677042       -.301
         15  |  -.4318832   .0720834    -5.99   0.000    -.5732011   -.2905653
         16  |  -.4462723   .0757294    -5.89   0.000     -.594738   -.2978065
         17  |  -.4584742   .0795646    -5.76   0.000    -.6144588   -.3024896
         18  |   -.457528   .0845721    -5.41   0.000    -.6233296   -.2917264
         19  |  -.3945536   .0888479    -4.44   0.000    -.5687379   -.2203693
         20  |  -.4164694   .0962781    -4.33   0.000    -.6052204   -.2277183
         25  |  -.3951293   .1159202    -3.41   0.001    -.6223881   -.1678705
         30  |  -.4356257   .1555108    -2.80   0.005    -.7405011   -.1307503
         40  |  -.3409121   .1982063    -1.72   0.086    -.7294911    .0476669
         50  |  -.2968649   .2445821    -1.21   0.225    -.7763626    .1826329
             |
       _cons |   .3835703   .0388282     9.88   0.000     .3074484    .4596921
-------------+----------------------------------------------------------------
     sigma_u |  .37594882
     sigma_e |  .84956416
         rho |  .16375628   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0415554257153433

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    185,951
Group variable: firm_person                     Number of groups  =     14,571

R-sq:                                           Obs per group:
     within  = 0.0416                                         min =          1
     between = 0.0060                                         avg =       12.8
     overall = 0.0285                                         max =         24

                                                F(51,4623)        =      53.96
corr(u_i, Xb)  = -0.1010                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,624 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0611733   .0372128     1.64   0.100    -.0117816    .1341282
      during |  -.0208812   .0126164    -1.66   0.098    -.0456153     .003853
       after |   .0051039   .0181751     0.28   0.779     -.030528    .0407358
during_expat |   .0455048   .0204216     2.23   0.026     .0054687    .0855409
 after_expat |   .0265891    .024984     1.06   0.287    -.0223914    .0755695
             |
    ind_year |
         28  |   -.218619   .0353458    -6.19   0.000    -.2879136   -.1493243
         29  |  -.0392765   .0346649    -1.13   0.257    -.1072362    .0286833
         30  |  -.1739478   .0359643    -4.84   0.000    -.2444551   -.1034406
         31  |  -.0121851   .0390346    -0.31   0.755    -.0887116    .0643414
         32  |   -.126113   .0404763    -3.12   0.002    -.2054658   -.0467601
         33  |  -.0085557   .0432609    -0.20   0.843    -.0933677    .0762563
         34  |  -.1398193   .0458827    -3.05   0.002    -.2297713   -.0498674
         35  |  -.0970264   .0499998    -1.94   0.052    -.1950498    .0009971
         36  |   -.087531   .0533352    -1.64   0.101    -.1920936    .0170315
         37  |  -.1676271   .0563103    -2.98   0.003    -.2780222    -.057232
         38  |  -.1277447   .0602154    -2.12   0.034    -.2457955   -.0096938
         39  |    -.21206   .0637024    -3.33   0.001    -.3369471   -.0871729
         40  |  -.1629446   .0671602    -2.43   0.015    -.2946107   -.0312785
         41  |  -.1948999   .0715306    -2.72   0.006    -.3351341   -.0546658
         42  |  -.1870034   .0757029    -2.47   0.014    -.3354172   -.0385896
         43  |  -.1000909   .0792306    -1.26   0.207    -.2554206    .0552388
         44  |  -.1785779    .082997    -2.15   0.031    -.3412917   -.0158642
         45  |  -.3622489   .0872754    -4.15   0.000    -.5333504   -.1911475
         46  |  -.2236375    .091408    -2.45   0.014    -.4028408   -.0444342
         47  |  -.0586977   .0940075    -0.62   0.532    -.2429973     .125602
         48  |  -.3568145    .097628    -3.65   0.000     -.548212   -.1654171
         49  |  -.8804188   .1006333    -8.75   0.000    -1.077708   -.6831294
         50  |  -.2223889   .1086256    -2.05   0.041     -.435347   -.0094308
             |
     age_cat |
          2  |  -.1575561   .0324706    -4.85   0.000    -.2212139   -.0938982
          3  |  -.2555343   .0329097    -7.76   0.000     -.320053   -.1910156
          4  |  -.3092953   .0343369    -9.01   0.000     -.376612   -.2419785
          5  |  -.4162017   .0369016   -11.28   0.000    -.4885465   -.3438569
          6  |  -.4136253   .0396775   -10.42   0.000    -.4914122   -.3358384
          7  |  -.4616773   .0426464   -10.83   0.000    -.5452846   -.3780699
          8  |  -.4358679   .0458048    -9.52   0.000    -.5256671   -.3460687
          9  |  -.4582906   .0492069    -9.31   0.000    -.5547596   -.3618216
         10  |  -.4949615    .052661    -9.40   0.000    -.5982021   -.3917208
         11  |  -.4631322   .0563979    -8.21   0.000    -.5736989   -.3525655
         12  |  -.4271534   .0604177    -7.07   0.000    -.5456009   -.3087059
         13  |  -.4432343   .0643482    -6.89   0.000    -.5693875   -.3170811
         14  |  -.4343521   .0680202    -6.39   0.000    -.5677042       -.301
         15  |  -.4318832   .0720834    -5.99   0.000    -.5732011   -.2905653
         16  |  -.4462723   .0757294    -5.89   0.000     -.594738   -.2978065
         17  |  -.4584742   .0795646    -5.76   0.000    -.6144588   -.3024896
         18  |   -.457528   .0845721    -5.41   0.000    -.6233296   -.2917264
         19  |  -.3945536   .0888479    -4.44   0.000    -.5687379   -.2203693
         20  |  -.4164694   .0962781    -4.33   0.000    -.6052204   -.2277183
         25  |  -.3951293   .1159202    -3.41   0.001    -.6223881   -.1678705
         30  |  -.4356257   .1555108    -2.80   0.005    -.7405011   -.1307503
         40  |  -.3409121   .1982063    -1.72   0.086    -.7294911    .0476669
         50  |  -.2968649   .2445821    -1.21   0.225    -.7763626    .1826329
             |
       _cons |   .3835703   .0388282     9.88   0.000     .3074484    .4596921
-------------+----------------------------------------------------------------
     sigma_u |  .37594882
     sigma_e |  .84956416
         rho |  .16375628   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    350775
Group variable: firm_person                     Number of groups   =     20446

R-sq:  within  = 0.1537                         Obs per group: min =         1
       between = 0.0751                                        avg =      17.2
       overall = 0.0838                                        max =        25

                                                F(78,4628)         =     29.99
corr(u_i, Xb)  = -0.0546                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,629 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0142177   .0347647    -0.41   0.683    -.0823731    .0539377
      during |  -.1607285   .0182366    -8.81   0.000     -.196481    -.124976
       after |  -.3563594   .0296501   -12.02   0.000    -.4144878    -.298231
during_expat |   .1002384   .0256767     3.90   0.000     .0498999     .150577
 after_expat |   .2396532   .0390138     6.14   0.000     .1631676    .3161388
             |
    ind_year |
          2  |   -.054134   .0368085    -1.47   0.141    -.1262962    .0180282
          3  |  -.1148971   .0460529    -2.49   0.013    -.2051827   -.0246115
          4  |  -.1656102   .0536157    -3.09   0.002    -.2707225   -.0604978
          5  |  -.2358971   .0619152    -3.81   0.000    -.3572803   -.1145138
          6  |  -.2819865   .0685516    -4.11   0.000    -.4163804   -.1475926
          7  |  -.3182602   .0754022    -4.22   0.000    -.4660843    -.170436
          8  |  -.3128772   .0832408    -3.76   0.000    -.4760688   -.1496855
          9  |  -.3321763   .0901273    -3.69   0.000    -.5088688   -.1554837
         10  |  -.3631982   .0976121    -3.72   0.000    -.5545643    -.171832
         11  |  -.4348193   .1052753    -4.13   0.000    -.6412091   -.2284296
         12  |  -.4664913    .112502    -4.15   0.000    -.6870489   -.2459337
         13  |  -.5025933   .1199559    -4.19   0.000    -.7377641   -.2674225
         14  |  -.4825915    .127245    -3.79   0.000    -.7320523   -.2331307
         15  |  -.4581235   .1350803    -3.39   0.001    -.7229453   -.1933017
         16  |  -.4334059    .142695    -3.04   0.002    -.7131562   -.1536556
         17  |  -.4335101   .1507711    -2.88   0.004    -.7290932   -.1379269
         18  |  -.5023773   .1588046    -3.16   0.002    -.8137101   -.1910446
         19  |  -.5224433   .1669108    -3.13   0.002    -.8496681   -.1952185
         20  |  -.5502742   .1741999    -3.16   0.002    -.8917891   -.2087594
         21  |  -.6263189   .1811603    -3.46   0.001    -.9814794   -.2711584
         22  |  -.6566456   .1875846    -3.50   0.000    -1.024401   -.2888903
         23  |  -.6806436   .1936243    -3.52   0.000     -1.06024   -.3010477
         24  |   -.668453   .2009891    -3.33   0.001    -1.062487   -.2744186
         25  |   -.649774   .2086057    -3.11   0.002    -1.058741   -.2408074
         26  |     1.1193   .1012665    11.05   0.000     .9207689     1.31783
         27  |   .9284254   .0996622     9.32   0.000     .7330401    1.123811
         28  |   .8111789   .0986952     8.22   0.000     .6176892    1.004669
         29  |   .7083522   .0990814     7.15   0.000     .5141054     .902599
         30  |   .6643148    .099755     6.66   0.000     .4687474    .8598821
         31  |    .615601    .102891     5.98   0.000     .4138856    .8173164
         32  |   .5698907   .1058007     5.39   0.000     .3624708    .7773105
         33  |   .5185255   .1094606     4.74   0.000     .3039307    .7331204
         34  |   .4993878   .1140424     4.38   0.000     .2758103    .7229654
         35  |   .4429947   .1188782     3.73   0.000     .2099368    .6760527
         36  |   .3491719   .1241948     2.81   0.005     .1056909    .5926529
         37  |   .2901009   .1298078     2.23   0.025     .0356158     .544586
         38  |   .2245816   .1361894     1.65   0.099    -.0424146    .4915778
         39  |    .197451   .1428605     1.38   0.167    -.0826236    .4775256
         40  |    .166517   .1494081     1.11   0.265    -.1263941    .4594281
         41  |   .1733916   .1561488     1.11   0.267    -.1327344    .4795176
         42  |   .1606957   .1639364     0.98   0.327    -.1606978    .4820892
         43  |   .0107613   .1718442     0.06   0.950    -.3261353    .3476579
         44  |  -.0202726   .1799681    -0.11   0.910    -.3730959    .3325507
         45  |   .0149804   .1867304     0.08   0.936    -.3511003     .381061
         46  |   .0204958   .1929391     0.11   0.915    -.3577569    .3987485
         47  |   .0387251   .1987194     0.19   0.846    -.3508597    .4283098
         48  |   .0423756   .2043578     0.21   0.836    -.3582631    .4430143
         49  |   .0979544    .210797     0.46   0.642    -.3153081     .511217
         50  |   .1451736   .2164671     0.67   0.502    -.2792051    .5695523
             |
     age_cat |
          1  |   .4607021   .0300009    15.36   0.000      .401886    .5195181
          2  |   .8422767   .0358642    23.49   0.000     .7719658    .9125876
          3  |   1.079631   .0423797    25.48   0.000     .9965469    1.162716
          4  |   1.270849   .0496344    25.60   0.000     1.173542    1.368156
          5  |   1.415319   .0572861    24.71   0.000     1.303011    1.527627
          6  |   1.530351   .0649691    23.56   0.000     1.402981    1.657722
          7  |   1.637717   .0728366    22.48   0.000     1.494923    1.780512
          8  |   1.731029   .0809386    21.39   0.000     1.572351    1.889707
          9  |   1.804176   .0889902    20.27   0.000     1.629713    1.978639
         10  |   1.851566   .0970019    19.09   0.000     1.661396    2.041736
         11  |   1.908633   .1051915    18.14   0.000     1.702408    2.114859
         12  |   1.964171   .1132806    17.34   0.000     1.742087    2.186255
         13  |   2.017559    .121353    16.63   0.000     1.779649    2.255469
         14  |   2.039633   .1293769    15.77   0.000     1.785993    2.293274
         15  |   2.068983   .1378087    15.01   0.000     1.798813    2.339154
         16  |   2.089598   .1463207    14.28   0.000     1.802739    2.376456
         17  |   2.118229   .1548941    13.68   0.000     1.814563    2.421895
         18  |   2.132218   .1634069    13.05   0.000     1.811863    2.452574
         19  |   2.144039   .1714948    12.50   0.000     1.807827     2.48025
         20  |    2.14223   .1897264    11.29   0.000     1.770276    2.514185
         25  |   2.148862   .2179826     9.86   0.000     1.721512    2.576212
         30  |   1.919394   .3282614     5.85   0.000     1.275845    2.562943
         40  |   1.595081   .3779666     4.22   0.000     .8540861    2.336076
         50  |   1.306612   .4632274     2.82   0.005     .3984657    2.214759
             |
       _cons |   2.733283   .0732273    37.33   0.000     2.589722    2.876843
-------------+----------------------------------------------------------------
     sigma_u |  1.3171554
     sigma_e |  .77921356
         rho |  .74075359   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .153662611367255

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    350,775
Group variable: firm_person                     Number of groups  =     20,446

R-sq:                                           Obs per group:
     within  = 0.1537                                         min =          1
     between = 0.0751                                         avg =       17.2
     overall = 0.0838                                         max =         25

                                                F(78,4628)        =      29.99
corr(u_i, Xb)  = -0.0546                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,629 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0142177   .0347647    -0.41   0.683    -.0823731    .0539377
      during |  -.1607285   .0182366    -8.81   0.000     -.196481    -.124976
       after |  -.3563594   .0296501   -12.02   0.000    -.4144878    -.298231
during_expat |   .1002384   .0256767     3.90   0.000     .0498999     .150577
 after_expat |   .2396532   .0390138     6.14   0.000     .1631676    .3161388
             |
    ind_year |
          2  |   -.054134   .0368085    -1.47   0.141    -.1262962    .0180282
          3  |  -.1148971   .0460529    -2.49   0.013    -.2051827   -.0246115
          4  |  -.1656102   .0536157    -3.09   0.002    -.2707225   -.0604978
          5  |  -.2358971   .0619152    -3.81   0.000    -.3572803   -.1145138
          6  |  -.2819865   .0685516    -4.11   0.000    -.4163804   -.1475926
          7  |  -.3182602   .0754022    -4.22   0.000    -.4660843    -.170436
          8  |  -.3128772   .0832408    -3.76   0.000    -.4760688   -.1496855
          9  |  -.3321763   .0901273    -3.69   0.000    -.5088688   -.1554837
         10  |  -.3631982   .0976121    -3.72   0.000    -.5545643    -.171832
         11  |  -.4348193   .1052753    -4.13   0.000    -.6412091   -.2284296
         12  |  -.4664913    .112502    -4.15   0.000    -.6870489   -.2459337
         13  |  -.5025933   .1199559    -4.19   0.000    -.7377641   -.2674225
         14  |  -.4825915    .127245    -3.79   0.000    -.7320523   -.2331307
         15  |  -.4581235   .1350803    -3.39   0.001    -.7229453   -.1933017
         16  |  -.4334059    .142695    -3.04   0.002    -.7131562   -.1536556
         17  |  -.4335101   .1507711    -2.88   0.004    -.7290932   -.1379269
         18  |  -.5023773   .1588046    -3.16   0.002    -.8137101   -.1910446
         19  |  -.5224433   .1669108    -3.13   0.002    -.8496681   -.1952185
         20  |  -.5502742   .1741999    -3.16   0.002    -.8917891   -.2087594
         21  |  -.6263189   .1811603    -3.46   0.001    -.9814794   -.2711584
         22  |  -.6566456   .1875846    -3.50   0.000    -1.024401   -.2888903
         23  |  -.6806436   .1936243    -3.52   0.000     -1.06024   -.3010477
         24  |   -.668453   .2009891    -3.33   0.001    -1.062487   -.2744186
         25  |   -.649774   .2086057    -3.11   0.002    -1.058741   -.2408074
         26  |     1.1193   .1012665    11.05   0.000     .9207689     1.31783
         27  |   .9284254   .0996622     9.32   0.000     .7330401    1.123811
         28  |   .8111789   .0986952     8.22   0.000     .6176892    1.004669
         29  |   .7083522   .0990814     7.15   0.000     .5141054     .902599
         30  |   .6643148    .099755     6.66   0.000     .4687474    .8598821
         31  |    .615601    .102891     5.98   0.000     .4138856    .8173164
         32  |   .5698907   .1058007     5.39   0.000     .3624708    .7773105
         33  |   .5185255   .1094606     4.74   0.000     .3039307    .7331204
         34  |   .4993878   .1140424     4.38   0.000     .2758103    .7229654
         35  |   .4429947   .1188782     3.73   0.000     .2099368    .6760527
         36  |   .3491719   .1241948     2.81   0.005     .1056909    .5926529
         37  |   .2901009   .1298078     2.23   0.025     .0356158     .544586
         38  |   .2245816   .1361894     1.65   0.099    -.0424146    .4915778
         39  |    .197451   .1428605     1.38   0.167    -.0826236    .4775256
         40  |    .166517   .1494081     1.11   0.265    -.1263941    .4594281
         41  |   .1733916   .1561488     1.11   0.267    -.1327344    .4795176
         42  |   .1606957   .1639364     0.98   0.327    -.1606978    .4820892
         43  |   .0107613   .1718442     0.06   0.950    -.3261353    .3476579
         44  |  -.0202726   .1799681    -0.11   0.910    -.3730959    .3325507
         45  |   .0149804   .1867304     0.08   0.936    -.3511003     .381061
         46  |   .0204958   .1929391     0.11   0.915    -.3577569    .3987485
         47  |   .0387251   .1987194     0.19   0.846    -.3508597    .4283098
         48  |   .0423756   .2043578     0.21   0.836    -.3582631    .4430143
         49  |   .0979544    .210797     0.46   0.642    -.3153081     .511217
         50  |   .1451736   .2164671     0.67   0.502    -.2792051    .5695523
             |
     age_cat |
          1  |   .4607021   .0300009    15.36   0.000      .401886    .5195181
          2  |   .8422767   .0358642    23.49   0.000     .7719658    .9125876
          3  |   1.079631   .0423797    25.48   0.000     .9965469    1.162716
          4  |   1.270849   .0496344    25.60   0.000     1.173542    1.368156
          5  |   1.415319   .0572861    24.71   0.000     1.303011    1.527627
          6  |   1.530351   .0649691    23.56   0.000     1.402981    1.657722
          7  |   1.637717   .0728366    22.48   0.000     1.494923    1.780512
          8  |   1.731029   .0809386    21.39   0.000     1.572351    1.889707
          9  |   1.804176   .0889902    20.27   0.000     1.629713    1.978639
         10  |   1.851566   .0970019    19.09   0.000     1.661396    2.041736
         11  |   1.908633   .1051915    18.14   0.000     1.702408    2.114859
         12  |   1.964171   .1132806    17.34   0.000     1.742087    2.186255
         13  |   2.017559    .121353    16.63   0.000     1.779649    2.255469
         14  |   2.039633   .1293769    15.77   0.000     1.785993    2.293274
         15  |   2.068983   .1378087    15.01   0.000     1.798813    2.339154
         16  |   2.089598   .1463207    14.28   0.000     1.802739    2.376456
         17  |   2.118229   .1548941    13.68   0.000     1.814563    2.421895
         18  |   2.132218   .1634069    13.05   0.000     1.811863    2.452574
         19  |   2.144039   .1714948    12.50   0.000     1.807827     2.48025
         20  |    2.14223   .1897264    11.29   0.000     1.770276    2.514185
         25  |   2.148862   .2179826     9.86   0.000     1.721512    2.576212
         30  |   1.919394   .3282614     5.85   0.000     1.275845    2.562943
         40  |   1.595081   .3779666     4.22   0.000     .8540861    2.336076
         50  |   1.306612   .4632274     2.82   0.005     .3984657    2.214759
             |
       _cons |   2.733283   .0732273    37.33   0.000     2.589722    2.876843
-------------+----------------------------------------------------------------
     sigma_u |  1.3171554
     sigma_e |  .77921356
         rho |  .74075359   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    325013
Group variable: firm_person                     Number of groups   =     20280

R-sq:  within  = 0.2036                         Obs per group: min =         1
       between = 0.0979                                        avg =      16.0
       overall = 0.0972                                        max =        25

                                                F(78,4545)         =     41.20
corr(u_i, Xb)  = 0.0444                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,546 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0602352   .0503375     1.20   0.232    -.0384508    .1589211
      during |  -.1519717   .0254201    -5.98   0.000    -.2018074   -.1021359
       after |  -.3208445   .0389186    -8.24   0.000    -.3971438   -.2445451
during_expat |    .010945   .0356004     0.31   0.759    -.0588491    .0807391
 after_expat |    .034172   .0501088     0.68   0.495    -.0640656    .1324095
             |
    ind_year |
          2  |   .1564865   .0578621     2.70   0.007     .0430487    .2699244
          3  |   .6507842   .0715592     9.09   0.000     .5104934    .7910749
          4  |   .7632203    .082704     9.23   0.000     .6010803    .9253603
          5  |   .9447034   .0923885    10.23   0.000      .763577     1.12583
          6  |   1.097457    .102484    10.71   0.000     .8965386    1.298376
          7  |   1.295276   .1130918    11.45   0.000     1.073561    1.516991
          8  |    1.47473   .1237161    11.92   0.000     1.232186    1.717274
          9  |   1.598759   .1337931    11.95   0.000     1.336459    1.861058
         10  |   1.670197   .1440329    11.60   0.000     1.387822    1.952571
         11  |   1.707689   .1541789    11.08   0.000     1.405423    2.009955
         12  |   1.713114   .1657389    10.34   0.000     1.388185    2.038043
         13  |    1.74776   .1766574     9.89   0.000     1.401426    2.094094
         14  |    1.79219   .1872303     9.57   0.000     1.425128    2.159252
         15  |    1.77909   .1982289     8.97   0.000     1.390465    2.167715
         16  |   1.803065   .2092862     8.62   0.000     1.392763    2.213368
         17  |   1.825339   .2205574     8.28   0.000     1.392939    2.257738
         18  |   1.763097   .2331088     7.56   0.000     1.306091    2.220104
         19  |   1.691195   .2455054     6.89   0.000     1.209885    2.172505
         20  |   1.642775   .2565647     6.40   0.000     1.139783    2.145766
         21  |   1.614336   .2662378     6.06   0.000      1.09238    2.136291
         22  |   1.582574   .2760424     5.73   0.000     1.041397    2.123751
         23  |   1.605757   .2855407     5.62   0.000     1.045958    2.165556
         24  |   .9862047   .3017437     3.27   0.001     .3946403    1.577769
         25  |    1.09023   .3138007     3.47   0.001      .475028    1.705432
         26  |   1.472353   .1386284    10.62   0.000     1.200574    1.744132
         27  |   1.444552   .1333487    10.83   0.000     1.183124     1.70598
         28  |   1.554862    .129956    11.96   0.000     1.300085    1.809639
         29  |    1.61969   .1323921    12.23   0.000     1.360137    1.879243
         30  |   1.719716   .1354479    12.70   0.000     1.454173     1.98526
         31  |   1.810881   .1406472    12.88   0.000     1.535144    2.086618
         32  |   1.988795   .1460516    13.62   0.000     1.702463    2.275127
         33  |   2.124509   .1522369    13.96   0.000      1.82605    2.422967
         34  |   2.226595   .1596005    13.95   0.000     1.913701     2.53949
         35  |   2.288633   .1680178    13.62   0.000     1.959236    2.618029
         36  |    2.26625   .1772251    12.79   0.000     1.918802    2.613697
         37  |   2.289225   .1853097    12.35   0.000     1.925928    2.652522
         38  |   2.306023   .1958091    11.78   0.000     1.922142    2.689904
         39  |   2.356948    .205846    11.45   0.000     1.953389    2.760506
         40  |    2.37963   .2156463    11.03   0.000     1.956858    2.802402
         41  |   2.407206    .227136    10.60   0.000     1.961909    2.852503
         42  |   2.471446    .237127    10.42   0.000     2.006562     2.93633
         43  |   2.434823   .2478806     9.82   0.000     1.948856    2.920789
         44  |   2.378157   .2602854     9.14   0.000     1.867871    2.888442
         45  |   2.495491   .2708752     9.21   0.000     1.964444    3.026538
         46  |    2.50311   .2808904     8.91   0.000     1.952428    3.053791
         47  |   2.585763   .2897311     8.92   0.000      2.01775    3.153777
         48  |   2.673885   .2980351     8.97   0.000     2.089591    3.258179
         49  |   2.581364   .3061541     8.43   0.000     1.981153    3.181575
         50  |   2.678476   .3153408     8.49   0.000     2.060255    3.296697
             |
     age_cat |
          1  |    .467679   .0482214     9.70   0.000     .3731416    .5622163
          2  |   .8122546   .0554905    14.64   0.000     .7034663    .9210429
          3  |   .9899742    .064222    15.41   0.000     .8640678    1.115881
          4  |   1.153355   .0737753    15.63   0.000      1.00872    1.297991
          5  |    1.23256   .0845904    14.57   0.000     1.066722    1.398398
          6  |   1.306428   .0955345    13.67   0.000     1.119134    1.493722
          7  |   1.356667   .1068284    12.70   0.000     1.147232    1.566103
          8  |   1.407051   .1183168    11.89   0.000     1.175092    1.639009
          9  |   1.421808   .1299703    10.94   0.000     1.167003    1.676613
         10  |   1.428911   .1417102    10.08   0.000      1.15109    1.706732
         11  |   1.495736    .153046     9.77   0.000     1.195692    1.795781
         12  |   1.521692   .1648542     9.23   0.000     1.198498    1.844886
         13  |   1.513063   .1767503     8.56   0.000     1.166547     1.85958
         14  |   1.524173   .1884349     8.09   0.000     1.154749    1.893597
         15  |   1.511012   .2004913     7.54   0.000     1.117951    1.904072
         16  |   1.539119   .2132051     7.22   0.000     1.121133    1.957105
         17  |   1.533726    .225686     6.80   0.000     1.091272    1.976181
         18  |   1.553513   .2378733     6.53   0.000     1.087165     2.01986
         19  |   1.542838   .2510274     6.15   0.000     1.050702    2.034974
         20  |   1.503935   .2759499     5.45   0.000     .9629387    2.044931
         25  |   1.443609   .3177686     4.54   0.000     .8206283     2.06659
         30  |   1.211753   .4609923     2.63   0.009      .307984    2.115522
         40  |   .7896023   .5627972     1.40   0.161    -.3137537    1.892958
         50  |   .9841459   .6265623     1.57   0.116    -.2442207    2.212512
             |
       _cons |   8.081308     .10608    76.18   0.000      7.87334    8.289277
-------------+----------------------------------------------------------------
     sigma_u |   2.154156
     sigma_e |  1.1028821
         rho |  .79231629   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2035855167689551

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    325,013
Group variable: firm_person                     Number of groups  =     20,280

R-sq:                                           Obs per group:
     within  = 0.2036                                         min =          1
     between = 0.0979                                         avg =       16.0
     overall = 0.0972                                         max =         25

                                                F(78,4545)        =      41.20
corr(u_i, Xb)  = 0.0444                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,546 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0602352   .0503375     1.20   0.232    -.0384508    .1589211
      during |  -.1519717   .0254201    -5.98   0.000    -.2018074   -.1021359
       after |  -.3208445   .0389186    -8.24   0.000    -.3971438   -.2445451
during_expat |    .010945   .0356004     0.31   0.759    -.0588491    .0807391
 after_expat |    .034172   .0501088     0.68   0.495    -.0640656    .1324095
             |
    ind_year |
          2  |   .1564865   .0578621     2.70   0.007     .0430487    .2699244
          3  |   .6507842   .0715592     9.09   0.000     .5104934    .7910749
          4  |   .7632203    .082704     9.23   0.000     .6010803    .9253603
          5  |   .9447034   .0923885    10.23   0.000      .763577     1.12583
          6  |   1.097457    .102484    10.71   0.000     .8965386    1.298376
          7  |   1.295276   .1130918    11.45   0.000     1.073561    1.516991
          8  |    1.47473   .1237161    11.92   0.000     1.232186    1.717274
          9  |   1.598759   .1337931    11.95   0.000     1.336459    1.861058
         10  |   1.670197   .1440329    11.60   0.000     1.387822    1.952571
         11  |   1.707689   .1541789    11.08   0.000     1.405423    2.009955
         12  |   1.713114   .1657389    10.34   0.000     1.388185    2.038043
         13  |    1.74776   .1766574     9.89   0.000     1.401426    2.094094
         14  |    1.79219   .1872303     9.57   0.000     1.425128    2.159252
         15  |    1.77909   .1982289     8.97   0.000     1.390465    2.167715
         16  |   1.803065   .2092862     8.62   0.000     1.392763    2.213368
         17  |   1.825339   .2205574     8.28   0.000     1.392939    2.257738
         18  |   1.763097   .2331088     7.56   0.000     1.306091    2.220104
         19  |   1.691195   .2455054     6.89   0.000     1.209885    2.172505
         20  |   1.642775   .2565647     6.40   0.000     1.139783    2.145766
         21  |   1.614336   .2662378     6.06   0.000      1.09238    2.136291
         22  |   1.582574   .2760424     5.73   0.000     1.041397    2.123751
         23  |   1.605757   .2855407     5.62   0.000     1.045958    2.165556
         24  |   .9862047   .3017437     3.27   0.001     .3946403    1.577769
         25  |    1.09023   .3138007     3.47   0.001      .475028    1.705432
         26  |   1.472353   .1386284    10.62   0.000     1.200574    1.744132
         27  |   1.444552   .1333487    10.83   0.000     1.183124     1.70598
         28  |   1.554862    .129956    11.96   0.000     1.300085    1.809639
         29  |    1.61969   .1323921    12.23   0.000     1.360137    1.879243
         30  |   1.719716   .1354479    12.70   0.000     1.454173     1.98526
         31  |   1.810881   .1406472    12.88   0.000     1.535144    2.086618
         32  |   1.988795   .1460516    13.62   0.000     1.702463    2.275127
         33  |   2.124509   .1522369    13.96   0.000      1.82605    2.422967
         34  |   2.226595   .1596005    13.95   0.000     1.913701     2.53949
         35  |   2.288633   .1680178    13.62   0.000     1.959236    2.618029
         36  |    2.26625   .1772251    12.79   0.000     1.918802    2.613697
         37  |   2.289225   .1853097    12.35   0.000     1.925928    2.652522
         38  |   2.306023   .1958091    11.78   0.000     1.922142    2.689904
         39  |   2.356948    .205846    11.45   0.000     1.953389    2.760506
         40  |    2.37963   .2156463    11.03   0.000     1.956858    2.802402
         41  |   2.407206    .227136    10.60   0.000     1.961909    2.852503
         42  |   2.471446    .237127    10.42   0.000     2.006562     2.93633
         43  |   2.434823   .2478806     9.82   0.000     1.948856    2.920789
         44  |   2.378157   .2602854     9.14   0.000     1.867871    2.888442
         45  |   2.495491   .2708752     9.21   0.000     1.964444    3.026538
         46  |    2.50311   .2808904     8.91   0.000     1.952428    3.053791
         47  |   2.585763   .2897311     8.92   0.000      2.01775    3.153777
         48  |   2.673885   .2980351     8.97   0.000     2.089591    3.258179
         49  |   2.581364   .3061541     8.43   0.000     1.981153    3.181575
         50  |   2.678476   .3153408     8.49   0.000     2.060255    3.296697
             |
     age_cat |
          1  |    .467679   .0482214     9.70   0.000     .3731416    .5622163
          2  |   .8122546   .0554905    14.64   0.000     .7034663    .9210429
          3  |   .9899742    .064222    15.41   0.000     .8640678    1.115881
          4  |   1.153355   .0737753    15.63   0.000      1.00872    1.297991
          5  |    1.23256   .0845904    14.57   0.000     1.066722    1.398398
          6  |   1.306428   .0955345    13.67   0.000     1.119134    1.493722
          7  |   1.356667   .1068284    12.70   0.000     1.147232    1.566103
          8  |   1.407051   .1183168    11.89   0.000     1.175092    1.639009
          9  |   1.421808   .1299703    10.94   0.000     1.167003    1.676613
         10  |   1.428911   .1417102    10.08   0.000      1.15109    1.706732
         11  |   1.495736    .153046     9.77   0.000     1.195692    1.795781
         12  |   1.521692   .1648542     9.23   0.000     1.198498    1.844886
         13  |   1.513063   .1767503     8.56   0.000     1.166547     1.85958
         14  |   1.524173   .1884349     8.09   0.000     1.154749    1.893597
         15  |   1.511012   .2004913     7.54   0.000     1.117951    1.904072
         16  |   1.539119   .2132051     7.22   0.000     1.121133    1.957105
         17  |   1.533726    .225686     6.80   0.000     1.091272    1.976181
         18  |   1.553513   .2378733     6.53   0.000     1.087165     2.01986
         19  |   1.542838   .2510274     6.15   0.000     1.050702    2.034974
         20  |   1.503935   .2759499     5.45   0.000     .9629387    2.044931
         25  |   1.443609   .3177686     4.54   0.000     .8206283     2.06659
         30  |   1.211753   .4609923     2.63   0.009      .307984    2.115522
         40  |   .7896023   .5627972     1.40   0.161    -.3137537    1.892958
         50  |   .9841459   .6265623     1.57   0.116    -.2442207    2.212512
             |
       _cons |   8.081308     .10608    76.18   0.000      7.87334    8.289277
-------------+----------------------------------------------------------------
     sigma_u |   2.154156
     sigma_e |  1.1028821
         rho |  .79231629   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    350775
Group variable: firm_person                     Number of groups   =     20446

R-sq:  within  = 0.3898                         Obs per group: min =         1
       between = 0.0692                                        avg =      17.2
       overall = 0.1351                                        max =        25

                                                F(78,4628)         =     99.92
corr(u_i, Xb)  = -0.0149                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,629 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0692996   .0370515     1.87   0.061     -.003339    .1419382
      during |  -.1979112   .0207731    -9.53   0.000    -.2386365    -.157186
       after |  -.3713889   .0319675   -11.62   0.000    -.4340604   -.3087174
during_expat |   .1703674   .0285613     5.96   0.000     .1143737    .2263611
 after_expat |   .3105367   .0423458     7.33   0.000     .2275189    .3935546
             |
    ind_year |
          2  |   .0839763    .045034     1.86   0.062    -.0043118    .1722644
          3  |   .2101735   .0537876     3.91   0.000     .1047241    .3156229
          4  |   .3589117    .062242     5.77   0.000     .2368877    .4809356
          5  |   .5355686   .0700369     7.65   0.000      .398263    .6728742
          6  |   .6691683   .0783931     8.54   0.000     .5154804    .8228562
          7  |   .8001495   .0859502     9.31   0.000     .6316461    .9686528
          8  |   .8985317   .0955107     9.41   0.000     .7112853    1.085778
          9  |   1.015721    .103165     9.85   0.000     .8134685    1.217974
         10  |   1.093816   .1117295     9.79   0.000      .874773    1.312859
         11  |   1.113814   .1205899     9.24   0.000     .8774002    1.350228
         12  |    1.16687   .1293015     9.02   0.000     .9133772    1.420362
         13  |   1.200815   .1383892     8.68   0.000     .9295058    1.472123
         14  |   1.285599   .1470885     8.74   0.000     .9972355    1.573963
         15  |   1.359735   .1566655     8.68   0.000     1.052596    1.666874
         16  |   1.398868   .1659959     8.43   0.000     1.073437    1.724299
         17  |   1.443029   .1747681     8.26   0.000       1.1004    1.785657
         18  |    1.32426    .185025     7.16   0.000     .9615227    1.686997
         19  |      1.358   .1947535     6.97   0.000     .9761903     1.73981
         20  |   1.385666   .2031134     6.82   0.000     .9874666    1.783865
         21  |   1.310565   .2119728     6.18   0.000     .8949975    1.726133
         22  |   1.350077   .2198376     6.14   0.000     .9190904    1.781063
         23  |   1.406354   .2264723     6.21   0.000     .9623602    1.850347
         24  |   1.455352   .2345025     6.21   0.000     .9956153    1.915088
         25  |   1.476926   .2429122     6.08   0.000     1.000703     1.95315
         26  |   .5541997   .1100091     5.04   0.000     .3385295      .76987
         27  |   .5145783   .1053166     4.89   0.000     .3081075    .7210491
         28  |   .6646742   .1036193     6.41   0.000      .461531    .8678173
         29  |   .8637294   .1026746     8.41   0.000     .6624381    1.065021
         30  |    1.00815   .1041853     9.68   0.000     .8038976    1.212403
         31  |   1.168506   .1078159    10.84   0.000     .9571351    1.379876
         32  |   1.312565   .1118803    11.73   0.000     1.093226    1.531904
         33  |   1.391521   .1174822    11.84   0.000       1.1612    1.621842
         34  |    1.54637   .1233896    12.53   0.000     1.304468    1.788273
         35  |   1.587979   .1294788    12.26   0.000     1.334139     1.84182
         36  |   1.569846   .1366728    11.49   0.000     1.301902     1.83779
         37  |   1.628074    .143579    11.34   0.000     1.346591    1.909557
         38  |    1.63538   .1519617    10.76   0.000     1.337463    1.933298
         39  |   1.718118   .1602126    10.72   0.000     1.404025    2.032211
         40  |   1.835102   .1690358    10.86   0.000     1.503711    2.166493
         41  |   1.900971   .1770329    10.74   0.000     1.553902     2.24804
         42  |   1.956297   .1859846    10.52   0.000     1.591678    2.320915
         43  |   1.804529   .1953617     9.24   0.000     1.421527    2.187531
         44  |   1.881616   .2051057     9.17   0.000     1.479511    2.283721
         45  |   2.011266   .2132383     9.43   0.000     1.593217    2.429315
         46  |   2.049676   .2211084     9.27   0.000     1.616198    2.483154
         47  |    2.13514   .2276231     9.38   0.000      1.68889     2.58139
         48  |   2.188034   .2352594     9.30   0.000     1.726813    2.649255
         49  |   2.261557   .2419635     9.35   0.000     1.787194    2.735921
         50  |   2.355477   .2487529     9.47   0.000     1.867802    2.843151
             |
     age_cat |
          1  |   1.168113   .0463501    25.20   0.000     1.077244    1.258981
          2  |    1.68095   .0504952    33.29   0.000     1.581956    1.779945
          3  |   1.941807   .0568139    34.18   0.000     1.830424    2.053189
          4  |   2.132015   .0637597    33.44   0.000     2.007015    2.257014
          5  |   2.250836   .0719411    31.29   0.000     2.109797    2.391875
          6  |   2.354003   .0799752    29.43   0.000     2.197214    2.510793
          7  |   2.449208   .0885951    27.64   0.000     2.275519    2.622897
          8  |   2.505716   .0975609    25.68   0.000      2.31445    2.696982
          9  |   2.562415   .1066484    24.03   0.000     2.353333    2.771497
         10  |   2.594298   .1158057    22.40   0.000     2.367263    2.821332
         11  |   2.655644   .1251541    21.22   0.000     2.410282    2.901006
         12  |   2.681384   .1346285    19.92   0.000     2.417448     2.94532
         13  |   2.710896   .1438689    18.84   0.000     2.428845    2.992948
         14  |   2.718501   .1534042    17.72   0.000     2.417756    3.019247
         15  |   2.750149   .1632413    16.85   0.000     2.430118     3.07018
         16  |   2.731007   .1731846    15.77   0.000     2.391482    3.070531
         17  |   2.736971    .183049    14.95   0.000     2.378107    3.095834
         18  |   2.744046   .1928883    14.23   0.000     2.365893    3.122199
         19  |   2.707508    .202563    13.37   0.000     2.310388    3.104628
         20  |   2.666685   .2229619    11.96   0.000     2.229573    3.103797
         25  |   2.567567   .2533647    10.13   0.000     2.070851    3.064283
         30  |   2.254628    .382718     5.89   0.000     1.504318    3.004937
         40  |    2.12191   .4584389     4.63   0.000     1.223151    3.020669
         50  |   2.124624   .5414117     3.92   0.000     1.063199    3.186049
             |
       _cons |   10.18062   .0839606   121.25   0.000     10.01601    10.34522
-------------+----------------------------------------------------------------
     sigma_u |  1.8201466
     sigma_e |  .94124467
         rho |  .78900503   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .3898437073262162

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    350,775
Group variable: firm_person                     Number of groups  =     20,446

R-sq:                                           Obs per group:
     within  = 0.3898                                         min =          1
     between = 0.0692                                         avg =       17.2
     overall = 0.1351                                         max =         25

                                                F(78,4628)        =      99.92
corr(u_i, Xb)  = -0.0149                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,629 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0692996   .0370515     1.87   0.061     -.003339    .1419382
      during |  -.1979112   .0207731    -9.53   0.000    -.2386365    -.157186
       after |  -.3713889   .0319675   -11.62   0.000    -.4340604   -.3087174
during_expat |   .1703674   .0285613     5.96   0.000     .1143737    .2263611
 after_expat |   .3105367   .0423458     7.33   0.000     .2275189    .3935546
             |
    ind_year |
          2  |   .0839763    .045034     1.86   0.062    -.0043118    .1722644
          3  |   .2101735   .0537876     3.91   0.000     .1047241    .3156229
          4  |   .3589117    .062242     5.77   0.000     .2368877    .4809356
          5  |   .5355686   .0700369     7.65   0.000      .398263    .6728742
          6  |   .6691683   .0783931     8.54   0.000     .5154804    .8228562
          7  |   .8001495   .0859502     9.31   0.000     .6316461    .9686528
          8  |   .8985317   .0955107     9.41   0.000     .7112853    1.085778
          9  |   1.015721    .103165     9.85   0.000     .8134685    1.217974
         10  |   1.093816   .1117295     9.79   0.000      .874773    1.312859
         11  |   1.113814   .1205899     9.24   0.000     .8774002    1.350228
         12  |    1.16687   .1293015     9.02   0.000     .9133772    1.420362
         13  |   1.200815   .1383892     8.68   0.000     .9295058    1.472123
         14  |   1.285599   .1470885     8.74   0.000     .9972355    1.573963
         15  |   1.359735   .1566655     8.68   0.000     1.052596    1.666874
         16  |   1.398868   .1659959     8.43   0.000     1.073437    1.724299
         17  |   1.443029   .1747681     8.26   0.000       1.1004    1.785657
         18  |    1.32426    .185025     7.16   0.000     .9615227    1.686997
         19  |      1.358   .1947535     6.97   0.000     .9761903     1.73981
         20  |   1.385666   .2031134     6.82   0.000     .9874666    1.783865
         21  |   1.310565   .2119728     6.18   0.000     .8949975    1.726133
         22  |   1.350077   .2198376     6.14   0.000     .9190904    1.781063
         23  |   1.406354   .2264723     6.21   0.000     .9623602    1.850347
         24  |   1.455352   .2345025     6.21   0.000     .9956153    1.915088
         25  |   1.476926   .2429122     6.08   0.000     1.000703     1.95315
         26  |   .5541997   .1100091     5.04   0.000     .3385295      .76987
         27  |   .5145783   .1053166     4.89   0.000     .3081075    .7210491
         28  |   .6646742   .1036193     6.41   0.000      .461531    .8678173
         29  |   .8637294   .1026746     8.41   0.000     .6624381    1.065021
         30  |    1.00815   .1041853     9.68   0.000     .8038976    1.212403
         31  |   1.168506   .1078159    10.84   0.000     .9571351    1.379876
         32  |   1.312565   .1118803    11.73   0.000     1.093226    1.531904
         33  |   1.391521   .1174822    11.84   0.000       1.1612    1.621842
         34  |    1.54637   .1233896    12.53   0.000     1.304468    1.788273
         35  |   1.587979   .1294788    12.26   0.000     1.334139     1.84182
         36  |   1.569846   .1366728    11.49   0.000     1.301902     1.83779
         37  |   1.628074    .143579    11.34   0.000     1.346591    1.909557
         38  |    1.63538   .1519617    10.76   0.000     1.337463    1.933298
         39  |   1.718118   .1602126    10.72   0.000     1.404025    2.032211
         40  |   1.835102   .1690358    10.86   0.000     1.503711    2.166493
         41  |   1.900971   .1770329    10.74   0.000     1.553902     2.24804
         42  |   1.956297   .1859846    10.52   0.000     1.591678    2.320915
         43  |   1.804529   .1953617     9.24   0.000     1.421527    2.187531
         44  |   1.881616   .2051057     9.17   0.000     1.479511    2.283721
         45  |   2.011266   .2132383     9.43   0.000     1.593217    2.429315
         46  |   2.049676   .2211084     9.27   0.000     1.616198    2.483154
         47  |    2.13514   .2276231     9.38   0.000      1.68889     2.58139
         48  |   2.188034   .2352594     9.30   0.000     1.726813    2.649255
         49  |   2.261557   .2419635     9.35   0.000     1.787194    2.735921
         50  |   2.355477   .2487529     9.47   0.000     1.867802    2.843151
             |
     age_cat |
          1  |   1.168113   .0463501    25.20   0.000     1.077244    1.258981
          2  |    1.68095   .0504952    33.29   0.000     1.581956    1.779945
          3  |   1.941807   .0568139    34.18   0.000     1.830424    2.053189
          4  |   2.132015   .0637597    33.44   0.000     2.007015    2.257014
          5  |   2.250836   .0719411    31.29   0.000     2.109797    2.391875
          6  |   2.354003   .0799752    29.43   0.000     2.197214    2.510793
          7  |   2.449208   .0885951    27.64   0.000     2.275519    2.622897
          8  |   2.505716   .0975609    25.68   0.000      2.31445    2.696982
          9  |   2.562415   .1066484    24.03   0.000     2.353333    2.771497
         10  |   2.594298   .1158057    22.40   0.000     2.367263    2.821332
         11  |   2.655644   .1251541    21.22   0.000     2.410282    2.901006
         12  |   2.681384   .1346285    19.92   0.000     2.417448     2.94532
         13  |   2.710896   .1438689    18.84   0.000     2.428845    2.992948
         14  |   2.718501   .1534042    17.72   0.000     2.417756    3.019247
         15  |   2.750149   .1632413    16.85   0.000     2.430118     3.07018
         16  |   2.731007   .1731846    15.77   0.000     2.391482    3.070531
         17  |   2.736971    .183049    14.95   0.000     2.378107    3.095834
         18  |   2.744046   .1928883    14.23   0.000     2.365893    3.122199
         19  |   2.707508    .202563    13.37   0.000     2.310388    3.104628
         20  |   2.666685   .2229619    11.96   0.000     2.229573    3.103797
         25  |   2.567567   .2533647    10.13   0.000     2.070851    3.064283
         30  |   2.254628    .382718     5.89   0.000     1.504318    3.004937
         40  |    2.12191   .4584389     4.63   0.000     1.223151    3.020669
         50  |   2.124624   .5414117     3.92   0.000     1.063199    3.186049
             |
       _cons |   10.18062   .0839606   121.25   0.000     10.01601    10.34522
-------------+----------------------------------------------------------------
     sigma_u |  1.8201466
     sigma_e |  .94124467
         rho |  .78900503   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    325013
Group variable: firm_person                     Number of groups   =     20280

R-sq:  within  = 0.1444                         Obs per group: min =         1
       between = 0.0188                                        avg =      16.0
       overall = 0.0692                                        max =        25

                                                F(78,4545)         =     30.12
corr(u_i, Xb)  = -0.0331                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,546 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0892285   .0413115     2.16   0.031     .0082379    .1702191
      during |   .0080051   .0202972     0.39   0.693    -.0317873    .0477975
       after |   .0203683   .0293843     0.69   0.488    -.0372391    .0779758
during_expat |  -.0971681   .0286704    -3.39   0.001     -.153376   -.0409603
 after_expat |  -.2098791   .0385837    -5.44   0.000     -.285522   -.1342363
             |
    ind_year |
          2  |   .2014297    .049974     4.03   0.000     .1034563    .2994031
          3  |   .7629901   .0611749    12.47   0.000     .6430575    .8829227
          4  |   .9215828   .0703008    13.11   0.000     .7837591    1.059407
          5  |    1.15494   .0776992    14.86   0.000     1.002612    1.307268
          6  |   1.349831   .0857556    15.74   0.000     1.181708    1.517953
          7  |   1.584825   .0947042    16.73   0.000     1.399159    1.770491
          8  |   1.756688    .103099    17.04   0.000     1.554564    1.958812
          9  |   1.894195   .1111206    17.05   0.000     1.676344    2.112045
         10  |    1.99963    .120243    16.63   0.000     1.763895    2.235364
         11  |    2.10155   .1291691    16.27   0.000     1.848316    2.354785
         12  |   2.129543   .1390987    15.31   0.000     1.856842    2.402244
         13  |   2.200469   .1494294    14.73   0.000     1.907514    2.493423
         14  |   2.210058   .1586402    13.93   0.000     1.899046     2.52107
         15  |   2.167782   .1685916    12.86   0.000     1.837261    2.498304
         16  |   2.153511   .1785161    12.06   0.000     1.803532    2.503489
         17  |   2.173928   .1886858    11.52   0.000     1.804012    2.543844
         18  |   2.178748   .1995902    10.92   0.000     1.787454    2.570042
         19  |   2.139385   .2103586    10.17   0.000      1.72698    2.551791
         20  |   2.110366   .2202224     9.58   0.000     1.678623    2.542109
         21  |   2.127142   .2298247     9.26   0.000     1.676574    2.577711
         22  |   2.132198    .237592     8.97   0.000     1.666403    2.597994
         23  |   2.146747   .2464601     8.71   0.000     1.663566    2.629929
         24  |   1.390451   .2625992     5.29   0.000      .875629    1.905273
         25  |   1.460061   .2752256     5.30   0.000     .9204854    1.999638
         26  |   .4079005   .1031689     3.95   0.000     .2056393    .6101617
         27  |   .5826178    .097283     5.99   0.000     .3918958    .7733398
         28  |   .8027928   .0956622     8.39   0.000     .6152485    .9903371
         29  |   .9724066    .099119     9.81   0.000     .7780852    1.166728
         30  |    1.11486   .1023688    10.89   0.000     .9141679    1.315553
         31  |    1.25927     .10707    11.76   0.000     1.049361     1.46918
         32  |   1.482141   .1117684    13.26   0.000     1.263021    1.701262
         33  |   1.663918   .1184966    14.04   0.000     1.431607    1.896229
         34  |   1.791374   .1254628    14.28   0.000     1.545406    2.037342
         35  |   1.900016   .1330486    14.28   0.000     1.639176    2.160856
         36  |   1.970849   .1412787    13.95   0.000     1.693874    2.247824
         37  |    2.04919   .1493266    13.72   0.000     1.756437    2.341942
         38  |   2.114017    .159144    13.28   0.000     1.802017    2.426016
         39  |   2.184066   .1680688    13.00   0.000      1.85457    2.513563
         40  |    2.24216   .1767726    12.68   0.000       1.8956     2.58872
         41  |   2.244697   .1868969    12.01   0.000     1.878289    2.611106
         42  |   2.314908   .1959435    11.81   0.000     1.930763    2.699052
         43  |   2.419558   .2067304    11.70   0.000     2.014266    2.824851
         44  |   2.385738   .2173793    10.98   0.000     1.959569    2.811907
         45  |   2.464351   .2274725    10.83   0.000     2.018394    2.910307
         46  |   2.473168    .235554    10.50   0.000     2.011367    2.934968
         47  |   2.524632   .2438655    10.35   0.000     2.046537    3.002727
         48  |   2.594762   .2516428    10.31   0.000      2.10142    3.088105
         49  |   2.391772   .2589898     9.24   0.000     1.884026    2.899518
         50  |   2.475615   .2672209     9.26   0.000     1.951732    2.999498
             |
     age_cat |
          1  |   .0384903    .043984     0.88   0.382    -.0477398    .1247203
          2  |   .0054295   .0497054     0.11   0.913    -.0920173    .1028763
          3  |  -.0394045   .0564624    -0.70   0.485    -.1500983    .0712893
          4  |  -.0558561   .0642279    -0.87   0.385    -.1817739    .0700617
          5  |  -.1212361   .0732005    -1.66   0.098    -.2647446    .0222725
          6  |  -.1583327   .0823932    -1.92   0.055    -.3198634     .003198
          7  |     -.2119   .0920631    -2.30   0.021    -.3923885   -.0314116
          8  |  -.2546758   .1018805    -2.50   0.012    -.4544111   -.0549405
          9  |  -.3104389   .1121682    -2.77   0.006     -.530343   -.0905347
         10  |   -.356402   .1222465    -2.92   0.004    -.5960645   -.1167395
         11  |  -.3391246   .1320313    -2.57   0.010    -.5979701   -.0802791
         12  |  -.3571108   .1422659    -2.51   0.012    -.6360211   -.0782004
         13  |  -.4109355   .1526118    -2.69   0.007    -.7101287   -.1117422
         14  |   -.414303    .163042    -2.54   0.011    -.7339445   -.0946614
         15  |  -.4525835   .1730419    -2.62   0.009    -.7918298   -.1133372
         16  |  -.4498243   .1840651    -2.44   0.015    -.8106813   -.0889672
         17  |  -.4555499   .1949256    -2.34   0.019    -.8376989   -.0734009
         18  |  -.4741737   .2056484    -2.31   0.021    -.8773446   -.0710029
         19  |  -.4991299   .2171329    -2.30   0.022    -.9248159   -.0734439
         20  |  -.5225628   .2397029    -2.18   0.029    -.9924971   -.0526286
         25  |  -.6452081   .2783289    -2.32   0.020    -1.190868   -.0995481
         30  |   -.591003   .3766177    -1.57   0.117    -1.329357    .1473507
         40  |  -.6638514   .4856493    -1.37   0.172     -1.61596    .2882573
         50  |   -.233896   .5445419    -0.43   0.668    -1.301463    .8336708
             |
       _cons |   5.256982   .0850271    61.83   0.000     5.090287    5.423676
-------------+----------------------------------------------------------------
     sigma_u |  1.5297988
     sigma_e |  .93088568
         rho |  .72978067   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1443687320031207

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    325,013
Group variable: firm_person                     Number of groups  =     20,280

R-sq:                                           Obs per group:
     within  = 0.1444                                         min =          1
     between = 0.0188                                         avg =       16.0
     overall = 0.0692                                         max =         25

                                                F(78,4545)        =      30.12
corr(u_i, Xb)  = -0.0331                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,546 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0892285   .0413115     2.16   0.031     .0082379    .1702191
      during |   .0080051   .0202972     0.39   0.693    -.0317873    .0477975
       after |   .0203683   .0293843     0.69   0.488    -.0372391    .0779758
during_expat |  -.0971681   .0286704    -3.39   0.001     -.153376   -.0409603
 after_expat |  -.2098791   .0385837    -5.44   0.000     -.285522   -.1342363
             |
    ind_year |
          2  |   .2014297    .049974     4.03   0.000     .1034563    .2994031
          3  |   .7629901   .0611749    12.47   0.000     .6430575    .8829227
          4  |   .9215828   .0703008    13.11   0.000     .7837591    1.059407
          5  |    1.15494   .0776992    14.86   0.000     1.002612    1.307268
          6  |   1.349831   .0857556    15.74   0.000     1.181708    1.517953
          7  |   1.584825   .0947042    16.73   0.000     1.399159    1.770491
          8  |   1.756688    .103099    17.04   0.000     1.554564    1.958812
          9  |   1.894195   .1111206    17.05   0.000     1.676344    2.112045
         10  |    1.99963    .120243    16.63   0.000     1.763895    2.235364
         11  |    2.10155   .1291691    16.27   0.000     1.848316    2.354785
         12  |   2.129543   .1390987    15.31   0.000     1.856842    2.402244
         13  |   2.200469   .1494294    14.73   0.000     1.907514    2.493423
         14  |   2.210058   .1586402    13.93   0.000     1.899046     2.52107
         15  |   2.167782   .1685916    12.86   0.000     1.837261    2.498304
         16  |   2.153511   .1785161    12.06   0.000     1.803532    2.503489
         17  |   2.173928   .1886858    11.52   0.000     1.804012    2.543844
         18  |   2.178748   .1995902    10.92   0.000     1.787454    2.570042
         19  |   2.139385   .2103586    10.17   0.000      1.72698    2.551791
         20  |   2.110366   .2202224     9.58   0.000     1.678623    2.542109
         21  |   2.127142   .2298247     9.26   0.000     1.676574    2.577711
         22  |   2.132198    .237592     8.97   0.000     1.666403    2.597994
         23  |   2.146747   .2464601     8.71   0.000     1.663566    2.629929
         24  |   1.390451   .2625992     5.29   0.000      .875629    1.905273
         25  |   1.460061   .2752256     5.30   0.000     .9204854    1.999638
         26  |   .4079005   .1031689     3.95   0.000     .2056393    .6101617
         27  |   .5826178    .097283     5.99   0.000     .3918958    .7733398
         28  |   .8027928   .0956622     8.39   0.000     .6152485    .9903371
         29  |   .9724066    .099119     9.81   0.000     .7780852    1.166728
         30  |    1.11486   .1023688    10.89   0.000     .9141679    1.315553
         31  |    1.25927     .10707    11.76   0.000     1.049361     1.46918
         32  |   1.482141   .1117684    13.26   0.000     1.263021    1.701262
         33  |   1.663918   .1184966    14.04   0.000     1.431607    1.896229
         34  |   1.791374   .1254628    14.28   0.000     1.545406    2.037342
         35  |   1.900016   .1330486    14.28   0.000     1.639176    2.160856
         36  |   1.970849   .1412787    13.95   0.000     1.693874    2.247824
         37  |    2.04919   .1493266    13.72   0.000     1.756437    2.341942
         38  |   2.114017    .159144    13.28   0.000     1.802017    2.426016
         39  |   2.184066   .1680688    13.00   0.000      1.85457    2.513563
         40  |    2.24216   .1767726    12.68   0.000       1.8956     2.58872
         41  |   2.244697   .1868969    12.01   0.000     1.878289    2.611106
         42  |   2.314908   .1959435    11.81   0.000     1.930763    2.699052
         43  |   2.419558   .2067304    11.70   0.000     2.014266    2.824851
         44  |   2.385738   .2173793    10.98   0.000     1.959569    2.811907
         45  |   2.464351   .2274725    10.83   0.000     2.018394    2.910307
         46  |   2.473168    .235554    10.50   0.000     2.011367    2.934968
         47  |   2.524632   .2438655    10.35   0.000     2.046537    3.002727
         48  |   2.594762   .2516428    10.31   0.000      2.10142    3.088105
         49  |   2.391772   .2589898     9.24   0.000     1.884026    2.899518
         50  |   2.475615   .2672209     9.26   0.000     1.951732    2.999498
             |
     age_cat |
          1  |   .0384903    .043984     0.88   0.382    -.0477398    .1247203
          2  |   .0054295   .0497054     0.11   0.913    -.0920173    .1028763
          3  |  -.0394045   .0564624    -0.70   0.485    -.1500983    .0712893
          4  |  -.0558561   .0642279    -0.87   0.385    -.1817739    .0700617
          5  |  -.1212361   .0732005    -1.66   0.098    -.2647446    .0222725
          6  |  -.1583327   .0823932    -1.92   0.055    -.3198634     .003198
          7  |     -.2119   .0920631    -2.30   0.021    -.3923885   -.0314116
          8  |  -.2546758   .1018805    -2.50   0.012    -.4544111   -.0549405
          9  |  -.3104389   .1121682    -2.77   0.006     -.530343   -.0905347
         10  |   -.356402   .1222465    -2.92   0.004    -.5960645   -.1167395
         11  |  -.3391246   .1320313    -2.57   0.010    -.5979701   -.0802791
         12  |  -.3571108   .1422659    -2.51   0.012    -.6360211   -.0782004
         13  |  -.4109355   .1526118    -2.69   0.007    -.7101287   -.1117422
         14  |   -.414303    .163042    -2.54   0.011    -.7339445   -.0946614
         15  |  -.4525835   .1730419    -2.62   0.009    -.7918298   -.1133372
         16  |  -.4498243   .1840651    -2.44   0.015    -.8106813   -.0889672
         17  |  -.4555499   .1949256    -2.34   0.019    -.8376989   -.0734009
         18  |  -.4741737   .2056484    -2.31   0.021    -.8773446   -.0710029
         19  |  -.4991299   .2171329    -2.30   0.022    -.9248159   -.0734439
         20  |  -.5225628   .2397029    -2.18   0.029    -.9924971   -.0526286
         25  |  -.6452081   .2783289    -2.32   0.020    -1.190868   -.0995481
         30  |   -.591003   .3766177    -1.57   0.117    -1.329357    .1473507
         40  |  -.6638514   .4856493    -1.37   0.172     -1.61596    .2882573
         50  |   -.233896   .5445419    -0.43   0.668    -1.301463    .8336708
             |
       _cons |   5.256982   .0850271    61.83   0.000     5.090287    5.423676
-------------+----------------------------------------------------------------
     sigma_u |  1.5297988
     sigma_e |  .93088568
         rho |  .72978067   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    350775
Group variable: firm_person                     Number of groups   =     20446

R-sq:  within  = 0.4007                         Obs per group: min =         1
       between = 0.1214                                        avg =      17.2
       overall = 0.2126                                        max =        25

                                                F(78,4628)         =    112.00
corr(u_i, Xb)  = 0.0067                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,629 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0835173   .0234525     3.56   0.000     .0375392    .1294954
      during |  -.0371827   .0128377    -2.90   0.004    -.0623507   -.0120147
       after |  -.0150295   .0191466    -0.78   0.433    -.0525659    .0225069
during_expat |    .070129   .0176644     3.97   0.000     .0354982    .1047597
 after_expat |   .0708836   .0248753     2.85   0.004     .0221161     .119651
             |
    ind_year |
          2  |   .1381103   .0345444     4.00   0.000     .0703869    .2058337
          3  |   .3250706   .0390145     8.33   0.000     .2485835    .4015577
          4  |   .5245218   .0432946    12.12   0.000     .4396437    .6093999
          5  |   .7714657   .0457587    16.86   0.000     .6817569    .8611745
          6  |   .9511548    .050078    18.99   0.000     .8529781    1.049331
          7  |    1.11841   .0543211    20.59   0.000     1.011914    1.224905
          8  |   1.211409   .0583224    20.77   0.000     1.097069    1.325749
          9  |   1.347897   .0627603    21.48   0.000     1.224857    1.470938
         10  |   1.457014   .0670892    21.72   0.000     1.325487    1.588541
         11  |   1.548633    .071225    21.74   0.000     1.408998    1.688268
         12  |   1.633361   .0757209    21.57   0.000     1.484912     1.78181
         13  |   1.703408   .0802091    21.24   0.000      1.54616    1.860656
         14  |   1.768191   .0843067    20.97   0.000     1.602909    1.933472
         15  |   1.817858   .0892177    20.38   0.000     1.642949    1.992767
         16  |   1.832274   .0940591    19.48   0.000     1.647874    2.016675
         17  |   1.876539   .0988508    18.98   0.000     1.682744    2.070333
         18  |   1.826637   .1037551    17.61   0.000     1.623228    2.030047
         19  |   1.880443    .108764    17.29   0.000     1.667214    2.093673
         20  |    1.93594    .113278    17.09   0.000     1.713861    2.158019
         21  |   1.936884   .1179525    16.42   0.000     1.705641    2.168127
         22  |   2.006723   .1218903    16.46   0.000     1.767759    2.245686
         23  |   2.086997   .1258299    16.59   0.000     1.840311    2.333684
         24  |   2.123805   .1302438    16.31   0.000     1.868465    2.379145
         25  |     2.1267     .13447    15.82   0.000     1.863075    2.390326
         26  |  -.5650998   .0660273    -8.56   0.000    -.6945449   -.4356548
         27  |  -.4138471   .0646197    -6.40   0.000    -.5405324   -.2871618
         28  |  -.1465047   .0634666    -2.31   0.021    -.2709294     -.02208
         29  |   .1553772   .0642019     2.42   0.016     .0295108    .2812435
         30  |   .3438356   .0644443     5.34   0.000     .2174941    .4701771
         31  |   .5529047   .0661434     8.36   0.000      .423232    .6825773
         32  |   .7426745   .0687944    10.80   0.000     .6078048    .8775443
         33  |   .8729957   .0706042    12.36   0.000     .7345779    1.011413
         34  |   1.046983    .073648    14.22   0.000     .9025974    1.191368
         35  |   1.144985   .0762756    15.01   0.000     .9954481    1.294521
         36  |   1.220674   .0798971    15.28   0.000     1.064037     1.37731
         37  |   1.337973   .0837743    15.97   0.000     1.173735     1.50221
         38  |   1.410799   .0879077    16.05   0.000     1.238458     1.58314
         39  |   1.520667   .0920789    16.51   0.000     1.340148    1.701185
         40  |   1.668585   .0965246    17.29   0.000     1.479351    1.857819
         41  |   1.727579   .1011058    17.09   0.000     1.529364    1.925795
         42  |   1.795601   .1050809    17.09   0.000     1.589592     2.00161
         43  |   1.793767   .1098544    16.33   0.000       1.5784    2.009134
         44  |   1.901888   .1147652    16.57   0.000     1.676894    2.126883
         45  |   1.996286   .1187193    16.82   0.000     1.763539    2.229032
         46  |    2.02918   .1225933    16.55   0.000     1.788839    2.269522
         47  |   2.096415   .1257147    16.68   0.000     1.849954    2.342876
         48  |   2.145658   .1296231    16.55   0.000     1.891535    2.399781
         49  |   2.163603   .1337153    16.18   0.000     1.901457    2.425749
         50  |   2.210303   .1371175    16.12   0.000     1.941487    2.479119
             |
     age_cat |
          1  |   .7074104   .0366013    19.33   0.000     .6356543    .7791665
          2  |   .8386737    .038254    21.92   0.000     .7636776    .9136698
          3  |   .8621752   .0408212    21.12   0.000     .7821461    .9422043
          4  |   .8611656    .043578    19.76   0.000      .775732    .9465993
          5  |    .835517   .0475765    17.56   0.000     .7422443    .9287896
          6  |   .8236518   .0511814    16.09   0.000     .7233119    .9239917
          7  |   .8114907   .0551539    14.71   0.000     .7033627    .9196187
          8  |    .774687   .0593617    13.05   0.000     .6583097    .8910642
          9  |   .7582385   .0639234    11.86   0.000     .6329181     .883559
         10  |   .7427318   .0683229    10.87   0.000     .6087864    .8766772
         11  |   .7470107   .0731059    10.22   0.000     .6036883     .890333
         12  |   .7172128    .077878     9.21   0.000     .5645348    .8698908
         13  |   .6933374   .0826376     8.39   0.000     .5313283    .8553465
         14  |   .6788681   .0874579     7.76   0.000     .5074089    .8503273
         15  |   .6811656   .0926604     7.35   0.000     .4995071    .8628241
         16  |   .6414091   .0979619     6.55   0.000     .4493571    .8334611
         17  |   .6187417   .1027759     6.02   0.000      .417252    .8202315
         18  |   .6118275   .1077528     5.68   0.000     .4005807    .8230743
         19  |   .5634693   .1129398     4.99   0.000     .3420534    .7848851
         20  |   .5244545   .1226558     4.28   0.000     .2839906    .7649184
         25  |   .4187049   .1373975     3.05   0.002     .1493402    .6880696
         30  |   .3352337   .2085364     1.61   0.108     -.073597    .7440643
         40  |   .5268291   .2520134     2.09   0.037     .0327626    1.020896
         50  |    .818012   .2993747     2.73   0.006      .231095    1.404929
             |
       _cons |   7.447333   .0592385   125.72   0.000     7.331197    7.563469
-------------+----------------------------------------------------------------
     sigma_u |  1.1894652
     sigma_e |  .65434389
         rho |  .76767907   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .4007495210727137

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    350,775
Group variable: firm_person                     Number of groups  =     20,446

R-sq:                                           Obs per group:
     within  = 0.4007                                         min =          1
     between = 0.1214                                         avg =       17.2
     overall = 0.2126                                         max =         25

                                                F(78,4628)        =     112.00
corr(u_i, Xb)  = 0.0067                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,629 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0835173   .0234525     3.56   0.000     .0375392    .1294954
      during |  -.0371827   .0128377    -2.90   0.004    -.0623507   -.0120147
       after |  -.0150295   .0191466    -0.78   0.433    -.0525659    .0225069
during_expat |    .070129   .0176644     3.97   0.000     .0354982    .1047597
 after_expat |   .0708836   .0248753     2.85   0.004     .0221161     .119651
             |
    ind_year |
          2  |   .1381103   .0345444     4.00   0.000     .0703869    .2058337
          3  |   .3250706   .0390145     8.33   0.000     .2485835    .4015577
          4  |   .5245218   .0432946    12.12   0.000     .4396437    .6093999
          5  |   .7714657   .0457587    16.86   0.000     .6817569    .8611745
          6  |   .9511548    .050078    18.99   0.000     .8529781    1.049331
          7  |    1.11841   .0543211    20.59   0.000     1.011914    1.224905
          8  |   1.211409   .0583224    20.77   0.000     1.097069    1.325749
          9  |   1.347897   .0627603    21.48   0.000     1.224857    1.470938
         10  |   1.457014   .0670892    21.72   0.000     1.325487    1.588541
         11  |   1.548633    .071225    21.74   0.000     1.408998    1.688268
         12  |   1.633361   .0757209    21.57   0.000     1.484912     1.78181
         13  |   1.703408   .0802091    21.24   0.000      1.54616    1.860656
         14  |   1.768191   .0843067    20.97   0.000     1.602909    1.933472
         15  |   1.817858   .0892177    20.38   0.000     1.642949    1.992767
         16  |   1.832274   .0940591    19.48   0.000     1.647874    2.016675
         17  |   1.876539   .0988508    18.98   0.000     1.682744    2.070333
         18  |   1.826637   .1037551    17.61   0.000     1.623228    2.030047
         19  |   1.880443    .108764    17.29   0.000     1.667214    2.093673
         20  |    1.93594    .113278    17.09   0.000     1.713861    2.158019
         21  |   1.936884   .1179525    16.42   0.000     1.705641    2.168127
         22  |   2.006723   .1218903    16.46   0.000     1.767759    2.245686
         23  |   2.086997   .1258299    16.59   0.000     1.840311    2.333684
         24  |   2.123805   .1302438    16.31   0.000     1.868465    2.379145
         25  |     2.1267     .13447    15.82   0.000     1.863075    2.390326
         26  |  -.5650998   .0660273    -8.56   0.000    -.6945449   -.4356548
         27  |  -.4138471   .0646197    -6.40   0.000    -.5405324   -.2871618
         28  |  -.1465047   .0634666    -2.31   0.021    -.2709294     -.02208
         29  |   .1553772   .0642019     2.42   0.016     .0295108    .2812435
         30  |   .3438356   .0644443     5.34   0.000     .2174941    .4701771
         31  |   .5529047   .0661434     8.36   0.000      .423232    .6825773
         32  |   .7426745   .0687944    10.80   0.000     .6078048    .8775443
         33  |   .8729957   .0706042    12.36   0.000     .7345779    1.011413
         34  |   1.046983    .073648    14.22   0.000     .9025974    1.191368
         35  |   1.144985   .0762756    15.01   0.000     .9954481    1.294521
         36  |   1.220674   .0798971    15.28   0.000     1.064037     1.37731
         37  |   1.337973   .0837743    15.97   0.000     1.173735     1.50221
         38  |   1.410799   .0879077    16.05   0.000     1.238458     1.58314
         39  |   1.520667   .0920789    16.51   0.000     1.340148    1.701185
         40  |   1.668585   .0965246    17.29   0.000     1.479351    1.857819
         41  |   1.727579   .1011058    17.09   0.000     1.529364    1.925795
         42  |   1.795601   .1050809    17.09   0.000     1.589592     2.00161
         43  |   1.793767   .1098544    16.33   0.000       1.5784    2.009134
         44  |   1.901888   .1147652    16.57   0.000     1.676894    2.126883
         45  |   1.996286   .1187193    16.82   0.000     1.763539    2.229032
         46  |    2.02918   .1225933    16.55   0.000     1.788839    2.269522
         47  |   2.096415   .1257147    16.68   0.000     1.849954    2.342876
         48  |   2.145658   .1296231    16.55   0.000     1.891535    2.399781
         49  |   2.163603   .1337153    16.18   0.000     1.901457    2.425749
         50  |   2.210303   .1371175    16.12   0.000     1.941487    2.479119
             |
     age_cat |
          1  |   .7074104   .0366013    19.33   0.000     .6356543    .7791665
          2  |   .8386737    .038254    21.92   0.000     .7636776    .9136698
          3  |   .8621752   .0408212    21.12   0.000     .7821461    .9422043
          4  |   .8611656    .043578    19.76   0.000      .775732    .9465993
          5  |    .835517   .0475765    17.56   0.000     .7422443    .9287896
          6  |   .8236518   .0511814    16.09   0.000     .7233119    .9239917
          7  |   .8114907   .0551539    14.71   0.000     .7033627    .9196187
          8  |    .774687   .0593617    13.05   0.000     .6583097    .8910642
          9  |   .7582385   .0639234    11.86   0.000     .6329181     .883559
         10  |   .7427318   .0683229    10.87   0.000     .6087864    .8766772
         11  |   .7470107   .0731059    10.22   0.000     .6036883     .890333
         12  |   .7172128    .077878     9.21   0.000     .5645348    .8698908
         13  |   .6933374   .0826376     8.39   0.000     .5313283    .8553465
         14  |   .6788681   .0874579     7.76   0.000     .5074089    .8503273
         15  |   .6811656   .0926604     7.35   0.000     .4995071    .8628241
         16  |   .6414091   .0979619     6.55   0.000     .4493571    .8334611
         17  |   .6187417   .1027759     6.02   0.000      .417252    .8202315
         18  |   .6118275   .1077528     5.68   0.000     .4005807    .8230743
         19  |   .5634693   .1129398     4.99   0.000     .3420534    .7848851
         20  |   .5244545   .1226558     4.28   0.000     .2839906    .7649184
         25  |   .4187049   .1373975     3.05   0.002     .1493402    .6880696
         30  |   .3352337   .2085364     1.61   0.108     -.073597    .7440643
         40  |   .5268291   .2520134     2.09   0.037     .0327626    1.020896
         50  |    .818012   .2993747     2.73   0.006      .231095    1.404929
             |
       _cons |   7.447333   .0592385   125.72   0.000     7.331197    7.563469
-------------+----------------------------------------------------------------
     sigma_u |  1.1894652
     sigma_e |  .65434389
         rho |  .76767907   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    350775
Group variable: firm_person                     Number of groups   =     20446

R-sq:  within  = 0.0352                         Obs per group: min =         1
       between = 0.1698                                        avg =      17.2
       overall = 0.0816                                        max =        25

                                                F(78,4628)         =     10.89
corr(u_i, Xb)  = 0.1756                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,629 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0281768   .0107243     2.63   0.009      .007152    .0492015
      during |  -.0223473    .005598    -3.99   0.000    -.0333221   -.0113726
       after |  -.0393863   .0085833    -4.59   0.000    -.0562136   -.0225589
during_expat |   .0126502   .0074633     1.69   0.090    -.0019815    .0272818
 after_expat |   .0138436   .0101925     1.36   0.174    -.0061386    .0338258
             |
    ind_year |
          2  |   .0071247   .0159973     0.45   0.656    -.0242377    .0384871
          3  |    -.02938   .0181804    -1.62   0.106    -.0650224    .0062623
          4  |  -.0472454   .0203573    -2.32   0.020    -.0871553   -.0073354
          5  |  -.0287561   .0221122    -1.30   0.194    -.0721066    .0145944
          6  |   -.045796   .0242552    -1.89   0.059    -.0933478    .0017559
          7  |  -.0326444   .0262667    -1.24   0.214    -.0841397    .0188509
          8  |  -.0428897   .0288187    -1.49   0.137    -.0993881    .0136086
          9  |  -.0468716   .0312591    -1.50   0.134    -.1081543    .0144112
         10  |  -.0359077   .0338707    -1.06   0.289    -.1023104    .0304951
         11  |  -.0439125   .0366802    -1.20   0.231    -.1158232    .0279983
         12  |  -.0370531   .0391483    -0.95   0.344    -.1138023    .0396962
         13  |  -.0239883   .0417595    -0.57   0.566    -.1058569    .0578803
         14  |   .0010071   .0444958     0.02   0.982    -.0862258    .0882401
         15  |   .0153646   .0471415     0.33   0.744    -.0770552    .1077844
         16  |   .0284679   .0503285     0.57   0.572    -.0702001    .1271358
         17  |   .0394909   .0533544     0.74   0.459    -.0651092     .144091
         18  |   .0485816   .0566328     0.86   0.391    -.0624458    .1596089
         19  |   .0512425   .0597666     0.86   0.391    -.0659287    .1684136
         20  |   .0780346   .0625599     1.25   0.212    -.0446125    .2006817
         21  |   .0880967   .0650557     1.35   0.176    -.0394436    .2156369
         22  |   .1028001   .0678714     1.51   0.130    -.0302603    .2358604
         23  |   .0906451   .0701694     1.29   0.196    -.0469203    .2282105
         24  |   .0440904   .0729327     0.60   0.546    -.0988925    .1870732
         25  |   .0167857   .0754525     0.22   0.824    -.1311371    .1647086
         26  |   .1299945   .0266193     4.88   0.000     .0778079     .182181
         27  |   .1061151   .0257088     4.13   0.000     .0557136    .1565165
         28  |   .1184784   .0254801     4.65   0.000     .0685253    .1684315
         29  |   .1142574    .026062     4.38   0.000     .0631634    .1653514
         30  |   .1185417    .026917     4.40   0.000     .0657716    .1713119
         31  |   .1144135   .0282577     4.05   0.000      .059015     .169812
         32  |   .1005704   .0301497     3.34   0.001     .0414626    .1596781
         33  |   .1066576   .0316644     3.37   0.001     .0445802     .168735
         34  |   .0948952   .0338087     2.81   0.005      .028614    .1611764
         35  |   .0955103   .0359148     2.66   0.008     .0251002    .1659204
         36  |   .0904091   .0383263     2.36   0.018     .0152713    .1655468
         37  |   .0979026   .0407522     2.40   0.016     .0180088    .1777964
         38  |   .1104452   .0432743     2.55   0.011     .0256069    .1952834
         39  |    .117936   .0458757     2.57   0.010     .0279979    .2078742
         40  |    .104463   .0485884     2.15   0.032     .0092066    .1997194
         41  |   .1154805   .0514362     2.25   0.025     .0146409      .21632
         42  |   .1206812   .0543149     2.22   0.026      .014198    .2271643
         43  |   .1279305   .0574572     2.23   0.026      .015287    .2405739
         44  |   .1267943   .0605419     2.09   0.036     .0081033    .2454853
         45  |    .135407   .0631321     2.14   0.032      .011638     .259176
         46  |    .148517   .0658953     2.25   0.024     .0193308    .2777031
         47  |   .1502421   .0685255     2.19   0.028     .0158995    .2845847
         48  |   .1436001   .0708622     2.03   0.043     .0046763    .2825239
         49  |   .0273389    .073456     0.37   0.710    -.1166699    .1713478
         50  |   .0002354   .0760032     0.00   0.998    -.1487672     .149238
             |
     age_cat |
          1  |   .0764771   .0109225     7.00   0.000     .0550638    .0978904
          2  |   .1118439   .0126493     8.84   0.000     .0870452    .1366426
          3  |   .1410232    .014715     9.58   0.000     .1121749    .1698715
          4  |   .1649837   .0172138     9.58   0.000     .1312365     .198731
          5  |   .1719417   .0197133     8.72   0.000     .1332942    .2105891
          6  |   .1732208   .0223994     7.73   0.000     .1293073    .2171342
          7  |   .1833879   .0250959     7.31   0.000      .134188    .2325879
          8  |   .1831011   .0279285     6.56   0.000      .128348    .2378543
          9  |   .1887791   .0308078     6.13   0.000     .1283811    .2491771
         10  |   .1902453   .0338264     5.62   0.000     .1239293    .2565613
         11  |   .1900272   .0367254     5.17   0.000     .1180279    .2620265
         12  |   .1875558   .0397139     4.72   0.000     .1096978    .2654139
         13  |   .1794056   .0426885     4.20   0.000     .0957158    .2630955
         14  |   .1912009   .0458058     4.17   0.000     .1013998     .281002
         15  |   .1957732   .0487903     4.01   0.000     .1001209    .2914254
         16  |   .2041462   .0518811     3.93   0.000     .1024346    .3058579
         17  |   .2011836   .0550762     3.65   0.000     .0932079    .3091592
         18  |   .1881911   .0582066     3.23   0.001     .0740785    .3023038
         19  |   .1876427   .0614586     3.05   0.002     .0671545     .308131
         20  |   .1686643   .0685381     2.46   0.014     .0342969    .3030317
         25  |   .1851923   .0797715     2.32   0.020     .0288021    .3415826
         30  |   .1747814   .1143595     1.53   0.126    -.0494177    .3989805
         40  |   .2098743    .141375     1.48   0.138    -.0672881    .4870367
         50  |   .1850886   .1650096     1.12   0.262     -.138409    .5085862
             |
       _cons |   .4593655   .0221821    20.71   0.000      .415878     .502853
-------------+----------------------------------------------------------------
     sigma_u |  .33935673
     sigma_e |  .29305559
         rho |  .57282318   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0352232597325326

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    350,775
Group variable: firm_person                     Number of groups  =     20,446

R-sq:                                           Obs per group:
     within  = 0.0352                                         min =          1
     between = 0.1698                                         avg =       17.2
     overall = 0.0816                                         max =         25

                                                F(78,4628)        =      10.89
corr(u_i, Xb)  = 0.1756                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,629 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0281768   .0107243     2.63   0.009      .007152    .0492015
      during |  -.0223473    .005598    -3.99   0.000    -.0333221   -.0113726
       after |  -.0393863   .0085833    -4.59   0.000    -.0562136   -.0225589
during_expat |   .0126502   .0074633     1.69   0.090    -.0019815    .0272818
 after_expat |   .0138436   .0101925     1.36   0.174    -.0061386    .0338258
             |
    ind_year |
          2  |   .0071247   .0159973     0.45   0.656    -.0242377    .0384871
          3  |    -.02938   .0181804    -1.62   0.106    -.0650224    .0062623
          4  |  -.0472454   .0203573    -2.32   0.020    -.0871553   -.0073354
          5  |  -.0287561   .0221122    -1.30   0.194    -.0721066    .0145944
          6  |   -.045796   .0242552    -1.89   0.059    -.0933478    .0017559
          7  |  -.0326444   .0262667    -1.24   0.214    -.0841397    .0188509
          8  |  -.0428897   .0288187    -1.49   0.137    -.0993881    .0136086
          9  |  -.0468716   .0312591    -1.50   0.134    -.1081543    .0144112
         10  |  -.0359077   .0338707    -1.06   0.289    -.1023104    .0304951
         11  |  -.0439125   .0366802    -1.20   0.231    -.1158232    .0279983
         12  |  -.0370531   .0391483    -0.95   0.344    -.1138023    .0396962
         13  |  -.0239883   .0417595    -0.57   0.566    -.1058569    .0578803
         14  |   .0010071   .0444958     0.02   0.982    -.0862258    .0882401
         15  |   .0153646   .0471415     0.33   0.744    -.0770552    .1077844
         16  |   .0284679   .0503285     0.57   0.572    -.0702001    .1271358
         17  |   .0394909   .0533544     0.74   0.459    -.0651092     .144091
         18  |   .0485816   .0566328     0.86   0.391    -.0624458    .1596089
         19  |   .0512425   .0597666     0.86   0.391    -.0659287    .1684136
         20  |   .0780346   .0625599     1.25   0.212    -.0446125    .2006817
         21  |   .0880967   .0650557     1.35   0.176    -.0394436    .2156369
         22  |   .1028001   .0678714     1.51   0.130    -.0302603    .2358604
         23  |   .0906451   .0701694     1.29   0.196    -.0469203    .2282105
         24  |   .0440904   .0729327     0.60   0.546    -.0988925    .1870732
         25  |   .0167857   .0754525     0.22   0.824    -.1311371    .1647086
         26  |   .1299945   .0266193     4.88   0.000     .0778079     .182181
         27  |   .1061151   .0257088     4.13   0.000     .0557136    .1565165
         28  |   .1184784   .0254801     4.65   0.000     .0685253    .1684315
         29  |   .1142574    .026062     4.38   0.000     .0631634    .1653514
         30  |   .1185417    .026917     4.40   0.000     .0657716    .1713119
         31  |   .1144135   .0282577     4.05   0.000      .059015     .169812
         32  |   .1005704   .0301497     3.34   0.001     .0414626    .1596781
         33  |   .1066576   .0316644     3.37   0.001     .0445802     .168735
         34  |   .0948952   .0338087     2.81   0.005      .028614    .1611764
         35  |   .0955103   .0359148     2.66   0.008     .0251002    .1659204
         36  |   .0904091   .0383263     2.36   0.018     .0152713    .1655468
         37  |   .0979026   .0407522     2.40   0.016     .0180088    .1777964
         38  |   .1104452   .0432743     2.55   0.011     .0256069    .1952834
         39  |    .117936   .0458757     2.57   0.010     .0279979    .2078742
         40  |    .104463   .0485884     2.15   0.032     .0092066    .1997194
         41  |   .1154805   .0514362     2.25   0.025     .0146409      .21632
         42  |   .1206812   .0543149     2.22   0.026      .014198    .2271643
         43  |   .1279305   .0574572     2.23   0.026      .015287    .2405739
         44  |   .1267943   .0605419     2.09   0.036     .0081033    .2454853
         45  |    .135407   .0631321     2.14   0.032      .011638     .259176
         46  |    .148517   .0658953     2.25   0.024     .0193308    .2777031
         47  |   .1502421   .0685255     2.19   0.028     .0158995    .2845847
         48  |   .1436001   .0708622     2.03   0.043     .0046763    .2825239
         49  |   .0273389    .073456     0.37   0.710    -.1166699    .1713478
         50  |   .0002354   .0760032     0.00   0.998    -.1487672     .149238
             |
     age_cat |
          1  |   .0764771   .0109225     7.00   0.000     .0550638    .0978904
          2  |   .1118439   .0126493     8.84   0.000     .0870452    .1366426
          3  |   .1410232    .014715     9.58   0.000     .1121749    .1698715
          4  |   .1649837   .0172138     9.58   0.000     .1312365     .198731
          5  |   .1719417   .0197133     8.72   0.000     .1332942    .2105891
          6  |   .1732208   .0223994     7.73   0.000     .1293073    .2171342
          7  |   .1833879   .0250959     7.31   0.000      .134188    .2325879
          8  |   .1831011   .0279285     6.56   0.000      .128348    .2378543
          9  |   .1887791   .0308078     6.13   0.000     .1283811    .2491771
         10  |   .1902453   .0338264     5.62   0.000     .1239293    .2565613
         11  |   .1900272   .0367254     5.17   0.000     .1180279    .2620265
         12  |   .1875558   .0397139     4.72   0.000     .1096978    .2654139
         13  |   .1794056   .0426885     4.20   0.000     .0957158    .2630955
         14  |   .1912009   .0458058     4.17   0.000     .1013998     .281002
         15  |   .1957732   .0487903     4.01   0.000     .1001209    .2914254
         16  |   .2041462   .0518811     3.93   0.000     .1024346    .3058579
         17  |   .2011836   .0550762     3.65   0.000     .0932079    .3091592
         18  |   .1881911   .0582066     3.23   0.001     .0740785    .3023038
         19  |   .1876427   .0614586     3.05   0.002     .0671545     .308131
         20  |   .1686643   .0685381     2.46   0.014     .0342969    .3030317
         25  |   .1851923   .0797715     2.32   0.020     .0288021    .3415826
         30  |   .1747814   .1143595     1.53   0.126    -.0494177    .3989805
         40  |   .2098743    .141375     1.48   0.138    -.0672881    .4870367
         50  |   .1850886   .1650096     1.12   0.262     -.138409    .5085862
             |
       _cons |   .4593655   .0221821    20.71   0.000      .415878     .502853
-------------+----------------------------------------------------------------
     sigma_u |  .33935673
     sigma_e |  .29305559
         rho |  .57282318   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    293327
Group variable: firm_person                     Number of groups   =     20083

R-sq:  within  = 0.0413                         Obs per group: min =         1
       between = 0.0002                                        avg =      14.6
       overall = 0.0279                                        max =        24

                                                F(75,4448)         =     35.91
corr(u_i, Xb)  = -0.1854                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,449 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0106118   .0205892     0.52   0.606    -.0297533    .0509769
      during |  -.0307393   .0117364    -2.62   0.009    -.0537484   -.0077302
       after |   -.049757   .0156409    -3.18   0.001    -.0804209   -.0190931
during_expat |   -.005435   .0154743    -0.35   0.725    -.0357723    .0249023
 after_expat |   .0184456   .0175263     1.05   0.293    -.0159146    .0528058
             |
    ind_year |
          3  |  -.1113791   .0486275    -2.29   0.022    -.2067132    -.016045
          4  |    .002979   .0478397     0.06   0.950    -.0908105    .0967686
          5  |  -.0519546   .0491854    -1.06   0.291    -.1483824    .0444732
          6  |  -.1288191   .0523241    -2.46   0.014    -.2314004   -.0262377
          7  |  -.0104514   .0530722    -0.20   0.844    -.1144993    .0935964
          8  |  -.1261784   .0566509    -2.23   0.026    -.2372424   -.0151144
          9  |  -.1306357    .060196    -2.17   0.030    -.2486498   -.0126217
         10  |  -.1687921   .0615319    -2.74   0.006    -.2894253    -.048159
         11  |  -.1989203   .0657889    -3.02   0.003    -.3278993   -.0699412
         12  |  -.2067462   .0700065    -2.95   0.003    -.3439937   -.0694987
         13  |  -.2552748   .0722605    -3.53   0.000    -.3969414   -.1136083
         14  |  -.3612021   .0762157    -4.74   0.000    -.5106229   -.2117814
         15  |  -.2444604   .0807212    -3.03   0.002     -.402714   -.0862068
         16  |  -.2558421   .0848879    -3.01   0.003    -.4222645   -.0894197
         17  |  -.3100014   .0893103    -3.47   0.001    -.4850941   -.1349087
         18  |  -.3207787   .0931293    -3.44   0.001    -.5033585   -.1381989
         19  |  -.3345931   .0984204    -3.40   0.001     -.527546   -.1416402
         20  |  -.2594673   .1027685    -2.52   0.012    -.4609448   -.0579899
         21  |  -.3873486   .1066685    -3.63   0.000    -.5964719   -.1782252
         22  |  -.1265344   .1094108    -1.16   0.248    -.3410341    .0879652
         23  |  -.4806815   .1135902    -4.23   0.000    -.7033747   -.2579883
         24  |  -.6653758   .1202582    -5.53   0.000    -.9011417   -.4296099
         25  |  -.4571048   .1272681    -3.59   0.000    -.7066136   -.2075961
         27  |  -.0767742   .0620544    -1.24   0.216    -.1984316    .0448833
         28  |  -.3964659   .0581614    -6.82   0.000    -.5104912   -.2824406
         29  |  -.1668335   .0575668    -2.90   0.004    -.2796931   -.0539739
         30  |  -.2789199   .0578681    -4.82   0.000    -.3923702   -.1654697
         31  |  -.1958727   .0590655    -3.32   0.001    -.3116704   -.0800749
         32  |  -.3136732   .0609964    -5.14   0.000    -.4332565   -.1940899
         33  |  -.1768802   .0618864    -2.86   0.004    -.2982084    -.055552
         34  |  -.3012891   .0646258    -4.66   0.000    -.4279879   -.1745903
         35  |  -.2956415   .0675322    -4.38   0.000    -.4280382   -.1632449
         36  |  -.3591417   .0705759    -5.09   0.000    -.4975057   -.2207778
         37  |  -.3717937   .0744248    -5.00   0.000    -.5177034   -.2258841
         38  |   -.342842     .07753    -4.42   0.000    -.4948394   -.1908446
         39  |   -.436087   .0807231    -5.40   0.000    -.5943445   -.2778296
         40  |  -.3300195   .0845101    -3.91   0.000    -.4957013   -.1643376
         41  |  -.3953858   .0892424    -4.43   0.000    -.5703453   -.2204263
         42  |  -.4017049   .0935436    -4.29   0.000    -.5850968   -.2183129
         43  |  -.2830063   .0969767    -2.92   0.004    -.4731288   -.0928837
         44  |  -.3162586   .1024409    -3.09   0.002    -.5170937   -.1154235
         45  |  -.5119526   .1065921    -4.80   0.000    -.7209262   -.3029789
         46  |  -.3728989   .1105745    -3.37   0.001    -.5896799   -.1561179
         47  |  -.1803968   .1138599    -1.58   0.113    -.4036189    .0428254
         48  |  -.5594956    .117732    -4.75   0.000    -.7903089   -.3286822
         49  |   -1.05062   .1202364    -8.74   0.000    -1.286343   -.8148966
         50  |  -.4775664   .1290591    -3.70   0.000    -.7305865   -.2245464
             |
     age_cat |
          2  |   -.135636    .031877    -4.25   0.000    -.1981308   -.0731411
          3  |   -.288377   .0327613    -8.80   0.000    -.3526054   -.2241486
          4  |  -.3351505   .0344906    -9.72   0.000    -.4027692   -.2675318
          5  |  -.3701011   .0378509    -9.78   0.000    -.4443077   -.2958945
          6  |  -.3748177   .0410636    -9.13   0.000    -.4553227   -.2943126
          7  |  -.4032426   .0441925    -9.12   0.000    -.4898818   -.3166034
          8  |  -.3906122   .0479913    -8.14   0.000     -.484699   -.2965253
          9  |  -.4093833     .05215    -7.85   0.000    -.5116233   -.3071433
         10  |  -.4139373   .0565319    -7.32   0.000    -.5247679   -.3031067
         11  |  -.3830975   .0608788    -6.29   0.000    -.5024503   -.2637448
         12  |  -.3525609    .065209    -5.41   0.000     -.480403   -.2247189
         13  |    -.37524   .0699499    -5.36   0.000    -.5123765   -.2381035
         14  |  -.3667347   .0746019    -4.92   0.000    -.5129915   -.2204779
         15  |  -.3959763   .0790486    -5.01   0.000    -.5509509   -.2410017
         16  |  -.3375544    .083734    -4.03   0.000    -.5017146   -.1733942
         17  |  -.3237554   .0885609    -3.66   0.000    -.4973789    -.150132
         18  |  -.3674921   .0940375    -3.91   0.000    -.5518524   -.1831318
         19  |  -.2994611    .099783    -3.00   0.003    -.4950854   -.1038367
         20  |   -.290925   .1094155    -2.66   0.008    -.5054338   -.0764162
         25  |  -.2871774    .130168    -2.21   0.027    -.5423715   -.0319832
         30  |   -.127398   .1837634    -0.69   0.488    -.4876656    .2328696
         40  |  -.1478286    .234903    -0.63   0.529    -.6083553    .3126982
         50  |   .0590873   .2901343     0.20   0.839    -.5097203    .6278949
             |
       _cons |   .5116037   .0519149     9.85   0.000     .4098246    .6133828
-------------+----------------------------------------------------------------
     sigma_u |  .33015699
     sigma_e |  .85729032
         rho |  .12915883   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0412998332834873

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    293,327
Group variable: firm_person                     Number of groups  =     20,083

R-sq:                                           Obs per group:
     within  = 0.0413                                         min =          1
     between = 0.0002                                         avg =       14.6
     overall = 0.0279                                         max =         24

                                                F(75,4448)        =      35.91
corr(u_i, Xb)  = -0.1854                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,449 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0106118   .0205892     0.52   0.606    -.0297533    .0509769
      during |  -.0307393   .0117364    -2.62   0.009    -.0537484   -.0077302
       after |   -.049757   .0156409    -3.18   0.001    -.0804209   -.0190931
during_expat |   -.005435   .0154743    -0.35   0.725    -.0357723    .0249023
 after_expat |   .0184456   .0175263     1.05   0.293    -.0159146    .0528058
             |
    ind_year |
          3  |  -.1113791   .0486275    -2.29   0.022    -.2067132    -.016045
          4  |    .002979   .0478397     0.06   0.950    -.0908105    .0967686
          5  |  -.0519546   .0491854    -1.06   0.291    -.1483824    .0444732
          6  |  -.1288191   .0523241    -2.46   0.014    -.2314004   -.0262377
          7  |  -.0104514   .0530722    -0.20   0.844    -.1144993    .0935964
          8  |  -.1261784   .0566509    -2.23   0.026    -.2372424   -.0151144
          9  |  -.1306357    .060196    -2.17   0.030    -.2486498   -.0126217
         10  |  -.1687921   .0615319    -2.74   0.006    -.2894253    -.048159
         11  |  -.1989203   .0657889    -3.02   0.003    -.3278993   -.0699412
         12  |  -.2067462   .0700065    -2.95   0.003    -.3439937   -.0694987
         13  |  -.2552748   .0722605    -3.53   0.000    -.3969414   -.1136083
         14  |  -.3612021   .0762157    -4.74   0.000    -.5106229   -.2117814
         15  |  -.2444604   .0807212    -3.03   0.002     -.402714   -.0862068
         16  |  -.2558421   .0848879    -3.01   0.003    -.4222645   -.0894197
         17  |  -.3100014   .0893103    -3.47   0.001    -.4850941   -.1349087
         18  |  -.3207787   .0931293    -3.44   0.001    -.5033585   -.1381989
         19  |  -.3345931   .0984204    -3.40   0.001     -.527546   -.1416402
         20  |  -.2594673   .1027685    -2.52   0.012    -.4609448   -.0579899
         21  |  -.3873486   .1066685    -3.63   0.000    -.5964719   -.1782252
         22  |  -.1265344   .1094108    -1.16   0.248    -.3410341    .0879652
         23  |  -.4806815   .1135902    -4.23   0.000    -.7033747   -.2579883
         24  |  -.6653758   .1202582    -5.53   0.000    -.9011417   -.4296099
         25  |  -.4571048   .1272681    -3.59   0.000    -.7066136   -.2075961
         27  |  -.0767742   .0620544    -1.24   0.216    -.1984316    .0448833
         28  |  -.3964659   .0581614    -6.82   0.000    -.5104912   -.2824406
         29  |  -.1668335   .0575668    -2.90   0.004    -.2796931   -.0539739
         30  |  -.2789199   .0578681    -4.82   0.000    -.3923702   -.1654697
         31  |  -.1958727   .0590655    -3.32   0.001    -.3116704   -.0800749
         32  |  -.3136732   .0609964    -5.14   0.000    -.4332565   -.1940899
         33  |  -.1768802   .0618864    -2.86   0.004    -.2982084    -.055552
         34  |  -.3012891   .0646258    -4.66   0.000    -.4279879   -.1745903
         35  |  -.2956415   .0675322    -4.38   0.000    -.4280382   -.1632449
         36  |  -.3591417   .0705759    -5.09   0.000    -.4975057   -.2207778
         37  |  -.3717937   .0744248    -5.00   0.000    -.5177034   -.2258841
         38  |   -.342842     .07753    -4.42   0.000    -.4948394   -.1908446
         39  |   -.436087   .0807231    -5.40   0.000    -.5943445   -.2778296
         40  |  -.3300195   .0845101    -3.91   0.000    -.4957013   -.1643376
         41  |  -.3953858   .0892424    -4.43   0.000    -.5703453   -.2204263
         42  |  -.4017049   .0935436    -4.29   0.000    -.5850968   -.2183129
         43  |  -.2830063   .0969767    -2.92   0.004    -.4731288   -.0928837
         44  |  -.3162586   .1024409    -3.09   0.002    -.5170937   -.1154235
         45  |  -.5119526   .1065921    -4.80   0.000    -.7209262   -.3029789
         46  |  -.3728989   .1105745    -3.37   0.001    -.5896799   -.1561179
         47  |  -.1803968   .1138599    -1.58   0.113    -.4036189    .0428254
         48  |  -.5594956    .117732    -4.75   0.000    -.7903089   -.3286822
         49  |   -1.05062   .1202364    -8.74   0.000    -1.286343   -.8148966
         50  |  -.4775664   .1290591    -3.70   0.000    -.7305865   -.2245464
             |
     age_cat |
          2  |   -.135636    .031877    -4.25   0.000    -.1981308   -.0731411
          3  |   -.288377   .0327613    -8.80   0.000    -.3526054   -.2241486
          4  |  -.3351505   .0344906    -9.72   0.000    -.4027692   -.2675318
          5  |  -.3701011   .0378509    -9.78   0.000    -.4443077   -.2958945
          6  |  -.3748177   .0410636    -9.13   0.000    -.4553227   -.2943126
          7  |  -.4032426   .0441925    -9.12   0.000    -.4898818   -.3166034
          8  |  -.3906122   .0479913    -8.14   0.000     -.484699   -.2965253
          9  |  -.4093833     .05215    -7.85   0.000    -.5116233   -.3071433
         10  |  -.4139373   .0565319    -7.32   0.000    -.5247679   -.3031067
         11  |  -.3830975   .0608788    -6.29   0.000    -.5024503   -.2637448
         12  |  -.3525609    .065209    -5.41   0.000     -.480403   -.2247189
         13  |    -.37524   .0699499    -5.36   0.000    -.5123765   -.2381035
         14  |  -.3667347   .0746019    -4.92   0.000    -.5129915   -.2204779
         15  |  -.3959763   .0790486    -5.01   0.000    -.5509509   -.2410017
         16  |  -.3375544    .083734    -4.03   0.000    -.5017146   -.1733942
         17  |  -.3237554   .0885609    -3.66   0.000    -.4973789    -.150132
         18  |  -.3674921   .0940375    -3.91   0.000    -.5518524   -.1831318
         19  |  -.2994611    .099783    -3.00   0.003    -.4950854   -.1038367
         20  |   -.290925   .1094155    -2.66   0.008    -.5054338   -.0764162
         25  |  -.2871774    .130168    -2.21   0.027    -.5423715   -.0319832
         30  |   -.127398   .1837634    -0.69   0.488    -.4876656    .2328696
         40  |  -.1478286    .234903    -0.63   0.529    -.6083553    .3126982
         50  |   .0590873   .2901343     0.20   0.839    -.5097203    .6278949
             |
       _cons |   .5116037   .0519149     9.85   0.000     .4098246    .6133828
-------------+----------------------------------------------------------------
     sigma_u |  .33015699
     sigma_e |  .85729032
         rho |  .12915883   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
. *Szelekció az akvicíziós mintában
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. areg f1.expat lnL lnQ lnK exporter if ever_foreign==1&greenfield!=1, a(industry_year) cluster(frame_id)

Linear regression, absorbing indicators         Number of obs     =    107,455
Absorbed variable: industry_year                No. of categories =      1,653
                                                F(   4,   1352)   =       4.68
                                                Prob > F          =     0.0009
                                                R-squared         =     0.0762
                                                Adj R-squared     =     0.0617
                                                Root MSE          =     0.4528

                           (Std. Err. adjusted for 1,353 clusters in frame_id)
------------------------------------------------------------------------------
             |               Robust
     F.expat |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         lnL |  -.0238634   .0109652    -2.18   0.030    -.0453739   -.0023528
         lnQ |   .0230453   .0092428     2.49   0.013     .0049134    .0411771
         lnK |   .0023352   .0071066     0.33   0.743    -.0116059    .0162762
    exporter |   .0435343   .0187465     2.32   0.020      .006759    .0803095
       _cons |   .0464254   .0821814     0.56   0.572    -.1147916    .2076423
------------------------------------------------------------------------------

. do regram output/regression/selection 1 1

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Linear regression, absorbing indicators         Number of obs     =    107,455
Absorbed variable: industry_year                No. of categories =      1,653
                                                F(   4,   1352)   =       4.68
                                                Prob > F          =     0.0009
                                                R-squared         =     0.0762
                                                Adj R-squared     =     0.0617
                                                Root MSE          =     0.4528

                           (Std. Err. adjusted for 1,353 clusters in frame_id)
------------------------------------------------------------------------------
             |               Robust
     F.expat |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         lnL |  -.0238634   .0109652    -2.18   0.030    -.0453739   -.0023528
         lnQ |   .0230453   .0092428     2.49   0.013     .0049134    .0411771
         lnK |   .0023352   .0071066     0.33   0.743    -.0116059    .0162762
    exporter |   .0435343   .0187465     2.32   0.020      .006759    .0803095
       _cons |   .0464254   .0821814     0.56   0.572    -.1147916    .2076423
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
. keep if ever_foreign==1
(337,379 observations deleted)

. *Dinamika
. scalar Tbefore = 4

. scalar Tafter = 6

. 
. local N = Tbefore+Tafter+1

. 
. do event_study

. local T1 = Tbefore 

. local T2 = Tafter

. 
. foreach X in expat domestic {
  2.         gen byte `X'_p_0 = tenure==0 & (`X'==1)
  3.         forval t=1/`T1' {
  4.                 gen byte `X'_m_`t' = tenure== -`t' & (`X'==1)
  5.         }
  6.         forval t=1/`T2' {
  7.                 gen byte `X'_p_`t' = tenure== `t' & (`X'==1)
  8.         }
  9.         replace `X'_p_`T2' = tenure>= `T2' & (`X'==1)
 10. }
(34,755 real changes made)
(30,298 real changes made)

. local X foreign

. gen byte `X'_p_0 = tenure_`X'==0

. forval t=1/`T1' {
  2.         gen byte `X'_m_`t' = tenure_`X'== -`t'
  3. }

. forval t=1/`T2' {
  2.         gen byte `X'_p_`t' = tenure_`X'== `t'
  3. }

. replace `X'_p_`T2' = tenure_`X'>= `T2' 
(177,405 real changes made)

. sort frame_id year

. 
. * illustrate window overlap and recoding
. l manager_id expat year tenure* if frame_id=="ft10072219"

        +--------------------------------------------------------------------------+
        |      manager_id   expat   year   tenure~n   tenure   tenure~c   tenure~t |
        |--------------------------------------------------------------------------|
  4450. |         PP45376       0   1992        -19      -21        -21          0 |
  4451. |         PP18562       0   1992        -19      -21        -21          0 |
  4452. | PP177715_998327       0   1992        -19      -20        -20          0 |
  4453. |         PP18562       0   1993        -18      -20        -20          0 |
  4454. | PP177715_998327       0   1993        -18      -19        -19          0 |
        |--------------------------------------------------------------------------|
  4455. |         PP45376       0   1993        -18      -20        -20          0 |
  4456. |         PP18562       0   1994        -17      -19        -19          0 |
  4457. |         PP45376       0   1994        -17      -19        -19          0 |
  4458. | PP177715_998327       0   1994        -17      -18        -18          0 |
  4459. |         PP18562       0   1995        -16      -18        -18          0 |
        |--------------------------------------------------------------------------|
  4460. | PP177715_998327       0   1995        -16      -17        -17          0 |
  4461. |         PP45376       0   1995        -16      -18        -18          0 |
  4462. |         PP45376       0   1996        -15      -17        -17          0 |
  4463. | PP177715_998327       0   1996        -15      -16        -16          0 |
  4464. |         PP18562       0   1996        -15      -17        -17          0 |
        |--------------------------------------------------------------------------|
  4465. |         PP45376       0   1997        -14      -16        -16          0 |
  4466. | PP177715_998327       0   1997        -14      -15        -15          0 |
  4467. |         PP18562       0   1997        -14      -16        -16          0 |
  4468. |         PP18562       0   1998        -13      -15        -15          0 |
  4469. | PP177715_998327       0   1998        -13      -14        -14          0 |
        |--------------------------------------------------------------------------|
  4470. |         PP45376       0   1998        -13      -15        -15          0 |
  4471. |         PP45376       0   1999        -12      -14        -14          0 |
  4472. | PP177715_998327       0   1999        -12      -13        -13          0 |
  4473. |         PP18562       0   1999        -12      -14        -14          0 |
  4474. | PP177715_998327       0   2000        -11      -12        -12          0 |
        |--------------------------------------------------------------------------|
  4475. |         PP18562       0   2000        -11      -13        -13          0 |
  4476. |         PP45376       0   2000        -11      -13        -13          0 |
  4477. | PP177715_998327       0   2001        -10      -11        -11          0 |
  4478. |         PP45376       0   2001        -10      -12        -12          0 |
  4479. |         PP18562       0   2001        -10      -12        -12          0 |
        |--------------------------------------------------------------------------|
  4480. |         PP45376       0   2002         -9      -11        -11          0 |
  4481. |         PP18562       0   2002         -9      -11        -11          0 |
  4482. | PP177715_998327       0   2002         -9      -10        -10          0 |
  4483. |         PP18562       0   2003         -8      -10        -10          0 |
  4484. |         PP45376       0   2003         -8      -10        -10          0 |
        |--------------------------------------------------------------------------|
  4485. | PP177715_998327       0   2003         -8       -9         -9          0 |
  4486. | PP177715_998327       0   2004         -7       -8         -8          0 |
  4487. |         PP18562       0   2004         -7       -9         -9          0 |
  4488. |         PP45376       0   2004         -7       -9         -9          0 |
  4489. |         PP18562       0   2005         -6       -8         -8          0 |
        |--------------------------------------------------------------------------|
  4490. |         PP45376       0   2005         -6       -8         -8          0 |
  4491. | PP177715_998327       0   2005         -6       -7         -7          0 |
  4492. | PP177715_998327       0   2006         -5       -6         -6          0 |
  4493. |         PP18562       0   2006         -5       -7         -7          0 |
  4494. |         PP45376       0   2006         -5       -7         -7          0 |
        |--------------------------------------------------------------------------|
  4495. | PP177715_998327       0   2007         -4       -5         -5          0 |
  4496. |         PP18562       0   2007         -4       -6         -6          0 |
  4497. |         PP45376       0   2007         -4       -6         -6          0 |
  4498. | PP177715_998327       0   2008         -3       -4         -4          0 |
  4499. |         PP18562       0   2008         -3       -5         -5          0 |
        |--------------------------------------------------------------------------|
  4500. |         PP45376       0   2008         -3       -5         -5          0 |
  4501. | PP177715_998327       0   2009         -2       -3         -3          0 |
  4502. |         PP45376       0   2009         -2       -4         -4          0 |
  4503. |         PP18562       0   2009         -2       -4         -4          0 |
  4504. | PP177715_998327       0   2010         -1       -2         -2          0 |
        |--------------------------------------------------------------------------|
  4505. |         PP18562       0   2010         -1       -3         -3          0 |
  4506. |         PP45376       0   2010         -1       -3         -3          0 |
  4507. | PP177715_998327       0   2011          0       -1         -1          0 |
  4508. |         PP18562       0   2011          0       -2         -2          0 |
  4509. |         PP45376       0   2011          0       -2         -2          0 |
        |--------------------------------------------------------------------------|
  4510. | PP177715_998327       0   2012          1        0          0          0 |
  4511. |         PP45376       0   2012          1       -1         -1          0 |
  4512. |         PP18562       0   2012          1       -1         -1          0 |
  4513. | PP177715_998327       0   2013          2        1          1          0 |
  4514. |         PP45376       0   2013          2        0          0          0 |
        |--------------------------------------------------------------------------|
  4515. |         PP18562       0   2013          2        0          0          0 |
  4516. | PP177715_998327       0   2014          3        2          2          0 |
  4517. |         PP18562       0   2014          3        1          1          0 |
  4518. |         PP45376       0   2014          3        1          1          0 |
  4519. |         PP18562       0   2015          4        2          2          0 |
        |--------------------------------------------------------------------------|
  4520. |         PP45376       0   2015          4        2          2          0 |
  4521. | PP177715_998327       0   2015          4        3          3          0 |
  4522. |         PP45376       0   2016          5        3          3          0 |
  4523. |         PP18562       0   2016          5        3          3          0 |
  4524. | PP177715_998327       0   2016          5        4          4          0 |
        +--------------------------------------------------------------------------+

. 
end of do-file

. 
. local Tbefore = Tbefore

. local Tafter = Tafter

. 
. foreach Y of var `scale' `intensity' {
  2.         * with firm FE, controls are years more than Tbefore before any event happens
.         xtreg `Y' *_m_* *_p_* i.ind_year i.age_cat if expat!=. & ever_foreign==1 & after==0 [aw=inverse_weight], i(firm_person
> ) fe vce(cluster id)
  3.         preserve
  4.         clear
  5.         set obs `N'
  6.         gen t = _n-1-`Tbefore'
  7.         label var t "Time since event (year)"
  8. 
.         foreach X in foreign expat domestic {
  9.                 gen `X'_beta=.
 10.                 gen `X'_lower=.
 11.                 gen `X'_upper=.
 12.                 forval t=-`Tbefore'/`Tafter' {
 13.                         local tag "`t'"
 14.                         if (`t'<0) {
 15.                                 local tag = -`t'
 16.                                 local tag  _m_`tag'
 17.                         }
 18.                         else {
 19.                                 local tag  _p_`t'
 20.                         }
 21.                         replace `X'_beta = _b[`X'`tag'] if t==`t'
 22.                         replace `X'_lower = `X'_beta-1.69*_se[`X'`tag'] if t==`t'
 23.                         replace `X'_upper = `X'_beta+1.69*_se[`X'`tag'] if t==`t'
 24.                 }
 25.                 label var `X'_beta "`Y'"
 26.                 label var `X'_upper "90% CI"
 27.                 label var `X'_lower "90% CI"
 28. 
.         }
 29.         label var foreign_beta "Foreign owner"
 30.         label var expat_beta "New expat manager"
 31.         label var domestic_beta "New domestic manager"
 32.         * omit last event year from graph, which is winsorized
.         tw (line expat_beta domestic_beta t if t>=-Tbefore & t<Tafter, sort), scheme(538w) title(`Y') aspect(0.67)
 33.         graph export output/figure/`Y'_event_study.png, replace width(800)
 34.         
.         restore
 35. 
. }

Fixed-effects (within) regression               Number of obs      =    241615
Group variable: firm_person                     Number of groups   =     20311

R-sq:  within  = 0.2000                         Obs per group: min =         1
       between = 0.1031                                        avg =      11.9
       overall = 0.1109                                        max =        25

                                                F(106,4618)        =     31.53
corr(u_i, Xb)  = -0.0124                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,619 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0511155   .0271052    -1.89   0.059    -.1042546    .0020236
   expat_m_2 |  -.0181101   .0234658    -0.77   0.440    -.0641143    .0278942
   expat_m_3 |  -.0049614   .0206631    -0.24   0.810    -.0454709    .0355481
   expat_m_4 |   .0052088    .017221     0.30   0.762    -.0285525    .0389701
domestic_m_1 |  -.1804831   .0260455    -6.93   0.000    -.2315447   -.1294214
domestic_m_2 |    -.12902   .0234622    -5.50   0.000    -.1750171   -.0830228
domestic_m_3 |  -.0869765   .0195793    -4.44   0.000    -.1253612   -.0485918
domestic_m_4 |   -.041612   .0162482    -2.56   0.010    -.0734662   -.0097578
 foreign_m_1 |  -.2485517   .0572451    -4.34   0.000    -.3607794   -.1363239
 foreign_m_2 |    -.22657   .0532593    -4.25   0.000    -.3309837   -.1221563
 foreign_m_3 |  -.1975129   .0483336    -4.09   0.000    -.2922698    -.102756
 foreign_m_4 |  -.1831336   .0418804    -4.37   0.000    -.2652391    -.101028
   expat_p_0 |  -.1078464   .0310838    -3.47   0.001    -.1687856   -.0469073
   expat_p_1 |  -.1538731   .0349676    -4.40   0.000    -.2224264   -.0853198
   expat_p_2 |  -.1717117   .0392209    -4.38   0.000    -.2486034   -.0948199
   expat_p_3 |  -.1875281   .0440683    -4.26   0.000    -.2739231   -.1011331
   expat_p_4 |  -.1812641   .0486897    -3.72   0.000    -.2767191   -.0858091
   expat_p_5 |  -.2217748    .055574    -3.99   0.000    -.3307263   -.1128232
   expat_p_6 |  -.3468486   .0699828    -4.96   0.000    -.4840484   -.2096488
domestic_p_0 |  -.2463883   .0293789    -8.39   0.000    -.3039851   -.1887916
domestic_p_1 |   -.275927   .0341256    -8.09   0.000    -.3428296   -.2090245
domestic_p_2 |  -.2863799   .0387648    -7.39   0.000    -.3623774   -.2103823
domestic_p_3 |  -.3043513   .0435818    -6.98   0.000    -.3897925   -.2189101
domestic_p_4 |  -.3218937   .0483336    -6.66   0.000    -.4166506   -.2271367
domestic_p_5 |  -.3292134    .053971    -6.10   0.000    -.4350223   -.2234044
domestic_p_6 |  -.3238707    .064292    -5.04   0.000    -.4499137   -.1978276
 foreign_p_0 |  -.5087611   .0633817    -8.03   0.000    -.6330196   -.3845026
 foreign_p_1 |  -.2869303   .0674293    -4.26   0.000    -.4191239   -.1547367
 foreign_p_2 |  -.2802727   .0714178    -3.92   0.000    -.4202856   -.1402597
 foreign_p_3 |  -.2885878   .0760425    -3.80   0.000    -.4376674   -.1395082
 foreign_p_4 |  -.3015866   .0801351    -3.76   0.000    -.4586897   -.1444835
 foreign_p_5 |  -.3070218   .0839018    -3.66   0.000    -.4715093   -.1425342
 foreign_p_6 |  -.3184208   .0894248    -3.56   0.000    -.4937362   -.1431054
             |
    ind_year |
          2  |  -.1067607   .0340973    -3.13   0.002    -.1736078   -.0399136
          3  |  -.1503537   .0433926    -3.46   0.001    -.2354239   -.0652834
          4  |  -.1975479   .0512315    -3.86   0.000    -.2979861   -.0971097
          5  |  -.2477227   .0600605    -4.12   0.000    -.3654699   -.1299755
          6  |  -.2720363   .0670779    -4.06   0.000     -.403541   -.1405316
          7  |  -.2741062   .0739631    -3.71   0.000    -.4191092   -.1291031
          8  |  -.2522042   .0824717    -3.06   0.002    -.4138881   -.0905202
          9  |  -.2513394   .0896355    -2.80   0.005    -.4270678   -.0756109
         10  |  -.2841783   .0979749    -2.90   0.004    -.4762559   -.0921008
         11  |  -.3406083   .1060878    -3.21   0.001    -.5485911   -.1326255
         12  |  -.3608759   .1140863    -3.16   0.002    -.5845396   -.1372123
         13  |   -.357834   .1219232    -2.93   0.003    -.5968618   -.1188062
         14  |  -.3148304   .1302803    -2.42   0.016    -.5702419   -.0594188
         15  |  -.2639172   .1384323    -1.91   0.057    -.5353107    .0074763
         16  |  -.2181639   .1468851    -1.49   0.138    -.5061289    .0698011
         17  |  -.2036701   .1560059    -1.31   0.192    -.5095163     .102176
         18  |  -.2541484   .1643061    -1.55   0.122    -.5762669    .0679702
         19  |  -.2577872   .1728257    -1.49   0.136    -.5966082    .0810338
         20  |  -.2821895   .1811552    -1.56   0.119    -.6373402    .0729613
         21  |  -.3380004   .1889704    -1.79   0.074    -.7084728     .032472
         22  |  -.3483402   .1961456    -1.78   0.076    -.7328793    .0361989
         23  |  -.3297349   .2038125    -1.62   0.106    -.7293048    .0698349
         24  |   -.327316   .2122647    -1.54   0.123    -.7434562    .0888242
         25  |  -.2776334   .2205351    -1.26   0.208    -.7099876    .1547208
         26  |   1.033686   .0943415    10.96   0.000     .8487312     1.21864
         27  |   .7840816   .0932652     8.41   0.000     .6012373     .966926
         28  |   .6617551   .0930481     7.11   0.000     .4793365    .8441738
         29  |   .5781717   .0936734     6.17   0.000      .394527    .7618163
         30  |   .5420387   .0949002     5.71   0.000      .355989    .7280884
         31  |   .5222817   .0987822     5.29   0.000     .3286214     .715942
         32  |   .4847663   .1022349     4.74   0.000     .2843371    .6851955
         33  |   .4411116   .1067185     4.13   0.000     .2318922    .6503309
         34  |   .4317446   .1120799     3.85   0.000     .2120145    .6514747
         35  |   .3889383   .1177196     3.30   0.001     .1581517    .6197249
         36  |   .2998248   .1237343     2.42   0.015     .0572465    .5424031
         37  |   .2563233   .1297178     1.98   0.048     .0020144    .5106322
         38  |   .2172026   .1366959     1.59   0.112    -.0507867    .4851919
         39  |   .1933308   .1438206     1.34   0.179    -.0886263     .475288
         40  |   .1777087   .1506371     1.18   0.238    -.1176119    .4730294
         41  |   .2110818    .157959     1.34   0.182    -.0985934    .5207569
         42  |   .2225918   .1662141     1.34   0.181    -.1032671    .5484508
         43  |   .0671564   .1752241     0.38   0.702    -.2763664    .4106793
         44  |   .0435538   .1842978     0.24   0.813    -.3177579    .4048656
         45  |    .093754   .1914744     0.49   0.624    -.2816273    .4691354
         46  |    .125291   .1985965     0.63   0.528    -.2640531    .5146351
         47  |   .1520889   .2053963     0.74   0.459    -.2505861    .5547638
         48  |   .1907262   .2117178     0.90   0.368    -.2243419    .6057943
         49  |   .2714194   .2196929     1.24   0.217    -.1592837    .7021224
         50  |   .3088625   .2273059     1.36   0.174    -.1367656    .7544906
             |
     age_cat |
          1  |    .403315   .0291645    13.83   0.000     .3461387    .4604914
          2  |   .7263564   .0376701    19.28   0.000      .652505    .8002078
          3  |   .9491782   .0454776    20.87   0.000     .8600204    1.038336
          4  |   1.138725   .0538346    21.15   0.000     1.033184    1.244267
          5  |   1.285632   .0622232    20.66   0.000     1.163645    1.407619
          6  |    1.40747   .0707388    19.90   0.000     1.268788    1.546152
          7  |   1.510715   .0795148    19.00   0.000     1.354828    1.666602
          8  |   1.599551   .0876844    18.24   0.000     1.427648    1.771454
          9  |   1.675237   .0956261    17.52   0.000     1.487764     1.86271
         10  |   1.731725   .1032019    16.78   0.000       1.5294     1.93405
         11  |    1.78109   .1110301    16.04   0.000     1.563418    1.998762
         12  |   1.844846   .1187271    15.54   0.000     1.612084    2.077608
         13  |   1.885204    .126311    14.93   0.000     1.637574    2.132834
         14  |   1.893414   .1341695    14.11   0.000     1.630378     2.15645
         15  |   1.924283   .1427141    13.48   0.000     1.644495    2.204071
         16  |    1.94281   .1512562    12.84   0.000     1.646276    2.239345
         17  |   1.956051    .159869    12.24   0.000     1.642632    2.269471
         18  |   1.973148   .1680805    11.74   0.000      1.64363    2.302666
         19  |   1.982651   .1760772    11.26   0.000     1.637456    2.327847
         20  |   1.978665   .1917562    10.32   0.000     1.602731    2.354598
         25  |   1.983666   .2207373     8.99   0.000     1.550916    2.416417
         30  |   1.650179   .3300612     5.00   0.000     1.003102    2.297257
         40  |   1.524973   .3576732     4.26   0.000     .8237629    2.226183
         50  |   1.327922   .4342019     3.06   0.002     .4766788    2.179165
             |
       _cons |   3.105964   .0794711    39.08   0.000     2.950162    3.261765
-------------+----------------------------------------------------------------
     sigma_u |  1.3805623
     sigma_e |  .70973017
         rho |  .79096015   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnL_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    228388
Group variable: firm_person                     Number of groups   =     20089

R-sq:  within  = 0.2526                         Obs per group: min =         1
       between = 0.0782                                        avg =      11.4
       overall = 0.0992                                        max =        25

                                                F(106,4531)        =     32.33
corr(u_i, Xb)  = 0.0026                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,532 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnK |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.1933202   .0391487    -4.94   0.000    -.2700708   -.1165696
   expat_m_2 |  -.1471288   .0348862    -4.22   0.000    -.2155226   -.0787349
   expat_m_3 |   -.095699   .0308763    -3.10   0.002    -.1562316   -.0351665
   expat_m_4 |  -.0361307   .0256821    -1.41   0.160    -.0864802    .0142188
domestic_m_1 |  -.2198611   .0362795    -6.06   0.000    -.2909866   -.1487356
domestic_m_2 |  -.1758715    .032355    -5.44   0.000    -.2393032   -.1124399
domestic_m_3 |  -.1208245   .0278355    -4.34   0.000    -.1753957   -.0662532
domestic_m_4 |  -.0598656   .0236084    -2.54   0.011    -.1061497   -.0135815
 foreign_m_1 |   .0323966   .0750109     0.43   0.666    -.1146613    .1794546
 foreign_m_2 |   .0105552   .0687935     0.15   0.878    -.1243137     .145424
 foreign_m_3 |   .0024988   .0638418     0.04   0.969    -.1226622    .1276598
 foreign_m_4 |    .035549   .0546539     0.65   0.515    -.0715994    .1426973
   expat_p_0 |  -.2758309   .0437623    -6.30   0.000    -.3616262   -.1900355
   expat_p_1 |  -.3378387   .0500869    -6.75   0.000    -.4360335   -.2396438
   expat_p_2 |  -.3984132    .055805    -7.14   0.000    -.5078182   -.2890083
   expat_p_3 |    -.41977   .0612596    -6.85   0.000    -.5398686   -.2996713
   expat_p_4 |  -.4719923   .0697372    -6.77   0.000    -.6087112   -.3352733
   expat_p_5 |  -.4862605   .0774603    -6.28   0.000    -.6381204   -.3344005
   expat_p_6 |  -.5777485   .0928679    -6.22   0.000    -.7598149    -.395682
domestic_p_0 |  -.3002876   .0411077    -7.30   0.000    -.3808789   -.2196964
domestic_p_1 |  -.3697977   .0471811    -7.84   0.000    -.4622957   -.2772997
domestic_p_2 |  -.4169111   .0543239    -7.67   0.000    -.5234125   -.3104098
domestic_p_3 |  -.4745388      .0613    -7.74   0.000    -.5947167   -.3543608
domestic_p_4 |  -.4948145   .0693179    -7.14   0.000    -.6307115   -.3589176
domestic_p_5 |  -.4552228   .0775646    -5.87   0.000    -.6072873   -.3031583
domestic_p_6 |  -.4464335   .0909411    -4.91   0.000    -.6247223   -.2681447
 foreign_p_0 |  -.0616946   .0805921    -0.77   0.444    -.2196944    .0963053
 foreign_p_1 |   .1324544   .0844445     1.57   0.117    -.0330981    .2980069
 foreign_p_2 |   .1439981   .0890982     1.62   0.106    -.0306779    .3186741
 foreign_p_3 |   .1378058    .094838     1.45   0.146    -.0481229    .3237344
 foreign_p_4 |   .1175617   .1006747     1.17   0.243    -.0798099    .3149333
 foreign_p_5 |   .0821955   .1067009     0.77   0.441    -.1269903    .2913814
 foreign_p_6 |   .0485318     .11457     0.42   0.672    -.1760813    .2731449
             |
    ind_year |
          2  |   .1045134   .0556301     1.88   0.060    -.0045487    .2135755
          3  |   .6096241   .0711535     8.57   0.000     .4701286    .7491196
          4  |   .7230693    .085346     8.47   0.000     .5557495    .8903892
          5  |   .9313566    .097269     9.58   0.000     .7406618    1.122051
          6  |   1.092882   .1091241    10.02   0.000     .8789452    1.306818
          7  |   1.322008   .1219292    10.84   0.000     1.082967    1.561049
          8  |   1.516834   .1351602    11.22   0.000     1.251854    1.781814
          9  |   1.651438   .1478529    11.17   0.000     1.361575    1.941302
         10  |   1.726679   .1604132    10.76   0.000     1.412191    2.041167
         11  |   1.784402   .1727705    10.33   0.000     1.445688    2.123117
         12  |   1.799038   .1861929     9.66   0.000     1.434009    2.164067
         13  |   1.858668   .2000279     9.29   0.000     1.466516     2.25082
         14  |   1.933826   .2126841     9.09   0.000     1.516861    2.350791
         15  |    1.97197   .2265223     8.71   0.000     1.527876    2.416065
         16  |   2.014113   .2408158     8.36   0.000     1.541996    2.486229
         17  |   2.070855   .2542702     8.14   0.000     1.572362    2.569349
         18  |    2.02351   .2692949     7.51   0.000     1.495561    2.551459
         19  |    1.96641   .2840511     6.92   0.000     1.409531    2.523288
         20  |   1.972939   .2983807     6.61   0.000     1.387968    2.557911
         21  |    1.95789   .3116215     6.28   0.000      1.34696     2.56882
         22  |   1.977472   .3229157     6.12   0.000       1.3444    2.610544
         23  |   2.044165   .3363911     6.08   0.000     1.384674    2.703655
         24  |   1.435038    .354809     4.04   0.000     .7394395    2.130637
         25  |   1.523728   .3753605     4.06   0.000     .7878382    2.259617
         26  |   1.362934   .1357622    10.04   0.000     1.096774    1.629094
         27  |   1.287586   .1322466     9.74   0.000     1.028318    1.546854
         28  |   1.401971   .1308487    10.71   0.000     1.145444    1.658499
         29  |   1.474383   .1350525    10.92   0.000     1.209614    1.739152
         30  |   1.580473   .1402466    11.27   0.000     1.305521    1.855425
         31  |   1.687841   .1485648    11.36   0.000     1.396581      1.9791
         32  |   1.886475   .1562129    12.08   0.000     1.580222    2.192729
         33  |   2.042205    .165213    12.36   0.000     1.718307    2.366104
         34  |   2.165282    .175315    12.35   0.000     1.821579    2.508985
         35  |   2.254645   .1864542    12.09   0.000     1.889104    2.620186
         36  |   2.237655   .1985311    11.27   0.000     1.848437    2.626873
         37  |   2.287684   .2090028    10.95   0.000     1.877936    2.697431
         38  |   2.350551   .2213986    10.62   0.000     1.916502      2.7846
         39  |   2.405738    .234238    10.27   0.000     1.946517    2.864959
         40  |   2.463046   .2466736     9.99   0.000     1.979445    2.946647
         41  |    2.52075   .2607686     9.67   0.000     2.009517    3.031984
         42  |   2.595221   .2731461     9.50   0.000     2.059722    3.130721
         43  |   2.588243   .2862053     9.04   0.000     2.027141    3.149345
         44  |     2.5597   .3003021     8.52   0.000     1.970961    3.148439
         45  |   2.701842   .3150786     8.58   0.000     2.084134     3.31955
         46  |   2.747787   .3285731     8.36   0.000     2.103624    3.391951
         47  |    2.86111    .341001     8.39   0.000     2.192582    3.529638
         48  |   2.990153   .3524989     8.48   0.000     2.299084    3.681223
         49  |   2.940159   .3633964     8.09   0.000     2.227724    3.652593
         50  |   3.057444   .3770833     8.11   0.000     2.318176    3.796711
             |
     age_cat |
          1  |   .4073807   .0488032     8.35   0.000     .3117026    .5030588
          2  |   .6884261   .0604992    11.38   0.000     .5698181    .8070341
          3  |   .8486465   .0727302    11.67   0.000     .7060597    .9912332
          4  |   1.003415   .0858023    11.69   0.000     .8352001    1.171629
          5  |   1.092605   .0997515    10.95   0.000     .8970438    1.288167
          6  |   1.183878   .1138124    10.40   0.000     .9607505    1.407006
          7  |   1.243815   .1281021     9.71   0.000     .9926725    1.494958
          8  |    1.29219   .1415482     9.13   0.000     1.014686    1.569693
          9  |   1.324282   .1548758     8.55   0.000      1.02065    1.627914
         10  |   1.334242   .1678065     7.95   0.000      1.00526    1.663225
         11  |   1.371357   .1808289     7.58   0.000     1.016844     1.72587
         12  |   1.405835   .1938176     7.25   0.000     1.025858    1.785813
         13  |    1.38921   .2072587     6.70   0.000     .9828815    1.795538
         14  |   1.391181   .2205475     6.31   0.000        .9588    1.823562
         15  |   1.372335   .2340667     5.86   0.000     .9134501     1.83122
         16  |   1.387848   .2487866     5.58   0.000     .9001054    1.875591
         17  |   1.398038   .2621606     5.33   0.000     .8840756    1.912001
         18  |   1.381206   .2760015     5.00   0.000     .8401085    1.922303
         19  |   1.371299    .290852     4.71   0.000     .8010878    1.941511
         20  |   1.335827   .3181128     4.20   0.000     .7121709    1.959483
         25  |   1.276689   .3692225     3.46   0.001     .5528324    2.000545
         30  |   .8579242   .5253191     1.63   0.103    -.1719575    1.887806
         40  |   .5626714   .6096756     0.92   0.356      -.63259    1.757933
         50  |   .5471947   .7083112     0.77   0.440    -.8414406     1.93583
             |
       _cons |   8.145109   .1183114    68.84   0.000     7.913161    8.377057
-------------+----------------------------------------------------------------
     sigma_u |  2.1990992
     sigma_e |  1.0251441
         rho |  .82148328   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnK_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    241615
Group variable: firm_person                     Number of groups   =     20311

R-sq:  within  = 0.4583                         Obs per group: min =         1
       between = 0.0855                                        avg =      11.9
       overall = 0.1528                                        max =        25

                                                F(106,4618)        =     79.22
corr(u_i, Xb)  = -0.0565                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,619 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnQ |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0101917   .0309373    -0.33   0.742    -.0708437    .0504602
   expat_m_2 |   .0026901    .027442     0.10   0.922    -.0511093    .0564894
   expat_m_3 |   .0203661   .0244307     0.83   0.405    -.0275299     .068262
   expat_m_4 |    .026129   .0214972     1.22   0.224    -.0160159    .0682738
domestic_m_1 |  -.2379133   .0290483    -8.19   0.000    -.2948619   -.1809647
domestic_m_2 |  -.1581016   .0258163    -6.12   0.000    -.2087138   -.1074894
domestic_m_3 |   -.103043     .02215    -4.65   0.000    -.1464676   -.0596184
domestic_m_4 |  -.0532034   .0188493    -2.82   0.005     -.090157   -.0162498
 foreign_m_1 |  -.1815671   .0614627    -2.95   0.003    -.3020634   -.0610708
 foreign_m_2 |  -.1886161   .0579814    -3.25   0.001    -.3022873   -.0749448
 foreign_m_3 |  -.1766431    .052065    -3.39   0.001    -.2787153   -.0745709
 foreign_m_4 |  -.1493403   .0436011    -3.43   0.001    -.2348192   -.0638613
   expat_p_0 |  -.0732906   .0343086    -2.14   0.033    -.1405519   -.0060293
   expat_p_1 |  -.1110332   .0393122    -2.82   0.005    -.1881039   -.0339625
   expat_p_2 |      -.162   .0435824    -3.72   0.000    -.2474424   -.0765576
   expat_p_3 |  -.1775377   .0499825    -3.55   0.000    -.2755272   -.0795482
   expat_p_4 |  -.1875121   .0534022    -3.51   0.000    -.2922059   -.0828183
   expat_p_5 |  -.1968651    .058661    -3.36   0.001    -.3118686   -.0818615
   expat_p_6 |  -.3304983    .080995    -4.08   0.000    -.4892871   -.1717095
domestic_p_0 |  -.3122483   .0324635    -9.62   0.000    -.3758922   -.2486043
domestic_p_1 |  -.3395509   .0375919    -9.03   0.000    -.4132491   -.2658527
domestic_p_2 |  -.3624019    .043916    -8.25   0.000    -.4484982   -.2763056
domestic_p_3 |  -.3785064    .048438    -7.81   0.000    -.4734681   -.2835447
domestic_p_4 |  -.4386583   .0566618    -7.74   0.000    -.5497425   -.3275741
domestic_p_5 |  -.4388722   .0604799    -7.26   0.000    -.5574418   -.3203027
domestic_p_6 |  -.4816065   .0734871    -6.55   0.000    -.6256762   -.3375367
 foreign_p_0 |  -.4858859   .0666998    -7.28   0.000    -.6166495   -.3551224
 foreign_p_1 |  -.0806733   .0700376    -1.15   0.249    -.2179805    .0566339
 foreign_p_2 |  -.0540209   .0746576    -0.72   0.469    -.2003854    .0923436
 foreign_p_3 |  -.0668999   .0798669    -0.84   0.402    -.2234771    .0896774
 foreign_p_4 |  -.0790506   .0848935    -0.93   0.352    -.2454824    .0873811
 foreign_p_5 |  -.0716215   .0896528    -0.80   0.424    -.2473839    .1041409
 foreign_p_6 |  -.0503575   .0961129    -0.52   0.600    -.2387847    .1380696
             |
    ind_year |
          2  |   -.025568   .0437249    -0.58   0.559    -.1112898    .0601538
          3  |   .1195993   .0526759     2.27   0.023     .0163295    .2228692
          4  |   .2816276   .0634245     4.44   0.000     .1572852    .4059699
          5  |   .4960124    .073017     6.79   0.000     .3528642    .6391605
          6  |   .6532449   .0836359     7.81   0.000     .4892786    .8172113
          7  |   .8139213   .0933899     8.72   0.000     .6308324    .9970102
          8  |   .9310162   .1057116     8.81   0.000     .7237709    1.138262
          9  |   1.076877   .1155691     9.32   0.000     .8503066    1.303448
         10  |     1.1648   .1274434     9.14   0.000     .9149502     1.41465
         11  |   1.205614   .1388653     8.68   0.000     .9333721    1.477857
         12  |     1.2754   .1501362     8.49   0.000     .9810616    1.569739
         13  |   1.359947   .1617001     8.41   0.000     1.042938    1.676957
         14  |   1.484292   .1731999     8.57   0.000     1.144738    1.823847
         15  |   1.599644   .1847863     8.66   0.000     1.237374    1.961913
         16  |   1.671066   .1968802     8.49   0.000     1.285086    2.057045
         17  |    1.73886   .2085321     8.34   0.000     1.330037    2.147683
         18  |   1.638534   .2209935     7.41   0.000     1.205281    2.071787
         19  |   1.708772   .2334337     7.32   0.000      1.25113    2.166414
         20  |   1.755724   .2450366     7.17   0.000     1.275336    2.236113
         21  |   1.724261   .2556714     6.74   0.000     1.223023      2.2255
         22  |   1.792135   .2664201     6.73   0.000     1.269824    2.314446
         23  |   1.905163   .2768087     6.88   0.000     1.362485     2.44784
         24  |   1.942115   .2870413     6.77   0.000     1.379377    2.504853
         25  |   2.005069   .2983957     6.72   0.000     1.420071    2.590067
         26  |   .5248651   .1029343     5.10   0.000     .3230646    .7266655
         27  |    .379204   .1002697     3.78   0.000     .1826275    .5757805
         28  |   .5173772   .1004855     5.15   0.000     .3203776    .7143769
         29  |   .7457622   .1008628     7.39   0.000     .5480229    .9435016
         30  |   .9120755    .104603     8.72   0.000     .7070037    1.117147
         31  |   1.104983   .1107698     9.98   0.000     .8878208    1.322144
         32  |   1.252254   .1173071    10.68   0.000     1.022276    1.482232
         33  |   1.343958   .1252686    10.73   0.000     1.098372    1.589545
         34  |   1.520306   .1331827    11.42   0.000     1.259205    1.781408
         35  |   1.588665   .1425721    11.14   0.000     1.309155    1.868174
         36  |   1.585877     .15232    10.41   0.000     1.287257    1.884497
         37  |   1.674062   .1613742    10.37   0.000     1.357691    1.990433
         38  |   1.713746    .172759     9.92   0.000     1.375056    2.052436
         39  |   1.816592   .1833721     9.91   0.000     1.457095    2.176089
         40  |   1.938771   .1939037    10.00   0.000     1.558627    2.318915
         41  |   2.043023   .2042514    10.00   0.000     1.642593    2.443454
         42  |   2.139995   .2150292     9.95   0.000     1.718435    2.561555
         43  |   1.987468   .2259051     8.80   0.000     1.544586     2.43035
         44  |   2.076014   .2390514     8.68   0.000     1.607359    2.544669
         45  |   2.231599   .2496631     8.94   0.000      1.74214    2.721058
         46  |   2.331095   .2596528     8.98   0.000     1.822052    2.840139
         47  |   2.433418    .269333     9.03   0.000     1.905397    2.961439
         48  |   2.538705   .2790258     9.10   0.000     1.991681    3.085729
         49  |   2.666402    .288721     9.24   0.000      2.10037    3.232433
         50  |    2.74828   .2990757     9.19   0.000     2.161949    3.334612
             |
     age_cat |
          1  |   1.043619   .0458933    22.74   0.000      .953646    1.133592
          2  |   1.425479   .0534812    26.65   0.000     1.320631    1.530328
          3  |   1.638049   .0622152    26.33   0.000     1.516077     1.76002
          4  |   1.802354   .0713581    25.26   0.000     1.662458     1.94225
          5  |   1.914759   .0819263    23.37   0.000     1.754144    2.075373
          6  |   1.999258   .0922306    21.68   0.000     1.818442    2.180074
          7  |   2.073306   .1033183    20.07   0.000     1.870753     2.27586
          8  |    2.10643   .1139656    18.48   0.000     1.883003    2.329857
          9  |   2.150938   .1244845    17.28   0.000     1.906889    2.394987
         10  |   2.180051   .1350981    16.14   0.000     1.915194    2.444908
         11  |   2.210329   .1460925    15.13   0.000     1.923918     2.49674
         12  |     2.2363   .1570021    14.24   0.000     1.928501    2.544099
         13  |   2.247085   .1676619    13.40   0.000     1.918387    2.575782
         14  |   2.229189   .1789213    12.46   0.000     1.878418     2.57996
         15  |   2.240914   .1906244    11.76   0.000     1.867199    2.614628
         16  |   2.207973   .2022015    10.92   0.000     1.811562    2.604385
         17  |   2.178287   .2138598    10.19   0.000      1.75902    2.597555
         18  |   2.187722    .225129     9.72   0.000     1.746361    2.629082
         19  |   2.139249   .2364223     9.05   0.000     1.675749     2.60275
         20  |   2.065063   .2603856     7.93   0.000     1.554583    2.575543
         25  |   1.918235    .300042     6.39   0.000     1.330009     2.50646
         30  |   1.555537   .4004428     3.88   0.000     .7704775    2.340596
         40  |   1.363954   .4808258     2.84   0.005     .4213054    2.306602
         50  |    1.11293   .5780749     1.93   0.054    -.0203726    2.246234
             |
       _cons |   10.61902   .0901153   117.84   0.000     10.44235    10.79569
-------------+----------------------------------------------------------------
     sigma_u |  1.8592823
     sigma_e |  .85685804
         rho |  .82481941   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnQ_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    228388
Group variable: firm_person                     Number of groups   =     20089

R-sq:  within  = 0.1600                         Obs per group: min =         1
       between = 0.0511                                        avg =      11.4
       overall = 0.0856                                        max =        25

                                                F(106,4531)        =     21.35
corr(u_i, Xb)  = -0.0735                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,532 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.1336295    .030509    -4.38   0.000     -.193442    -.073817
   expat_m_2 |  -.1154921    .027909    -4.14   0.000    -.1702073   -.0607768
   expat_m_3 |  -.0832675   .0250777    -3.32   0.001    -.1324319    -.034103
   expat_m_4 |  -.0390051   .0209805    -1.86   0.063     -.080137    .0021269
domestic_m_1 |  -.0335054   .0284718    -1.18   0.239    -.0893241    .0223133
domestic_m_2 |  -.0411188   .0257148    -1.60   0.110    -.0915323    .0092947
domestic_m_3 |  -.0315949   .0223518    -1.41   0.158    -.0754154    .0122256
domestic_m_4 |  -.0100815   .0194127    -0.52   0.604    -.0481399    .0279768
 foreign_m_1 |   .2695651   .0612245     4.40   0.000     .1495351     .389595
 foreign_m_2 |   .2266305   .0537153     4.22   0.000     .1213224    .3319386
 foreign_m_3 |   .2018429   .0497603     4.06   0.000     .1042885    .2993974
 foreign_m_4 |   .2027516   .0419631     4.83   0.000     .1204835    .2850198
   expat_p_0 |   -.167441   .0338445    -4.95   0.000    -.2337927   -.1010893
   expat_p_1 |   -.186661   .0381904    -4.89   0.000    -.2615328   -.1117892
   expat_p_2 |  -.2348565   .0432056    -5.44   0.000    -.3195606   -.1501524
   expat_p_3 |  -.2609866   .0473967    -5.51   0.000    -.3539073   -.1680659
   expat_p_4 |  -.2959658   .0539446    -5.49   0.000    -.4017235   -.1902081
   expat_p_5 |  -.2631485   .0617651    -4.26   0.000    -.3842382   -.1420588
   expat_p_6 |  -.2360597   .0780979    -3.02   0.003    -.3891698   -.0829497
domestic_p_0 |  -.0632533   .0320012    -1.98   0.048    -.1259912   -.0005154
domestic_p_1 |  -.0948024   .0361485    -2.62   0.009    -.1656711   -.0239337
domestic_p_2 |    -.12633   .0404332    -3.12   0.002    -.2055987   -.0470613
domestic_p_3 |  -.1673896   .0458168    -3.65   0.000    -.2572128   -.0775664
domestic_p_4 |  -.1794575   .0521405    -3.44   0.001    -.2816783   -.0772367
domestic_p_5 |  -.1556898   .0617975    -2.52   0.012     -.276843   -.0345365
domestic_p_6 |  -.1126259   .0696385    -1.62   0.106    -.2491513    .0238996
 foreign_p_0 |    .468748   .0645849     7.26   0.000       .34213    .5953659
 foreign_p_1 |   .4548548   .0675647     6.73   0.000     .3223951    .5873145
 foreign_p_2 |   .4454738   .0715197     6.23   0.000     .3052602    .5856873
 foreign_p_3 |   .4290249   .0764407     5.61   0.000     .2791638     .578886
 foreign_p_4 |   .4119583   .0809859     5.09   0.000     .2531864    .5707303
 foreign_p_5 |   .3844345   .0857831     4.48   0.000     .2162577    .5526113
 foreign_p_6 |   .3548949   .0917068     3.87   0.000     .1751048     .534685
             |
    ind_year |
          2  |   .1949518   .0489825     3.98   0.000     .0989223    .2909813
          3  |   .7545712   .0618766    12.19   0.000     .6332629    .8758796
          4  |   .9163473   .0733874    12.49   0.000     .7724723    1.060222
          5  |   1.164613   .0832181    13.99   0.000     1.001465    1.327761
          6  |   1.347247    .093588    14.40   0.000     1.163769    1.530725
          7  |   1.585417   .1047371    15.14   0.000     1.380082    1.790753
          8  |   1.760443   .1163743    15.13   0.000     1.532293    1.988593
          9  |   1.895313   .1271691    14.90   0.000        1.646    2.144627
         10  |   2.004542   .1387504    14.45   0.000     1.732524    2.276561
         11  |   2.109889   .1499748    14.07   0.000     1.815866    2.403913
         12  |   2.140335   .1624857    13.17   0.000     1.821784    2.458886
         13  |   2.206801   .1756176    12.57   0.000     1.862505    2.551097
         14  |   2.226837   .1872656    11.89   0.000     1.859705    2.593969
         15  |   2.212673   .1998563    11.07   0.000     1.820857    2.604489
         16  |   2.196418   .2126864    10.33   0.000     1.779449    2.613387
         17  |   2.230068   .2253198     9.90   0.000     1.788331    2.671804
         18  |   2.236542   .2389177     9.36   0.000     1.768147    2.704938
         19  |   2.217629   .2524422     8.78   0.000     1.722719    2.712538
         20  |   2.236385   .2652961     8.43   0.000     1.716275    2.756494
         21  |   2.251885   .2778169     8.11   0.000     1.707228    2.796541
         22  |   2.285967    .288178     7.93   0.000     1.720997    2.850936
         23  |   2.325182   .3002468     7.74   0.000     1.736552    2.913813
         24  |   1.590723   .3177703     5.01   0.000     .9677378    2.213707
         25  |   1.651226   .3371659     4.90   0.000     .9902159    2.312235
         26  |   .3498727   .1033961     3.38   0.001      .147166    .5525794
         27  |   .5302413   .0982903     5.39   0.000     .3375443    .7229382
         28  |   .7645307   .0979785     7.80   0.000     .5724451    .9566163
         29  |    .928555   .1030193     9.01   0.000     .7265869    1.130523
         30  |   1.071819   .1079098     9.93   0.000     .8602634    1.283375
         31  |   1.204946   .1153696    10.44   0.000     .9787656    1.431127
         32  |   1.445648   .1228968    11.76   0.000     1.204711    1.686586
         33  |   1.644685    .132347    12.43   0.000     1.385221     1.90415
         34  |   1.781844    .142032    12.55   0.000     1.503392    2.060296
         35  |   1.905649   .1522009    12.52   0.000     1.607261    2.204037
         36  |   1.977846   .1633606    12.11   0.000     1.657579    2.298112
         37  |   2.072979   .1741413    11.90   0.000     1.731577    2.414381
         38  |   2.161738   .1864048    11.60   0.000     1.796293    2.527182
         39  |   2.231963   .1982759    11.26   0.000     1.843245     2.62068
         40  |   2.313873   .2094203    11.05   0.000     1.903307    2.724438
         41  |   2.321561   .2227496    10.42   0.000     1.884864    2.758259
         42  |   2.387172   .2344832    10.18   0.000      1.92747    2.846873
         43  |   2.540089   .2486693    10.21   0.000     2.052576    3.027602
         44  |   2.527781   .2613323     9.67   0.000     2.015442     3.04012
         45  |   2.615391   .2738433     9.55   0.000     2.078525    3.152258
         46  |   2.637245   .2852563     9.25   0.000     2.078004    3.196486
         47  |   2.717936   .2968061     9.16   0.000     2.136051     3.29982
         48  |    2.79939   .3081626     9.08   0.000     2.195241    3.403539
         49  |    2.61524   .3177378     8.23   0.000     1.992319    3.238161
         50  |   2.684213   .3306128     8.12   0.000     2.036051    3.332375
             |
     age_cat |
          1  |   .0179563   .0451278     0.40   0.691    -.0705163    .1064289
          2  |  -.0263224   .0548808    -0.48   0.632    -.1339154    .0812707
          3  |  -.0721956   .0647299    -1.12   0.265    -.1990977    .0547065
          4  |  -.0902556   .0755017    -1.20   0.232    -.2382757    .0577645
          5  |  -.1471893   .0870144    -1.69   0.091      -.31778    .0234013
          6  |  -.1735083   .0987961    -1.76   0.079    -.3671968    .0201802
          7  |  -.2132173   .1108395    -1.92   0.054    -.4305167    .0040822
          8  |  -.2548492   .1228768    -2.07   0.038    -.4957477   -.0139507
          9  |   -.299269   .1350336    -2.22   0.027    -.5640008   -.0345372
         10  |  -.3501811   .1467428    -2.39   0.017    -.6378685   -.0624937
         11  |  -.3590259   .1588696    -2.26   0.024    -.6704877   -.0475641
         12  |  -.3741492   .1708012    -2.19   0.029    -.7090029   -.0392955
         13  |  -.4271934   .1831622    -2.33   0.020    -.7862806   -.0681061
         14  |  -.4361785   .1956781    -2.23   0.026     -.819803    -.052554
         15  |  -.4795248   .2078288    -2.31   0.021    -.8869707   -.0720789
         16  |  -.4898903    .221359    -2.21   0.027    -.9238618   -.0559188
         17  |  -.4794072   .2341505    -2.05   0.041    -.9384564    -.020358
         18  |  -.5338452   .2471125    -2.16   0.031    -1.018306   -.0493842
         19  |  -.5592958   .2606872    -2.15   0.032     -1.07037   -.0482217
         20  |  -.5896113   .2875593    -2.05   0.040    -1.153368   -.0258549
         25  |   -.696448   .3375602    -2.06   0.039    -1.358231   -.0346654
         30  |  -.7176919   .4545347    -1.58   0.114    -1.608801    .1734177
         40  |  -.8827411   .5460176    -1.62   0.106    -1.953202    .1877197
         50  |  -.7287189   .6375387    -1.14   0.253    -1.978606    .5211678
             |
       _cons |   4.967101   .0935133    53.12   0.000      4.78377    5.150433
-------------+----------------------------------------------------------------
     sigma_u |  1.5494431
     sigma_e |  .87693602
         rho |  .75739194   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnKL_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    241615
Group variable: firm_person                     Number of groups   =     20311

R-sq:  within  = 0.4044                         Obs per group: min =         1
       between = 0.1657                                        avg =      11.9
       overall = 0.2216                                        max =        25

                                                F(106,4618)        =     78.89
corr(u_i, Xb)  = -0.0481                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,619 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |   .0409238   .0197426     2.07   0.038     .0022188    .0796288
   expat_m_2 |   .0208001   .0180044     1.16   0.248     -.014497    .0560973
   expat_m_3 |   .0253275   .0161917     1.56   0.118    -.0064161     .057071
   expat_m_4 |   .0209201   .0145295     1.44   0.150    -.0075647     .049405
domestic_m_1 |  -.0574302   .0190317    -3.02   0.003    -.0947415   -.0201189
domestic_m_2 |  -.0290816   .0170434    -1.71   0.088    -.0624948    .0043316
domestic_m_3 |  -.0160666   .0150768    -1.07   0.287    -.0456243    .0134912
domestic_m_4 |  -.0115914   .0138046    -0.84   0.401    -.0386549    .0154721
 foreign_m_1 |   .0669845   .0397335     1.69   0.092    -.0109121    .1448811
 foreign_m_2 |   .0379539   .0371687     1.02   0.307    -.0349144    .1108223
 foreign_m_3 |   .0208698    .034263     0.61   0.542     -.046302    .0880416
 foreign_m_4 |   .0337933   .0305418     1.11   0.269    -.0260832    .0936698
   expat_p_0 |   .0345558   .0217139     1.59   0.112    -.0080137    .0771254
   expat_p_1 |   .0428399   .0244227     1.75   0.079    -.0050402      .09072
   expat_p_2 |   .0097117   .0275245     0.35   0.724    -.0442496    .0636729
   expat_p_3 |   .0099903   .0306762     0.33   0.745    -.0501497    .0701304
   expat_p_4 |   -.006248   .0350804    -0.18   0.859    -.0750222    .0625263
   expat_p_5 |   .0249097   .0370274     0.67   0.501    -.0476816     .097501
   expat_p_6 |   .0163503    .047783     0.34   0.732    -.0773272    .1100278
domestic_p_0 |  -.0658599   .0207745    -3.17   0.002    -.1065878   -.0251321
domestic_p_1 |  -.0636238   .0235975    -2.70   0.007    -.1098863   -.0173614
domestic_p_2 |  -.0760221   .0275551    -2.76   0.006    -.1300432   -.0220009
domestic_p_3 |  -.0741551   .0295644    -2.51   0.012    -.1321155   -.0161947
domestic_p_4 |  -.1167646   .0365849    -3.19   0.001    -.1884886   -.0450407
domestic_p_5 |  -.1096589   .0383431    -2.86   0.004    -.1848296   -.0344881
domestic_p_6 |  -.1577358   .0457769    -3.45   0.001    -.2474805   -.0679911
 foreign_p_0 |   .0228752   .0416984     0.55   0.583    -.0588735    .1046239
 foreign_p_1 |    .206257   .0434912     4.74   0.000     .1209934    .2915206
 foreign_p_2 |   .2262518   .0462467     4.89   0.000     .1355862    .3169174
 foreign_p_3 |   .2216879   .0494033     4.49   0.000     .1248338    .3185421
 foreign_p_4 |   .2225359   .0525296     4.24   0.000     .1195528     .325519
 foreign_p_5 |   .2354002   .0554374     4.25   0.000     .1267165    .3440839
 foreign_p_6 |   .2680632   .0597864     4.48   0.000     .1508533    .3852732
             |
    ind_year |
          2  |   .0811927    .035969     2.26   0.024     .0106762    .1517092
          3  |    .269953   .0405344     6.66   0.000     .1904862    .3494198
          4  |   .4791754    .046348    10.34   0.000     .3883112    .5700396
          5  |    .743735   .0501522    14.83   0.000     .6454128    .8420573
          6  |   .9252812   .0565141    16.37   0.000     .8144866    1.036076
          7  |   1.088027    .062248    17.48   0.000     .9659917    1.210063
          8  |    1.18322   .0685658    17.26   0.000     1.048799    1.317642
          9  |   1.328217   .0746723    17.79   0.000     1.181823     1.47461
         10  |   1.448979   .0810575    17.88   0.000     1.290067     1.60789
         11  |   1.546223   .0871388    17.74   0.000     1.375389    1.717056
         12  |   1.636276    .093727    17.46   0.000     1.452526    1.820026
         13  |   1.717781   .1006504    17.07   0.000     1.520458    1.915104
         14  |   1.799123   .1071689    16.79   0.000      1.58902    2.009225
         15  |   1.863561   .1138163    16.37   0.000     1.640427    2.086695
         16  |    1.88923   .1208225    15.64   0.000      1.65236    2.126099
         17  |    1.94253   .1277337    15.21   0.000     1.692111    2.192949
         18  |   1.892682   .1350076    14.02   0.000     1.628003    2.157361
         19  |   1.966559   .1426955    13.78   0.000     1.686808    2.246311
         20  |   2.037914   .1498645    13.60   0.000     1.744108     2.33172
         21  |   2.062262   .1559281    13.23   0.000     1.756568    2.367955
         22  |   2.140475   .1626377    13.16   0.000     1.821627    2.459323
         23  |   2.234898   .1688937    13.23   0.000     1.903785     2.56601
         24  |   2.269431   .1754126    12.94   0.000     1.925539    2.613324
         25  |   2.282702   .1826435    12.50   0.000     1.924634    2.640771
         26  |  -.5088206   .0652327    -7.80   0.000    -.6367078   -.3809333
         27  |  -.4048776   .0645651    -6.27   0.000    -.5314561   -.2782992
         28  |  -.1443779   .0645015    -2.24   0.025    -.2708316   -.0179242
         29  |   .1675906   .0660626     2.54   0.011     .0380763    .2971049
         30  |   .3700368   .0673975     5.49   0.000     .2379055    .5021682
         31  |   .5827009   .0709804     8.21   0.000     .4435455    .7218563
         32  |   .7674877   .0749939    10.23   0.000     .6204639    .9145115
         33  |   .9028467   .0787376    11.47   0.000     .7484834     1.05721
         34  |   1.088562   .0836556    13.01   0.000     .9245569    1.252567
         35  |   1.199727   .0884387    13.57   0.000     1.026345    1.373109
         36  |   1.286052   .0942885    13.64   0.000     1.101201    1.470902
         37  |   1.417739    .100378    14.12   0.000      1.22095    1.614528
         38  |   1.496543   .1067201    14.02   0.000     1.287321    1.705766
         39  |   1.623262   .1132211    14.34   0.000     1.401294    1.845229
         40  |   1.761062   .1198273    14.70   0.000     1.526144    1.995981
         41  |   1.831942   .1261218    14.53   0.000     1.584683    2.079201
         42  |   1.917403   .1320601    14.52   0.000     1.658502    2.176304
         43  |   1.920312   .1389973    13.82   0.000      1.64781    2.192813
         44  |    2.03246   .1462946    13.89   0.000     1.745653    2.319268
         45  |   2.137845   .1528689    13.98   0.000     1.838149    2.437541
         46  |   2.205804   .1582775    13.94   0.000     1.895505    2.516104
         47  |   2.281329   .1638079    13.93   0.000     1.960187    2.602471
         48  |   2.347979   .1696738    13.84   0.000     2.015337    2.680621
         49  |   2.394982   .1754597    13.65   0.000     2.050997    2.738967
         50  |   2.439418   .1816784    13.43   0.000     2.083242    2.795594
             |
     age_cat |
          1  |   .6403037   .0369572    17.33   0.000     .5678499    .7127575
          2  |   .6991228   .0408426    17.12   0.000     .6190517    .7791939
          3  |   .6888704   .0454361    15.16   0.000     .5997939    .7779469
          4  |   .6636292   .0501135    13.24   0.000     .5653829    .7618756
          5  |   .6291263   .0562225    11.19   0.000     .5189033    .7393494
          6  |    .591788   .0619759     9.55   0.000     .4702856    .7132904
          7  |   .5625911   .0680237     8.27   0.000     .4292321    .6959502
          8  |   .5068787   .0741998     6.83   0.000     .3614116    .6523458
          9  |   .4757011   .0802678     5.93   0.000     .3183378    .6330645
         10  |   .4483259   .0862398     5.20   0.000     .2792546    .6173972
         11  |   .4292388   .0927304     4.63   0.000     .2474429    .6110347
         12  |   .3914545   .0992637     3.94   0.000     .1968502    .5860588
         13  |   .3618811   .1056082     3.43   0.001     .1548385    .5689237
         14  |   .3357754   .1121869     2.99   0.003     .1158355    .5557152
         15  |   .3166309   .1191311     2.66   0.008     .0830771    .5501848
         16  |    .265163   .1263206     2.10   0.036     .0175142    .5128117
         17  |    .222236    .133411     1.67   0.096    -.0393134    .4837853
         18  |   .2145734   .1399741     1.53   0.125    -.0598427    .4889895
         19  |   .1565979    .146812     1.07   0.286    -.1312238    .4444196
         20  |   .0863983   .1602707     0.54   0.590    -.2278089    .4006055
         25  |  -.0654314   .1836731    -0.36   0.722    -.4255185    .2946557
         30  |  -.0946425   .2553236    -0.37   0.711    -.5951987    .4059136
         40  |  -.1610195   .2928916    -0.55   0.583    -.7352269    .4131879
         50  |  -.2149916   .3489855    -0.62   0.538    -.8991699    .4691867
             |
       _cons |   7.513055   .0626807   119.86   0.000     7.390171    7.635939
-------------+----------------------------------------------------------------
     sigma_u |   1.239248
     sigma_e |  .62310532
         rho |  .79820111   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnQL_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    241615
Group variable: firm_person                     Number of groups   =     20311

R-sq:  within  = 0.0412                         Obs per group: min =         1
       between = 0.1239                                        avg =      11.9
       overall = 0.0786                                        max =        25

                                                F(106,4618)        =      7.67
corr(u_i, Xb)  = 0.1343                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,619 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0283032   .0088618    -3.19   0.001    -.0456766   -.0109298
   expat_m_2 |  -.0211612   .0082638    -2.56   0.010    -.0373623   -.0049601
   expat_m_3 |  -.0111994   .0075577    -1.48   0.138    -.0260162    .0036173
   expat_m_4 |  -.0098694   .0068287    -1.45   0.148    -.0232568     .003518
domestic_m_1 |   -.046472   .0088014    -5.28   0.000    -.0637269   -.0292171
domestic_m_2 |  -.0309001   .0077625    -3.98   0.000    -.0461183   -.0156819
domestic_m_3 |  -.0203346    .006988    -2.91   0.004    -.0340345   -.0066347
domestic_m_4 |  -.0158656   .0062088    -2.56   0.011    -.0280377   -.0036935
 foreign_m_1 |   .0087735   .0177204     0.50   0.621     -.025967    .0435139
 foreign_m_2 |   .0036771   .0169216     0.22   0.828    -.0294972    .0368515
 foreign_m_3 |   .0096733   .0161208     0.60   0.549    -.0219311    .0412777
 foreign_m_4 |   .0003275   .0147763     0.02   0.982    -.0286411    .0292962
   expat_p_0 |  -.0351688    .009651    -3.64   0.000    -.0540893   -.0162483
   expat_p_1 |  -.0417514   .0106923    -3.90   0.000    -.0627135   -.0207893
   expat_p_2 |  -.0500887   .0120802    -4.15   0.000    -.0737716   -.0264058
   expat_p_3 |   -.048033    .013179    -3.64   0.000      -.07387   -.0221959
   expat_p_4 |  -.0485395   .0147979    -3.28   0.001    -.0775505   -.0195285
   expat_p_5 |  -.0692486   .0171225    -4.04   0.000    -.1028169   -.0356802
   expat_p_6 |  -.0810859   .0196328    -4.13   0.000    -.1195756   -.0425963
domestic_p_0 |   -.052813   .0095373    -5.54   0.000    -.0715107   -.0341153
domestic_p_1 |  -.0662244   .0107874    -6.14   0.000    -.0873728   -.0450759
domestic_p_2 |   -.073873   .0121764    -6.07   0.000    -.0977446   -.0500014
domestic_p_3 |  -.0853475   .0141344    -6.04   0.000    -.1130576   -.0576374
domestic_p_4 |  -.0888484   .0151874    -5.85   0.000    -.1186231   -.0590738
domestic_p_5 |  -.0860185   .0169395    -5.08   0.000    -.1192281   -.0528089
domestic_p_6 |  -.1024585   .0201155    -5.09   0.000    -.1418944   -.0630225
 foreign_p_0 |   .0376989   .0184076     2.05   0.041     .0016113    .0737865
 foreign_p_1 |   .0642979   .0199542     3.22   0.001     .0251781    .1034177
 foreign_p_2 |   .0579818   .0215794     2.69   0.007     .0156759    .1002878
 foreign_p_3 |   .0515764   .0229714     2.25   0.025     .0065414    .0966115
 foreign_p_4 |   .0549477   .0244899     2.24   0.025     .0069359    .1029595
 foreign_p_5 |   .0584647   .0259723     2.25   0.024     .0075466    .1093828
 foreign_p_6 |    .052439   .0283547     1.85   0.064    -.0031498    .1080278
             |
    ind_year |
          2  |  -.0062558   .0161412    -0.39   0.698    -.0379004    .0253887
          3  |  -.0410583   .0182992    -2.24   0.025    -.0769334   -.0051832
          4  |  -.0616848   .0203696    -3.03   0.002     -.101619   -.0217506
          5  |  -.0461626   .0216684    -2.13   0.033    -.0886431   -.0036822
          6  |   -.064815   .0233888    -2.77   0.006    -.1106682   -.0189618
          7  |  -.0466833   .0253112    -1.84   0.065    -.0963053    .0029387
          8  |  -.0630312   .0278207    -2.27   0.024    -.1175731   -.0084893
          9  |  -.0625012   .0299024    -2.09   0.037    -.1211241   -.0038783
         10  |  -.0564937   .0323262    -1.75   0.081    -.1198686    .0068812
         11  |  -.0696736   .0349594    -1.99   0.046    -.1382108   -.0011364
         12  |  -.0636335   .0370955    -1.72   0.086    -.1363584    .0090915
         13  |  -.0439035   .0397019    -1.11   0.269    -.1217382    .0339311
         14  |  -.0188551   .0421393    -0.45   0.655    -.1014684    .0637581
         15  |  -.0077416   .0444028    -0.17   0.862    -.0947923    .0793092
         16  |   .0077502   .0474147     0.16   0.870    -.0852053    .1007056
         17  |   .0168373   .0502846     0.33   0.738    -.0817445    .1154191
         18  |   .0304302   .0531212     0.57   0.567    -.0737128    .1345733
         19  |   .0426052   .0559104     0.76   0.446    -.0670059    .1522164
         20  |   .0720645   .0587284     1.23   0.220    -.0430712    .1872002
         21  |   .0871402   .0611174     1.43   0.154    -.0326791    .2069595
         22  |   .1020746   .0638164     1.60   0.110     -.023036    .2271852
         23  |   .0948702   .0659453     1.44   0.150    -.0344142    .2241546
         24  |   .0167971   .0688896     0.24   0.807    -.1182595    .1518536
         25  |  -.0040425   .0719869    -0.06   0.955    -.1451712    .1370862
         26  |    .106621   .0270375     3.94   0.000     .0536146    .1596275
         27  |   .0662144    .026445     2.50   0.012     .0143696    .1180592
         28  |   .0770713   .0261996     2.94   0.003     .0257075    .1284351
         29  |   .0742418   .0265457     2.80   0.005     .0221995    .1262841
         30  |   .0735085   .0271368     2.71   0.007     .0203075    .1267096
         31  |   .0650769   .0283565     2.29   0.022     .0094846    .1206692
         32  |   .0540465   .0300927     1.80   0.073    -.0049495    .1130426
         33  |     .05705   .0313644     1.82   0.069    -.0044392    .1185392
         34  |   .0466646   .0333573     1.40   0.162    -.0187316    .1120608
         35  |   .0423789   .0352961     1.20   0.230    -.0268182    .1115761
         36  |   .0347062   .0373773     0.93   0.353    -.0385712    .1079836
         37  |   .0447319   .0393654     1.14   0.256    -.0324431    .1219069
         38  |   .0585128   .0415896     1.41   0.160    -.0230228    .1400483
         39  |   .0638522    .043958     1.45   0.146    -.0223266     .150031
         40  |    .048901    .046348     1.06   0.291    -.0419632    .1397652
         41  |   .0634823   .0489089     1.30   0.194    -.0324026    .1593671
         42  |   .0707119   .0515431     1.37   0.170    -.0303373     .171761
         43  |   .0748304   .0543211     1.38   0.168    -.0316649    .1813257
         44  |   .0724773   .0572605     1.27   0.206    -.0397807    .1847353
         45  |   .0865792     .05969     1.45   0.147    -.0304419    .2036002
         46  |   .1062036   .0623127     1.70   0.088    -.0159591    .2283662
         47  |   .1031111   .0648582     1.59   0.112     -.024042    .2302642
         48  |   .1008895   .0673488     1.50   0.134    -.0311463    .2329254
         49  |  -.0377253   .0701162    -0.54   0.591    -.1751866     .099736
         50  |  -.0770839   .0725938    -1.06   0.288    -.2194025    .0652347
             |
     age_cat |
          1  |    .073013   .0111329     6.56   0.000     .0511872    .0948387
          2  |   .1027305   .0134771     7.62   0.000     .0763089    .1291522
          3  |   .1366992   .0157578     8.68   0.000     .1058064     .167592
          4  |   .1656223   .0181012     9.15   0.000     .1301353    .2011093
          5  |   .1739316   .0204336     8.51   0.000     .1338719    .2139912
          6  |   .1803689   .0229046     7.87   0.000     .1354648    .2252729
          7  |   .1930598   .0254897     7.57   0.000     .1430877    .2430318
          8  |   .1954419   .0279128     7.00   0.000     .1407195    .2501642
          9  |   .2043949    .030344     6.74   0.000     .1449062    .2638836
         10  |   .2111182   .0330134     6.39   0.000      .146396    .2758403
         11  |   .2118844   .0353688     5.99   0.000     .1425447    .2812241
         12  |   .2155141   .0378344     5.70   0.000     .1413406    .2896876
         13  |   .2134971   .0402125     5.31   0.000     .1346614    .2923328
         14  |   .2235216   .0430106     5.20   0.000     .1392003     .307843
         15  |   .2309438   .0455108     5.07   0.000     .1417208    .3201667
         16  |   .2387052   .0483105     4.94   0.000     .1439935    .3334169
         17  |   .2359322    .051152     4.61   0.000     .1356498    .3362145
         18  |   .2285386   .0538278     4.25   0.000     .1230103    .3340668
         19  |   .2314194   .0569374     4.06   0.000     .1197948     .343044
         20  |   .2117628   .0618085     3.43   0.001     .0905886     .332937
         25  |   .2462228   .0729549     3.37   0.001     .1031963    .3892494
         30  |   .2196527   .1066767     2.06   0.040     .0105154    .4287901
         40  |   .2919244   .1215201     2.40   0.016     .0536869    .5301618
         50  |   .2704462   .1442997     1.87   0.061    -.0124501    .5533426
             |
       _cons |   .4692619   .0243127    19.30   0.000     .4215974    .5169264
-------------+----------------------------------------------------------------
     sigma_u |  .35783211
     sigma_e |  .28664605
         rho |    .609124   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/exporter_event_study.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    201690
Group variable: firm_person                     Number of groups   =     19488

R-sq:  within  = 0.0379                         Obs per group: min =         1
       between = 0.0078                                        avg =      10.3
       overall = 0.0240                                        max =        24

                                                F(103,4410)        =     18.96
corr(u_i, Xb)  = -0.1703                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,411 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         inv |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
   expat_m_1 |  -.0812095   .0211282    -3.84   0.000    -.1226314   -.0397877
   expat_m_2 |  -.0472804   .0204978    -2.31   0.021    -.0874664   -.0070944
   expat_m_3 |  -.0690775   .0196378    -3.52   0.000    -.1075774   -.0305776
   expat_m_4 |  -.0537159   .0198451    -2.71   0.007    -.0926222   -.0148095
domestic_m_1 |  -.0597423   .0206159    -2.90   0.004    -.1001597   -.0193248
domestic_m_2 |  -.0425105   .0196443    -2.16   0.031    -.0810232   -.0039978
domestic_m_3 |  -.0306686   .0188881    -1.62   0.105    -.0676988    .0063616
domestic_m_4 |   .0074076   .0190227     0.39   0.697    -.0298864    .0447016
 foreign_m_1 |  -.0406953   .0403259    -1.01   0.313    -.1197542    .0383636
 foreign_m_2 |  -.0486789   .0399943    -1.22   0.224    -.1270878      .02973
 foreign_m_3 |  -.0967602   .0417478    -2.32   0.021    -.1786069   -.0149136
 foreign_m_4 |  -.0320254   .0427449    -0.75   0.454    -.1158268     .051776
   expat_p_0 |  -.0932701   .0224803    -4.15   0.000    -.1373427   -.0491975
   expat_p_1 |  -.0777738    .025167    -3.09   0.002    -.1271138   -.0284338
   expat_p_2 |  -.1108397   .0280748    -3.95   0.000    -.1658804   -.0557991
   expat_p_3 |  -.0874667   .0321955    -2.72   0.007    -.1505861   -.0243472
   expat_p_4 |  -.1079184   .0357952    -3.01   0.003     -.178095   -.0377418
   expat_p_5 |  -.0728913   .0445757    -1.64   0.102     -.160282    .0144995
   expat_p_6 |  -.0858586   .0477523    -1.80   0.072     -.179477    .0077598
domestic_p_0 |  -.0669843   .0218336    -3.07   0.002     -.109789   -.0241795
domestic_p_1 |  -.0784178   .0241914    -3.24   0.001    -.1258451   -.0309904
domestic_p_2 |  -.0594071   .0277481    -2.14   0.032    -.1138073   -.0050069
domestic_p_3 |  -.0821208   .0311675    -2.63   0.008    -.1432249   -.0210168
domestic_p_4 |  -.0636098    .035015    -1.82   0.069    -.1322568    .0050373
domestic_p_5 |  -.0923317   .0407129    -2.27   0.023    -.1721495    -.012514
domestic_p_6 |  -.1431924   .0391549    -3.66   0.000    -.2199556   -.0664291
 foreign_p_0 |   .0102554   .0402626     0.25   0.799    -.0686795    .0891902
 foreign_p_1 |   .0670132   .0359596     1.86   0.062    -.0034857    .1375122
 foreign_p_2 |  -.0119721   .0374004    -0.32   0.749    -.0852957    .0613515
 foreign_p_3 |  -.0350948   .0400186    -0.88   0.381    -.1135513    .0433617
 foreign_p_4 |  -.0491206   .0417163    -1.18   0.239    -.1309054    .0326643
 foreign_p_5 |  -.0864705   .0445345    -1.94   0.052    -.1737804    .0008395
 foreign_p_6 |  -.0863778   .0482962    -1.79   0.074    -.1810626    .0083071
             |
    ind_year |
          3  |  -.0865431   .0505561    -1.71   0.087    -.1856584    .0125722
          4  |   .0233464    .049678     0.47   0.638    -.0740473    .1207401
          5  |  -.0151546   .0511203    -0.30   0.767    -.1153761    .0850669
          6  |  -.0935325   .0547969    -1.71   0.088    -.2009619    .0138968
          7  |   .0318827   .0561473     0.57   0.570    -.0781942    .1419597
          8  |  -.0964126   .0598559    -1.61   0.107    -.2137602    .0209351
          9  |  -.0950856   .0648011    -1.47   0.142    -.2221283    .0319572
         10  |  -.1142064   .0670455    -1.70   0.089    -.2456493    .0172365
         11  |  -.1548042   .0718814    -2.15   0.031    -.2957278   -.0138806
         12  |   -.145671   .0760619    -1.92   0.056    -.2947905    .0034484
         13  |  -.2004673   .0810022    -2.47   0.013    -.3592724   -.0416623
         14  |  -.2741575    .085474    -3.21   0.001    -.4417295   -.1065854
         15  |  -.1470505   .0905064    -1.62   0.104    -.3244884    .0303875
         16  |  -.1785215   .0956021    -1.87   0.062    -.3659497    .0089066
         17  |  -.2212698   .1012214    -2.19   0.029    -.4197145    -.022825
         18  |   -.223106   .1060955    -2.10   0.036    -.4311064   -.0151056
         19  |  -.2305793   .1114313    -2.07   0.039    -.4490407    -.012118
         20  |  -.1237911   .1168299    -1.06   0.289    -.3528365    .1052542
         21  |   -.255864   .1217486    -2.10   0.036    -.4945525   -.0171756
         22  |   .0169732   .1260101     0.13   0.893    -.2300697    .2640162
         23  |   -.342456   .1318853    -2.60   0.009    -.6010173   -.0838947
         24  |  -.5106222   .1409846    -3.62   0.000    -.7870228   -.2342215
         25  |  -.3124541   .1510855    -2.07   0.039    -.6086576   -.0162506
         27  |  -.1169833   .0648929    -1.80   0.072     -.244206    .0102394
         28  |  -.4094336   .0617144    -6.63   0.000    -.5304247   -.2884424
         29  |  -.1510688    .061428    -2.46   0.014    -.2714986   -.0306391
         30  |  -.2627559   .0620194    -4.24   0.000    -.3843449   -.1411668
         31  |   -.172154   .0636451    -2.70   0.007    -.2969304   -.0473776
         32  |  -.2882658   .0657749    -4.38   0.000    -.4172175    -.159314
         33  |  -.1411501   .0673638    -2.10   0.036    -.2732168   -.0090833
         34  |  -.2564627   .0707301    -3.63   0.000    -.3951292   -.1177962
         35  |  -.2417932   .0743078    -3.25   0.001    -.3874737   -.0961126
         36  |  -.3152409   .0781842    -4.03   0.000    -.4685213   -.1619606
         37  |  -.3123863   .0825893    -3.78   0.000    -.4743028   -.1504697
         38  |  -.2744501    .085788    -3.20   0.001    -.4426376   -.1062626
         39  |   -.362421   .0901331    -4.02   0.000    -.5391272   -.1857149
         40  |  -.2554742   .0956078    -2.67   0.008    -.4429136   -.0680349
         41  |  -.3010748   .1007407    -2.99   0.003    -.4985772   -.1035724
         42  |  -.3391448   .1052172    -3.22   0.001    -.5454233   -.1328664
         43  |  -.1915229   .1101022    -1.74   0.082    -.4073786    .0243327
         44  |  -.2377395   .1153507    -2.06   0.039    -.4638847   -.0115943
         45  |  -.4134991   .1207751    -3.42   0.001     -.650279   -.1767192
         46  |  -.2557018    .125627    -2.04   0.042    -.5019938   -.0094099
         47  |  -.0494986   .1306028    -0.38   0.705    -.3055456    .2065485
         48  |  -.4332686   .1352074    -3.20   0.001     -.698343   -.1681942
         49  |  -.9016516   .1383604    -6.52   0.000    -1.172907   -.6303958
         50  |  -.4000471   .1523197    -2.63   0.009    -.6986703    -.101424
             |
     age_cat |
          2  |  -.1263606   .0332099    -3.80   0.000    -.1914687   -.0612525
          3  |  -.2472919   .0360769    -6.85   0.000    -.3180206   -.1765631
          4  |  -.2813095   .0391289    -7.19   0.000    -.3580217   -.2045973
          5  |  -.3028565   .0435035    -6.96   0.000    -.3881453   -.2175678
          6  |  -.2929826   .0472231    -6.20   0.000    -.3855636   -.2004017
          7  |  -.3123421   .0514239    -6.07   0.000    -.4131588   -.2115254
          8  |  -.2928058   .0556827    -5.26   0.000    -.4019719   -.1836397
          9  |  -.3040254   .0607954    -5.00   0.000    -.4232148   -.1848359
         10  |  -.3223531   .0653014    -4.94   0.000    -.4503765   -.1943296
         11  |  -.2926599   .0701466    -4.17   0.000    -.4301824   -.1551374
         12  |  -.2601131    .075741    -3.43   0.001    -.4086036   -.1116227
         13  |  -.2910145   .0805643    -3.61   0.000    -.4489609   -.1330682
         14  |  -.2684387    .085494    -3.14   0.002    -.4360498   -.1008276
         15  |  -.3198296    .091176    -3.51   0.000    -.4985804   -.1410787
         16  |  -.2852283   .0959892    -2.97   0.003    -.4734152   -.0970414
         17  |  -.2516531   .1015869    -2.48   0.013    -.4508143   -.0524918
         18  |  -.2905913   .1077644    -2.70   0.007    -.5018636    -.079319
         19  |   -.252819   .1143643    -2.21   0.027    -.4770305   -.0286076
         20  |  -.2293725   .1247532    -1.84   0.066    -.4739514    .0152064
         25  |  -.2173068    .151097    -1.44   0.150    -.5135328    .0789192
         30  |  -.0192074   .2162985    -0.09   0.929     -.443261    .4048462
         40  |   .0198045   .2704958     0.07   0.942    -.5105032    .5501121
         50  |   .1513782    .335707     0.45   0.652     -.506776    .8095323
             |
       _cons |   .4617953    .057231     8.07   0.000     .3495938    .5739969
-------------+----------------------------------------------------------------
     sigma_u |  .41592341
     sigma_e |  .86006289
         rho |  .18953894   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 11
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(11 missing values generated)
(11 missing values generated)
(11 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/inv_event_study.png written in PNG format)

. 
. 
. 
. log close
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/estimate.log
  log type:  text
 closed on:  28 Nov 2018, 17:01:31
--------------------------------------------------------------------------------------------------------------------------------
