----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/
> estimate.log
  log type:  text
 opened on:  30 Nov 2018, 21:53:26

. 
. use temp/analysis_sample

. 
. *Dinamika
. scalar Tbefore = 4

. scalar Tduring = 6

. scalar Tafter = 4

. 
. gen byte analysis_window = (tenure>=-Tbefore-1)&(year-first_exit_year<=Tafter)

. 
. local sample_baseline (analysis_window==1)

. local sample_manufacturing `sample_baseline' & (manufacturing==1)

. local sample_acquisitions `sample_baseline' & (greenfield==0)

. 
. local samples baseline manufacturing acquisitions

. 
. local outcomes lnL lnKL lnQL exporter

. label var lnL "Employment (log)"

. label var lnKL "Capital per worker (log)"

. label var lnQL "Revenue per worker (log)"

. label var exporter "Firm is an exporter (dummy)"

. 
. egen person_tag = tag(frame_id manager_id)

. egen N = sum(person_tag), by(frame_id)

. gen inverse_weight = 1/N

. 
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. foreach X of var `outcomes' {
  2.         foreach sample in `samples' {
  3.                 xtreg `X' foreign during after during_expat after_expat i.ind
> _year i.age_cat if `sample_`sample'' [aw=inverse_weight], i(firm_person ) fe vce
> (cluster id)
  4.                 local r2_w = `e(r2_w)'
  5.                 do regram output/regression/`sample' `X' `X' R2_within "`r2_w
> '"
  6. 
.                 local fname = e(depvar)
  7.                 local title : variable label `fname'
  8. 
.                 slopegraph, ///
>                         from(0 0 1 _b[during] 0 0 1 _b[during]+_b[during_expat])
>  ///
>                         to(1 _b[during] 2 _b[after] 1 _b[during]+_b[during_expat
> ] 2 _b[after]+_b[after_expat]) ///
>                         style(p1 p1 p2 p2) ///
>                         label("Local-during" "Local-after" "Expat-during" "Expat
> -after" ) ///
>                         width_test(during after==during during_expat after_expat
> ==during_expat) ///
>                         star_test(1==1 1==1 during_expat after_expat) ///
>                         format(scheme(538w) xlabel(none) xtitle("") ytitle(`titl
> e') legend(off) aspect(0.67))
  9. 
.                 graph export output/figure/`sample'_`fname'_slope.png, width(800
> ) replace
 10.         }
 11.         xtreg `X' foreign during_?? after_?? i.ind_year i.age_cat if `sample_
> acquisitions' [aw=inverse_weight], i(firm_person ) fe vce(cluster id)
 12.         local r2_w = `e(r2_w)'
 13.         do regram output/regression/acquisitions_change `X' `X' R2_within "`r
> 2_w'"
 14.         do tree_graph
 15. 
.         foreach Y in `outcomes' {
 16.                 xtreg `X' foreign during after during_expat after_expat i.ind
> _year i.age_cat if `sample_acquisitions' & high_`Y' [aw=inverse_weight], i(firm_
> person ) fe vce(cluster id)
 17.                 local r2_w = `e(r2_w)'
 18.                 do regram output/regression/high_`Y' `X' `X' R2_within "`r2_w
> '"
 19.         }
 20. }

Fixed-effects (within) regression               Number of obs      =    382405
Group variable: firm_person                     Number of groups   =     40681

R-sq:  within  = 0.1068                         Obs per group: min =         1
       between = 0.0262                                        avg =       9.4
       overall = 0.0400                                        max =        25

                                                F(78,14145)        =     40.85
corr(u_i, Xb)  = -0.2504                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,146 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0151085   .0305628     0.49   0.621    -.0447986    .0750156
      during |  -.0707295   .0098558    -7.18   0.000    -.0900482   -.0514109
       after |  -.2264645   .0177571   -12.75   0.000    -.2612708   -.1916582
during_expat |   .0487878   .0194233     2.51   0.012     .0107156    .0868601
 after_expat |   .1518387   .0271427     5.59   0.000     .0986356    .2050419
             |
    ind_year |
          2  |  -.0766751   .0313711    -2.44   0.015    -.1381666   -.0151836
          3  |  -.2338695   .0401662    -5.82   0.000    -.3126006   -.1551385
          4  |  -.3347047    .044954    -7.45   0.000    -.4228203    -.246589
          5  |   -.420185   .0498829    -8.42   0.000    -.5179621   -.3224079
          6  |  -.5035214   .0535103    -9.41   0.000    -.6084086   -.3986343
          7  |  -.5724443   .0569103   -10.06   0.000     -.683996   -.4608927
          8  |  -.5952618   .0605322    -9.83   0.000    -.7139128   -.4766107
          9  |  -.6461529   .0640774   -10.08   0.000    -.7717531   -.5205526
         10  |  -.6906713   .0674041   -10.25   0.000    -.8227922   -.5585503
         11  |  -.7593403   .0706569   -10.75   0.000    -.8978371   -.6208435
         12  |  -.8014804   .0740273   -10.83   0.000    -.9465836   -.6563772
         13  |  -.8501809   .0776805   -10.94   0.000    -1.002445   -.6979169
         14  |  -.8916426   .0812693   -10.97   0.000    -1.050941    -.732344
         15  |    -.93049   .0847623   -10.98   0.000    -1.096635   -.7643447
         16  |  -.9698984   .0879683   -11.03   0.000    -1.142328   -.7974689
         17  |  -1.016154   .0913376   -11.13   0.000    -1.195188   -.8371201
         18  |  -1.101941   .0944932   -11.66   0.000     -1.28716   -.9167215
         19  |  -1.168881   .0977536   -11.96   0.000    -1.360491   -.9772716
         20  |  -1.220481   .1006529   -12.13   0.000    -1.417774   -1.023188
         21  |  -1.288096    .103419   -12.46   0.000    -1.490811   -1.085381
         22  |  -1.338689   .1060541   -12.62   0.000    -1.546569   -1.130809
         23  |  -1.358716   .1086291   -12.51   0.000    -1.571643   -1.145788
         24  |  -1.395076   .1118028   -12.48   0.000    -1.614224   -1.175928
         25  |  -1.395188   .1150431   -12.13   0.000    -1.620687   -1.169688
         26  |    .913535   .0805645    11.34   0.000     .7556179    1.071452
         27  |   .6534787    .075985     8.60   0.000      .504538    .8024193
         28  |   .5056183    .073094     6.92   0.000     .3623444    .6488921
         29  |   .3512991   .0719739     4.88   0.000     .2102206    .4923775
         30  |   .2746468   .0707079     3.88   0.000       .13605    .4132436
         31  |   .1946869   .0722388     2.70   0.007     .0530894    .3362845
         32  |   .1226618   .0726227     1.69   0.091    -.0196883    .2650119
         33  |   .0556078   .0737674     0.75   0.451     -.088986    .2002017
         34  |  -.0093149   .0755626    -0.12   0.902    -.1574276    .1387978
         35  |  -.0713087   .0779574    -0.91   0.360    -.2241154    .0814981
         36  |  -.1713245   .0802671    -2.13   0.033    -.3286586   -.0139904
         37  |  -.2422785   .0826347    -2.93   0.003    -.4042533   -.0803037
         38  |  -.3406265   .0853181    -3.99   0.000    -.5078611   -.1733918
         39  |  -.4126478   .0883777    -4.67   0.000    -.5858796   -.2394159
         40  |  -.4515056   .0914868    -4.94   0.000    -.6308317   -.2721795
         41  |  -.4817919   .0941453    -5.12   0.000    -.6663292   -.2972547
         42  |  -.5343852   .0972582    -5.49   0.000    -.7250241   -.3437462
         43  |  -.6763369   .1003509    -6.74   0.000    -.8730379    -.479636
         44  |  -.7419825   .1038878    -7.14   0.000    -.9456163   -.5383487
         45  |  -.7524455   .1067466    -7.05   0.000    -.9616828   -.5432081
         46  |  -.7861784   .1097887    -7.16   0.000    -1.001379    -.570978
         47  |  -.8167148   .1123396    -7.27   0.000    -1.036915   -.5965145
         48  |   -.836071    .115041    -7.27   0.000    -1.061567   -.6105755
         49  |  -.8404264   .1179807    -7.12   0.000    -1.071684   -.6091687
         50  |   -.859585   .1207139    -7.12   0.000      -1.0962   -.6229699
             |
     age_cat |
          1  |   .4664904    .026236    17.78   0.000     .4150645    .5179163
          2  |   .8449493   .0296497    28.50   0.000     .7868319    .9030667
          3  |   1.103861   .0327126    33.74   0.000      1.03974    1.167982
          4  |    1.31792   .0360318    36.58   0.000     1.247293    1.388547
          5  |   1.497255   .0393556    38.04   0.000     1.420113    1.574397
          6  |   1.635951   .0427225    38.29   0.000     1.552209    1.719693
          7  |    1.74918   .0461155    37.93   0.000     1.658787    1.839572
          8  |   1.852617   .0497347    37.25   0.000      1.75513    1.950103
          9  |   1.942479   .0533294    36.42   0.000     1.837947    2.047012
         10  |   2.008138   .0569813    35.24   0.000     1.896447    2.119828
         11  |   2.087628   .0605994    34.45   0.000     1.968845    2.206411
         12  |   2.151253   .0641423    33.54   0.000     2.025526     2.27698
         13  |   2.221164   .0678235    32.75   0.000     2.088221    2.354107
         14  |   2.268129   .0715314    31.71   0.000     2.127918    2.408339
         15  |   2.314198   .0752846    30.74   0.000     2.166631    2.461766
         16  |   2.356281   .0790915    29.79   0.000     2.201251    2.511311
         17  |   2.401081   .0829375    28.95   0.000     2.238512    2.563649
         18  |   2.449046   .0864393    28.33   0.000     2.279613    2.618478
         19  |   2.491031   .0901361    27.64   0.000     2.314353     2.66771
         20  |   2.553907   .0967698    26.39   0.000     2.364225    2.743589
         25  |   2.636457   .1083039    24.34   0.000     2.424167    2.848747
         30  |   2.461748   .1398512    17.60   0.000     2.187621    2.735874
         40  |    2.34721   .1595649    14.71   0.000     2.034442    2.659978
         50  |   2.286009   .1593922    14.34   0.000     1.973579    2.598438
             |
       _cons |   2.657794   .0575697    46.17   0.000      2.54495    2.770638
-------------+----------------------------------------------------------------
     sigma_u |  1.2224139
     sigma_e |  .66695845
         rho |  .77060139   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1068084804471486

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    382,405
Group variable: firm_person                     Number of groups  =     40,681

R-sq:                                           Obs per group:
     within  = 0.1068                                         min =          1
     between = 0.0262                                         avg =        9.4
     overall = 0.0400                                         max =         25

                                                F(78,14145)       =      40.85
corr(u_i, Xb)  = -0.2504                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,146 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0151085   .0305628     0.49   0.621    -.0447986    .0750156
      during |  -.0707295   .0098558    -7.18   0.000    -.0900482   -.0514109
       after |  -.2264645   .0177571   -12.75   0.000    -.2612708   -.1916582
during_expat |   .0487878   .0194233     2.51   0.012     .0107156    .0868601
 after_expat |   .1518387   .0271427     5.59   0.000     .0986356    .2050419
             |
    ind_year |
          2  |  -.0766751   .0313711    -2.44   0.015    -.1381666   -.0151836
          3  |  -.2338695   .0401662    -5.82   0.000    -.3126006   -.1551385
          4  |  -.3347047    .044954    -7.45   0.000    -.4228203    -.246589
          5  |   -.420185   .0498829    -8.42   0.000    -.5179621   -.3224079
          6  |  -.5035214   .0535103    -9.41   0.000    -.6084086   -.3986343
          7  |  -.5724443   .0569103   -10.06   0.000     -.683996   -.4608927
          8  |  -.5952618   .0605322    -9.83   0.000    -.7139128   -.4766107
          9  |  -.6461529   .0640774   -10.08   0.000    -.7717531   -.5205526
         10  |  -.6906713   .0674041   -10.25   0.000    -.8227922   -.5585503
         11  |  -.7593403   .0706569   -10.75   0.000    -.8978371   -.6208435
         12  |  -.8014804   .0740273   -10.83   0.000    -.9465836   -.6563772
         13  |  -.8501809   .0776805   -10.94   0.000    -1.002445   -.6979169
         14  |  -.8916426   .0812693   -10.97   0.000    -1.050941    -.732344
         15  |    -.93049   .0847623   -10.98   0.000    -1.096635   -.7643447
         16  |  -.9698984   .0879683   -11.03   0.000    -1.142328   -.7974689
         17  |  -1.016154   .0913376   -11.13   0.000    -1.195188   -.8371201
         18  |  -1.101941   .0944932   -11.66   0.000     -1.28716   -.9167215
         19  |  -1.168881   .0977536   -11.96   0.000    -1.360491   -.9772716
         20  |  -1.220481   .1006529   -12.13   0.000    -1.417774   -1.023188
         21  |  -1.288096    .103419   -12.46   0.000    -1.490811   -1.085381
         22  |  -1.338689   .1060541   -12.62   0.000    -1.546569   -1.130809
         23  |  -1.358716   .1086291   -12.51   0.000    -1.571643   -1.145788
         24  |  -1.395076   .1118028   -12.48   0.000    -1.614224   -1.175928
         25  |  -1.395188   .1150431   -12.13   0.000    -1.620687   -1.169688
         26  |    .913535   .0805645    11.34   0.000     .7556179    1.071452
         27  |   .6534787    .075985     8.60   0.000      .504538    .8024193
         28  |   .5056183    .073094     6.92   0.000     .3623444    .6488921
         29  |   .3512991   .0719739     4.88   0.000     .2102206    .4923775
         30  |   .2746468   .0707079     3.88   0.000       .13605    .4132436
         31  |   .1946869   .0722388     2.70   0.007     .0530894    .3362845
         32  |   .1226618   .0726227     1.69   0.091    -.0196883    .2650119
         33  |   .0556078   .0737674     0.75   0.451     -.088986    .2002017
         34  |  -.0093149   .0755626    -0.12   0.902    -.1574276    .1387978
         35  |  -.0713087   .0779574    -0.91   0.360    -.2241154    .0814981
         36  |  -.1713245   .0802671    -2.13   0.033    -.3286586   -.0139904
         37  |  -.2422785   .0826347    -2.93   0.003    -.4042533   -.0803037
         38  |  -.3406265   .0853181    -3.99   0.000    -.5078611   -.1733918
         39  |  -.4126478   .0883777    -4.67   0.000    -.5858796   -.2394159
         40  |  -.4515056   .0914868    -4.94   0.000    -.6308317   -.2721795
         41  |  -.4817919   .0941453    -5.12   0.000    -.6663292   -.2972547
         42  |  -.5343852   .0972582    -5.49   0.000    -.7250241   -.3437462
         43  |  -.6763369   .1003509    -6.74   0.000    -.8730379    -.479636
         44  |  -.7419825   .1038878    -7.14   0.000    -.9456163   -.5383487
         45  |  -.7524455   .1067466    -7.05   0.000    -.9616828   -.5432081
         46  |  -.7861784   .1097887    -7.16   0.000    -1.001379    -.570978
         47  |  -.8167148   .1123396    -7.27   0.000    -1.036915   -.5965145
         48  |   -.836071    .115041    -7.27   0.000    -1.061567   -.6105755
         49  |  -.8404264   .1179807    -7.12   0.000    -1.071684   -.6091687
         50  |   -.859585   .1207139    -7.12   0.000      -1.0962   -.6229699
             |
     age_cat |
          1  |   .4664904    .026236    17.78   0.000     .4150645    .5179163
          2  |   .8449493   .0296497    28.50   0.000     .7868319    .9030667
          3  |   1.103861   .0327126    33.74   0.000      1.03974    1.167982
          4  |    1.31792   .0360318    36.58   0.000     1.247293    1.388547
          5  |   1.497255   .0393556    38.04   0.000     1.420113    1.574397
          6  |   1.635951   .0427225    38.29   0.000     1.552209    1.719693
          7  |    1.74918   .0461155    37.93   0.000     1.658787    1.839572
          8  |   1.852617   .0497347    37.25   0.000      1.75513    1.950103
          9  |   1.942479   .0533294    36.42   0.000     1.837947    2.047012
         10  |   2.008138   .0569813    35.24   0.000     1.896447    2.119828
         11  |   2.087628   .0605994    34.45   0.000     1.968845    2.206411
         12  |   2.151253   .0641423    33.54   0.000     2.025526     2.27698
         13  |   2.221164   .0678235    32.75   0.000     2.088221    2.354107
         14  |   2.268129   .0715314    31.71   0.000     2.127918    2.408339
         15  |   2.314198   .0752846    30.74   0.000     2.166631    2.461766
         16  |   2.356281   .0790915    29.79   0.000     2.201251    2.511311
         17  |   2.401081   .0829375    28.95   0.000     2.238512    2.563649
         18  |   2.449046   .0864393    28.33   0.000     2.279613    2.618478
         19  |   2.491031   .0901361    27.64   0.000     2.314353     2.66771
         20  |   2.553907   .0967698    26.39   0.000     2.364225    2.743589
         25  |   2.636457   .1083039    24.34   0.000     2.424167    2.848747
         30  |   2.461748   .1398512    17.60   0.000     2.187621    2.735874
         40  |    2.34721   .1595649    14.71   0.000     2.034442    2.659978
         50  |   2.286009   .1593922    14.34   0.000     1.973579    2.598438
             |
       _cons |   2.657794   .0575697    46.17   0.000      2.54495    2.770638
-------------+----------------------------------------------------------------
     sigma_u |  1.2224139
     sigma_e |  .66695845
         rho |  .77060139   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1, 14145) =   51.50
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14145) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1, 14145) =  157.96
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14145) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1, 14145) =    6.31
            Prob > F =    0.0120

 ( 1)  during_expat = 0

       F(  1, 14145) =    6.31
            Prob > F =    0.0120
variable label was str12 now str14
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1, 14145) =   27.42
            Prob > F =    0.0000

 ( 1)  after_expat = 0

       F(  1, 14145) =   31.29
            Prob > F =    0.0000
(1 real change made)
(file output/figure/baseline_lnL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    127139
Group variable: firm_person                     Number of groups   =     14598

R-sq:  within  = 0.0833                         Obs per group: min =         1
       between = 0.0100                                        avg =       8.7
       overall = 0.0128                                        max =        25

                                                F(53,5219)         =     18.53
corr(u_i, Xb)  = -0.2338                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,220 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0154137   .0448717     0.34   0.731    -.0725535     .103381
      during |  -.0858438   .0154141    -5.57   0.000    -.1160618   -.0556257
       after |  -.2434183    .028805    -8.45   0.000    -.2998881   -.1869485
during_expat |    .035444   .0248084     1.43   0.153    -.0131909     .084079
 after_expat |   .1287883   .0383021     3.36   0.001     .0537001    .2038766
             |
    ind_year |
         27  |  -.2180208   .0321676    -6.78   0.000    -.2810827   -.1549588
         28  |  -.3303966    .041719    -7.92   0.000    -.4121833   -.2486099
         29  |  -.4759378   .0498523    -9.55   0.000    -.5736693   -.3782064
         30  |   -.518407    .055526    -9.34   0.000    -.6272613   -.4095528
         31  |  -.5845659   .0633713    -9.22   0.000    -.7088002   -.4603317
         32  |  -.6456943   .0701001    -9.21   0.000    -.7831198   -.5082687
         33  |  -.7039836   .0764667    -9.21   0.000    -.8538903   -.5540769
         34  |  -.7686769   .0833448    -9.22   0.000    -.9320677   -.6052862
         35  |  -.8346916   .0901118    -9.26   0.000    -1.011348   -.6580348
         36  |  -.9296415   .0961877    -9.66   0.000     -1.11821   -.7410733
         37  |  -.9943229   .1027077    -9.68   0.000    -1.195673   -.7929729
         38  |  -1.090857   .1098244    -9.93   0.000    -1.306159   -.8755554
         39  |  -1.171849   .1167338   -10.04   0.000    -1.400696   -.9430018
         40  |  -1.208421   .1237703    -9.76   0.000    -1.451063   -.9657798
         41  |  -1.231598    .130128    -9.46   0.000    -1.486703   -.9764925
         42  |  -1.285161   .1365518    -9.41   0.000    -1.552859   -1.017462
         43  |  -1.440109    .142987   -10.07   0.000    -1.720424   -1.159795
         44  |  -1.504424   .1498829   -10.04   0.000    -1.798258   -1.210591
         45  |  -1.512496   .1557249    -9.71   0.000    -1.817782    -1.20721
         46  |  -1.545349   .1616695    -9.56   0.000    -1.862289   -1.228409
         47  |   -1.56762   .1669766    -9.39   0.000    -1.894964   -1.240276
         48  |  -1.582986   .1726128    -9.17   0.000    -1.921379   -1.244593
         49  |   -1.57732    .178436    -8.84   0.000    -1.927129    -1.22751
         50  |  -1.590654   .1836493    -8.66   0.000    -1.950683   -1.230624
             |
     age_cat |
          1  |   .5021922   .0445498    11.27   0.000     .4148559    .5895285
          2  |   .8501052   .0508734    16.71   0.000      .750372    .9498385
          3  |   1.084401   .0563118    19.26   0.000      .974006    1.194796
          4  |   1.254266    .061335    20.45   0.000     1.134023    1.374508
          5  |   1.398463   .0671246    20.83   0.000      1.26687    1.530055
          6  |    1.53417   .0728681    21.05   0.000     1.391318    1.677022
          7  |   1.637011   .0785771    20.83   0.000     1.482967    1.791055
          8  |   1.733464   .0846551    20.48   0.000     1.567505    1.899424
          9  |   1.824041   .0906834    20.11   0.000     1.646264    2.001819
         10  |   1.891237   .0967729    19.54   0.000     1.701522    2.080953
         11  |   1.973084   .1029822    19.16   0.000     1.771196    2.174973
         12  |   2.019032   .1092165    18.49   0.000     1.804922    2.233142
         13  |    2.08476   .1157962    18.00   0.000     1.857751     2.31177
         14  |   2.136529   .1221776    17.49   0.000     1.897009    2.376048
         15  |   2.208729   .1287295    17.16   0.000     1.956365    2.461093
         16  |   2.255133   .1355824    16.63   0.000     1.989335    2.520931
         17  |   2.313481   .1422116    16.27   0.000     2.034687    2.592276
         18  |   2.349119   .1484451    15.82   0.000     2.058105    2.640134
         19  |   2.399962   .1546403    15.52   0.000     2.096802    2.703122
         20  |    2.47729   .1668303    14.85   0.000     2.150232    2.804347
         25  |   2.563443   .1874381    13.68   0.000     2.195986      2.9309
         30  |   2.591573   .2294901    11.29   0.000     2.141676     3.04147
         40  |   2.426751   .2650806     9.15   0.000     1.907082    2.946419
         50  |   2.305659   .2709795     8.51   0.000     1.774425    2.836892
             |
       _cons |   3.418059   .0650671    52.53   0.000       3.2905    3.545617
-------------+----------------------------------------------------------------
     sigma_u |  1.2486639
     sigma_e |  .56969703
         rho |   .8277051   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .083290781469625

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    127,139
Group variable: firm_person                     Number of groups  =     14,598

R-sq:                                           Obs per group:
     within  = 0.0833                                         min =          1
     between = 0.0100                                         avg =        8.7
     overall = 0.0128                                         max =         25

                                                F(53,5219)        =      18.53
corr(u_i, Xb)  = -0.2338                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,220 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0154137   .0448717     0.34   0.731    -.0725535     .103381
      during |  -.0858438   .0154141    -5.57   0.000    -.1160618   -.0556257
       after |  -.2434183    .028805    -8.45   0.000    -.2998881   -.1869485
during_expat |    .035444   .0248084     1.43   0.153    -.0131909     .084079
 after_expat |   .1287883   .0383021     3.36   0.001     .0537001    .2038766
             |
    ind_year |
         27  |  -.2180208   .0321676    -6.78   0.000    -.2810827   -.1549588
         28  |  -.3303966    .041719    -7.92   0.000    -.4121833   -.2486099
         29  |  -.4759378   .0498523    -9.55   0.000    -.5736693   -.3782064
         30  |   -.518407    .055526    -9.34   0.000    -.6272613   -.4095528
         31  |  -.5845659   .0633713    -9.22   0.000    -.7088002   -.4603317
         32  |  -.6456943   .0701001    -9.21   0.000    -.7831198   -.5082687
         33  |  -.7039836   .0764667    -9.21   0.000    -.8538903   -.5540769
         34  |  -.7686769   .0833448    -9.22   0.000    -.9320677   -.6052862
         35  |  -.8346916   .0901118    -9.26   0.000    -1.011348   -.6580348
         36  |  -.9296415   .0961877    -9.66   0.000     -1.11821   -.7410733
         37  |  -.9943229   .1027077    -9.68   0.000    -1.195673   -.7929729
         38  |  -1.090857   .1098244    -9.93   0.000    -1.306159   -.8755554
         39  |  -1.171849   .1167338   -10.04   0.000    -1.400696   -.9430018
         40  |  -1.208421   .1237703    -9.76   0.000    -1.451063   -.9657798
         41  |  -1.231598    .130128    -9.46   0.000    -1.486703   -.9764925
         42  |  -1.285161   .1365518    -9.41   0.000    -1.552859   -1.017462
         43  |  -1.440109    .142987   -10.07   0.000    -1.720424   -1.159795
         44  |  -1.504424   .1498829   -10.04   0.000    -1.798258   -1.210591
         45  |  -1.512496   .1557249    -9.71   0.000    -1.817782    -1.20721
         46  |  -1.545349   .1616695    -9.56   0.000    -1.862289   -1.228409
         47  |   -1.56762   .1669766    -9.39   0.000    -1.894964   -1.240276
         48  |  -1.582986   .1726128    -9.17   0.000    -1.921379   -1.244593
         49  |   -1.57732    .178436    -8.84   0.000    -1.927129    -1.22751
         50  |  -1.590654   .1836493    -8.66   0.000    -1.950683   -1.230624
             |
     age_cat |
          1  |   .5021922   .0445498    11.27   0.000     .4148559    .5895285
          2  |   .8501052   .0508734    16.71   0.000      .750372    .9498385
          3  |   1.084401   .0563118    19.26   0.000      .974006    1.194796
          4  |   1.254266    .061335    20.45   0.000     1.134023    1.374508
          5  |   1.398463   .0671246    20.83   0.000      1.26687    1.530055
          6  |    1.53417   .0728681    21.05   0.000     1.391318    1.677022
          7  |   1.637011   .0785771    20.83   0.000     1.482967    1.791055
          8  |   1.733464   .0846551    20.48   0.000     1.567505    1.899424
          9  |   1.824041   .0906834    20.11   0.000     1.646264    2.001819
         10  |   1.891237   .0967729    19.54   0.000     1.701522    2.080953
         11  |   1.973084   .1029822    19.16   0.000     1.771196    2.174973
         12  |   2.019032   .1092165    18.49   0.000     1.804922    2.233142
         13  |    2.08476   .1157962    18.00   0.000     1.857751     2.31177
         14  |   2.136529   .1221776    17.49   0.000     1.897009    2.376048
         15  |   2.208729   .1287295    17.16   0.000     1.956365    2.461093
         16  |   2.255133   .1355824    16.63   0.000     1.989335    2.520931
         17  |   2.313481   .1422116    16.27   0.000     2.034687    2.592276
         18  |   2.349119   .1484451    15.82   0.000     2.058105    2.640134
         19  |   2.399962   .1546403    15.52   0.000     2.096802    2.703122
         20  |    2.47729   .1668303    14.85   0.000     2.150232    2.804347
         25  |   2.563443   .1874381    13.68   0.000     2.195986      2.9309
         30  |   2.591573   .2294901    11.29   0.000     2.141676     3.04147
         40  |   2.426751   .2650806     9.15   0.000     1.907082    2.946419
         50  |   2.305659   .2709795     8.51   0.000     1.774425    2.836892
             |
       _cons |   3.418059   .0650671    52.53   0.000       3.2905    3.545617
-------------+----------------------------------------------------------------
     sigma_u |  1.2486639
     sigma_e |  .56969703
         rho |   .8277051   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1,  5219) =   31.02
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0,  5219) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1,  5219) =   63.74
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0,  5219) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1,  5219) =    2.04
            Prob > F =    0.1531

 ( 1)  during_expat = 0

       F(  1,  5219) =    2.04
            Prob > F =    0.1531
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1,  5219) =   10.44
            Prob > F =    0.0012

 ( 1)  after_expat = 0

       F(  1,  5219) =   11.31
            Prob > F =    0.0008
variable label was str12 now str13
(1 real change made)
(file output/figure/manufacturing_lnL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    265452
Group variable: firm_person                     Number of groups   =     28209

R-sq:  within  = 0.0999                         Obs per group: min =         1
       between = 0.0178                                        avg =       9.4
       overall = 0.0309                                        max =        25

                                                F(78,10918)        =     28.17
corr(u_i, Xb)  = -0.2821                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0121372   .0406564     0.30   0.765    -.0675566    .0918311
      during |  -.0641164   .0110362    -5.81   0.000    -.0857494   -.0424835
       after |  -.2311978   .0200917   -11.51   0.000    -.2705811   -.1918144
during_expat |  -.0403882    .047095    -0.86   0.391    -.1327029    .0519266
 after_expat |   .0326645     .05639     0.58   0.562      -.07787    .1431991
             |
    ind_year |
          2  |   -.095881   .0356188    -2.69   0.007    -.1657003   -.0260617
          3  |  -.2778821   .0461173    -6.03   0.000    -.3682803   -.1874839
          4  |   -.388148   .0511282    -7.59   0.000    -.4883686   -.2879275
          5  |  -.4904972   .0564524    -8.69   0.000    -.6011543   -.3798402
          6  |  -.5905022   .0607578    -9.72   0.000    -.7095985   -.4714058
          7  |  -.6665126    .064479   -10.34   0.000    -.7929031   -.5401222
          8  |  -.7005552   .0684583   -10.23   0.000     -.834746   -.5663645
          9  |  -.7583556    .072415   -10.47   0.000    -.9003022   -.6164091
         10  |  -.8046294   .0760112   -10.59   0.000    -.9536252   -.6556336
         11  |    -.86812   .0794129   -10.93   0.000    -1.023784   -.7124562
         12  |  -.9122633   .0830109   -10.99   0.000     -1.07498   -.7495468
         13  |  -.9599784   .0869134   -11.05   0.000    -1.130344   -.7896123
         14  |  -1.015586   .0907892   -11.19   0.000     -1.19355    -.837623
         15  |  -1.063342   .0944543   -11.26   0.000     -1.24849   -.8781946
         16  |  -1.115032   .0977999   -11.40   0.000    -1.306737   -.9233259
         17  |  -1.169648   .1013157   -11.54   0.000    -1.368245   -.9710506
         18  |  -1.250842   .1045583   -11.96   0.000    -1.455795   -1.045889
         19  |  -1.315884   .1079207   -12.19   0.000    -1.527428    -1.10434
         20  |  -1.364099   .1108631   -12.30   0.000    -1.581411   -1.146787
         21  |  -1.424994   .1137505   -12.53   0.000    -1.647966   -1.202022
         22  |  -1.472766   .1164376   -12.65   0.000    -1.701004   -1.244527
         23  |  -1.490426   .1190223   -12.52   0.000    -1.723731   -1.257121
         24  |  -1.532635   .1223247   -12.53   0.000    -1.772414   -1.292857
         25  |  -1.534747   .1256798   -12.21   0.000    -1.781102   -1.288391
         26  |   .8851692   .0951507     9.30   0.000     .6986566    1.071682
         27  |   .5965662   .0886735     6.73   0.000       .42275    .7703824
         28  |   .4464086   .0848107     5.26   0.000     .2801641     .612653
         29  |   .2796003   .0828983     3.37   0.001     .1171047     .442096
         30  |   .1608886   .0817278     1.97   0.049     .0006874    .3210898
         31  |   .0567121    .083408     0.68   0.497    -.1067828     .220207
         32  |  -.0128609    .083482    -0.15   0.878    -.1765008     .150779
         33  |   -.091846   .0846801    -1.08   0.278    -.2578343    .0741422
         34  |  -.1760943   .0863144    -2.04   0.041    -.3452863   -.0069024
         35  |  -.2375946    .088918    -2.67   0.008      -.41189   -.0632992
         36  |   -.324997   .0910221    -3.57   0.000    -.5034168   -.1465771
         37  |  -.3981204   .0934988    -4.26   0.000     -.581395   -.2148458
         38  |  -.4957902   .0961521    -5.16   0.000    -.6842658   -.3073146
         39  |  -.5744506   .0993621    -5.78   0.000    -.7692183   -.3796829
         40  |  -.6087007   .1026356    -5.93   0.000    -.8098851   -.4075163
         41  |  -.6559977    .105315    -6.23   0.000    -.8624343   -.4495611
         42  |  -.7096636   .1084801    -6.54   0.000    -.9223043    -.497023
         43  |  -.8358349   .1116431    -7.49   0.000    -1.054676   -.6169943
         44  |  -.8977673   .1152438    -7.79   0.000    -1.123666   -.6718685
         45  |  -.9235382   .1182767    -7.81   0.000    -1.155382   -.6916945
         46  |  -.9514045   .1214573    -7.83   0.000    -1.189483   -.7133262
         47  |  -.9812038   .1238064    -7.93   0.000    -1.223887   -.7385209
         48  |  -.9994176   .1265113    -7.90   0.000    -1.247403   -.7514326
         49  |  -1.030474   .1295659    -7.95   0.000    -1.284447   -.7765012
         50  |  -1.055598   .1323423    -7.98   0.000    -1.315013   -.7961835
             |
     age_cat |
          1  |   .4509814   .0307657    14.66   0.000      .390675    .5112878
          2  |   .8100723   .0348674    23.23   0.000      .741726    .8784187
          3  |   1.073783   .0384395    27.93   0.000     .9984346    1.149131
          4  |    1.29594   .0421855    30.72   0.000     1.213249    1.378631
          5  |   1.492456   .0458177    32.57   0.000     1.402645    1.582267
          6  |    1.63355    .049411    33.06   0.000     1.536695    1.730404
          7  |   1.751624   .0529387    33.09   0.000     1.647854    1.855393
          8  |   1.856192   .0568091    32.67   0.000     1.744836    1.967548
          9  |    1.94028    .060645    31.99   0.000     1.821405    2.059155
         10  |   2.008531   .0644624    31.16   0.000     1.882173    2.134889
         11  |   2.091444   .0682318    30.65   0.000     1.957698    2.225191
         12  |   2.153417     .07194    29.93   0.000     2.012401    2.294432
         13  |   2.220114   .0757834    29.30   0.000     2.071565    2.368663
         14  |   2.268292   .0796906    28.46   0.000     2.112084      2.4245
         15  |   2.311238   .0835453    27.66   0.000     2.147474    2.475002
         16  |   2.350576   .0875064    26.86   0.000     2.179047    2.522104
         17  |   2.393539   .0914965    26.16   0.000     2.214189    2.572888
         18  |   2.441898   .0950655    25.69   0.000     2.255553    2.628244
         19  |   2.483339   .0989008    25.11   0.000     2.289475    2.677202
         20  |      2.544    .105642    24.08   0.000     2.336923    2.751078
         25  |   2.627837   .1178751    22.29   0.000      2.39678    2.858893
         30  |   2.480934   .1489631    16.65   0.000     2.188939    2.772928
         40  |   2.376978   .1695914    14.02   0.000     2.044548    2.709408
         50  |   2.326356   .1702902    13.66   0.000     1.992556    2.660155
             |
       _cons |   2.687389   .0649069    41.40   0.000      2.56016    2.814618
-------------+----------------------------------------------------------------
     sigma_u |  1.2049714
     sigma_e |  .67849237
         rho |  .75926897   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0998889106080513

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    265,452
Group variable: firm_person                     Number of groups  =     28,209

R-sq:                                           Obs per group:
     within  = 0.0999                                         min =          1
     between = 0.0178                                         avg =        9.4
     overall = 0.0309                                         max =         25

                                                F(78,10918)       =      28.17
corr(u_i, Xb)  = -0.2821                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0121372   .0406564     0.30   0.765    -.0675566    .0918311
      during |  -.0641164   .0110362    -5.81   0.000    -.0857494   -.0424835
       after |  -.2311978   .0200917   -11.51   0.000    -.2705811   -.1918144
during_expat |  -.0403882    .047095    -0.86   0.391    -.1327029    .0519266
 after_expat |   .0326645     .05639     0.58   0.562      -.07787    .1431991
             |
    ind_year |
          2  |   -.095881   .0356188    -2.69   0.007    -.1657003   -.0260617
          3  |  -.2778821   .0461173    -6.03   0.000    -.3682803   -.1874839
          4  |   -.388148   .0511282    -7.59   0.000    -.4883686   -.2879275
          5  |  -.4904972   .0564524    -8.69   0.000    -.6011543   -.3798402
          6  |  -.5905022   .0607578    -9.72   0.000    -.7095985   -.4714058
          7  |  -.6665126    .064479   -10.34   0.000    -.7929031   -.5401222
          8  |  -.7005552   .0684583   -10.23   0.000     -.834746   -.5663645
          9  |  -.7583556    .072415   -10.47   0.000    -.9003022   -.6164091
         10  |  -.8046294   .0760112   -10.59   0.000    -.9536252   -.6556336
         11  |    -.86812   .0794129   -10.93   0.000    -1.023784   -.7124562
         12  |  -.9122633   .0830109   -10.99   0.000     -1.07498   -.7495468
         13  |  -.9599784   .0869134   -11.05   0.000    -1.130344   -.7896123
         14  |  -1.015586   .0907892   -11.19   0.000     -1.19355    -.837623
         15  |  -1.063342   .0944543   -11.26   0.000     -1.24849   -.8781946
         16  |  -1.115032   .0977999   -11.40   0.000    -1.306737   -.9233259
         17  |  -1.169648   .1013157   -11.54   0.000    -1.368245   -.9710506
         18  |  -1.250842   .1045583   -11.96   0.000    -1.455795   -1.045889
         19  |  -1.315884   .1079207   -12.19   0.000    -1.527428    -1.10434
         20  |  -1.364099   .1108631   -12.30   0.000    -1.581411   -1.146787
         21  |  -1.424994   .1137505   -12.53   0.000    -1.647966   -1.202022
         22  |  -1.472766   .1164376   -12.65   0.000    -1.701004   -1.244527
         23  |  -1.490426   .1190223   -12.52   0.000    -1.723731   -1.257121
         24  |  -1.532635   .1223247   -12.53   0.000    -1.772414   -1.292857
         25  |  -1.534747   .1256798   -12.21   0.000    -1.781102   -1.288391
         26  |   .8851692   .0951507     9.30   0.000     .6986566    1.071682
         27  |   .5965662   .0886735     6.73   0.000       .42275    .7703824
         28  |   .4464086   .0848107     5.26   0.000     .2801641     .612653
         29  |   .2796003   .0828983     3.37   0.001     .1171047     .442096
         30  |   .1608886   .0817278     1.97   0.049     .0006874    .3210898
         31  |   .0567121    .083408     0.68   0.497    -.1067828     .220207
         32  |  -.0128609    .083482    -0.15   0.878    -.1765008     .150779
         33  |   -.091846   .0846801    -1.08   0.278    -.2578343    .0741422
         34  |  -.1760943   .0863144    -2.04   0.041    -.3452863   -.0069024
         35  |  -.2375946    .088918    -2.67   0.008      -.41189   -.0632992
         36  |   -.324997   .0910221    -3.57   0.000    -.5034168   -.1465771
         37  |  -.3981204   .0934988    -4.26   0.000     -.581395   -.2148458
         38  |  -.4957902   .0961521    -5.16   0.000    -.6842658   -.3073146
         39  |  -.5744506   .0993621    -5.78   0.000    -.7692183   -.3796829
         40  |  -.6087007   .1026356    -5.93   0.000    -.8098851   -.4075163
         41  |  -.6559977    .105315    -6.23   0.000    -.8624343   -.4495611
         42  |  -.7096636   .1084801    -6.54   0.000    -.9223043    -.497023
         43  |  -.8358349   .1116431    -7.49   0.000    -1.054676   -.6169943
         44  |  -.8977673   .1152438    -7.79   0.000    -1.123666   -.6718685
         45  |  -.9235382   .1182767    -7.81   0.000    -1.155382   -.6916945
         46  |  -.9514045   .1214573    -7.83   0.000    -1.189483   -.7133262
         47  |  -.9812038   .1238064    -7.93   0.000    -1.223887   -.7385209
         48  |  -.9994176   .1265113    -7.90   0.000    -1.247403   -.7514326
         49  |  -1.030474   .1295659    -7.95   0.000    -1.284447   -.7765012
         50  |  -1.055598   .1323423    -7.98   0.000    -1.315013   -.7961835
             |
     age_cat |
          1  |   .4509814   .0307657    14.66   0.000      .390675    .5112878
          2  |   .8100723   .0348674    23.23   0.000      .741726    .8784187
          3  |   1.073783   .0384395    27.93   0.000     .9984346    1.149131
          4  |    1.29594   .0421855    30.72   0.000     1.213249    1.378631
          5  |   1.492456   .0458177    32.57   0.000     1.402645    1.582267
          6  |    1.63355    .049411    33.06   0.000     1.536695    1.730404
          7  |   1.751624   .0529387    33.09   0.000     1.647854    1.855393
          8  |   1.856192   .0568091    32.67   0.000     1.744836    1.967548
          9  |    1.94028    .060645    31.99   0.000     1.821405    2.059155
         10  |   2.008531   .0644624    31.16   0.000     1.882173    2.134889
         11  |   2.091444   .0682318    30.65   0.000     1.957698    2.225191
         12  |   2.153417     .07194    29.93   0.000     2.012401    2.294432
         13  |   2.220114   .0757834    29.30   0.000     2.071565    2.368663
         14  |   2.268292   .0796906    28.46   0.000     2.112084      2.4245
         15  |   2.311238   .0835453    27.66   0.000     2.147474    2.475002
         16  |   2.350576   .0875064    26.86   0.000     2.179047    2.522104
         17  |   2.393539   .0914965    26.16   0.000     2.214189    2.572888
         18  |   2.441898   .0950655    25.69   0.000     2.255553    2.628244
         19  |   2.483339   .0989008    25.11   0.000     2.289475    2.677202
         20  |      2.544    .105642    24.08   0.000     2.336923    2.751078
         25  |   2.627837   .1178751    22.29   0.000      2.39678    2.858893
         30  |   2.480934   .1489631    16.65   0.000     2.188939    2.772928
         40  |   2.376978   .1695914    14.02   0.000     2.044548    2.709408
         50  |   2.326356   .1702902    13.66   0.000     1.992556    2.660155
             |
       _cons |   2.687389   .0649069    41.40   0.000      2.56016    2.814618
-------------+----------------------------------------------------------------
     sigma_u |  1.2049714
     sigma_e |  .67849237
         rho |  .75926897   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1, 10918) =   33.75
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1, 10918) =  141.19
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1, 10918) =    0.74
            Prob > F =    0.3911

 ( 1)  during_expat = 0

       F(  1, 10918) =    0.74
            Prob > F =    0.3911
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1, 10918) =    3.06
            Prob > F =    0.0804

 ( 1)  after_expat = 0

       F(  1, 10918) =    0.34
            Prob > F =    0.5624
(file output/figure/acquisitions_lnL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    265452
Group variable: firm_person                     Number of groups   =     28209

R-sq:  within  = 0.0986                         Obs per group: min =         1
       between = 0.0179                                        avg =       9.4
       overall = 0.0306                                        max =        25

                                                F(82,10918)        =     26.21
corr(u_i, Xb)  = -0.2923                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0105455   .0407604     0.26   0.796    -.0693522    .0904432
   during_DD |  -.0511164   .0116569    -4.39   0.000     -.073966   -.0282668
   during_DE |  -.0355021   .0655552    -0.54   0.588    -.1640022     .092998
   during_ED |  -.0428722   .0300391    -1.43   0.154    -.1017542    .0160099
   during_EE |  -.1412344   .0668506    -2.11   0.035    -.2722736   -.0101952
    after_DD |  -.2045983   .0212355    -9.63   0.000    -.2462238   -.1629728
    after_DE |  -.0821882   .0688153    -1.19   0.232    -.2170787    .0527023
    after_ED |  -.2001091   .0451517    -4.43   0.000    -.2886147   -.1116035
    after_EE |   -.245107   .0794009    -3.09   0.002    -.4007472   -.0894668
             |
    ind_year |
          2  |  -.1001805   .0358451    -2.79   0.005    -.1704434   -.0299177
          3  |  -.2857411   .0465393    -6.14   0.000    -.3769666   -.1945156
          4  |  -.3994066   .0516386    -7.73   0.000    -.5006276   -.2981857
          5  |  -.5046697   .0570216    -8.85   0.000    -.6164424    -.392897
          6  |   -.608043   .0613813    -9.91   0.000    -.7283614   -.4877246
          7  |  -.6867275   .0651596   -10.54   0.000    -.8144521    -.559003
          8  |   -.723345    .069134   -10.46   0.000    -.8588602   -.5878298
          9  |  -.7843997   .0731612   -10.72   0.000    -.9278088   -.6409905
         10  |  -.8337317   .0766636   -10.88   0.000    -.9840062   -.6834571
         11  |  -.9007316     .07996   -11.26   0.000    -1.057468   -.7439956
         12  |  -.9479053   .0834877   -11.35   0.000    -1.111556   -.7842544
         13  |  -.9991538   .0872598   -11.45   0.000    -1.170199   -.8281087
         14  |  -1.058674   .0910037   -11.63   0.000    -1.237058     -.88029
         15  |  -1.110807   .0945489   -11.75   0.000     -1.29614   -.9254736
         16  |   -1.16643   .0977691   -11.93   0.000    -1.358076   -.9747853
         17  |  -1.226708   .1011031   -12.13   0.000    -1.424888   -1.028528
         18  |  -1.311975   .1042237   -12.59   0.000    -1.516272   -1.107678
         19  |  -1.381472   .1074371   -12.86   0.000    -1.592068   -1.170876
         20  |  -1.434183   .1102425   -13.01   0.000    -1.650278   -1.218087
         21  |  -1.498638   .1129891   -13.26   0.000    -1.720117   -1.277159
         22  |  -1.550631   .1155519   -13.42   0.000    -1.777133   -1.324128
         23  |  -1.571585   .1180311   -13.32   0.000    -1.802947   -1.340222
         24  |  -1.618175   .1211823   -13.35   0.000    -1.855715   -1.380636
         25  |    -1.6251    .124359   -13.07   0.000    -1.868866   -1.381334
         26  |   .8872071   .0952987     9.31   0.000     .7004043     1.07401
         27  |   .5940528   .0888837     6.68   0.000     .4198246     .768281
         28  |   .4395075   .0851003     5.16   0.000     .2726955    .6063194
         29  |   .2691858   .0832681     3.23   0.001     .1059651    .4324064
         30  |    .147383   .0821655     1.79   0.073    -.0136763    .3084423
         31  |   .0401307   .0839393     0.48   0.633    -.1244056    .2046669
         32  |   -.032955   .0840669    -0.39   0.695    -.1977413    .1318313
         33  |  -.1145588   .0853422    -1.34   0.180    -.2818449    .0527273
         34  |  -.2022742    .087029    -2.32   0.020    -.3728667   -.0316817
         35  |   -.266607   .0896221    -2.97   0.003    -.4422826   -.0909314
         36  |  -.3578203   .0916675    -3.90   0.000    -.5375052   -.1781353
         37  |  -.4339587   .0940724    -4.61   0.000    -.6183577   -.2495596
         38  |   -.535224    .096645    -5.54   0.000    -.7246658   -.3457822
         39  |  -.6183487   .0997225    -6.20   0.000    -.8138229   -.4228745
         40  |   -.657095   .1028538    -6.39   0.000    -.8587071    -.455483
         41  |   -.708313   .1054353    -6.72   0.000    -.9149853   -.5016406
         42  |  -.7662891    .108485    -7.06   0.000    -.9789394   -.5536389
         43  |  -.8959885   .1115686    -8.03   0.000    -1.114683   -.6772938
         44  |  -.9610557   .1150591    -8.35   0.000    -1.186592   -.7355189
         45  |  -.9907684   .1179349    -8.40   0.000    -1.221942   -.7595946
         46  |  -1.022194   .1209621    -8.45   0.000    -1.259302   -.7850867
         47  |  -1.055231   .1231537    -8.57   0.000    -1.296635   -.8138278
         48  |   -1.07726   .1257682    -8.57   0.000    -1.323788   -.8307311
         49  |  -1.112741    .128684    -8.65   0.000    -1.364984   -.8604967
         50  |  -1.141408   .1313445    -8.69   0.000    -1.398867    -.883949
             |
     age_cat |
          1  |   .4493867   .0307691    14.61   0.000     .3890738    .5096997
          2  |   .8060974   .0348983    23.10   0.000     .7376904    .8745043
          3  |   1.068465   .0385062    27.75   0.000     .9929857    1.143944
          4  |   1.290321   .0423087    30.50   0.000     1.207388    1.373253
          5  |    1.48732   .0459881    32.34   0.000     1.397175    1.577465
          6  |   1.629206   .0496029    32.84   0.000     1.531975    1.726437
          7  |    1.74858   .0531588    32.89   0.000     1.644379    1.852781
          8  |   1.854473    .057056    32.50   0.000     1.742633    1.966313
          9  |   1.939864   .0609099    31.85   0.000     1.820469    2.059258
         10  |   2.009568   .0647464    31.04   0.000     1.882653    2.136482
         11  |   2.094249   .0685064    30.57   0.000     1.959965    2.228534
         12  |   2.158094   .0722287    29.88   0.000     2.016513    2.299676
         13  |   2.226482   .0760794    29.27   0.000     2.077353    2.375612
         14  |   2.276888    .080001    28.46   0.000     2.120072    2.433705
         15  |   2.322016   .0838407    27.70   0.000     2.157673    2.486359
         16  |   2.363264   .0878072    26.91   0.000     2.191146    2.535382
         17  |   2.408656   .0917829    26.24   0.000     2.228745    2.588567
         18  |    2.45945   .0953326    25.80   0.000      2.27258    2.646319
         19  |   2.503411   .0991462    25.25   0.000     2.309066    2.697755
         20  |   2.569002   .1058461    24.27   0.000     2.361525     2.77648
         25  |   2.660461   .1179744    22.55   0.000      2.42921    2.891712
         30  |   2.515272   .1490088    16.88   0.000     2.223187    2.807356
         40  |   2.402156   .1697815    14.15   0.000     2.069353    2.734958
         50  |    2.34653   .1711823    13.71   0.000     2.010982    2.682079
             |
       _cons |   2.707723   .0654091    41.40   0.000     2.579509    2.835937
-------------+----------------------------------------------------------------
     sigma_u |  1.2109449
     sigma_e |  .67900099
         rho |  .76079943   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0985541091127539

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    265,452
Group variable: firm_person                     Number of groups  =     28,209

R-sq:                                           Obs per group:
     within  = 0.0986                                         min =          1
     between = 0.0179                                         avg =        9.4
     overall = 0.0306                                         max =         25

                                                F(82,10918)       =      26.21
corr(u_i, Xb)  = -0.2923                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0105455   .0407604     0.26   0.796    -.0693522    .0904432
   during_DD |  -.0511164   .0116569    -4.39   0.000     -.073966   -.0282668
   during_DE |  -.0355021   .0655552    -0.54   0.588    -.1640022     .092998
   during_ED |  -.0428722   .0300391    -1.43   0.154    -.1017542    .0160099
   during_EE |  -.1412344   .0668506    -2.11   0.035    -.2722736   -.0101952
    after_DD |  -.2045983   .0212355    -9.63   0.000    -.2462238   -.1629728
    after_DE |  -.0821882   .0688153    -1.19   0.232    -.2170787    .0527023
    after_ED |  -.2001091   .0451517    -4.43   0.000    -.2886147   -.1116035
    after_EE |   -.245107   .0794009    -3.09   0.002    -.4007472   -.0894668
             |
    ind_year |
          2  |  -.1001805   .0358451    -2.79   0.005    -.1704434   -.0299177
          3  |  -.2857411   .0465393    -6.14   0.000    -.3769666   -.1945156
          4  |  -.3994066   .0516386    -7.73   0.000    -.5006276   -.2981857
          5  |  -.5046697   .0570216    -8.85   0.000    -.6164424    -.392897
          6  |   -.608043   .0613813    -9.91   0.000    -.7283614   -.4877246
          7  |  -.6867275   .0651596   -10.54   0.000    -.8144521    -.559003
          8  |   -.723345    .069134   -10.46   0.000    -.8588602   -.5878298
          9  |  -.7843997   .0731612   -10.72   0.000    -.9278088   -.6409905
         10  |  -.8337317   .0766636   -10.88   0.000    -.9840062   -.6834571
         11  |  -.9007316     .07996   -11.26   0.000    -1.057468   -.7439956
         12  |  -.9479053   .0834877   -11.35   0.000    -1.111556   -.7842544
         13  |  -.9991538   .0872598   -11.45   0.000    -1.170199   -.8281087
         14  |  -1.058674   .0910037   -11.63   0.000    -1.237058     -.88029
         15  |  -1.110807   .0945489   -11.75   0.000     -1.29614   -.9254736
         16  |   -1.16643   .0977691   -11.93   0.000    -1.358076   -.9747853
         17  |  -1.226708   .1011031   -12.13   0.000    -1.424888   -1.028528
         18  |  -1.311975   .1042237   -12.59   0.000    -1.516272   -1.107678
         19  |  -1.381472   .1074371   -12.86   0.000    -1.592068   -1.170876
         20  |  -1.434183   .1102425   -13.01   0.000    -1.650278   -1.218087
         21  |  -1.498638   .1129891   -13.26   0.000    -1.720117   -1.277159
         22  |  -1.550631   .1155519   -13.42   0.000    -1.777133   -1.324128
         23  |  -1.571585   .1180311   -13.32   0.000    -1.802947   -1.340222
         24  |  -1.618175   .1211823   -13.35   0.000    -1.855715   -1.380636
         25  |    -1.6251    .124359   -13.07   0.000    -1.868866   -1.381334
         26  |   .8872071   .0952987     9.31   0.000     .7004043     1.07401
         27  |   .5940528   .0888837     6.68   0.000     .4198246     .768281
         28  |   .4395075   .0851003     5.16   0.000     .2726955    .6063194
         29  |   .2691858   .0832681     3.23   0.001     .1059651    .4324064
         30  |    .147383   .0821655     1.79   0.073    -.0136763    .3084423
         31  |   .0401307   .0839393     0.48   0.633    -.1244056    .2046669
         32  |   -.032955   .0840669    -0.39   0.695    -.1977413    .1318313
         33  |  -.1145588   .0853422    -1.34   0.180    -.2818449    .0527273
         34  |  -.2022742    .087029    -2.32   0.020    -.3728667   -.0316817
         35  |   -.266607   .0896221    -2.97   0.003    -.4422826   -.0909314
         36  |  -.3578203   .0916675    -3.90   0.000    -.5375052   -.1781353
         37  |  -.4339587   .0940724    -4.61   0.000    -.6183577   -.2495596
         38  |   -.535224    .096645    -5.54   0.000    -.7246658   -.3457822
         39  |  -.6183487   .0997225    -6.20   0.000    -.8138229   -.4228745
         40  |   -.657095   .1028538    -6.39   0.000    -.8587071    -.455483
         41  |   -.708313   .1054353    -6.72   0.000    -.9149853   -.5016406
         42  |  -.7662891    .108485    -7.06   0.000    -.9789394   -.5536389
         43  |  -.8959885   .1115686    -8.03   0.000    -1.114683   -.6772938
         44  |  -.9610557   .1150591    -8.35   0.000    -1.186592   -.7355189
         45  |  -.9907684   .1179349    -8.40   0.000    -1.221942   -.7595946
         46  |  -1.022194   .1209621    -8.45   0.000    -1.259302   -.7850867
         47  |  -1.055231   .1231537    -8.57   0.000    -1.296635   -.8138278
         48  |   -1.07726   .1257682    -8.57   0.000    -1.323788   -.8307311
         49  |  -1.112741    .128684    -8.65   0.000    -1.364984   -.8604967
         50  |  -1.141408   .1313445    -8.69   0.000    -1.398867    -.883949
             |
     age_cat |
          1  |   .4493867   .0307691    14.61   0.000     .3890738    .5096997
          2  |   .8060974   .0348983    23.10   0.000     .7376904    .8745043
          3  |   1.068465   .0385062    27.75   0.000     .9929857    1.143944
          4  |   1.290321   .0423087    30.50   0.000     1.207388    1.373253
          5  |    1.48732   .0459881    32.34   0.000     1.397175    1.577465
          6  |   1.629206   .0496029    32.84   0.000     1.531975    1.726437
          7  |    1.74858   .0531588    32.89   0.000     1.644379    1.852781
          8  |   1.854473    .057056    32.50   0.000     1.742633    1.966313
          9  |   1.939864   .0609099    31.85   0.000     1.820469    2.059258
         10  |   2.009568   .0647464    31.04   0.000     1.882653    2.136482
         11  |   2.094249   .0685064    30.57   0.000     1.959965    2.228534
         12  |   2.158094   .0722287    29.88   0.000     2.016513    2.299676
         13  |   2.226482   .0760794    29.27   0.000     2.077353    2.375612
         14  |   2.276888    .080001    28.46   0.000     2.120072    2.433705
         15  |   2.322016   .0838407    27.70   0.000     2.157673    2.486359
         16  |   2.363264   .0878072    26.91   0.000     2.191146    2.535382
         17  |   2.408656   .0917829    26.24   0.000     2.228745    2.588567
         18  |    2.45945   .0953326    25.80   0.000      2.27258    2.646319
         19  |   2.503411   .0991462    25.25   0.000     2.309066    2.697755
         20  |   2.569002   .1058461    24.27   0.000     2.361525     2.77648
         25  |   2.660461   .1179744    22.55   0.000      2.42921    2.891712
         30  |   2.515272   .1490088    16.88   0.000     2.223187    2.807356
         40  |   2.402156   .1697815    14.15   0.000     2.069353    2.734958
         50  |    2.34653   .1711823    13.71   0.000     2.010982    2.682079
             |
       _cons |   2.707723   .0654091    41.40   0.000     2.579509    2.835937
-------------+----------------------------------------------------------------
     sigma_u |  1.2109449
     sigma_e |  .67900099
         rho |  .76079943   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[du
> ring_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle(`title') legend(off) 
> aspect(0.67))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 10918) =   19.23
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 10918) =    0.29
            Prob > F =    0.5881

 ( 1)  - during_DD + during_DE = 0

       F(  1, 10918) =    0.06
            Prob > F =    0.8141
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 10918) =    2.04
            Prob > F =    0.1535

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 10918) =    4.46
            Prob > F =    0.0347

 ( 1)  - during_ED + during_EE = 0

       F(  1, 10918) =    1.84
            Prob > F =    0.1747

. 
. graph export output/figure/`fname'_tree.png, width(800) replace
(file output/figure/lnL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    177613
Group variable: firm_person                     Number of groups   =     19465

R-sq:  within  = 0.0802                         Obs per group: min =         1
       between = 0.0157                                        avg =       9.1
       overall = 0.0267                                        max =        25

                                                F(78,6772)         =     14.24
corr(u_i, Xb)  = -0.2099                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 6,773 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0215378   .0511332    -0.42   0.674    -.1217749    .0786993
      during |  -.1769036   .0138019   -12.82   0.000    -.2039596   -.1498476
       after |  -.3464698   .0248575   -13.94   0.000    -.3951983   -.2977413
during_expat |   .0311046   .0493503     0.63   0.529    -.0656375    .1278467
 after_expat |   .1694484   .0639652     2.65   0.008     .0440565    .2948404
             |
    ind_year |
          2  |  -.1329126   .0367665    -3.62   0.000    -.2049864   -.0608387
          3  |  -.3171897   .0486508    -6.52   0.000    -.4125606   -.2218189
          4  |  -.3871518   .0527665    -7.34   0.000    -.4905907   -.2837129
          5  |  -.4939579    .060304    -8.19   0.000    -.6121726   -.3757432
          6  |  -.6003909   .0657099    -9.14   0.000    -.7292029   -.4715788
          7  |  -.7053386   .0711992    -9.91   0.000    -.8449113   -.5657658
          8  |  -.7617169   .0766777    -9.93   0.000    -.9120292   -.6114046
          9  |  -.8467644   .0821497   -10.31   0.000    -1.007804   -.6857251
         10  |  -.8957677   .0865731   -10.35   0.000    -1.065478   -.7260572
         11  |  -.9654706   .0907522   -10.64   0.000    -1.143373   -.7875678
         12  |  -1.005437   .0954264   -10.54   0.000    -1.192502   -.8183711
         13  |  -1.053682   .1000899   -10.53   0.000     -1.24989   -.8574744
         14  |  -1.128604   .1046707   -10.78   0.000    -1.333792   -.9234171
         15  |  -1.187438   .1090103   -10.89   0.000    -1.401132   -.9737436
         16  |  -1.244718   .1126776   -11.05   0.000    -1.465602   -1.023835
         17  |  -1.311065   .1166894   -11.24   0.000    -1.539813   -1.082317
         18  |  -1.392331   .1203743   -11.57   0.000    -1.628302   -1.156359
         19  |  -1.445255   .1240512   -11.65   0.000    -1.688434   -1.202076
         20  |  -1.507158      .1274   -11.83   0.000    -1.756902   -1.257414
         21  |  -1.560594   .1304593   -11.96   0.000    -1.816335   -1.304853
         22  |  -1.591962   .1331501   -11.96   0.000    -1.852978   -1.330946
         23  |  -1.603781   .1359771   -11.79   0.000    -1.870338   -1.337223
         24  |  -1.647481   .1396704   -11.80   0.000    -1.921279   -1.373683
         25  |  -1.644598   .1433329   -11.47   0.000    -1.925575    -1.36362
         26  |    .502082   .1091761     4.60   0.000     .2880624    .7161015
         27  |   .2892872   .1028884     2.81   0.005     .0875936    .4909808
         28  |   .1788676   .1010776     1.77   0.077    -.0192763    .3770115
         29  |   .0856376   .0991522     0.86   0.388    -.1087319     .280007
         30  |    .003773   .0977547     0.04   0.969     -.187857     .195403
         31  |  -.0539905   .0987545    -0.55   0.585    -.2475803    .1395993
         32  |  -.1205566     .09901    -1.22   0.223    -.3146473     .073534
         33  |  -.1830192   .1008805    -1.81   0.070    -.3807767    .0147383
         34  |  -.2515289   .1027891    -2.45   0.014    -.4530278   -.0500299
         35  |  -.3033991   .1056458    -2.87   0.004     -.510498   -.0963002
         36  |  -.3868648     .10767    -3.59   0.000    -.5979318   -.1757978
         37  |  -.4685076   .1103853    -4.24   0.000    -.6848976   -.2521177
         38  |  -.5424641    .113068    -4.80   0.000     -.764113   -.3208153
         39  |  -.6081058   .1167516    -5.21   0.000    -.8369757   -.3792358
         40  |  -.6503022   .1209452    -5.38   0.000    -.8873927   -.4132116
         41  |  -.7009294   .1239654    -5.65   0.000    -.9439406   -.4579182
         42  |  -.7503537   .1273246    -5.89   0.000    -.9999499   -.5007575
         43  |  -.8620181   .1306542    -6.60   0.000    -1.118141   -.6058947
         44  |  -.9227432   .1343345    -6.87   0.000    -1.186081   -.6594054
         45  |  -.9575749   .1379547    -6.94   0.000    -1.228009   -.6871404
         46  |  -.9820881   .1415864    -6.94   0.000    -1.259642   -.7045343
         47  |  -1.009257   .1442647    -7.00   0.000    -1.292061   -.7264524
         48  |  -1.024885   .1474696    -6.95   0.000    -1.313972   -.7357985
         49  |  -1.049101   .1507968    -6.96   0.000    -1.344711   -.7534923
         50  |  -1.052148   .1534802    -6.86   0.000    -1.353018   -.7512787
             |
     age_cat |
          1  |   .2897807   .0390313     7.42   0.000     .2132672    .3662942
          2  |   .4549639   .0434116    10.48   0.000     .3698635    .5400644
          3  |   .5747521   .0470906    12.21   0.000     .4824398    .6670644
          4  |   .7105562   .0515764    13.78   0.000     .6094503    .8116621
          5  |   .8390775   .0561416    14.95   0.000     .7290224    .9491326
          6  |   .9230024   .0603488    15.29   0.000     .8046999    1.041305
          7  |    .999767   .0640634    15.61   0.000     .8741825    1.125351
          8  |   1.072286   .0685019    15.65   0.000      .938001    1.206572
          9  |   1.127216   .0728445    15.47   0.000     .9844183    1.270015
         10  |    1.16922   .0771799    15.15   0.000     1.017923    1.320517
         11  |   1.231765   .0814672    15.12   0.000     1.072063    1.391466
         12  |   1.266902   .0856369    14.79   0.000     1.099027    1.434777
         13  |   1.315777   .0899805    14.62   0.000     1.139387    1.492168
         14  |   1.347634   .0942676    14.30   0.000      1.16284    1.532428
         15  |   1.398709   .0984853    14.20   0.000     1.205647    1.591772
         16  |   1.425544   .1029916    13.84   0.000     1.223648     1.62744
         17  |    1.46296   .1073994    13.62   0.000     1.252423    1.673496
         18  |   1.514591   .1113606    13.60   0.000     1.296289    1.732893
         19  |   1.546637    .115619    13.38   0.000     1.319988    1.773287
         20  |   1.592036   .1233736    12.90   0.000     1.350185    1.833887
         25  |    1.66572   .1377304    12.09   0.000     1.395725    1.935715
         30  |   1.525931   .1666157     9.16   0.000     1.199312    1.852551
         40  |   1.444337   .1884126     7.67   0.000     1.074989    1.813685
         50  |   1.420402   .1881992     7.55   0.000     1.051472    1.789331
             |
       _cons |   3.861582   .0774901    49.83   0.000     3.709677    4.013487
-------------+----------------------------------------------------------------
     sigma_u |  1.2472642
     sigma_e |  .61784827
         rho |  .80296501   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0801852818605082

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    177,613
Group variable: firm_person                     Number of groups  =     19,465

R-sq:                                           Obs per group:
     within  = 0.0802                                         min =          1
     between = 0.0157                                         avg =        9.1
     overall = 0.0267                                         max =         25

                                                F(78,6772)        =      14.24
corr(u_i, Xb)  = -0.2099                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 6,773 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0215378   .0511332    -0.42   0.674    -.1217749    .0786993
      during |  -.1769036   .0138019   -12.82   0.000    -.2039596   -.1498476
       after |  -.3464698   .0248575   -13.94   0.000    -.3951983   -.2977413
during_expat |   .0311046   .0493503     0.63   0.529    -.0656375    .1278467
 after_expat |   .1694484   .0639652     2.65   0.008     .0440565    .2948404
             |
    ind_year |
          2  |  -.1329126   .0367665    -3.62   0.000    -.2049864   -.0608387
          3  |  -.3171897   .0486508    -6.52   0.000    -.4125606   -.2218189
          4  |  -.3871518   .0527665    -7.34   0.000    -.4905907   -.2837129
          5  |  -.4939579    .060304    -8.19   0.000    -.6121726   -.3757432
          6  |  -.6003909   .0657099    -9.14   0.000    -.7292029   -.4715788
          7  |  -.7053386   .0711992    -9.91   0.000    -.8449113   -.5657658
          8  |  -.7617169   .0766777    -9.93   0.000    -.9120292   -.6114046
          9  |  -.8467644   .0821497   -10.31   0.000    -1.007804   -.6857251
         10  |  -.8957677   .0865731   -10.35   0.000    -1.065478   -.7260572
         11  |  -.9654706   .0907522   -10.64   0.000    -1.143373   -.7875678
         12  |  -1.005437   .0954264   -10.54   0.000    -1.192502   -.8183711
         13  |  -1.053682   .1000899   -10.53   0.000     -1.24989   -.8574744
         14  |  -1.128604   .1046707   -10.78   0.000    -1.333792   -.9234171
         15  |  -1.187438   .1090103   -10.89   0.000    -1.401132   -.9737436
         16  |  -1.244718   .1126776   -11.05   0.000    -1.465602   -1.023835
         17  |  -1.311065   .1166894   -11.24   0.000    -1.539813   -1.082317
         18  |  -1.392331   .1203743   -11.57   0.000    -1.628302   -1.156359
         19  |  -1.445255   .1240512   -11.65   0.000    -1.688434   -1.202076
         20  |  -1.507158      .1274   -11.83   0.000    -1.756902   -1.257414
         21  |  -1.560594   .1304593   -11.96   0.000    -1.816335   -1.304853
         22  |  -1.591962   .1331501   -11.96   0.000    -1.852978   -1.330946
         23  |  -1.603781   .1359771   -11.79   0.000    -1.870338   -1.337223
         24  |  -1.647481   .1396704   -11.80   0.000    -1.921279   -1.373683
         25  |  -1.644598   .1433329   -11.47   0.000    -1.925575    -1.36362
         26  |    .502082   .1091761     4.60   0.000     .2880624    .7161015
         27  |   .2892872   .1028884     2.81   0.005     .0875936    .4909808
         28  |   .1788676   .1010776     1.77   0.077    -.0192763    .3770115
         29  |   .0856376   .0991522     0.86   0.388    -.1087319     .280007
         30  |    .003773   .0977547     0.04   0.969     -.187857     .195403
         31  |  -.0539905   .0987545    -0.55   0.585    -.2475803    .1395993
         32  |  -.1205566     .09901    -1.22   0.223    -.3146473     .073534
         33  |  -.1830192   .1008805    -1.81   0.070    -.3807767    .0147383
         34  |  -.2515289   .1027891    -2.45   0.014    -.4530278   -.0500299
         35  |  -.3033991   .1056458    -2.87   0.004     -.510498   -.0963002
         36  |  -.3868648     .10767    -3.59   0.000    -.5979318   -.1757978
         37  |  -.4685076   .1103853    -4.24   0.000    -.6848976   -.2521177
         38  |  -.5424641    .113068    -4.80   0.000     -.764113   -.3208153
         39  |  -.6081058   .1167516    -5.21   0.000    -.8369757   -.3792358
         40  |  -.6503022   .1209452    -5.38   0.000    -.8873927   -.4132116
         41  |  -.7009294   .1239654    -5.65   0.000    -.9439406   -.4579182
         42  |  -.7503537   .1273246    -5.89   0.000    -.9999499   -.5007575
         43  |  -.8620181   .1306542    -6.60   0.000    -1.118141   -.6058947
         44  |  -.9227432   .1343345    -6.87   0.000    -1.186081   -.6594054
         45  |  -.9575749   .1379547    -6.94   0.000    -1.228009   -.6871404
         46  |  -.9820881   .1415864    -6.94   0.000    -1.259642   -.7045343
         47  |  -1.009257   .1442647    -7.00   0.000    -1.292061   -.7264524
         48  |  -1.024885   .1474696    -6.95   0.000    -1.313972   -.7357985
         49  |  -1.049101   .1507968    -6.96   0.000    -1.344711   -.7534923
         50  |  -1.052148   .1534802    -6.86   0.000    -1.353018   -.7512787
             |
     age_cat |
          1  |   .2897807   .0390313     7.42   0.000     .2132672    .3662942
          2  |   .4549639   .0434116    10.48   0.000     .3698635    .5400644
          3  |   .5747521   .0470906    12.21   0.000     .4824398    .6670644
          4  |   .7105562   .0515764    13.78   0.000     .6094503    .8116621
          5  |   .8390775   .0561416    14.95   0.000     .7290224    .9491326
          6  |   .9230024   .0603488    15.29   0.000     .8046999    1.041305
          7  |    .999767   .0640634    15.61   0.000     .8741825    1.125351
          8  |   1.072286   .0685019    15.65   0.000      .938001    1.206572
          9  |   1.127216   .0728445    15.47   0.000     .9844183    1.270015
         10  |    1.16922   .0771799    15.15   0.000     1.017923    1.320517
         11  |   1.231765   .0814672    15.12   0.000     1.072063    1.391466
         12  |   1.266902   .0856369    14.79   0.000     1.099027    1.434777
         13  |   1.315777   .0899805    14.62   0.000     1.139387    1.492168
         14  |   1.347634   .0942676    14.30   0.000      1.16284    1.532428
         15  |   1.398709   .0984853    14.20   0.000     1.205647    1.591772
         16  |   1.425544   .1029916    13.84   0.000     1.223648     1.62744
         17  |    1.46296   .1073994    13.62   0.000     1.252423    1.673496
         18  |   1.514591   .1113606    13.60   0.000     1.296289    1.732893
         19  |   1.546637    .115619    13.38   0.000     1.319988    1.773287
         20  |   1.592036   .1233736    12.90   0.000     1.350185    1.833887
         25  |    1.66572   .1377304    12.09   0.000     1.395725    1.935715
         30  |   1.525931   .1666157     9.16   0.000     1.199312    1.852551
         40  |   1.444337   .1884126     7.67   0.000     1.074989    1.813685
         50  |   1.420402   .1881992     7.55   0.000     1.051472    1.789331
             |
       _cons |   3.861582   .0774901    49.83   0.000     3.709677    4.013487
-------------+----------------------------------------------------------------
     sigma_u |  1.2472642
     sigma_e |  .61784827
         rho |  .80296501   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    156204
Group variable: firm_person                     Number of groups   =     16977

R-sq:  within  = 0.1600                         Obs per group: min =         1
       between = 0.0107                                        avg =       9.2
       overall = 0.0273                                        max =        25

                                                F(78,6146)         =     24.09
corr(u_i, Xb)  = -0.3739                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 6,147 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0341011   .0476644     0.72   0.474    -.0593378      .12754
      during |   .0052925   .0145452     0.36   0.716    -.0232212    .0338061
       after |  -.1623379   .0266543    -6.09   0.000    -.2145896   -.1100862
during_expat |  -.0967889   .0541871    -1.79   0.074    -.2030146    .0094368
 after_expat |  -.0562015    .065729    -0.86   0.393    -.1850534    .0726504
             |
    ind_year |
          2  |  -.1371099    .057089    -2.40   0.016    -.2490244   -.0251954
          3  |  -.3331014   .0708737    -4.70   0.000    -.4720386   -.1941641
          4  |  -.4266978   .0757472    -5.63   0.000    -.5751888   -.2782068
          5  |  -.5351287   .0832429    -6.43   0.000    -.6983139   -.3719435
          6  |  -.6245098   .0885814    -7.05   0.000    -.7981604   -.4508592
          7  |  -.7151498   .0934876    -7.65   0.000    -.8984182   -.5318815
          8  |  -.7578633   .0995599    -7.61   0.000    -.9530355   -.5626911
          9  |  -.8072832   .1037074    -7.78   0.000    -1.010586   -.6039804
         10  |  -.8511796   .1079123    -7.89   0.000    -1.062725   -.6396337
         11  |  -.9025429   .1114296    -8.10   0.000    -1.120984   -.6841019
         12  |  -.9624359   .1158279    -8.31   0.000    -1.189499   -.7353727
         13  |  -1.013368   .1208716    -8.38   0.000    -1.250319   -.7764175
         14  |  -1.089328   .1255947    -8.67   0.000    -1.335538   -.8431187
         15  |  -1.139436   .1301511    -8.75   0.000    -1.394578   -.8842945
         16  |  -1.200404   .1341643    -8.95   0.000    -1.463413   -.9373948
         17  |  -1.265902     .13852    -9.14   0.000     -1.53745   -.9943547
         18  |  -1.347981   .1425352    -9.46   0.000      -1.6274   -1.068562
         19  |  -1.440609   .1466241    -9.83   0.000    -1.728044   -1.153175
         20  |  -1.496305   .1501575    -9.96   0.000    -1.790667   -1.201944
         21  |  -1.558571    .153736   -10.14   0.000    -1.859947   -1.257195
         22  |  -1.606022   .1570706   -10.22   0.000    -1.913936   -1.298109
         23  |  -1.613077   .1604059   -10.06   0.000    -1.927528   -1.298625
         24  |  -1.661136    .164382   -10.11   0.000    -1.983382   -1.338889
         25  |  -1.693957   .1688152   -10.03   0.000    -2.024893    -1.36302
         26  |   .9248636    .141861     6.52   0.000     .6467665    1.202961
         27  |   .6077882   .1299984     4.68   0.000     .3529457    .8626307
         28  |   .3951081   .1258324     3.14   0.002     .1484326    .6417836
         29  |   .1945727   .1231416     1.58   0.114    -.0468279    .4359732
         30  |   .1002017   .1200215     0.83   0.404    -.1350824    .3354858
         31  |  -.0202066   .1204271    -0.17   0.867    -.2562859    .2158727
         32  |  -.0705828   .1190948    -0.59   0.553    -.3040504    .1628848
         33  |  -.1211871   .1192196    -1.02   0.309    -.3548992    .1125249
         34  |  -.2317457   .1206126    -1.92   0.055    -.4681887    .0046973
         35  |  -.3084795   .1240897    -2.49   0.013    -.5517388   -.0652203
         36  |  -.4028804   .1253447    -3.21   0.001    -.6485999   -.1571609
         37  |  -.4784161   .1283288    -3.73   0.000    -.7299854   -.2268468
         38  |  -.5786467   .1311648    -4.41   0.000    -.8357757   -.3215178
         39  |  -.6744904   .1348437    -5.00   0.000    -.9388312   -.4101497
         40  |  -.7064539    .138966    -5.08   0.000    -.9788758   -.4340319
         41  |  -.7638105   .1422873    -5.37   0.000    -1.042743   -.4848775
         42  |  -.8284903    .146266    -5.66   0.000    -1.115223   -.5417577
         43  |  -.9813141   .1498425    -6.55   0.000    -1.275058   -.6875704
         44  |  -1.062146   .1545357    -6.87   0.000     -1.36509   -.7592017
         45  |  -1.113849   .1581187    -7.04   0.000    -1.423817   -.8038812
         46  |  -1.131671   .1618811    -6.99   0.000    -1.449015   -.8143272
         47  |  -1.180273   .1653101    -7.14   0.000    -1.504339   -.8562076
         48  |  -1.198643   .1688702    -7.10   0.000    -1.529687   -.8675981
         49  |  -1.225699   .1731779    -7.08   0.000    -1.565189   -.8862102
         50  |  -1.259977   .1761772    -7.15   0.000    -1.605346   -.9146084
             |
     age_cat |
          1  |   .5424921   .0476944    11.37   0.000     .4489945    .6359898
          2  |   .9547879    .053747    17.76   0.000     .8494249    1.060151
          3  |   1.296841   .0585805    22.14   0.000     1.182002    1.411679
          4  |   1.574586   .0623199    25.27   0.000     1.452417    1.696755
          5  |   1.798822   .0666557    26.99   0.000     1.668153     1.92949
          6  |   1.971036   .0704091    27.99   0.000     1.833009    2.109062
          7  |    2.11597   .0744049    28.44   0.000     1.970111     2.26183
          8  |    2.24416    .078932    28.43   0.000     2.089425    2.398894
          9  |   2.358962   .0834532    28.27   0.000     2.195365     2.52256
         10  |   2.454073    .087887    27.92   0.000     2.281784    2.626362
         11  |   2.557536   .0926934    27.59   0.000     2.375824    2.739247
         12  |   2.648268   .0969963    27.30   0.000     2.458121    2.838415
         13  |   2.723123   .1019087    26.72   0.000     2.523346      2.9229
         14  |   2.793623   .1065762    26.21   0.000     2.584696     3.00255
         15  |   2.855735   .1113079    25.66   0.000     2.637533    3.073938
         16  |   2.902108   .1163192    24.95   0.000     2.674082    3.130135
         17  |   2.960341   .1213346    24.40   0.000     2.722483    3.198199
         18  |   3.029311   .1256872    24.10   0.000     2.782921    3.275702
         19  |   3.091229   .1305578    23.68   0.000      2.83529    3.347168
         20  |   3.188459   .1399685    22.78   0.000     2.914072    3.462846
         25  |   3.319751   .1566194    21.20   0.000     3.012722     3.62678
         30  |   3.231428   .1907778    16.94   0.000     2.857437    3.605419
         40  |   3.135331   .2159862    14.52   0.000     2.711922     3.55874
         50  |   3.071649   .2148631    14.30   0.000     2.650442    3.492856
             |
       _cons |   2.254458     .09877    22.83   0.000     2.060835    2.448082
-------------+----------------------------------------------------------------
     sigma_u |  1.2797721
     sigma_e |  .65304386
         rho |  .79340707   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1599502178672509

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    156,204
Group variable: firm_person                     Number of groups  =     16,977

R-sq:                                           Obs per group:
     within  = 0.1600                                         min =          1
     between = 0.0107                                         avg =        9.2
     overall = 0.0273                                         max =         25

                                                F(78,6146)        =      24.09
corr(u_i, Xb)  = -0.3739                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 6,147 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0341011   .0476644     0.72   0.474    -.0593378      .12754
      during |   .0052925   .0145452     0.36   0.716    -.0232212    .0338061
       after |  -.1623379   .0266543    -6.09   0.000    -.2145896   -.1100862
during_expat |  -.0967889   .0541871    -1.79   0.074    -.2030146    .0094368
 after_expat |  -.0562015    .065729    -0.86   0.393    -.1850534    .0726504
             |
    ind_year |
          2  |  -.1371099    .057089    -2.40   0.016    -.2490244   -.0251954
          3  |  -.3331014   .0708737    -4.70   0.000    -.4720386   -.1941641
          4  |  -.4266978   .0757472    -5.63   0.000    -.5751888   -.2782068
          5  |  -.5351287   .0832429    -6.43   0.000    -.6983139   -.3719435
          6  |  -.6245098   .0885814    -7.05   0.000    -.7981604   -.4508592
          7  |  -.7151498   .0934876    -7.65   0.000    -.8984182   -.5318815
          8  |  -.7578633   .0995599    -7.61   0.000    -.9530355   -.5626911
          9  |  -.8072832   .1037074    -7.78   0.000    -1.010586   -.6039804
         10  |  -.8511796   .1079123    -7.89   0.000    -1.062725   -.6396337
         11  |  -.9025429   .1114296    -8.10   0.000    -1.120984   -.6841019
         12  |  -.9624359   .1158279    -8.31   0.000    -1.189499   -.7353727
         13  |  -1.013368   .1208716    -8.38   0.000    -1.250319   -.7764175
         14  |  -1.089328   .1255947    -8.67   0.000    -1.335538   -.8431187
         15  |  -1.139436   .1301511    -8.75   0.000    -1.394578   -.8842945
         16  |  -1.200404   .1341643    -8.95   0.000    -1.463413   -.9373948
         17  |  -1.265902     .13852    -9.14   0.000     -1.53745   -.9943547
         18  |  -1.347981   .1425352    -9.46   0.000      -1.6274   -1.068562
         19  |  -1.440609   .1466241    -9.83   0.000    -1.728044   -1.153175
         20  |  -1.496305   .1501575    -9.96   0.000    -1.790667   -1.201944
         21  |  -1.558571    .153736   -10.14   0.000    -1.859947   -1.257195
         22  |  -1.606022   .1570706   -10.22   0.000    -1.913936   -1.298109
         23  |  -1.613077   .1604059   -10.06   0.000    -1.927528   -1.298625
         24  |  -1.661136    .164382   -10.11   0.000    -1.983382   -1.338889
         25  |  -1.693957   .1688152   -10.03   0.000    -2.024893    -1.36302
         26  |   .9248636    .141861     6.52   0.000     .6467665    1.202961
         27  |   .6077882   .1299984     4.68   0.000     .3529457    .8626307
         28  |   .3951081   .1258324     3.14   0.002     .1484326    .6417836
         29  |   .1945727   .1231416     1.58   0.114    -.0468279    .4359732
         30  |   .1002017   .1200215     0.83   0.404    -.1350824    .3354858
         31  |  -.0202066   .1204271    -0.17   0.867    -.2562859    .2158727
         32  |  -.0705828   .1190948    -0.59   0.553    -.3040504    .1628848
         33  |  -.1211871   .1192196    -1.02   0.309    -.3548992    .1125249
         34  |  -.2317457   .1206126    -1.92   0.055    -.4681887    .0046973
         35  |  -.3084795   .1240897    -2.49   0.013    -.5517388   -.0652203
         36  |  -.4028804   .1253447    -3.21   0.001    -.6485999   -.1571609
         37  |  -.4784161   .1283288    -3.73   0.000    -.7299854   -.2268468
         38  |  -.5786467   .1311648    -4.41   0.000    -.8357757   -.3215178
         39  |  -.6744904   .1348437    -5.00   0.000    -.9388312   -.4101497
         40  |  -.7064539    .138966    -5.08   0.000    -.9788758   -.4340319
         41  |  -.7638105   .1422873    -5.37   0.000    -1.042743   -.4848775
         42  |  -.8284903    .146266    -5.66   0.000    -1.115223   -.5417577
         43  |  -.9813141   .1498425    -6.55   0.000    -1.275058   -.6875704
         44  |  -1.062146   .1545357    -6.87   0.000     -1.36509   -.7592017
         45  |  -1.113849   .1581187    -7.04   0.000    -1.423817   -.8038812
         46  |  -1.131671   .1618811    -6.99   0.000    -1.449015   -.8143272
         47  |  -1.180273   .1653101    -7.14   0.000    -1.504339   -.8562076
         48  |  -1.198643   .1688702    -7.10   0.000    -1.529687   -.8675981
         49  |  -1.225699   .1731779    -7.08   0.000    -1.565189   -.8862102
         50  |  -1.259977   .1761772    -7.15   0.000    -1.605346   -.9146084
             |
     age_cat |
          1  |   .5424921   .0476944    11.37   0.000     .4489945    .6359898
          2  |   .9547879    .053747    17.76   0.000     .8494249    1.060151
          3  |   1.296841   .0585805    22.14   0.000     1.182002    1.411679
          4  |   1.574586   .0623199    25.27   0.000     1.452417    1.696755
          5  |   1.798822   .0666557    26.99   0.000     1.668153     1.92949
          6  |   1.971036   .0704091    27.99   0.000     1.833009    2.109062
          7  |    2.11597   .0744049    28.44   0.000     1.970111     2.26183
          8  |    2.24416    .078932    28.43   0.000     2.089425    2.398894
          9  |   2.358962   .0834532    28.27   0.000     2.195365     2.52256
         10  |   2.454073    .087887    27.92   0.000     2.281784    2.626362
         11  |   2.557536   .0926934    27.59   0.000     2.375824    2.739247
         12  |   2.648268   .0969963    27.30   0.000     2.458121    2.838415
         13  |   2.723123   .1019087    26.72   0.000     2.523346      2.9229
         14  |   2.793623   .1065762    26.21   0.000     2.584696     3.00255
         15  |   2.855735   .1113079    25.66   0.000     2.637533    3.073938
         16  |   2.902108   .1163192    24.95   0.000     2.674082    3.130135
         17  |   2.960341   .1213346    24.40   0.000     2.722483    3.198199
         18  |   3.029311   .1256872    24.10   0.000     2.782921    3.275702
         19  |   3.091229   .1305578    23.68   0.000      2.83529    3.347168
         20  |   3.188459   .1399685    22.78   0.000     2.914072    3.462846
         25  |   3.319751   .1566194    21.20   0.000     3.012722     3.62678
         30  |   3.231428   .1907778    16.94   0.000     2.857437    3.605419
         40  |   3.135331   .2159862    14.52   0.000     2.711922     3.55874
         50  |   3.071649   .2148631    14.30   0.000     2.650442    3.492856
             |
       _cons |   2.254458     .09877    22.83   0.000     2.060835    2.448082
-------------+----------------------------------------------------------------
     sigma_u |  1.2797721
     sigma_e |  .65304386
         rho |  .79340707   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    144967
Group variable: firm_person                     Number of groups   =     15682

R-sq:  within  = 0.1566                         Obs per group: min =         1
       between = 0.0052                                        avg =       9.2
       overall = 0.0204                                        max =        25

                                                F(78,5715)         =     22.45
corr(u_i, Xb)  = -0.3848                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,716 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .023768   .0516935     0.46   0.646    -.0775708    .1251068
      during |   .0130452   .0150947     0.86   0.388    -.0165461    .0426366
       after |  -.1437338   .0273771    -5.25   0.000    -.1974033   -.0900643
during_expat |  -.0011214   .0603341    -0.02   0.985     -.119399    .1171563
 after_expat |   -.016195    .080342    -0.20   0.840    -.1736958    .1413059
             |
    ind_year |
          2  |  -.1290548   .0523705    -2.46   0.014    -.2317207   -.0263888
          3  |  -.2853469   .0636281    -4.48   0.000    -.4100821   -.1606117
          4  |  -.3850675   .0705476    -5.46   0.000    -.5233676   -.2467675
          5  |  -.4700262   .0780624    -6.02   0.000    -.6230582   -.3169943
          6  |  -.5598363   .0844231    -6.63   0.000    -.7253376   -.3943351
          7  |  -.6278797   .0901327    -6.97   0.000     -.804574   -.4511854
          8  |   -.658379   .0964288    -6.83   0.000    -.8474161   -.4693419
          9  |    -.70834   .1015282    -6.98   0.000    -.9073738   -.5093062
         10  |  -.7505048   .1060714    -7.08   0.000    -.9584449   -.5425646
         11  |  -.7973528   .1100886    -7.24   0.000    -1.013168   -.5815374
         12  |  -.8560904   .1151112    -7.44   0.000    -1.081752   -.6304288
         13  |  -.9083873   .1205597    -7.53   0.000     -1.14473   -.6720445
         14  |    -.98725   .1258252    -7.85   0.000    -1.233915   -.7405849
         15  |   -1.03749   .1306686    -7.94   0.000     -1.29365   -.7813299
         16  |  -1.095559   .1350571    -8.11   0.000    -1.360322   -.8307959
         17  |  -1.165568   .1397628    -8.34   0.000    -1.439556   -.8915803
         18  |  -1.250586   .1440526    -8.68   0.000    -1.532984   -.9681882
         19  |  -1.335476    .148381    -9.00   0.000    -1.626359   -1.044593
         20  |  -1.390281   .1522896    -9.13   0.000    -1.688827   -1.091736
         21  |  -1.468278   .1561707    -9.40   0.000    -1.774432   -1.162124
         22  |  -1.527105    .159765    -9.56   0.000    -1.840305   -1.213905
         23  |  -1.554349   .1633697    -9.51   0.000    -1.874615   -1.234082
         24  |   -1.61243   .1675475    -9.62   0.000    -1.940886   -1.283973
         25  |  -1.631466   .1723082    -9.47   0.000    -1.969256   -1.293677
         26  |   .8111759   .1574031     5.15   0.000     .5026061    1.119746
         27  |   .4574699   .1420379     3.22   0.001     .1790216    .7359181
         28  |   .2735345   .1345212     2.03   0.042     .0098219    .5372471
         29  |   .1252441   .1312921     0.95   0.340    -.1321382    .3826263
         30  |   .1054078   .1266357     0.83   0.405    -.1428462    .3536617
         31  |  -.0236754   .1251245    -0.19   0.850    -.2689667     .221616
         32  |  -.0463784   .1226953    -0.38   0.705    -.2869077    .1941508
         33  |  -.1419102   .1231673    -1.15   0.249    -.3833648    .0995444
         34  |  -.2673154   .1249023    -2.14   0.032    -.5121713   -.0224595
         35  |  -.3103816   .1276002    -2.43   0.015    -.5605263   -.0602369
         36  |   -.394533   .1287838    -3.06   0.002     -.646998    -.142068
         37  |  -.4590632    .131721    -3.49   0.000    -.7172863   -.2008402
         38  |  -.5750556   .1341644    -4.29   0.000    -.8380686   -.3120425
         39  |  -.6721486   .1386495    -4.85   0.000    -.9439541    -.400343
         40  |  -.7028425   .1429471    -4.92   0.000    -.9830731   -.4226119
         41  |  -.7637608   .1464155    -5.22   0.000    -1.050791   -.4767309
         42  |  -.8387456   .1506363    -5.57   0.000     -1.13405   -.5434414
         43  |  -.9471338   .1547428    -6.12   0.000    -1.250488   -.6437793
         44  |  -1.026983    .159758    -6.43   0.000    -1.340169   -.7137967
         45  |  -1.072857   .1636793    -6.55   0.000    -1.393731   -.7519839
         46  |  -1.119812   .1683947    -6.65   0.000    -1.449929   -.7896943
         47  |  -1.144789   .1716931    -6.67   0.000    -1.481373   -.8082059
         48  |  -1.175259   .1756086    -6.69   0.000    -1.519518   -.8309995
         49  |  -1.225646   .1801489    -6.80   0.000    -1.578806    -.872486
         50  |  -1.256646   .1839345    -6.83   0.000    -1.617228    -.896065
             |
     age_cat |
          1  |   .5831358   .0545636    10.69   0.000     .4761704    .6901012
          2  |   .9954617    .058766    16.94   0.000     .8802582    1.110665
          3  |   1.322679   .0631294    20.95   0.000     1.198921    1.446436
          4  |   1.601846   .0668409    23.97   0.000     1.470812    1.732879
          5  |   1.819327   .0706279    25.76   0.000      1.68087    1.957784
          6  |   1.983395   .0743573    26.67   0.000     1.837626    2.129164
          7  |   2.114118    .079241    26.68   0.000     1.958775     2.26946
          8  |   2.239904   .0838657    26.71   0.000     2.075496    2.404313
          9  |   2.350621   .0885957    26.53   0.000      2.17694    2.524302
         10  |   2.449199   .0932362    26.27   0.000     2.266421    2.631978
         11  |   2.561536   .0981616    26.10   0.000     2.369102     2.75397
         12  |   2.640896   .1025394    25.75   0.000      2.43988    2.841912
         13  |    2.72478   .1074224    25.37   0.000     2.514191    2.935369
         14  |   2.798656   .1122356    24.94   0.000     2.578631     3.01868
         15  |    2.86559   .1173585    24.42   0.000     2.635523    3.095657
         16  |   2.910979   .1224697    23.77   0.000     2.670892    3.151066
         17  |   2.967683   .1277165    23.24   0.000      2.71731    3.218056
         18  |   3.039547   .1324885    22.94   0.000      2.77982    3.299275
         19  |    3.08557   .1374367    22.45   0.000     2.816142    3.354998
         20  |   3.172583   .1472226    21.55   0.000     2.883971    3.461196
         25  |   3.305507   .1644706    20.10   0.000     2.983082    3.627931
         30  |    3.21092   .2002665    16.03   0.000     2.818322    3.603518
         40  |   3.152055   .2249858    14.01   0.000     2.710998    3.593113
         50  |   3.056113   .2233724    13.68   0.000     2.618219    3.494008
             |
       _cons |   2.176948   .0970947    22.42   0.000     1.986605     2.36729
-------------+----------------------------------------------------------------
     sigma_u |   1.266633
     sigma_e |  .64349965
         rho |  .79484674   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1565945869637263

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    144,967
Group variable: firm_person                     Number of groups  =     15,682

R-sq:                                           Obs per group:
     within  = 0.1566                                         min =          1
     between = 0.0052                                         avg =        9.2
     overall = 0.0204                                         max =         25

                                                F(78,5715)        =      22.45
corr(u_i, Xb)  = -0.3848                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,716 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .023768   .0516935     0.46   0.646    -.0775708    .1251068
      during |   .0130452   .0150947     0.86   0.388    -.0165461    .0426366
       after |  -.1437338   .0273771    -5.25   0.000    -.1974033   -.0900643
during_expat |  -.0011214   .0603341    -0.02   0.985     -.119399    .1171563
 after_expat |   -.016195    .080342    -0.20   0.840    -.1736958    .1413059
             |
    ind_year |
          2  |  -.1290548   .0523705    -2.46   0.014    -.2317207   -.0263888
          3  |  -.2853469   .0636281    -4.48   0.000    -.4100821   -.1606117
          4  |  -.3850675   .0705476    -5.46   0.000    -.5233676   -.2467675
          5  |  -.4700262   .0780624    -6.02   0.000    -.6230582   -.3169943
          6  |  -.5598363   .0844231    -6.63   0.000    -.7253376   -.3943351
          7  |  -.6278797   .0901327    -6.97   0.000     -.804574   -.4511854
          8  |   -.658379   .0964288    -6.83   0.000    -.8474161   -.4693419
          9  |    -.70834   .1015282    -6.98   0.000    -.9073738   -.5093062
         10  |  -.7505048   .1060714    -7.08   0.000    -.9584449   -.5425646
         11  |  -.7973528   .1100886    -7.24   0.000    -1.013168   -.5815374
         12  |  -.8560904   .1151112    -7.44   0.000    -1.081752   -.6304288
         13  |  -.9083873   .1205597    -7.53   0.000     -1.14473   -.6720445
         14  |    -.98725   .1258252    -7.85   0.000    -1.233915   -.7405849
         15  |   -1.03749   .1306686    -7.94   0.000     -1.29365   -.7813299
         16  |  -1.095559   .1350571    -8.11   0.000    -1.360322   -.8307959
         17  |  -1.165568   .1397628    -8.34   0.000    -1.439556   -.8915803
         18  |  -1.250586   .1440526    -8.68   0.000    -1.532984   -.9681882
         19  |  -1.335476    .148381    -9.00   0.000    -1.626359   -1.044593
         20  |  -1.390281   .1522896    -9.13   0.000    -1.688827   -1.091736
         21  |  -1.468278   .1561707    -9.40   0.000    -1.774432   -1.162124
         22  |  -1.527105    .159765    -9.56   0.000    -1.840305   -1.213905
         23  |  -1.554349   .1633697    -9.51   0.000    -1.874615   -1.234082
         24  |   -1.61243   .1675475    -9.62   0.000    -1.940886   -1.283973
         25  |  -1.631466   .1723082    -9.47   0.000    -1.969256   -1.293677
         26  |   .8111759   .1574031     5.15   0.000     .5026061    1.119746
         27  |   .4574699   .1420379     3.22   0.001     .1790216    .7359181
         28  |   .2735345   .1345212     2.03   0.042     .0098219    .5372471
         29  |   .1252441   .1312921     0.95   0.340    -.1321382    .3826263
         30  |   .1054078   .1266357     0.83   0.405    -.1428462    .3536617
         31  |  -.0236754   .1251245    -0.19   0.850    -.2689667     .221616
         32  |  -.0463784   .1226953    -0.38   0.705    -.2869077    .1941508
         33  |  -.1419102   .1231673    -1.15   0.249    -.3833648    .0995444
         34  |  -.2673154   .1249023    -2.14   0.032    -.5121713   -.0224595
         35  |  -.3103816   .1276002    -2.43   0.015    -.5605263   -.0602369
         36  |   -.394533   .1287838    -3.06   0.002     -.646998    -.142068
         37  |  -.4590632    .131721    -3.49   0.000    -.7172863   -.2008402
         38  |  -.5750556   .1341644    -4.29   0.000    -.8380686   -.3120425
         39  |  -.6721486   .1386495    -4.85   0.000    -.9439541    -.400343
         40  |  -.7028425   .1429471    -4.92   0.000    -.9830731   -.4226119
         41  |  -.7637608   .1464155    -5.22   0.000    -1.050791   -.4767309
         42  |  -.8387456   .1506363    -5.57   0.000     -1.13405   -.5434414
         43  |  -.9471338   .1547428    -6.12   0.000    -1.250488   -.6437793
         44  |  -1.026983    .159758    -6.43   0.000    -1.340169   -.7137967
         45  |  -1.072857   .1636793    -6.55   0.000    -1.393731   -.7519839
         46  |  -1.119812   .1683947    -6.65   0.000    -1.449929   -.7896943
         47  |  -1.144789   .1716931    -6.67   0.000    -1.481373   -.8082059
         48  |  -1.175259   .1756086    -6.69   0.000    -1.519518   -.8309995
         49  |  -1.225646   .1801489    -6.80   0.000    -1.578806    -.872486
         50  |  -1.256646   .1839345    -6.83   0.000    -1.617228    -.896065
             |
     age_cat |
          1  |   .5831358   .0545636    10.69   0.000     .4761704    .6901012
          2  |   .9954617    .058766    16.94   0.000     .8802582    1.110665
          3  |   1.322679   .0631294    20.95   0.000     1.198921    1.446436
          4  |   1.601846   .0668409    23.97   0.000     1.470812    1.732879
          5  |   1.819327   .0706279    25.76   0.000      1.68087    1.957784
          6  |   1.983395   .0743573    26.67   0.000     1.837626    2.129164
          7  |   2.114118    .079241    26.68   0.000     1.958775     2.26946
          8  |   2.239904   .0838657    26.71   0.000     2.075496    2.404313
          9  |   2.350621   .0885957    26.53   0.000      2.17694    2.524302
         10  |   2.449199   .0932362    26.27   0.000     2.266421    2.631978
         11  |   2.561536   .0981616    26.10   0.000     2.369102     2.75397
         12  |   2.640896   .1025394    25.75   0.000      2.43988    2.841912
         13  |    2.72478   .1074224    25.37   0.000     2.514191    2.935369
         14  |   2.798656   .1122356    24.94   0.000     2.578631     3.01868
         15  |    2.86559   .1173585    24.42   0.000     2.635523    3.095657
         16  |   2.910979   .1224697    23.77   0.000     2.670892    3.151066
         17  |   2.967683   .1277165    23.24   0.000      2.71731    3.218056
         18  |   3.039547   .1324885    22.94   0.000      2.77982    3.299275
         19  |    3.08557   .1374367    22.45   0.000     2.816142    3.354998
         20  |   3.172583   .1472226    21.55   0.000     2.883971    3.461196
         25  |   3.305507   .1644706    20.10   0.000     2.983082    3.627931
         30  |    3.21092   .2002665    16.03   0.000     2.818322    3.603518
         40  |   3.152055   .2249858    14.01   0.000     2.710998    3.593113
         50  |   3.056113   .2233724    13.68   0.000     2.618219    3.494008
             |
       _cons |   2.176948   .0970947    22.42   0.000     1.986605     2.36729
-------------+----------------------------------------------------------------
     sigma_u |   1.266633
     sigma_e |  .64349965
         rho |  .79484674   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    132749
Group variable: firm_person                     Number of groups   =     14465

R-sq:  within  = 0.1094                         Obs per group: min =         1
       between = 0.0134                                        avg =       9.2
       overall = 0.0261                                        max =        25

                                                F(78,4832)         =     13.30
corr(u_i, Xb)  = -0.2663                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,833 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0228493   .0620093     0.37   0.713    -.0987172    .1444158
      during |  -.0947784   .0169902    -5.58   0.000    -.1280869   -.0614699
       after |  -.2981083   .0307502    -9.69   0.000    -.3583926    -.237824
during_expat |  -.0130673   .0544974    -0.24   0.811     -.119907    .0937724
 after_expat |   .0379074   .0705978     0.54   0.591    -.1004964    .1763112
             |
    ind_year |
          2  |  -.2143877   .0478488    -4.48   0.000     -.308193   -.1205824
          3  |  -.4526922   .0624675    -7.25   0.000    -.5751568   -.3302275
          4  |  -.5927404    .069303    -8.55   0.000    -.7286057    -.456875
          5  |  -.7219088   .0773205    -9.34   0.000    -.8734921   -.5703255
          6  |   -.836852   .0836973   -10.00   0.000    -1.000937   -.6727672
          7  |  -.9347433    .090041   -10.38   0.000    -1.111265   -.7582219
          8  |  -.9706431   .0969568   -10.01   0.000    -1.160723   -.7805636
          9  |  -1.065222   .1036633   -10.28   0.000    -1.268449    -.861995
         10  |  -1.128444   .1089293   -10.36   0.000    -1.341995   -.9148931
         11  |  -1.183206   .1125529   -10.51   0.000     -1.40386   -.9625508
         12  |  -1.248104    .117302   -10.64   0.000    -1.478069   -1.018138
         13  |  -1.283639   .1227003   -10.46   0.000    -1.524187    -1.04309
         14  |  -1.372326   .1278902   -10.73   0.000    -1.623049   -1.121604
         15  |  -1.418151   .1325638   -10.70   0.000    -1.678037   -1.158266
         16  |  -1.453465   .1367492   -10.63   0.000    -1.721556   -1.185375
         17  |  -1.502377   .1408562   -10.67   0.000    -1.778519   -1.226234
         18  |  -1.585706   .1447209   -10.96   0.000    -1.869424   -1.301987
         19  |  -1.649914   .1484392   -11.12   0.000    -1.940923   -1.358906
         20  |  -1.698906   .1517313   -11.20   0.000    -1.996369   -1.401444
         21  |  -1.737849   .1546418   -11.24   0.000    -2.041018   -1.434681
         22  |  -1.790959   .1576693   -11.36   0.000    -2.100062   -1.481855
         23  |  -1.787529   .1605056   -11.14   0.000    -2.102193   -1.472865
         24  |  -1.839157   .1643772   -11.19   0.000    -2.161411   -1.516903
         25  |  -1.839231   .1686859   -10.90   0.000    -2.169932    -1.50853
         26  |   .7495968   .1291197     5.81   0.000     .4964634     1.00273
         27  |   .4751498   .1222076     3.89   0.000     .2355673    .7147322
         28  |    .310608   .1199219     2.59   0.010     .0755065    .5457095
         29  |   .1250828   .1178437     1.06   0.289    -.1059444      .35611
         30  |   .0322475   .1168563     0.28   0.783    -.1968439    .2613389
         31  |  -.1209669   .1192138    -1.01   0.310    -.3546803    .1127464
         32  |   -.210539   .1195157    -1.76   0.078    -.4448442    .0237663
         33  |  -.3030597   .1214437    -2.50   0.013    -.5411446   -.0649748
         34  |  -.3992029   .1239307    -3.22   0.001    -.6421635   -.1562424
         35  |  -.4873059   .1274111    -3.82   0.000    -.7370897   -.2375222
         36  |  -.6012043   .1293511    -4.65   0.000    -.8547913   -.3476173
         37  |  -.7069228   .1319749    -5.36   0.000    -.9656537   -.4481918
         38  |  -.8066628   .1353513    -5.96   0.000    -1.072013   -.5413127
         39  |  -.9052677   .1395215    -6.49   0.000    -1.178793   -.6317422
         40  |  -.9452646   .1438393    -6.57   0.000    -1.227255   -.6632741
         41  |  -1.004013   .1472028    -6.82   0.000    -1.292597    -.715428
         42  |  -1.102367   .1508822    -7.31   0.000    -1.398165   -.8065693
         43  |  -1.247637   .1542455    -8.09   0.000    -1.550029   -.9452459
         44  |  -1.321419   .1585314    -8.34   0.000    -1.632213   -1.010626
         45  |   -1.35393   .1624136    -8.34   0.000    -1.672334   -1.035525
         46  |  -1.367369   .1663372    -8.22   0.000    -1.693466   -1.041273
         47  |  -1.382689   .1692559    -8.17   0.000    -1.714508   -1.050871
         48  |  -1.404946   .1728269    -8.13   0.000    -1.743766   -1.066127
         49  |  -1.443444   .1764166    -8.18   0.000    -1.789301   -1.097587
         50  |  -1.475814   .1797144    -8.21   0.000    -1.828136   -1.123492
             |
     age_cat |
          1  |   .5590054   .0697038     8.02   0.000     .4223542    .6956565
          2  |   .9064209   .0760851    11.91   0.000     .7572595    1.055582
          3  |   1.196593   .0811259    14.75   0.000     1.037549    1.355636
          4  |   1.449959   .0856224    16.93   0.000       1.2821    1.617818
          5  |   1.662447   .0898822    18.50   0.000     1.486237    1.838657
          6  |   1.816614   .0933386    19.46   0.000     1.633628      1.9996
          7  |   1.942073   .0976064    19.90   0.000      1.75072    2.133426
          8  |   2.060642    .101816    20.24   0.000     1.861037    2.260248
          9  |   2.154749   .1060085    20.33   0.000     1.946925    2.362574
         10  |   2.246334   .1097326    20.47   0.000     2.031208     2.46146
         11  |   2.342224   .1136561    20.61   0.000     2.119406    2.565042
         12  |   2.410216   .1173746    20.53   0.000     2.180109    2.640324
         13  |   2.481787   .1214996    20.43   0.000     2.243593    2.719982
         14  |   2.548577    .125533    20.30   0.000     2.302476    2.794679
         15  |   2.608215   .1297876    20.10   0.000     2.353772    2.862657
         16  |    2.65985   .1341282    19.83   0.000     2.396897    2.922802
         17  |   2.718865   .1384562    19.64   0.000     2.447428    2.990302
         18  |   2.792284   .1424703    19.60   0.000     2.512977    3.071591
         19  |   2.840738   .1465669    19.38   0.000       2.5534    3.128075
         20  |   2.905739    .154863    18.76   0.000     2.602137    3.209341
         25  |   3.000825   .1697017    17.68   0.000     2.668133    3.333518
         30  |   2.858011   .1986593    14.39   0.000     2.468549    3.247474
         40  |   2.819225   .2232318    12.63   0.000      2.38159    3.256861
         50  |   2.794627   .2235307    12.50   0.000     2.356405    3.232849
             |
       _cons |   2.735272   .1116455    24.50   0.000     2.516396    2.954148
-------------+----------------------------------------------------------------
     sigma_u |  1.3188074
     sigma_e |  .63397364
         rho |  .81228882   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1093962468618311

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    132,749
Group variable: firm_person                     Number of groups  =     14,465

R-sq:                                           Obs per group:
     within  = 0.1094                                         min =          1
     between = 0.0134                                         avg =        9.2
     overall = 0.0261                                         max =         25

                                                F(78,4832)        =      13.30
corr(u_i, Xb)  = -0.2663                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,833 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0228493   .0620093     0.37   0.713    -.0987172    .1444158
      during |  -.0947784   .0169902    -5.58   0.000    -.1280869   -.0614699
       after |  -.2981083   .0307502    -9.69   0.000    -.3583926    -.237824
during_expat |  -.0130673   .0544974    -0.24   0.811     -.119907    .0937724
 after_expat |   .0379074   .0705978     0.54   0.591    -.1004964    .1763112
             |
    ind_year |
          2  |  -.2143877   .0478488    -4.48   0.000     -.308193   -.1205824
          3  |  -.4526922   .0624675    -7.25   0.000    -.5751568   -.3302275
          4  |  -.5927404    .069303    -8.55   0.000    -.7286057    -.456875
          5  |  -.7219088   .0773205    -9.34   0.000    -.8734921   -.5703255
          6  |   -.836852   .0836973   -10.00   0.000    -1.000937   -.6727672
          7  |  -.9347433    .090041   -10.38   0.000    -1.111265   -.7582219
          8  |  -.9706431   .0969568   -10.01   0.000    -1.160723   -.7805636
          9  |  -1.065222   .1036633   -10.28   0.000    -1.268449    -.861995
         10  |  -1.128444   .1089293   -10.36   0.000    -1.341995   -.9148931
         11  |  -1.183206   .1125529   -10.51   0.000     -1.40386   -.9625508
         12  |  -1.248104    .117302   -10.64   0.000    -1.478069   -1.018138
         13  |  -1.283639   .1227003   -10.46   0.000    -1.524187    -1.04309
         14  |  -1.372326   .1278902   -10.73   0.000    -1.623049   -1.121604
         15  |  -1.418151   .1325638   -10.70   0.000    -1.678037   -1.158266
         16  |  -1.453465   .1367492   -10.63   0.000    -1.721556   -1.185375
         17  |  -1.502377   .1408562   -10.67   0.000    -1.778519   -1.226234
         18  |  -1.585706   .1447209   -10.96   0.000    -1.869424   -1.301987
         19  |  -1.649914   .1484392   -11.12   0.000    -1.940923   -1.358906
         20  |  -1.698906   .1517313   -11.20   0.000    -1.996369   -1.401444
         21  |  -1.737849   .1546418   -11.24   0.000    -2.041018   -1.434681
         22  |  -1.790959   .1576693   -11.36   0.000    -2.100062   -1.481855
         23  |  -1.787529   .1605056   -11.14   0.000    -2.102193   -1.472865
         24  |  -1.839157   .1643772   -11.19   0.000    -2.161411   -1.516903
         25  |  -1.839231   .1686859   -10.90   0.000    -2.169932    -1.50853
         26  |   .7495968   .1291197     5.81   0.000     .4964634     1.00273
         27  |   .4751498   .1222076     3.89   0.000     .2355673    .7147322
         28  |    .310608   .1199219     2.59   0.010     .0755065    .5457095
         29  |   .1250828   .1178437     1.06   0.289    -.1059444      .35611
         30  |   .0322475   .1168563     0.28   0.783    -.1968439    .2613389
         31  |  -.1209669   .1192138    -1.01   0.310    -.3546803    .1127464
         32  |   -.210539   .1195157    -1.76   0.078    -.4448442    .0237663
         33  |  -.3030597   .1214437    -2.50   0.013    -.5411446   -.0649748
         34  |  -.3992029   .1239307    -3.22   0.001    -.6421635   -.1562424
         35  |  -.4873059   .1274111    -3.82   0.000    -.7370897   -.2375222
         36  |  -.6012043   .1293511    -4.65   0.000    -.8547913   -.3476173
         37  |  -.7069228   .1319749    -5.36   0.000    -.9656537   -.4481918
         38  |  -.8066628   .1353513    -5.96   0.000    -1.072013   -.5413127
         39  |  -.9052677   .1395215    -6.49   0.000    -1.178793   -.6317422
         40  |  -.9452646   .1438393    -6.57   0.000    -1.227255   -.6632741
         41  |  -1.004013   .1472028    -6.82   0.000    -1.292597    -.715428
         42  |  -1.102367   .1508822    -7.31   0.000    -1.398165   -.8065693
         43  |  -1.247637   .1542455    -8.09   0.000    -1.550029   -.9452459
         44  |  -1.321419   .1585314    -8.34   0.000    -1.632213   -1.010626
         45  |   -1.35393   .1624136    -8.34   0.000    -1.672334   -1.035525
         46  |  -1.367369   .1663372    -8.22   0.000    -1.693466   -1.041273
         47  |  -1.382689   .1692559    -8.17   0.000    -1.714508   -1.050871
         48  |  -1.404946   .1728269    -8.13   0.000    -1.743766   -1.066127
         49  |  -1.443444   .1764166    -8.18   0.000    -1.789301   -1.097587
         50  |  -1.475814   .1797144    -8.21   0.000    -1.828136   -1.123492
             |
     age_cat |
          1  |   .5590054   .0697038     8.02   0.000     .4223542    .6956565
          2  |   .9064209   .0760851    11.91   0.000     .7572595    1.055582
          3  |   1.196593   .0811259    14.75   0.000     1.037549    1.355636
          4  |   1.449959   .0856224    16.93   0.000       1.2821    1.617818
          5  |   1.662447   .0898822    18.50   0.000     1.486237    1.838657
          6  |   1.816614   .0933386    19.46   0.000     1.633628      1.9996
          7  |   1.942073   .0976064    19.90   0.000      1.75072    2.133426
          8  |   2.060642    .101816    20.24   0.000     1.861037    2.260248
          9  |   2.154749   .1060085    20.33   0.000     1.946925    2.362574
         10  |   2.246334   .1097326    20.47   0.000     2.031208     2.46146
         11  |   2.342224   .1136561    20.61   0.000     2.119406    2.565042
         12  |   2.410216   .1173746    20.53   0.000     2.180109    2.640324
         13  |   2.481787   .1214996    20.43   0.000     2.243593    2.719982
         14  |   2.548577    .125533    20.30   0.000     2.302476    2.794679
         15  |   2.608215   .1297876    20.10   0.000     2.353772    2.862657
         16  |    2.65985   .1341282    19.83   0.000     2.396897    2.922802
         17  |   2.718865   .1384562    19.64   0.000     2.447428    2.990302
         18  |   2.792284   .1424703    19.60   0.000     2.512977    3.071591
         19  |   2.840738   .1465669    19.38   0.000       2.5534    3.128075
         20  |   2.905739    .154863    18.76   0.000     2.602137    3.209341
         25  |   3.000825   .1697017    17.68   0.000     2.668133    3.333518
         30  |   2.858011   .1986593    14.39   0.000     2.468549    3.247474
         40  |   2.819225   .2232318    12.63   0.000      2.38159    3.256861
         50  |   2.794627   .2235307    12.50   0.000     2.356405    3.232849
             |
       _cons |   2.735272   .1116455    24.50   0.000     2.516396    2.954148
-------------+----------------------------------------------------------------
     sigma_u |  1.3188074
     sigma_e |  .63397364
         rho |  .81228882   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    348983
Group variable: firm_person                     Number of groups   =     39867

R-sq:  within  = 0.1104                         Obs per group: min =         1
       between = 0.0377                                        avg =       8.8
       overall = 0.0516                                        max =        25

                                                F(78,13691)        =     50.17
corr(u_i, Xb)  = -0.0498                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 13,692 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1401913   .0404256     3.47   0.001     .0609517     .219431
      during |   .0330835   .0116028     2.85   0.004     .0103405    .0558266
       after |   .0077988   .0207355     0.38   0.707    -.0328457    .0484432
during_expat |  -.2364644   .0232986   -10.15   0.000    -.2821328   -.1907959
 after_expat |  -.3896942   .0318285   -12.24   0.000    -.4520825    -.327306
             |
    ind_year |
          2  |   .1014342   .0417129     2.43   0.015     .0196712    .1831971
          3  |   .6709699   .0495604    13.54   0.000     .5738247    .7681152
          4  |   .8316762   .0543897    15.29   0.000      .725065    .9382874
          5  |   1.029144   .0587176    17.53   0.000     .9140496    1.144239
          6  |   1.256947   .0632865    19.86   0.000     1.132897    1.380998
          7  |   1.517349   .0671691    22.59   0.000     1.385688     1.64901
          8  |    1.70687   .0716617    23.82   0.000     1.566403    1.847337
          9  |    1.85982   .0764306    24.33   0.000     1.710005    2.009634
         10  |   2.007222   .0812052    24.72   0.000     1.848049    2.166395
         11  |   2.153753   .0861232    25.01   0.000      1.98494    2.322566
         12  |    2.20495   .0914528    24.11   0.000      2.02569     2.38421
         13  |    2.28144   .0968091    23.57   0.000     2.091681    2.471199
         14  |   2.307195   .1017935    22.67   0.000     2.107666    2.506725
         15  |   2.299647   .1070061    21.49   0.000       2.0899    2.509394
         16  |   2.351548   .1122568    20.95   0.000      2.13151    2.571587
         17  |   2.383325   .1175889    20.27   0.000     2.152834    2.613815
         18  |   2.404553   .1229343    19.56   0.000     2.163585    2.645521
         19  |   2.377293    .128239    18.54   0.000     2.125927    2.628659
         20  |   2.377724   .1335339    17.81   0.000     2.115979    2.639469
         21  |   2.419974   .1382581    17.50   0.000     2.148969    2.690979
         22  |   2.461982   .1424756    17.28   0.000     2.182711    2.741254
         23  |    2.54802   .1468251    17.35   0.000     2.260223    2.835818
         24  |   1.948568   .1535547    12.69   0.000     1.647579    2.249556
         25  |   2.030365   .1619089    12.54   0.000     1.713001    2.347729
         26  |   .3619566   .0907549     3.99   0.000     .1840646    .5398487
         27  |   .4677532   .0838219     5.58   0.000     .3034507    .6320556
         28  |   .7694245   .0777031     9.90   0.000     .6171159    .9217332
         29  |   .9460184   .0765779    12.35   0.000     .7959152    1.096122
         30  |   1.076882   .0761143    14.15   0.000     .9276877    1.226077
         31  |   1.215274   .0779223    15.60   0.000     1.062536    1.368012
         32  |   1.442479   .0798797    18.06   0.000     1.285904    1.599054
         33  |   1.578338   .0818744    19.28   0.000     1.417853    1.738824
         34  |   1.702801   .0855298    19.91   0.000      1.53515    1.870451
         35  |   1.788664    .089429    20.00   0.000     1.613371    1.963958
         36  |   1.920147    .093488    20.54   0.000     1.736898    2.103396
         37  |   2.024431   .0978341    20.69   0.000     1.832663    2.216199
         38  |   2.097878   .1026742    20.43   0.000     1.896623    2.299134
         39  |   2.162665   .1074783    20.12   0.000     1.951992    2.373337
         40  |   2.196755   .1122326    19.57   0.000     1.976763    2.416746
         41  |   2.241284   .1170373    19.15   0.000     2.011875    2.470694
         42  |    2.32598   .1224722    18.99   0.000     2.085918    2.566043
         43  |   2.381554   .1279934    18.61   0.000      2.13067    2.632439
         44  |   2.386888     .13387    17.83   0.000     2.124484    2.649291
         45  |   2.440325   .1386279    17.60   0.000     2.168595    2.712054
         46  |   2.459116    .143332    17.16   0.000     2.178166    2.740067
         47  |   2.514695   .1471813    17.09   0.000     2.226199     2.80319
         48  |   2.600437   .1515354    17.16   0.000     2.303407    2.897468
         49  |   2.352945   .1573034    14.96   0.000     2.044609    2.661282
         50  |   2.447171    .162461    15.06   0.000     2.128725    2.765617
             |
     age_cat |
          1  |   .0644697   .0403653     1.60   0.110    -.0146519    .1435913
          2  |   .0830432   .0443165     1.87   0.061    -.0038233    .1699097
          3  |   .0664481   .0477766     1.39   0.164    -.0272006    .1600968
          4  |   .0679287   .0515788     1.32   0.188    -.0331728    .1690302
          5  |   .0234601    .055872     0.42   0.675    -.0860567     .132977
          6  |  -.0071728   .0605326    -0.12   0.906     -.125825    .1114795
          7  |  -.0425802   .0652684    -0.65   0.514    -.1705153    .0853549
          8  |  -.0634029   .0703434    -0.90   0.367    -.2012857    .0744799
          9  |  -.0900919   .0754785    -1.19   0.233    -.2380401    .0578564
         10  |  -.0999589   .0807059    -1.24   0.216    -.2581535    .0582357
         11  |    -.11013   .0860084    -1.28   0.200    -.2787183    .0584583
         12  |  -.1177145   .0913374    -1.29   0.197    -.2967484    .0613194
         13  |  -.1423647   .0969579    -1.47   0.142    -.3324156    .0476861
         14  |  -.1472429   .1025697    -1.44   0.151    -.3482936    .0538079
         15  |  -.1584594   .1079809    -1.47   0.142    -.3701167     .053198
         16  |  -.1763536   .1136357    -1.55   0.121    -.3990953     .046388
         17  |  -.1950518   .1193474    -1.63   0.102     -.428989    .0388855
         18  |  -.2109619   .1251524    -1.69   0.092    -.4562778     .034354
         19  |  -.2368211   .1311282    -1.81   0.071    -.4938505    .0202082
         20  |  -.2721012     .14168    -1.92   0.055    -.5498134    .0056111
         25  |  -.3988447   .1620331    -2.46   0.014    -.7164518   -.0812376
         30  |  -.4917323   .1990744    -2.47   0.014    -.8819454   -.1015192
         40  |   -.337379   .2260831    -1.49   0.136     -.780533     .105775
         50  |  -.2536934   .2525515    -1.00   0.315    -.7487289    .2413421
             |
       _cons |   4.466401   .0675394    66.13   0.000     4.334014    4.598787
-------------+----------------------------------------------------------------
     sigma_u |  1.6319677
     sigma_e |  .85292786
         rho |  .78545329   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1103800490762681

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    348,983
Group variable: firm_person                     Number of groups  =     39,867

R-sq:                                           Obs per group:
     within  = 0.1104                                         min =          1
     between = 0.0377                                         avg =        8.8
     overall = 0.0516                                         max =         25

                                                F(78,13691)       =      50.17
corr(u_i, Xb)  = -0.0498                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 13,692 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1401913   .0404256     3.47   0.001     .0609517     .219431
      during |   .0330835   .0116028     2.85   0.004     .0103405    .0558266
       after |   .0077988   .0207355     0.38   0.707    -.0328457    .0484432
during_expat |  -.2364644   .0232986   -10.15   0.000    -.2821328   -.1907959
 after_expat |  -.3896942   .0318285   -12.24   0.000    -.4520825    -.327306
             |
    ind_year |
          2  |   .1014342   .0417129     2.43   0.015     .0196712    .1831971
          3  |   .6709699   .0495604    13.54   0.000     .5738247    .7681152
          4  |   .8316762   .0543897    15.29   0.000      .725065    .9382874
          5  |   1.029144   .0587176    17.53   0.000     .9140496    1.144239
          6  |   1.256947   .0632865    19.86   0.000     1.132897    1.380998
          7  |   1.517349   .0671691    22.59   0.000     1.385688     1.64901
          8  |    1.70687   .0716617    23.82   0.000     1.566403    1.847337
          9  |    1.85982   .0764306    24.33   0.000     1.710005    2.009634
         10  |   2.007222   .0812052    24.72   0.000     1.848049    2.166395
         11  |   2.153753   .0861232    25.01   0.000      1.98494    2.322566
         12  |    2.20495   .0914528    24.11   0.000      2.02569     2.38421
         13  |    2.28144   .0968091    23.57   0.000     2.091681    2.471199
         14  |   2.307195   .1017935    22.67   0.000     2.107666    2.506725
         15  |   2.299647   .1070061    21.49   0.000       2.0899    2.509394
         16  |   2.351548   .1122568    20.95   0.000      2.13151    2.571587
         17  |   2.383325   .1175889    20.27   0.000     2.152834    2.613815
         18  |   2.404553   .1229343    19.56   0.000     2.163585    2.645521
         19  |   2.377293    .128239    18.54   0.000     2.125927    2.628659
         20  |   2.377724   .1335339    17.81   0.000     2.115979    2.639469
         21  |   2.419974   .1382581    17.50   0.000     2.148969    2.690979
         22  |   2.461982   .1424756    17.28   0.000     2.182711    2.741254
         23  |    2.54802   .1468251    17.35   0.000     2.260223    2.835818
         24  |   1.948568   .1535547    12.69   0.000     1.647579    2.249556
         25  |   2.030365   .1619089    12.54   0.000     1.713001    2.347729
         26  |   .3619566   .0907549     3.99   0.000     .1840646    .5398487
         27  |   .4677532   .0838219     5.58   0.000     .3034507    .6320556
         28  |   .7694245   .0777031     9.90   0.000     .6171159    .9217332
         29  |   .9460184   .0765779    12.35   0.000     .7959152    1.096122
         30  |   1.076882   .0761143    14.15   0.000     .9276877    1.226077
         31  |   1.215274   .0779223    15.60   0.000     1.062536    1.368012
         32  |   1.442479   .0798797    18.06   0.000     1.285904    1.599054
         33  |   1.578338   .0818744    19.28   0.000     1.417853    1.738824
         34  |   1.702801   .0855298    19.91   0.000      1.53515    1.870451
         35  |   1.788664    .089429    20.00   0.000     1.613371    1.963958
         36  |   1.920147    .093488    20.54   0.000     1.736898    2.103396
         37  |   2.024431   .0978341    20.69   0.000     1.832663    2.216199
         38  |   2.097878   .1026742    20.43   0.000     1.896623    2.299134
         39  |   2.162665   .1074783    20.12   0.000     1.951992    2.373337
         40  |   2.196755   .1122326    19.57   0.000     1.976763    2.416746
         41  |   2.241284   .1170373    19.15   0.000     2.011875    2.470694
         42  |    2.32598   .1224722    18.99   0.000     2.085918    2.566043
         43  |   2.381554   .1279934    18.61   0.000      2.13067    2.632439
         44  |   2.386888     .13387    17.83   0.000     2.124484    2.649291
         45  |   2.440325   .1386279    17.60   0.000     2.168595    2.712054
         46  |   2.459116    .143332    17.16   0.000     2.178166    2.740067
         47  |   2.514695   .1471813    17.09   0.000     2.226199     2.80319
         48  |   2.600437   .1515354    17.16   0.000     2.303407    2.897468
         49  |   2.352945   .1573034    14.96   0.000     2.044609    2.661282
         50  |   2.447171    .162461    15.06   0.000     2.128725    2.765617
             |
     age_cat |
          1  |   .0644697   .0403653     1.60   0.110    -.0146519    .1435913
          2  |   .0830432   .0443165     1.87   0.061    -.0038233    .1699097
          3  |   .0664481   .0477766     1.39   0.164    -.0272006    .1600968
          4  |   .0679287   .0515788     1.32   0.188    -.0331728    .1690302
          5  |   .0234601    .055872     0.42   0.675    -.0860567     .132977
          6  |  -.0071728   .0605326    -0.12   0.906     -.125825    .1114795
          7  |  -.0425802   .0652684    -0.65   0.514    -.1705153    .0853549
          8  |  -.0634029   .0703434    -0.90   0.367    -.2012857    .0744799
          9  |  -.0900919   .0754785    -1.19   0.233    -.2380401    .0578564
         10  |  -.0999589   .0807059    -1.24   0.216    -.2581535    .0582357
         11  |    -.11013   .0860084    -1.28   0.200    -.2787183    .0584583
         12  |  -.1177145   .0913374    -1.29   0.197    -.2967484    .0613194
         13  |  -.1423647   .0969579    -1.47   0.142    -.3324156    .0476861
         14  |  -.1472429   .1025697    -1.44   0.151    -.3482936    .0538079
         15  |  -.1584594   .1079809    -1.47   0.142    -.3701167     .053198
         16  |  -.1763536   .1136357    -1.55   0.121    -.3990953     .046388
         17  |  -.1950518   .1193474    -1.63   0.102     -.428989    .0388855
         18  |  -.2109619   .1251524    -1.69   0.092    -.4562778     .034354
         19  |  -.2368211   .1311282    -1.81   0.071    -.4938505    .0202082
         20  |  -.2721012     .14168    -1.92   0.055    -.5498134    .0056111
         25  |  -.3988447   .1620331    -2.46   0.014    -.7164518   -.0812376
         30  |  -.4917323   .1990744    -2.47   0.014    -.8819454   -.1015192
         40  |   -.337379   .2260831    -1.49   0.136     -.780533     .105775
         50  |  -.2536934   .2525515    -1.00   0.315    -.7487289    .2413421
             |
       _cons |   4.466401   .0675394    66.13   0.000     4.334014    4.598787
-------------+----------------------------------------------------------------
     sigma_u |  1.6319677
     sigma_e |  .85292786
         rho |  .78545329   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1, 13691) =    8.13
            Prob > F =    0.0044

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 13691) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1, 13691) =    2.92
            Prob > F =    0.0877

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 13691) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1, 13691) =  103.01
            Prob > F =    0.0000

 ( 1)  during_expat = 0

       F(  1, 13691) =  103.01
            Prob > F =    0.0000
variable label was str12 now str14
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1, 13691) =   43.06
            Prob > F =    0.0000

 ( 1)  after_expat = 0

       F(  1, 13691) =  149.90
            Prob > F =    0.0000
(1 real change made)
(file output/figure/baseline_lnKL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    118399
Group variable: firm_person                     Number of groups   =     14342

R-sq:  within  = 0.0949                         Obs per group: min =         1
       between = 0.0758                                        avg =       8.3
       overall = 0.0732                                        max =        25

                                                F(53,5069)         =     18.82
corr(u_i, Xb)  = 0.0593                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,070 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1159429   .0691835     1.68   0.094    -.0196867    .2515725
      during |   .0295727   .0204895     1.44   0.149    -.0105955    .0697409
       after |   .0274728   .0354189     0.78   0.438    -.0419635    .0969092
during_expat |    -.15784   .0317228    -4.98   0.000    -.2200305   -.0956496
 after_expat |  -.2514457   .0447489    -5.62   0.000    -.3391728   -.1637185
             |
    ind_year |
         27  |   .0617403    .055458     1.11   0.266    -.0469814     .170462
         28  |   .3277818   .0620848     5.28   0.000     .2060687    .4494948
         29  |   .4557266   .0708485     6.43   0.000      .316833    .5946202
         30  |   .5444232   .0792954     6.87   0.000       .38897    .6998763
         31  |   .6443674   .0886844     7.27   0.000     .4705077    .8182271
         32  |   .8366446   .0982029     8.52   0.000     .6441244    1.029165
         33  |   .9338194   .1067722     8.75   0.000     .7244998    1.143139
         34  |   1.021242   .1161738     8.79   0.000      .793491    1.248993
         35  |   1.075801    .125592     8.57   0.000     .8295863    1.322015
         36  |   1.168274   .1350364     8.65   0.000     .9035444    1.433004
         37  |   1.230859   .1443195     8.53   0.000     .9479301    1.513787
         38  |   1.270888   .1539821     8.25   0.000     .9690165    1.572759
         39  |   1.309934   .1637152     8.00   0.000     .9889813    1.630886
         40  |   1.312603   .1732355     7.58   0.000     .9729866    1.652219
         41  |   1.333698   .1828907     7.29   0.000     .9751529    1.692242
         42  |   1.390279   .1935142     7.18   0.000     1.010908     1.76965
         43  |    1.41395   .2040909     6.93   0.000     1.013844    1.814057
         44  |   1.387595   .2148958     6.46   0.000     .9663068    1.808884
         45  |   1.406287   .2241153     6.27   0.000     .9669238     1.84565
         46  |   1.391787   .2326695     5.98   0.000     .9356543     1.84792
         47  |   1.445379   .2395401     6.03   0.000      .975777    1.914981
         48  |   1.487456   .2477474     6.00   0.000     1.001764    1.973148
         49  |   1.192505   .2574232     4.63   0.000     .6878439    1.697165
         50  |   1.262929   .2654228     4.76   0.000     .7425861    1.783273
             |
     age_cat |
          1  |   .0386072       .071     0.54   0.587    -.1005836    .1777979
          2  |   .1220023   .0799738     1.53   0.127     -.034781    .2787856
          3  |   .1452175   .0850478     1.71   0.088    -.0215129     .311948
          4  |    .203001   .0920581     2.21   0.027     .0225274    .3834746
          5  |   .1717375   .0999084     1.72   0.086    -.0241262    .3676011
          6  |   .1944017   .1078842     1.80   0.072    -.0170979    .4059013
          7  |   .1795636   .1163486     1.54   0.123      -.04853    .4076572
          8  |   .2025891   .1245134     1.63   0.104    -.0415109    .4466891
          9  |    .213522   .1332574     1.60   0.109    -.0477201    .4747641
         10  |   .2157395   .1424564     1.51   0.130    -.0635366    .4950156
         11  |   .2198228   .1517334     1.45   0.147    -.0776403    .5172858
         12  |   .2565932   .1613025     1.59   0.112    -.0596293    .5728158
         13  |    .249499   .1708321     1.46   0.144    -.0854057    .5844038
         14  |    .279094   .1803665     1.55   0.122    -.0745022    .6326903
         15  |   .2890559   .1897723     1.52   0.128    -.0829797    .6610916
         16  |    .276945   .1995255     1.39   0.165    -.1142111    .6681011
         17  |   .2615255   .2094397     1.25   0.212    -.1490667    .6721178
         18  |   .3024331   .2196596     1.38   0.169    -.1281947    .7330608
         19  |   .3394519   .2302017     1.47   0.140    -.1118429    .7907467
         20  |   .3806767   .2485308     1.53   0.126    -.1065511    .8679045
         25  |   .3980356   .2825712     1.41   0.159    -.1559262    .9519973
         30  |   .4176526   .3421667     1.22   0.222    -.2531421    1.088447
         40  |   .2890218   .4105605     0.70   0.481     -.515854    1.093898
         50  |   .2248431    .467541     0.48   0.631    -.6917393    1.141426
             |
       _cons |   5.102222   .0950023    53.71   0.000     4.915977    5.288468
-------------+----------------------------------------------------------------
     sigma_u |   1.584882
     sigma_e |  .78841502
         rho |  .80162492   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0949320944253191

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    118,399
Group variable: firm_person                     Number of groups  =     14,342

R-sq:                                           Obs per group:
     within  = 0.0949                                         min =          1
     between = 0.0758                                         avg =        8.3
     overall = 0.0732                                         max =         25

                                                F(53,5069)        =      18.82
corr(u_i, Xb)  = 0.0593                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,070 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1159429   .0691835     1.68   0.094    -.0196867    .2515725
      during |   .0295727   .0204895     1.44   0.149    -.0105955    .0697409
       after |   .0274728   .0354189     0.78   0.438    -.0419635    .0969092
during_expat |    -.15784   .0317228    -4.98   0.000    -.2200305   -.0956496
 after_expat |  -.2514457   .0447489    -5.62   0.000    -.3391728   -.1637185
             |
    ind_year |
         27  |   .0617403    .055458     1.11   0.266    -.0469814     .170462
         28  |   .3277818   .0620848     5.28   0.000     .2060687    .4494948
         29  |   .4557266   .0708485     6.43   0.000      .316833    .5946202
         30  |   .5444232   .0792954     6.87   0.000       .38897    .6998763
         31  |   .6443674   .0886844     7.27   0.000     .4705077    .8182271
         32  |   .8366446   .0982029     8.52   0.000     .6441244    1.029165
         33  |   .9338194   .1067722     8.75   0.000     .7244998    1.143139
         34  |   1.021242   .1161738     8.79   0.000      .793491    1.248993
         35  |   1.075801    .125592     8.57   0.000     .8295863    1.322015
         36  |   1.168274   .1350364     8.65   0.000     .9035444    1.433004
         37  |   1.230859   .1443195     8.53   0.000     .9479301    1.513787
         38  |   1.270888   .1539821     8.25   0.000     .9690165    1.572759
         39  |   1.309934   .1637152     8.00   0.000     .9889813    1.630886
         40  |   1.312603   .1732355     7.58   0.000     .9729866    1.652219
         41  |   1.333698   .1828907     7.29   0.000     .9751529    1.692242
         42  |   1.390279   .1935142     7.18   0.000     1.010908     1.76965
         43  |    1.41395   .2040909     6.93   0.000     1.013844    1.814057
         44  |   1.387595   .2148958     6.46   0.000     .9663068    1.808884
         45  |   1.406287   .2241153     6.27   0.000     .9669238     1.84565
         46  |   1.391787   .2326695     5.98   0.000     .9356543     1.84792
         47  |   1.445379   .2395401     6.03   0.000      .975777    1.914981
         48  |   1.487456   .2477474     6.00   0.000     1.001764    1.973148
         49  |   1.192505   .2574232     4.63   0.000     .6878439    1.697165
         50  |   1.262929   .2654228     4.76   0.000     .7425861    1.783273
             |
     age_cat |
          1  |   .0386072       .071     0.54   0.587    -.1005836    .1777979
          2  |   .1220023   .0799738     1.53   0.127     -.034781    .2787856
          3  |   .1452175   .0850478     1.71   0.088    -.0215129     .311948
          4  |    .203001   .0920581     2.21   0.027     .0225274    .3834746
          5  |   .1717375   .0999084     1.72   0.086    -.0241262    .3676011
          6  |   .1944017   .1078842     1.80   0.072    -.0170979    .4059013
          7  |   .1795636   .1163486     1.54   0.123      -.04853    .4076572
          8  |   .2025891   .1245134     1.63   0.104    -.0415109    .4466891
          9  |    .213522   .1332574     1.60   0.109    -.0477201    .4747641
         10  |   .2157395   .1424564     1.51   0.130    -.0635366    .4950156
         11  |   .2198228   .1517334     1.45   0.147    -.0776403    .5172858
         12  |   .2565932   .1613025     1.59   0.112    -.0596293    .5728158
         13  |    .249499   .1708321     1.46   0.144    -.0854057    .5844038
         14  |    .279094   .1803665     1.55   0.122    -.0745022    .6326903
         15  |   .2890559   .1897723     1.52   0.128    -.0829797    .6610916
         16  |    .276945   .1995255     1.39   0.165    -.1142111    .6681011
         17  |   .2615255   .2094397     1.25   0.212    -.1490667    .6721178
         18  |   .3024331   .2196596     1.38   0.169    -.1281947    .7330608
         19  |   .3394519   .2302017     1.47   0.140    -.1118429    .7907467
         20  |   .3806767   .2485308     1.53   0.126    -.1065511    .8679045
         25  |   .3980356   .2825712     1.41   0.159    -.1559262    .9519973
         30  |   .4176526   .3421667     1.22   0.222    -.2531421    1.088447
         40  |   .2890218   .4105605     0.70   0.481     -.515854    1.093898
         50  |   .2248431    .467541     0.48   0.631    -.6917393    1.141426
             |
       _cons |   5.102222   .0950023    53.71   0.000     4.915977    5.288468
-------------+----------------------------------------------------------------
     sigma_u |   1.584882
     sigma_e |  .78841502
         rho |  .80162492   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1,  5069) =    2.08
            Prob > F =    0.1490

 ( 1) = 0
       Constraint 1 dropped

       F(  0,  5069) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1,  5069) =    0.01
            Prob > F =    0.9337

 ( 1) = 0
       Constraint 1 dropped

       F(  0,  5069) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1,  5069) =   24.76
            Prob > F =    0.0000

 ( 1)  during_expat = 0

       F(  1,  5069) =   24.76
            Prob > F =    0.0000
variable label was str12 now str14
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1,  5069) =    7.47
            Prob > F =    0.0063

 ( 1)  after_expat = 0

       F(  1,  5069) =   31.57
            Prob > F =    0.0000
(1 real change made)
(file output/figure/manufacturing_lnKL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    241136
Group variable: firm_person                     Number of groups   =     27574

R-sq:  within  = 0.1275                         Obs per group: min =         1
       between = 0.0587                                        avg =       8.7
       overall = 0.0747                                        max =        25

                                                F(78,10541)        =     44.61
corr(u_i, Xb)  = -0.0065                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 10,542 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0659576   .0525849     1.25   0.210    -.0371188    .1690341
      during |   .0207794   .0131421     1.58   0.114    -.0049817    .0465404
       after |   .0116355   .0236595     0.49   0.623    -.0347416    .0580127
during_expat |  -.0499524   .0531314    -0.94   0.347    -.1541001    .0541952
 after_expat |  -.1593396   .0687875    -2.32   0.021    -.2941761   -.0245031
             |
    ind_year |
          2  |   .0808741   .0469642     1.72   0.085    -.0111846    .1729327
          3  |   .6615108   .0557912    11.86   0.000     .5521496     .770872
          4  |   .8258776   .0606963    13.61   0.000     .7069013    .9448538
          5  |   1.003934   .0656574    15.29   0.000     .8752327    1.132635
          6  |   1.225373   .0705897    17.36   0.000     1.087004    1.363742
          7  |   1.496195   .0744775    20.09   0.000     1.350205    1.642185
          8  |   1.693305    .079064    21.42   0.000     1.538325    1.848285
          9  |   1.845065   .0842514    21.90   0.000     1.679917    2.010214
         10  |   1.988841   .0893974    22.25   0.000     1.813605    2.164077
         11  |    2.13331   .0948014    22.50   0.000     1.947482    2.319139
         12  |   2.185764   .1005894    21.73   0.000     1.988589    2.382938
         13  |   2.259608   .1063027    21.26   0.000     2.051234    2.467981
         14  |   2.281003   .1116441    20.43   0.000      2.06216    2.499847
         15  |   2.276272   .1171628    19.43   0.000     2.046611    2.505933
         16  |   2.339483   .1227278    19.06   0.000     2.098913    2.580052
         17  |   2.369672   .1284002    18.46   0.000     2.117984    2.621361
         18  |   2.389693   .1339238    17.84   0.000     2.127177    2.652209
         19  |   2.359832   .1394278    16.93   0.000     2.086527    2.633137
         20  |   2.351092   .1451568    16.20   0.000     2.066557    2.635627
         21  |   2.397383   .1502022    15.96   0.000     2.102958    2.691808
         22  |   2.444065   .1546752    15.80   0.000     2.140872    2.747258
         23  |   2.542466   .1591091    15.98   0.000     2.230582     2.85435
         24  |   2.025627   .1663514    12.18   0.000     1.699547    2.351708
         25  |   2.106505   .1755956    12.00   0.000     1.762304    2.450705
         26  |   .3516186   .1066644     3.30   0.001     .1425362    .5607009
         27  |      .3922   .0976172     4.02   0.000     .2008518    .5835482
         28  |   .6961297   .0896146     7.77   0.000     .5204681    .8717913
         29  |   .8947141   .0876916    10.20   0.000     .7228221    1.066606
         30  |   1.029435    .086851    11.85   0.000     .8591902    1.199679
         31  |   1.159383   .0891062    13.01   0.000      .984718    1.334048
         32  |   1.410665   .0904264    15.60   0.000     1.233412    1.587918
         33  |   1.506296   .0924906    16.29   0.000     1.324997    1.687595
         34  |   1.632855   .0961186    16.99   0.000     1.444444    1.821265
         35  |   1.719147   .1002906    17.14   0.000     1.522558    1.915735
         36  |   1.883406   .1042359    18.07   0.000     1.679084    2.087728
         37  |   2.002647   .1088787    18.39   0.000     1.789225     2.21607
         38  |   2.061552   .1139495    18.09   0.000     1.838189    2.284915
         39  |   2.125125   .1187392    17.90   0.000     1.892373    2.357876
         40  |   2.145773   .1238777    17.32   0.000      1.90295    2.388597
         41  |   2.203088   .1288294    17.10   0.000     1.950558    2.455618
         42  |   2.282916   .1346603    16.95   0.000     2.018956    2.546875
         43  |     2.3216   .1404709    16.53   0.000     2.046251     2.59695
         44  |   2.331118   .1466751    15.89   0.000     2.043607    2.618629
         45  |   2.386545   .1518785    15.71   0.000     2.088834    2.684255
         46  |   2.392523   .1568082    15.26   0.000     2.085149    2.699897
         47  |   2.433169   .1604419    15.17   0.000     2.118672    2.747665
         48  |   2.516833   .1649801    15.26   0.000     2.193441    2.840225
         49  |   2.277248   .1723202    13.22   0.000     1.939468    2.615028
         50  |   2.403178   .1784321    13.47   0.000     2.053418    2.752939
             |
     age_cat |
          1  |   .1081035   .0477427     2.26   0.024     .0145187    .2016883
          2  |   .1539985   .0526285     2.93   0.003     .0508368    .2571603
          3  |   .1611609   .0564081     2.86   0.004     .0505903    .2717314
          4  |   .1775524   .0604317     2.94   0.003     .0590948      .29601
          5  |   .1518492   .0649749     2.34   0.019     .0244862    .2792122
          6  |   .1207795   .0698377     1.73   0.084    -.0161156    .2576747
          7  |   .1107301    .074777     1.48   0.139     -.035847    .2573071
          8  |   .1001193   .0801312     1.25   0.212    -.0569531    .2571916
          9  |    .090653   .0854115     1.06   0.289    -.0767697    .2580757
         10  |   .0948418   .0908354     1.04   0.296    -.0832128    .2728963
         11  |   .0856689   .0964831     0.89   0.375    -.1034562     .274794
         12  |   .0857677   .1020922     0.84   0.401    -.1143523    .2858878
         13  |   .0628445   .1080574     0.58   0.561    -.1489684    .2746574
         14  |   .0636645   .1140155     0.56   0.577    -.1598275    .2871565
         15  |   .0621854   .1197181     0.52   0.603    -.1724847    .2968554
         16  |    .034945   .1256502     0.28   0.781    -.2113532    .2812431
         17  |   .0179081   .1316405     0.14   0.892    -.2401322    .2759483
         18  |   .0064061   .1377187     0.05   0.963    -.2635486    .2763607
         19  |  -.0132761   .1440094    -0.09   0.927    -.2955617    .2690096
         20  |  -.0541798   .1550909    -0.35   0.727    -.3581873    .2498276
         25  |  -.1810095   .1771921    -1.02   0.307    -.5283395    .1663205
         30  |  -.2681469   .2157216    -1.24   0.214     -.691002    .1547081
         40  |  -.1234473    .242874    -0.51   0.611    -.5995263    .3526316
         50  |  -.0510892   .2706895    -0.19   0.850    -.5816918    .4795133
             |
       _cons |   4.201982   .0758707    55.38   0.000     4.053261    4.350703
-------------+----------------------------------------------------------------
     sigma_u |  1.5942282
     sigma_e |  .85847979
         rho |  .77520937   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1274519060418404

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    241,136
Group variable: firm_person                     Number of groups  =     27,574

R-sq:                                           Obs per group:
     within  = 0.1275                                         min =          1
     between = 0.0587                                         avg =        8.7
     overall = 0.0747                                         max =         25

                                                F(78,10541)       =      44.61
corr(u_i, Xb)  = -0.0065                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,542 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0659576   .0525849     1.25   0.210    -.0371188    .1690341
      during |   .0207794   .0131421     1.58   0.114    -.0049817    .0465404
       after |   .0116355   .0236595     0.49   0.623    -.0347416    .0580127
during_expat |  -.0499524   .0531314    -0.94   0.347    -.1541001    .0541952
 after_expat |  -.1593396   .0687875    -2.32   0.021    -.2941761   -.0245031
             |
    ind_year |
          2  |   .0808741   .0469642     1.72   0.085    -.0111846    .1729327
          3  |   .6615108   .0557912    11.86   0.000     .5521496     .770872
          4  |   .8258776   .0606963    13.61   0.000     .7069013    .9448538
          5  |   1.003934   .0656574    15.29   0.000     .8752327    1.132635
          6  |   1.225373   .0705897    17.36   0.000     1.087004    1.363742
          7  |   1.496195   .0744775    20.09   0.000     1.350205    1.642185
          8  |   1.693305    .079064    21.42   0.000     1.538325    1.848285
          9  |   1.845065   .0842514    21.90   0.000     1.679917    2.010214
         10  |   1.988841   .0893974    22.25   0.000     1.813605    2.164077
         11  |    2.13331   .0948014    22.50   0.000     1.947482    2.319139
         12  |   2.185764   .1005894    21.73   0.000     1.988589    2.382938
         13  |   2.259608   .1063027    21.26   0.000     2.051234    2.467981
         14  |   2.281003   .1116441    20.43   0.000      2.06216    2.499847
         15  |   2.276272   .1171628    19.43   0.000     2.046611    2.505933
         16  |   2.339483   .1227278    19.06   0.000     2.098913    2.580052
         17  |   2.369672   .1284002    18.46   0.000     2.117984    2.621361
         18  |   2.389693   .1339238    17.84   0.000     2.127177    2.652209
         19  |   2.359832   .1394278    16.93   0.000     2.086527    2.633137
         20  |   2.351092   .1451568    16.20   0.000     2.066557    2.635627
         21  |   2.397383   .1502022    15.96   0.000     2.102958    2.691808
         22  |   2.444065   .1546752    15.80   0.000     2.140872    2.747258
         23  |   2.542466   .1591091    15.98   0.000     2.230582     2.85435
         24  |   2.025627   .1663514    12.18   0.000     1.699547    2.351708
         25  |   2.106505   .1755956    12.00   0.000     1.762304    2.450705
         26  |   .3516186   .1066644     3.30   0.001     .1425362    .5607009
         27  |      .3922   .0976172     4.02   0.000     .2008518    .5835482
         28  |   .6961297   .0896146     7.77   0.000     .5204681    .8717913
         29  |   .8947141   .0876916    10.20   0.000     .7228221    1.066606
         30  |   1.029435    .086851    11.85   0.000     .8591902    1.199679
         31  |   1.159383   .0891062    13.01   0.000      .984718    1.334048
         32  |   1.410665   .0904264    15.60   0.000     1.233412    1.587918
         33  |   1.506296   .0924906    16.29   0.000     1.324997    1.687595
         34  |   1.632855   .0961186    16.99   0.000     1.444444    1.821265
         35  |   1.719147   .1002906    17.14   0.000     1.522558    1.915735
         36  |   1.883406   .1042359    18.07   0.000     1.679084    2.087728
         37  |   2.002647   .1088787    18.39   0.000     1.789225     2.21607
         38  |   2.061552   .1139495    18.09   0.000     1.838189    2.284915
         39  |   2.125125   .1187392    17.90   0.000     1.892373    2.357876
         40  |   2.145773   .1238777    17.32   0.000      1.90295    2.388597
         41  |   2.203088   .1288294    17.10   0.000     1.950558    2.455618
         42  |   2.282916   .1346603    16.95   0.000     2.018956    2.546875
         43  |     2.3216   .1404709    16.53   0.000     2.046251     2.59695
         44  |   2.331118   .1466751    15.89   0.000     2.043607    2.618629
         45  |   2.386545   .1518785    15.71   0.000     2.088834    2.684255
         46  |   2.392523   .1568082    15.26   0.000     2.085149    2.699897
         47  |   2.433169   .1604419    15.17   0.000     2.118672    2.747665
         48  |   2.516833   .1649801    15.26   0.000     2.193441    2.840225
         49  |   2.277248   .1723202    13.22   0.000     1.939468    2.615028
         50  |   2.403178   .1784321    13.47   0.000     2.053418    2.752939
             |
     age_cat |
          1  |   .1081035   .0477427     2.26   0.024     .0145187    .2016883
          2  |   .1539985   .0526285     2.93   0.003     .0508368    .2571603
          3  |   .1611609   .0564081     2.86   0.004     .0505903    .2717314
          4  |   .1775524   .0604317     2.94   0.003     .0590948      .29601
          5  |   .1518492   .0649749     2.34   0.019     .0244862    .2792122
          6  |   .1207795   .0698377     1.73   0.084    -.0161156    .2576747
          7  |   .1107301    .074777     1.48   0.139     -.035847    .2573071
          8  |   .1001193   .0801312     1.25   0.212    -.0569531    .2571916
          9  |    .090653   .0854115     1.06   0.289    -.0767697    .2580757
         10  |   .0948418   .0908354     1.04   0.296    -.0832128    .2728963
         11  |   .0856689   .0964831     0.89   0.375    -.1034562     .274794
         12  |   .0857677   .1020922     0.84   0.401    -.1143523    .2858878
         13  |   .0628445   .1080574     0.58   0.561    -.1489684    .2746574
         14  |   .0636645   .1140155     0.56   0.577    -.1598275    .2871565
         15  |   .0621854   .1197181     0.52   0.603    -.1724847    .2968554
         16  |    .034945   .1256502     0.28   0.781    -.2113532    .2812431
         17  |   .0179081   .1316405     0.14   0.892    -.2401322    .2759483
         18  |   .0064061   .1377187     0.05   0.963    -.2635486    .2763607
         19  |  -.0132761   .1440094    -0.09   0.927    -.2955617    .2690096
         20  |  -.0541798   .1550909    -0.35   0.727    -.3581873    .2498276
         25  |  -.1810095   .1771921    -1.02   0.307    -.5283395    .1663205
         30  |  -.2681469   .2157216    -1.24   0.214     -.691002    .1547081
         40  |  -.1234473    .242874    -0.51   0.611    -.5995263    .3526316
         50  |  -.0510892   .2706895    -0.19   0.850    -.5816918    .4795133
             |
       _cons |   4.201982   .0758707    55.38   0.000     4.053261    4.350703
-------------+----------------------------------------------------------------
     sigma_u |  1.5942282
     sigma_e |  .85847979
         rho |  .77520937   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1, 10541) =    2.50
            Prob > F =    0.1139

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10541) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1, 10541) =    0.30
            Prob > F =    0.5848

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10541) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1, 10541) =    0.88
            Prob > F =    0.3472

 ( 1)  during_expat = 0

       F(  1, 10541) =    0.88
            Prob > F =    0.3472
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1, 10541) =    5.22
            Prob > F =    0.0223

 ( 1)  after_expat = 0

       F(  1, 10541) =    5.37
            Prob > F =    0.0206
variable label was str12 now str13
(1 real change made)
(file output/figure/acquisitions_lnKL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    241136
Group variable: firm_person                     Number of groups   =     27574

R-sq:  within  = 0.1275                         Obs per group: min =         1
       between = 0.0585                                        avg =       8.7
       overall = 0.0746                                        max =        25

                                                F(82,10541)        =     42.31
corr(u_i, Xb)  = -0.0072                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 10,542 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0662985   .0526002     1.26   0.208    -.0368079    .1694049
   during_DD |   .0220261   .0137505     1.60   0.109    -.0049275    .0489796
   during_DE |  -.0097348   .0736749    -0.13   0.895    -.1541514    .1346818
   during_ED |   .0230225   .0340825     0.68   0.499    -.0437856    .0898307
   during_EE |  -.0772381   .0726729    -1.06   0.288    -.2196907    .0652145
    after_DD |  -.0050381   .0251298    -0.20   0.841    -.0542972     .044221
    after_DE |  -.0989429   .0869362    -1.14   0.255    -.2693542    .0714684
    after_ED |   .0045494   .0505761     0.09   0.928    -.0945893    .1036882
    after_EE |  -.1760363   .0909757    -1.93   0.053    -.3543659    .0022934
             |
    ind_year |
          2  |   .0807481   .0470536     1.72   0.086    -.0114858     .172982
          3  |   .6613689   .0559456    11.82   0.000      .551705    .7710328
          4  |   .8255765     .06092    13.55   0.000     .7061618    .9449912
          5  |   1.003548   .0660174    15.20   0.000     .8741419    1.132955
          6  |   1.225183   .0709678    17.26   0.000     1.086073    1.364293
          7  |   1.495901   .0748472    19.99   0.000     1.349187    1.642616
          8  |   1.693023   .0795228    21.29   0.000     1.537143    1.848903
          9  |   1.845052   .0846827    21.79   0.000     1.679057    2.011046
         10  |   1.989119   .0897961    22.15   0.000     1.813101    2.165136
         11  |   2.133921   .0951245    22.43   0.000     1.947459    2.320383
         12  |   2.186662   .1007864    21.70   0.000     1.989102    2.384223
         13  |   2.261106   .1064048    21.25   0.000     2.052533     2.46968
         14  |   2.282885   .1116685    20.44   0.000     2.063994    2.501777
         15  |    2.27839   .1171274    19.45   0.000     2.048798    2.507982
         16  |   2.341952    .122598    19.10   0.000     2.101637    2.582267
         17  |    2.37284   .1281469    18.52   0.000     2.121648    2.624032
         18  |   2.393223   .1335728    17.92   0.000     2.131395    2.655051
         19  |    2.36388   .1390162    17.00   0.000     2.091382    2.636378
         20  |   2.355595    .144654    16.28   0.000     2.072046    2.639144
         21  |   2.402416   .1495962    16.06   0.000     2.109179    2.695653
         22  |   2.449516   .1539705    15.91   0.000     2.147704    2.751327
         23  |   2.548279   .1583243    16.10   0.000     2.237933    2.858624
         24  |   2.031728   .1654875    12.28   0.000     1.707341    2.356115
         25  |   2.113064   .1746538    12.10   0.000      1.77071    2.455419
         26  |   .3518006   .1066819     3.30   0.001     .1426839    .5609173
         27  |   .3919633    .097604     4.02   0.000      .200641    .5832856
         28  |   .6958716   .0896398     7.76   0.000     .5201606    .8715825
         29  |   .8948285   .0877434    10.20   0.000      .722835    1.066822
         30  |   1.029335   .0869464    11.84   0.000     .8589035    1.199766
         31  |   1.159258   .0892483    12.99   0.000     .9843145    1.334201
         32  |   1.410373   .0906631    15.56   0.000     1.232657     1.58809
         33  |   1.506212   .0927765    16.23   0.000     1.324352    1.688071
         34  |   1.632966   .0964734    16.93   0.000      1.44386    1.822072
         35  |   1.719378   .1006863    17.08   0.000     1.522014    1.916742
         36  |   1.883774   .1045862    18.01   0.000     1.678765    2.088783
         37  |   2.003296   .1091969    18.35   0.000      1.78925    2.217343
         38  |   2.062699   .1142297    18.06   0.000     1.838788    2.286611
         39  |   2.126577     .11893    17.88   0.000     1.893451    2.359702
         40  |   2.147572   .1239593    17.32   0.000     1.904589    2.390556
         41  |   2.205146   .1288435    17.11   0.000     1.952589    2.457704
         42  |   2.285494   .1345009    16.99   0.000     2.021846    2.549141
         43  |   2.324676   .1402153    16.58   0.000     2.049827    2.599524
         44  |   2.334653     .14633    15.95   0.000     2.047819    2.621488
         45  |   2.390391   .1513999    15.79   0.000     2.093619    2.687164
         46  |   2.396704   .1562586    15.34   0.000     2.090408       2.703
         47  |   2.437742   .1597849    15.26   0.000     2.124534    2.750951
         48  |   2.521755   .1642197    15.36   0.000     2.199853    2.843657
         49  |   2.283169   .1714801    13.31   0.000     1.947036    2.619302
         50  |   2.409559    .177434    13.58   0.000     2.061755    2.757363
             |
     age_cat |
          1  |   .1078911   .0477285     2.26   0.024     .0143341     .201448
          2  |   .1539414   .0525934     2.93   0.003     .0508483    .2570345
          3  |   .1613326   .0563794     2.86   0.004     .0508184    .2718468
          4  |   .1778601   .0604057     2.94   0.003     .0594535    .2962666
          5  |   .1522763   .0649628     2.34   0.019     .0249369    .2796157
          6  |   .1214295   .0698281     1.74   0.082    -.0154467    .2583057
          7  |    .111416   .0747884     1.49   0.136    -.0351834    .2580154
          8  |   .1007871   .0801708     1.26   0.209    -.0563628     .257937
          9  |   .0913506    .085492     1.07   0.285      -.07623    .2589311
         10  |   .0954545   .0909429     1.05   0.294    -.0828108    .2737198
         11  |   .0862609   .0966101     0.89   0.372    -.1031132    .2756351
         12  |    .086297   .1022392     0.84   0.399     -.114111    .2867051
         13  |    .063215   .1082254     0.58   0.559    -.1489272    .2753572
         14  |    .063811   .1141975     0.56   0.576    -.1600376    .2876596
         15  |   .0621335   .1199121     0.52   0.604     -.172917    .2971839
         16  |    .034771   .1258541     0.28   0.782    -.2119268    .2814688
         17  |   .0175904    .131859     0.13   0.894    -.2408783     .276059
         18  |   .0057951   .1379475     0.04   0.966    -.2646082    .2761984
         19  |  -.0140973   .1442481    -0.10   0.922    -.2968509    .2686563
         20  |  -.0555748   .1553304    -0.36   0.721    -.3600518    .2489021
         25  |  -.1830157   .1774242    -1.03   0.302    -.5308007    .1647694
         30  |  -.2697138   .2159361    -1.25   0.212    -.6929894    .1535619
         40  |  -.1243439   .2430845    -0.51   0.609    -.6008354    .3521477
         50  |  -.0520799   .2709091    -0.19   0.848     -.583113    .4789532
             |
       _cons |   4.202724   .0760842    55.24   0.000     4.053585    4.351864
-------------+----------------------------------------------------------------
     sigma_u |  1.5944174
     sigma_e |  .85848671
         rho |  .77524792   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .12745418777106

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    241,136
Group variable: firm_person                     Number of groups  =     27,574

R-sq:                                           Obs per group:
     within  = 0.1275                                         min =          1
     between = 0.0585                                         avg =        8.7
     overall = 0.0746                                         max =         25

                                                F(82,10541)       =      42.31
corr(u_i, Xb)  = -0.0072                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,542 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0662985   .0526002     1.26   0.208    -.0368079    .1694049
   during_DD |   .0220261   .0137505     1.60   0.109    -.0049275    .0489796
   during_DE |  -.0097348   .0736749    -0.13   0.895    -.1541514    .1346818
   during_ED |   .0230225   .0340825     0.68   0.499    -.0437856    .0898307
   during_EE |  -.0772381   .0726729    -1.06   0.288    -.2196907    .0652145
    after_DD |  -.0050381   .0251298    -0.20   0.841    -.0542972     .044221
    after_DE |  -.0989429   .0869362    -1.14   0.255    -.2693542    .0714684
    after_ED |   .0045494   .0505761     0.09   0.928    -.0945893    .1036882
    after_EE |  -.1760363   .0909757    -1.93   0.053    -.3543659    .0022934
             |
    ind_year |
          2  |   .0807481   .0470536     1.72   0.086    -.0114858     .172982
          3  |   .6613689   .0559456    11.82   0.000      .551705    .7710328
          4  |   .8255765     .06092    13.55   0.000     .7061618    .9449912
          5  |   1.003548   .0660174    15.20   0.000     .8741419    1.132955
          6  |   1.225183   .0709678    17.26   0.000     1.086073    1.364293
          7  |   1.495901   .0748472    19.99   0.000     1.349187    1.642616
          8  |   1.693023   .0795228    21.29   0.000     1.537143    1.848903
          9  |   1.845052   .0846827    21.79   0.000     1.679057    2.011046
         10  |   1.989119   .0897961    22.15   0.000     1.813101    2.165136
         11  |   2.133921   .0951245    22.43   0.000     1.947459    2.320383
         12  |   2.186662   .1007864    21.70   0.000     1.989102    2.384223
         13  |   2.261106   .1064048    21.25   0.000     2.052533     2.46968
         14  |   2.282885   .1116685    20.44   0.000     2.063994    2.501777
         15  |    2.27839   .1171274    19.45   0.000     2.048798    2.507982
         16  |   2.341952    .122598    19.10   0.000     2.101637    2.582267
         17  |    2.37284   .1281469    18.52   0.000     2.121648    2.624032
         18  |   2.393223   .1335728    17.92   0.000     2.131395    2.655051
         19  |    2.36388   .1390162    17.00   0.000     2.091382    2.636378
         20  |   2.355595    .144654    16.28   0.000     2.072046    2.639144
         21  |   2.402416   .1495962    16.06   0.000     2.109179    2.695653
         22  |   2.449516   .1539705    15.91   0.000     2.147704    2.751327
         23  |   2.548279   .1583243    16.10   0.000     2.237933    2.858624
         24  |   2.031728   .1654875    12.28   0.000     1.707341    2.356115
         25  |   2.113064   .1746538    12.10   0.000      1.77071    2.455419
         26  |   .3518006   .1066819     3.30   0.001     .1426839    .5609173
         27  |   .3919633    .097604     4.02   0.000      .200641    .5832856
         28  |   .6958716   .0896398     7.76   0.000     .5201606    .8715825
         29  |   .8948285   .0877434    10.20   0.000      .722835    1.066822
         30  |   1.029335   .0869464    11.84   0.000     .8589035    1.199766
         31  |   1.159258   .0892483    12.99   0.000     .9843145    1.334201
         32  |   1.410373   .0906631    15.56   0.000     1.232657     1.58809
         33  |   1.506212   .0927765    16.23   0.000     1.324352    1.688071
         34  |   1.632966   .0964734    16.93   0.000      1.44386    1.822072
         35  |   1.719378   .1006863    17.08   0.000     1.522014    1.916742
         36  |   1.883774   .1045862    18.01   0.000     1.678765    2.088783
         37  |   2.003296   .1091969    18.35   0.000      1.78925    2.217343
         38  |   2.062699   .1142297    18.06   0.000     1.838788    2.286611
         39  |   2.126577     .11893    17.88   0.000     1.893451    2.359702
         40  |   2.147572   .1239593    17.32   0.000     1.904589    2.390556
         41  |   2.205146   .1288435    17.11   0.000     1.952589    2.457704
         42  |   2.285494   .1345009    16.99   0.000     2.021846    2.549141
         43  |   2.324676   .1402153    16.58   0.000     2.049827    2.599524
         44  |   2.334653     .14633    15.95   0.000     2.047819    2.621488
         45  |   2.390391   .1513999    15.79   0.000     2.093619    2.687164
         46  |   2.396704   .1562586    15.34   0.000     2.090408       2.703
         47  |   2.437742   .1597849    15.26   0.000     2.124534    2.750951
         48  |   2.521755   .1642197    15.36   0.000     2.199853    2.843657
         49  |   2.283169   .1714801    13.31   0.000     1.947036    2.619302
         50  |   2.409559    .177434    13.58   0.000     2.061755    2.757363
             |
     age_cat |
          1  |   .1078911   .0477285     2.26   0.024     .0143341     .201448
          2  |   .1539414   .0525934     2.93   0.003     .0508483    .2570345
          3  |   .1613326   .0563794     2.86   0.004     .0508184    .2718468
          4  |   .1778601   .0604057     2.94   0.003     .0594535    .2962666
          5  |   .1522763   .0649628     2.34   0.019     .0249369    .2796157
          6  |   .1214295   .0698281     1.74   0.082    -.0154467    .2583057
          7  |    .111416   .0747884     1.49   0.136    -.0351834    .2580154
          8  |   .1007871   .0801708     1.26   0.209    -.0563628     .257937
          9  |   .0913506    .085492     1.07   0.285      -.07623    .2589311
         10  |   .0954545   .0909429     1.05   0.294    -.0828108    .2737198
         11  |   .0862609   .0966101     0.89   0.372    -.1031132    .2756351
         12  |    .086297   .1022392     0.84   0.399     -.114111    .2867051
         13  |    .063215   .1082254     0.58   0.559    -.1489272    .2753572
         14  |    .063811   .1141975     0.56   0.576    -.1600376    .2876596
         15  |   .0621335   .1199121     0.52   0.604     -.172917    .2971839
         16  |    .034771   .1258541     0.28   0.782    -.2119268    .2814688
         17  |   .0175904    .131859     0.13   0.894    -.2408783     .276059
         18  |   .0057951   .1379475     0.04   0.966    -.2646082    .2761984
         19  |  -.0140973   .1442481    -0.10   0.922    -.2968509    .2686563
         20  |  -.0555748   .1553304    -0.36   0.721    -.3600518    .2489021
         25  |  -.1830157   .1774242    -1.03   0.302    -.5308007    .1647694
         30  |  -.2697138   .2159361    -1.25   0.212    -.6929894    .1535619
         40  |  -.1243439   .2430845    -0.51   0.609    -.6008354    .3521477
         50  |  -.0520799   .2709091    -0.19   0.848     -.583113    .4789532
             |
       _cons |   4.202724   .0760842    55.24   0.000     4.053585    4.351864
-------------+----------------------------------------------------------------
     sigma_u |  1.5944174
     sigma_e |  .85848671
         rho |  .77524792   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[du
> ring_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle(`title') legend(off) 
> aspect(0.67))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 10541) =    2.57
            Prob > F =    0.1092

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10541) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 10541) =    0.02
            Prob > F =    0.8949

 ( 1)  - during_DD + during_DE = 0

       F(  1, 10541) =    0.18
            Prob > F =    0.6714
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 10541) =    0.46
            Prob > F =    0.4994

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10541) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 10541) =    1.13
            Prob > F =    0.2879

 ( 1)  - during_ED + during_EE = 0

       F(  1, 10541) =    1.57
            Prob > F =    0.2106

. 
. graph export output/figure/`fname'_tree.png, width(800) replace
(file output/figure/lnKL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    163601
Group variable: firm_person                     Number of groups   =     19026

R-sq:  within  = 0.1415                         Obs per group: min =         1
       between = 0.0936                                        avg =       8.6
       overall = 0.0996                                        max =        25

                                                F(78,6511)         =     30.43
corr(u_i, Xb)  = 0.0440                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 6,512 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1326039   .0649973     2.04   0.041     .0051879    .2600198
      during |   .0476054   .0162515     2.93   0.003      .015747    .0794637
       after |   .0606135    .028602     2.12   0.034     .0045441    .1166829
during_expat |   -.065451   .0565973    -1.16   0.248    -.1764004    .0454983
 after_expat |  -.1288227   .0799222    -1.61   0.107    -.2854964     .027851
             |
    ind_year |
          2  |   .0753392   .0512238     1.47   0.141    -.0250763    .1757547
          3  |   .5821489   .0594848     9.79   0.000     .4655391    .6987587
          4  |   .7058594   .0658125    10.73   0.000     .5768454    .8348734
          5  |   .8461149   .0723668    11.69   0.000     .7042523    .9879775
          6  |   1.071439   .0777623    13.78   0.000     .9189992    1.223879
          7  |   1.317682    .082226    16.03   0.000     1.156492    1.478872
          8  |   1.497758   .0870287    17.21   0.000     1.327154    1.668363
          9  |   1.653163   .0927784    17.82   0.000     1.471287    1.835039
         10  |   1.750215   .0985781    17.75   0.000      1.55697    1.943461
         11  |   1.858629   .1048726    17.72   0.000     1.653045    2.064214
         12  |   1.921481   .1106723    17.36   0.000     1.704527    2.138435
         13  |   1.960019   .1169544    16.76   0.000      1.73075    2.189288
         14  |   1.988741   .1222202    16.27   0.000      1.74915    2.228333
         15  |   1.998314   .1282139    15.59   0.000     1.746972    2.249655
         16  |   2.093029   .1337018    15.65   0.000     1.830929    2.355128
         17  |   2.157272   .1395756    15.46   0.000     1.883658    2.430886
         18  |   2.201746   .1452903    15.15   0.000     1.916929    2.486563
         19  |   2.164452    .150779    14.36   0.000     1.868876    2.460029
         20  |   2.170185   .1568502    13.84   0.000     1.862707    2.477663
         21  |   2.208247   .1623078    13.61   0.000      1.89007    2.526423
         22  |   2.247665   .1667124    13.48   0.000     1.920854    2.574476
         23  |   2.356899   .1711273    13.77   0.000     2.021433    2.692365
         24  |   1.897551   .1799544    10.54   0.000     1.544781    2.250321
         25  |   1.949426   .1901779    10.25   0.000     1.576615    2.322237
         26  |   .3869385   .1243981     3.11   0.002     .1430775    .6307996
         27  |   .3984972   .1137199     3.50   0.000     .1755688    .6214256
         28  |   .6658763   .1061902     6.27   0.000     .4577087     .874044
         29  |   .8342202   .1043845     7.99   0.000     .6295922    1.038848
         30  |    .964598   .1030773     9.36   0.000     .7625327    1.166663
         31  |   1.079761   .1051366    10.27   0.000      .873659    1.285864
         32  |   1.298745   .1051216    12.35   0.000     1.092673    1.504818
         33  |   1.374976   .1070862    12.84   0.000     1.165052      1.5849
         34  |   1.478076   .1110173    13.31   0.000     1.260445    1.695706
         35  |   1.550098   .1150627    13.47   0.000     1.324537    1.775658
         36  |   1.673683   .1181925    14.16   0.000     1.441987    1.905379
         37  |   1.772381   .1229966    14.41   0.000     1.531268    2.013495
         38  |   1.837584   .1277927    14.38   0.000     1.587068      2.0881
         39  |   1.875335   .1324301    14.16   0.000     1.615728    2.134942
         40  |   1.892004   .1380832    13.70   0.000     1.621315    2.162692
         41  |   1.949881    .142931    13.64   0.000     1.669689    2.230072
         42  |   2.016384   .1496017    13.48   0.000     1.723115    2.309652
         43  |   2.064789    .155911    13.24   0.000     1.759152    2.370426
         44  |   2.073549   .1626277    12.75   0.000     1.754745    2.392352
         45  |   2.128484   .1675803    12.70   0.000     1.799971    2.456996
         46  |   2.136976   .1730242    12.35   0.000     1.797791     2.47616
         47  |   2.176499   .1763411    12.34   0.000     1.830812    2.522185
         48  |   2.275846   .1807965    12.59   0.000     1.921426    2.630267
         49  |   2.009819   .1886356    10.65   0.000     1.640031    2.379606
         50  |   2.165581   .1945521    11.13   0.000     1.784195    2.546967
             |
     age_cat |
          1  |   .0995287   .0633419     1.57   0.116    -.0246423    .2236997
          2  |   .2023146   .0691639     2.93   0.003     .0667307    .3378985
          3  |   .2438428   .0734982     3.32   0.001     .0997621    .3879234
          4  |   .2748694    .077631     3.54   0.000     .1226871    .4270518
          5  |   .2876453   .0822991     3.50   0.000     .1263121    .4489786
          6  |   .2821199   .0869839     3.24   0.001     .1116029    .4526369
          7  |   .2668097   .0920102     2.90   0.004     .0864396    .4471798
          8  |   .2812024   .0968245     2.90   0.004     .0913945    .4710103
          9  |   .2866081   .1015997     2.82   0.005     .0874392    .4857769
         10  |   .2852194   .1075681     2.65   0.008     .0743505    .4960882
         11  |   .2948198   .1130714     2.61   0.009     .0731628    .5164768
         12  |   .3106615   .1186156     2.62   0.009     .0781361     .543187
         13  |   .3090905   .1244761     2.48   0.013     .0650764    .5531046
         14  |   .3381053   .1303546     2.59   0.010     .0825675    .5936431
         15  |   .3228787   .1364096     2.37   0.018     .0554711    .5902864
         16  |   .2920391   .1426606     2.05   0.041     .0123774    .5717008
         17  |   .2532342   .1489042     1.70   0.089    -.0386669    .5451354
         18  |   .2419191   .1551897     1.56   0.119    -.0623038    .5461419
         19  |    .225065   .1614719     1.39   0.163     -.091473     .541603
         20  |    .198468   .1731447     1.15   0.252    -.1409525    .5378884
         25  |   .0650206   .1966895     0.33   0.741    -.3205555    .4505966
         30  |   .0130204    .236792     0.05   0.956    -.4511696    .4772105
         40  |   .1029238   .2636141     0.39   0.696    -.4138465     .619694
         50  |   .1980121   .2940551     0.67   0.501    -.3784323    .7744566
             |
       _cons |   4.125342    .093413    44.16   0.000     3.942222    4.308462
-------------+----------------------------------------------------------------
     sigma_u |  1.6036607
     sigma_e |  .83505824
         rho |  .78668962   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1414645725466586

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    163,601
Group variable: firm_person                     Number of groups  =     19,026

R-sq:                                           Obs per group:
     within  = 0.1415                                         min =          1
     between = 0.0936                                         avg =        8.6
     overall = 0.0996                                         max =         25

                                                F(78,6511)        =      30.43
corr(u_i, Xb)  = 0.0440                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 6,512 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1326039   .0649973     2.04   0.041     .0051879    .2600198
      during |   .0476054   .0162515     2.93   0.003      .015747    .0794637
       after |   .0606135    .028602     2.12   0.034     .0045441    .1166829
during_expat |   -.065451   .0565973    -1.16   0.248    -.1764004    .0454983
 after_expat |  -.1288227   .0799222    -1.61   0.107    -.2854964     .027851
             |
    ind_year |
          2  |   .0753392   .0512238     1.47   0.141    -.0250763    .1757547
          3  |   .5821489   .0594848     9.79   0.000     .4655391    .6987587
          4  |   .7058594   .0658125    10.73   0.000     .5768454    .8348734
          5  |   .8461149   .0723668    11.69   0.000     .7042523    .9879775
          6  |   1.071439   .0777623    13.78   0.000     .9189992    1.223879
          7  |   1.317682    .082226    16.03   0.000     1.156492    1.478872
          8  |   1.497758   .0870287    17.21   0.000     1.327154    1.668363
          9  |   1.653163   .0927784    17.82   0.000     1.471287    1.835039
         10  |   1.750215   .0985781    17.75   0.000      1.55697    1.943461
         11  |   1.858629   .1048726    17.72   0.000     1.653045    2.064214
         12  |   1.921481   .1106723    17.36   0.000     1.704527    2.138435
         13  |   1.960019   .1169544    16.76   0.000      1.73075    2.189288
         14  |   1.988741   .1222202    16.27   0.000      1.74915    2.228333
         15  |   1.998314   .1282139    15.59   0.000     1.746972    2.249655
         16  |   2.093029   .1337018    15.65   0.000     1.830929    2.355128
         17  |   2.157272   .1395756    15.46   0.000     1.883658    2.430886
         18  |   2.201746   .1452903    15.15   0.000     1.916929    2.486563
         19  |   2.164452    .150779    14.36   0.000     1.868876    2.460029
         20  |   2.170185   .1568502    13.84   0.000     1.862707    2.477663
         21  |   2.208247   .1623078    13.61   0.000      1.89007    2.526423
         22  |   2.247665   .1667124    13.48   0.000     1.920854    2.574476
         23  |   2.356899   .1711273    13.77   0.000     2.021433    2.692365
         24  |   1.897551   .1799544    10.54   0.000     1.544781    2.250321
         25  |   1.949426   .1901779    10.25   0.000     1.576615    2.322237
         26  |   .3869385   .1243981     3.11   0.002     .1430775    .6307996
         27  |   .3984972   .1137199     3.50   0.000     .1755688    .6214256
         28  |   .6658763   .1061902     6.27   0.000     .4577087     .874044
         29  |   .8342202   .1043845     7.99   0.000     .6295922    1.038848
         30  |    .964598   .1030773     9.36   0.000     .7625327    1.166663
         31  |   1.079761   .1051366    10.27   0.000      .873659    1.285864
         32  |   1.298745   .1051216    12.35   0.000     1.092673    1.504818
         33  |   1.374976   .1070862    12.84   0.000     1.165052      1.5849
         34  |   1.478076   .1110173    13.31   0.000     1.260445    1.695706
         35  |   1.550098   .1150627    13.47   0.000     1.324537    1.775658
         36  |   1.673683   .1181925    14.16   0.000     1.441987    1.905379
         37  |   1.772381   .1229966    14.41   0.000     1.531268    2.013495
         38  |   1.837584   .1277927    14.38   0.000     1.587068      2.0881
         39  |   1.875335   .1324301    14.16   0.000     1.615728    2.134942
         40  |   1.892004   .1380832    13.70   0.000     1.621315    2.162692
         41  |   1.949881    .142931    13.64   0.000     1.669689    2.230072
         42  |   2.016384   .1496017    13.48   0.000     1.723115    2.309652
         43  |   2.064789    .155911    13.24   0.000     1.759152    2.370426
         44  |   2.073549   .1626277    12.75   0.000     1.754745    2.392352
         45  |   2.128484   .1675803    12.70   0.000     1.799971    2.456996
         46  |   2.136976   .1730242    12.35   0.000     1.797791     2.47616
         47  |   2.176499   .1763411    12.34   0.000     1.830812    2.522185
         48  |   2.275846   .1807965    12.59   0.000     1.921426    2.630267
         49  |   2.009819   .1886356    10.65   0.000     1.640031    2.379606
         50  |   2.165581   .1945521    11.13   0.000     1.784195    2.546967
             |
     age_cat |
          1  |   .0995287   .0633419     1.57   0.116    -.0246423    .2236997
          2  |   .2023146   .0691639     2.93   0.003     .0667307    .3378985
          3  |   .2438428   .0734982     3.32   0.001     .0997621    .3879234
          4  |   .2748694    .077631     3.54   0.000     .1226871    .4270518
          5  |   .2876453   .0822991     3.50   0.000     .1263121    .4489786
          6  |   .2821199   .0869839     3.24   0.001     .1116029    .4526369
          7  |   .2668097   .0920102     2.90   0.004     .0864396    .4471798
          8  |   .2812024   .0968245     2.90   0.004     .0913945    .4710103
          9  |   .2866081   .1015997     2.82   0.005     .0874392    .4857769
         10  |   .2852194   .1075681     2.65   0.008     .0743505    .4960882
         11  |   .2948198   .1130714     2.61   0.009     .0731628    .5164768
         12  |   .3106615   .1186156     2.62   0.009     .0781361     .543187
         13  |   .3090905   .1244761     2.48   0.013     .0650764    .5531046
         14  |   .3381053   .1303546     2.59   0.010     .0825675    .5936431
         15  |   .3228787   .1364096     2.37   0.018     .0554711    .5902864
         16  |   .2920391   .1426606     2.05   0.041     .0123774    .5717008
         17  |   .2532342   .1489042     1.70   0.089    -.0386669    .5451354
         18  |   .2419191   .1551897     1.56   0.119    -.0623038    .5461419
         19  |    .225065   .1614719     1.39   0.163     -.091473     .541603
         20  |    .198468   .1731447     1.15   0.252    -.1409525    .5378884
         25  |   .0650206   .1966895     0.33   0.741    -.3205555    .4505966
         30  |   .0130204    .236792     0.05   0.956    -.4511696    .4772105
         40  |   .1029238   .2636141     0.39   0.696    -.4138465     .619694
         50  |   .1980121   .2940551     0.67   0.501    -.3784323    .7744566
             |
       _cons |   4.125342    .093413    44.16   0.000     3.942222    4.308462
-------------+----------------------------------------------------------------
     sigma_u |  1.6036607
     sigma_e |  .83505824
         rho |  .78668962   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    141353
Group variable: firm_person                     Number of groups   =     16401

R-sq:  within  = 0.0956                         Obs per group: min =         1
       between = 0.0700                                        avg =       8.6
       overall = 0.0665                                        max =        25

                                                F(78,5785)         =     17.01
corr(u_i, Xb)  = -0.0132                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,786 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .053029    .071417     0.74   0.458     -.086975     .193033
      during |  -.0293864   .0169036    -1.74   0.082    -.0625238    .0037509
       after |  -.0546771   .0306672    -1.78   0.075    -.1147963    .0054421
during_expat |  -.0524997   .0645708    -0.81   0.416    -.1790825    .0740831
 after_expat |   -.143553   .0834114    -1.72   0.085    -.3070706    .0199645
             |
    ind_year |
          2  |   .1408109   .0765418     1.84   0.066    -.0092397    .2908615
          3  |   .6209668   .0872403     7.12   0.000     .4499431    .7919905
          4  |   .7747667   .0943719     8.21   0.000     .5897625    .9597709
          5  |   .9574286   .0998837     9.59   0.000     .7616193    1.153238
          6  |   1.199269   .1045406    11.47   0.000     .9943304    1.404208
          7  |   1.466046   .1076274    13.62   0.000     1.255056    1.677036
          8  |   1.686493   .1121533    15.04   0.000      1.46663    1.906355
          9  |   1.822638    .117534    15.51   0.000     1.592227    2.053048
         10  |   1.949763   .1235006    15.79   0.000     1.707655     2.19187
         11  |   2.112081   .1297653    16.28   0.000     1.857693     2.36647
         12  |    2.18091   .1355575    16.09   0.000     1.915167    2.446654
         13  |   2.257794   .1423667    15.86   0.000     1.978702    2.536886
         14  |   2.297696   .1487455    15.45   0.000     2.006099    2.589292
         15  |    2.29166   .1548094    14.80   0.000     1.988176    2.595145
         16  |   2.369421   .1609592    14.72   0.000     2.053881    2.684961
         17  |   2.404179   .1674393    14.36   0.000     2.075935    2.732422
         18  |    2.43863   .1739281    14.02   0.000     2.097666    2.779594
         19  |   2.407222   .1801461    13.36   0.000     2.054068    2.760376
         20  |   2.413291   .1866448    12.93   0.000     2.047397    2.779185
         21  |   2.448902   .1926958    12.71   0.000     2.071146    2.826658
         22  |   2.486463   .1983849    12.53   0.000     2.097554    2.875371
         23  |   2.572286   .2038545    12.62   0.000     2.172655    2.971917
         24  |    2.14097   .2129456    10.05   0.000     1.723517    2.558423
         25  |    2.18543   .2234308     9.78   0.000     1.747422    2.623438
         26  |   .4819112   .1686292     2.86   0.004     .1513348    .8124876
         27  |   .5462242   .1456646     3.75   0.000      .260667    .8317814
         28  |   .7810274   .1363684     5.73   0.000     .5136942    1.048361
         29  |   .9724495   .1328819     7.32   0.000     .7119513    1.232948
         30  |   1.084528   .1297227     8.36   0.000     .8302226    1.338833
         31  |   1.265989   .1298813     9.75   0.000     1.011373    1.520605
         32  |   1.481826   .1284756    11.53   0.000     1.229966    1.733686
         33  |   1.542765   .1301865    11.85   0.000     1.287551    1.797979
         34  |   1.729271   .1338787    12.92   0.000     1.466818    1.991723
         35  |   1.817912    .137424    13.23   0.000      1.54851    2.087315
         36  |   1.981074   .1415611    13.99   0.000     1.703561    2.258586
         37  |   2.121283    .146817    14.45   0.000     1.833467      2.4091
         38  |   2.184741   .1528431    14.29   0.000     1.885111     2.48437
         39  |   2.263565   .1581571    14.31   0.000     1.953518    2.573612
         40  |   2.301378   .1629503    14.12   0.000     1.981935    2.620822
         41  |   2.366534   .1691791    13.99   0.000      2.03488    2.698189
         42  |   2.419574   .1761659    13.73   0.000     2.074223    2.764925
         43  |   2.482665   .1828383    13.58   0.000     2.124234    2.841097
         44  |   2.493658   .1903103    13.10   0.000     2.120579    2.866738
         45  |   2.561103   .1962532    13.05   0.000     2.176373    2.945832
         46  |   2.542697   .2022915    12.57   0.000     2.146131    2.939264
         47  |   2.599268   .2065656    12.58   0.000     2.194322    3.004214
         48  |   2.665192   .2119439    12.57   0.000     2.249703    3.080681
         49  |   2.430873   .2204536    11.03   0.000     1.998701    2.863044
         50  |    2.56042    .228496    11.21   0.000     2.112482    3.008358
             |
     age_cat |
          1  |  -.0619036   .0684911    -0.90   0.366    -.1961717    .0723645
          2  |  -.0789905   .0731245    -1.08   0.280    -.2223418    .0643608
          3  |  -.1680485   .0772722    -2.17   0.030    -.3195309    -.016566
          4  |  -.2116517   .0811358    -2.61   0.009    -.3707082   -.0525952
          5  |  -.2504646   .0861587    -2.91   0.004    -.4193678   -.0815614
          6  |  -.3172053   .0914545    -3.47   0.001    -.4964903   -.1379203
          7  |  -.3353788   .0972189    -3.45   0.001    -.5259643   -.1447933
          8  |  -.3662189   .1033434    -3.54   0.000    -.5688107   -.1636271
          9  |  -.3936754   .1098272    -3.58   0.000    -.6089778    -.178373
         10  |  -.4001343   .1162581    -3.44   0.001    -.6280436   -.1722249
         11  |   -.410136   .1229364    -3.34   0.001    -.6511373   -.1691347
         12  |  -.4147854   .1296654    -3.20   0.001    -.6689781   -.1605926
         13  |  -.4529455   .1368869    -3.31   0.001    -.7212949    -.184596
         14  |  -.4603982   .1440596    -3.20   0.001    -.7428089   -.1779874
         15  |  -.4777736   .1507114    -3.17   0.002    -.7732244   -.1823228
         16  |  -.4953289   .1577851    -3.14   0.002    -.8046468    -.186011
         17  |  -.5114439   .1652307    -3.10   0.002    -.8353578     -.18753
         18  |  -.5389774   .1728348    -3.12   0.002    -.8777982   -.2001566
         19  |  -.5811113   .1802301    -3.22   0.001    -.9344299   -.2277928
         20  |  -.5893779   .1946827    -3.03   0.002    -.9710287    -.207727
         25  |  -.6954964   .2238357    -3.11   0.002    -1.134298   -.2566946
         30  |  -.7662737   .2667109    -2.87   0.004    -1.289127   -.2434206
         40  |  -.5687102   .3055304    -1.86   0.063    -1.167664    .0302438
         50  |  -.4947281   .3373559    -1.47   0.143    -1.156072    .1666158
             |
       _cons |   5.193655   .1162914    44.66   0.000     4.965681     5.42163
-------------+----------------------------------------------------------------
     sigma_u |  1.5167948
     sigma_e |  .79531417
         rho |  .78435614   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0955533538633424

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    141,353
Group variable: firm_person                     Number of groups  =     16,401

R-sq:                                           Obs per group:
     within  = 0.0956                                         min =          1
     between = 0.0700                                         avg =        8.6
     overall = 0.0665                                         max =         25

                                                F(78,5785)        =      17.01
corr(u_i, Xb)  = -0.0132                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,786 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .053029    .071417     0.74   0.458     -.086975     .193033
      during |  -.0293864   .0169036    -1.74   0.082    -.0625238    .0037509
       after |  -.0546771   .0306672    -1.78   0.075    -.1147963    .0054421
during_expat |  -.0524997   .0645708    -0.81   0.416    -.1790825    .0740831
 after_expat |   -.143553   .0834114    -1.72   0.085    -.3070706    .0199645
             |
    ind_year |
          2  |   .1408109   .0765418     1.84   0.066    -.0092397    .2908615
          3  |   .6209668   .0872403     7.12   0.000     .4499431    .7919905
          4  |   .7747667   .0943719     8.21   0.000     .5897625    .9597709
          5  |   .9574286   .0998837     9.59   0.000     .7616193    1.153238
          6  |   1.199269   .1045406    11.47   0.000     .9943304    1.404208
          7  |   1.466046   .1076274    13.62   0.000     1.255056    1.677036
          8  |   1.686493   .1121533    15.04   0.000      1.46663    1.906355
          9  |   1.822638    .117534    15.51   0.000     1.592227    2.053048
         10  |   1.949763   .1235006    15.79   0.000     1.707655     2.19187
         11  |   2.112081   .1297653    16.28   0.000     1.857693     2.36647
         12  |    2.18091   .1355575    16.09   0.000     1.915167    2.446654
         13  |   2.257794   .1423667    15.86   0.000     1.978702    2.536886
         14  |   2.297696   .1487455    15.45   0.000     2.006099    2.589292
         15  |    2.29166   .1548094    14.80   0.000     1.988176    2.595145
         16  |   2.369421   .1609592    14.72   0.000     2.053881    2.684961
         17  |   2.404179   .1674393    14.36   0.000     2.075935    2.732422
         18  |    2.43863   .1739281    14.02   0.000     2.097666    2.779594
         19  |   2.407222   .1801461    13.36   0.000     2.054068    2.760376
         20  |   2.413291   .1866448    12.93   0.000     2.047397    2.779185
         21  |   2.448902   .1926958    12.71   0.000     2.071146    2.826658
         22  |   2.486463   .1983849    12.53   0.000     2.097554    2.875371
         23  |   2.572286   .2038545    12.62   0.000     2.172655    2.971917
         24  |    2.14097   .2129456    10.05   0.000     1.723517    2.558423
         25  |    2.18543   .2234308     9.78   0.000     1.747422    2.623438
         26  |   .4819112   .1686292     2.86   0.004     .1513348    .8124876
         27  |   .5462242   .1456646     3.75   0.000      .260667    .8317814
         28  |   .7810274   .1363684     5.73   0.000     .5136942    1.048361
         29  |   .9724495   .1328819     7.32   0.000     .7119513    1.232948
         30  |   1.084528   .1297227     8.36   0.000     .8302226    1.338833
         31  |   1.265989   .1298813     9.75   0.000     1.011373    1.520605
         32  |   1.481826   .1284756    11.53   0.000     1.229966    1.733686
         33  |   1.542765   .1301865    11.85   0.000     1.287551    1.797979
         34  |   1.729271   .1338787    12.92   0.000     1.466818    1.991723
         35  |   1.817912    .137424    13.23   0.000      1.54851    2.087315
         36  |   1.981074   .1415611    13.99   0.000     1.703561    2.258586
         37  |   2.121283    .146817    14.45   0.000     1.833467      2.4091
         38  |   2.184741   .1528431    14.29   0.000     1.885111     2.48437
         39  |   2.263565   .1581571    14.31   0.000     1.953518    2.573612
         40  |   2.301378   .1629503    14.12   0.000     1.981935    2.620822
         41  |   2.366534   .1691791    13.99   0.000      2.03488    2.698189
         42  |   2.419574   .1761659    13.73   0.000     2.074223    2.764925
         43  |   2.482665   .1828383    13.58   0.000     2.124234    2.841097
         44  |   2.493658   .1903103    13.10   0.000     2.120579    2.866738
         45  |   2.561103   .1962532    13.05   0.000     2.176373    2.945832
         46  |   2.542697   .2022915    12.57   0.000     2.146131    2.939264
         47  |   2.599268   .2065656    12.58   0.000     2.194322    3.004214
         48  |   2.665192   .2119439    12.57   0.000     2.249703    3.080681
         49  |   2.430873   .2204536    11.03   0.000     1.998701    2.863044
         50  |    2.56042    .228496    11.21   0.000     2.112482    3.008358
             |
     age_cat |
          1  |  -.0619036   .0684911    -0.90   0.366    -.1961717    .0723645
          2  |  -.0789905   .0731245    -1.08   0.280    -.2223418    .0643608
          3  |  -.1680485   .0772722    -2.17   0.030    -.3195309    -.016566
          4  |  -.2116517   .0811358    -2.61   0.009    -.3707082   -.0525952
          5  |  -.2504646   .0861587    -2.91   0.004    -.4193678   -.0815614
          6  |  -.3172053   .0914545    -3.47   0.001    -.4964903   -.1379203
          7  |  -.3353788   .0972189    -3.45   0.001    -.5259643   -.1447933
          8  |  -.3662189   .1033434    -3.54   0.000    -.5688107   -.1636271
          9  |  -.3936754   .1098272    -3.58   0.000    -.6089778    -.178373
         10  |  -.4001343   .1162581    -3.44   0.001    -.6280436   -.1722249
         11  |   -.410136   .1229364    -3.34   0.001    -.6511373   -.1691347
         12  |  -.4147854   .1296654    -3.20   0.001    -.6689781   -.1605926
         13  |  -.4529455   .1368869    -3.31   0.001    -.7212949    -.184596
         14  |  -.4603982   .1440596    -3.20   0.001    -.7428089   -.1779874
         15  |  -.4777736   .1507114    -3.17   0.002    -.7732244   -.1823228
         16  |  -.4953289   .1577851    -3.14   0.002    -.8046468    -.186011
         17  |  -.5114439   .1652307    -3.10   0.002    -.8353578     -.18753
         18  |  -.5389774   .1728348    -3.12   0.002    -.8777982   -.2001566
         19  |  -.5811113   .1802301    -3.22   0.001    -.9344299   -.2277928
         20  |  -.5893779   .1946827    -3.03   0.002    -.9710287    -.207727
         25  |  -.6954964   .2238357    -3.11   0.002    -1.134298   -.2566946
         30  |  -.7662737   .2667109    -2.87   0.004    -1.289127   -.2434206
         40  |  -.5687102   .3055304    -1.86   0.063    -1.167664    .0302438
         50  |  -.4947281   .3373559    -1.47   0.143    -1.156072    .1666158
             |
       _cons |   5.193655   .1162914    44.66   0.000     4.965681     5.42163
-------------+----------------------------------------------------------------
     sigma_u |  1.5167948
     sigma_e |  .79531417
         rho |  .78435614   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    132492
Group variable: firm_person                     Number of groups   =     15330

R-sq:  within  = 0.1169                         Obs per group: min =         1
       between = 0.0680                                        avg =       8.6
       overall = 0.0678                                        max =        25

                                                F(78,5521)         =     22.53
corr(u_i, Xb)  = -0.0092                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,522 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0734248   .0729742     1.01   0.314    -.0696335     .216483
      during |   .0083082   .0175584     0.47   0.636    -.0261132    .0427296
       after |  -.0216716   .0318421    -0.68   0.496    -.0840947    .0407515
during_expat |  -.1351788   .0720142    -1.88   0.061     -.276355    .0059975
 after_expat |  -.2613712   .0920529    -2.84   0.005     -.441831   -.0809113
             |
    ind_year |
          2  |   .1258895   .0656163     1.92   0.055    -.0027444    .2545234
          3  |   .6838954   .0787237     8.69   0.000     .5295661    .8382248
          4  |   .8585921   .0833626    10.30   0.000     .6951686    1.022016
          5  |   .9974025   .0908708    10.98   0.000       .81926    1.175545
          6  |   1.240539     .09696    12.79   0.000     1.050459    1.430618
          7  |   1.494889    .100253    14.91   0.000     1.298353    1.691424
          8  |   1.728867   .1050306    16.46   0.000     1.522966    1.934768
          9  |   1.871273   .1112324    16.82   0.000     1.653213    2.089332
         10  |   2.015376   .1172245    17.19   0.000      1.78557    2.245183
         11  |   2.157833   .1239221    17.41   0.000     1.914897    2.400769
         12  |   2.204261   .1304577    16.90   0.000     1.948513    2.460009
         13  |   2.284074   .1377002    16.59   0.000     2.014127     2.55402
         14  |   2.284906   .1446296    15.80   0.000     2.001375    2.568437
         15  |   2.276033    .151104    15.06   0.000      1.97981    2.572256
         16  |   2.361903   .1575093    15.00   0.000     2.053123    2.670683
         17  |   2.390155   .1643662    14.54   0.000     2.067933    2.712378
         18  |   2.406915    .170672    14.10   0.000     2.072331      2.7415
         19  |      2.366   .1772024    13.35   0.000     2.018614    2.713387
         20  |   2.375184   .1837502    12.93   0.000     2.014961    2.735406
         21  |   2.409137   .1896533    12.70   0.000     2.037342    2.780932
         22  |   2.454149   .1952495    12.57   0.000     2.071383    2.836915
         23  |   2.550802   .2011223    12.68   0.000     2.156523    2.945081
         24  |    2.00816   .2106563     9.53   0.000     1.595191     2.42113
         25  |   2.075967   .2226325     9.32   0.000      1.63952    2.512414
         26  |   .5498347   .1765947     3.11   0.002     .2036395      .89603
         27  |   .6146711   .1510469     4.07   0.000     .3185598    .9107824
         28  |   .8832057   .1380507     6.40   0.000     .6125719    1.153839
         29  |    1.07099   .1357262     7.89   0.000     .8049136    1.337067
         30  |   1.106347   .1314851     8.41   0.000      .848584    1.364109
         31  |    1.30566   .1289312    10.13   0.000     1.052904    1.558416
         32  |   1.563932   .1250458    12.51   0.000     1.318793    1.809071
         33  |   1.650518   .1255036    13.15   0.000     1.404481    1.896554
         34  |   1.809757   .1294741    13.98   0.000     1.555937    2.063577
         35  |   1.873183   .1329493    14.09   0.000      1.61255    2.133816
         36  |   2.037179   .1355696    15.03   0.000     1.771409    2.302949
         37  |   2.131775   .1413425    15.08   0.000     1.854688    2.408862
         38  |    2.23385   .1473144    15.16   0.000     1.945056    2.522645
         39  |   2.310935   .1525368    15.15   0.000     2.011902    2.609967
         40  |   2.347912   .1585089    14.81   0.000     2.037172    2.658652
         41  |   2.399449   .1656898    14.48   0.000     2.074632    2.724266
         42  |   2.426256   .1731189    14.01   0.000     2.086875    2.765637
         43  |   2.488377   .1807461    13.77   0.000     2.134043     2.84271
         44  |   2.492632   .1885606    13.22   0.000     2.122979    2.862285
         45  |   2.547602   .1941335    13.12   0.000     2.167024     2.92818
         46  |   2.542629   .2007745    12.66   0.000     2.149032    2.936226
         47  |   2.600034     .20517    12.67   0.000      2.19782    3.002248
         48  |   2.686321   .2109842    12.73   0.000     2.272708    3.099933
         49  |   2.412126   .2215464    10.89   0.000     1.977808    2.846444
         50  |   2.547901   .2284112    11.15   0.000     2.100125    2.995677
             |
     age_cat |
          1  |    .140432   .0788662     1.78   0.075    -.0141767    .2950408
          2  |   .1729427   .0849837     2.04   0.042     .0063413    .3395442
          3  |   .2034232   .0882803     2.30   0.021     .0303589    .3764874
          4  |   .1917948   .0923856     2.08   0.038     .0106827     .372907
          5  |   .1703513   .0969713     1.76   0.079    -.0197505    .3604532
          6  |   .1288164   .1022378     1.26   0.208      -.07161    .3292428
          7  |    .126793    .107148     1.18   0.237    -.0832592    .3368451
          8  |   .0987847   .1136977     0.87   0.385    -.1241075    .3216769
          9  |   .0795645   .1196863     0.66   0.506    -.1550678    .3141968
         10  |   .0837912   .1253642     0.67   0.504     -.161972    .3295544
         11  |   .0666904   .1317006     0.51   0.613    -.1914946    .3248755
         12  |   .0613318    .137908     0.44   0.657    -.2090222    .3316858
         13  |   .0399143    .144932     0.28   0.783    -.2442094     .324038
         14  |   .0358589   .1518607     0.24   0.813    -.2618477    .3335656
         15  |   .0198022   .1588304     0.12   0.901    -.2915679    .3311723
         16  |  -.0048743    .165818    -0.03   0.977    -.3299428    .3201941
         17  |  -.0301397   .1731479    -0.17   0.862    -.3695778    .3092984
         18  |  -.0566959   .1803247    -0.31   0.753    -.4102033    .2968114
         19  |  -.0742064    .187587    -0.40   0.692    -.4419507    .2935379
         20  |  -.0964505   .2017053    -0.48   0.633    -.4918723    .2989713
         25  |  -.2113431   .2299906    -0.92   0.358    -.6622151     .239529
         30  |  -.2886912   .2709676    -1.07   0.287    -.8198945     .242512
         40  |  -.1525966   .3038811    -0.50   0.616    -.7483231      .44313
         50  |  -.0391571    .337381    -0.12   0.908    -.7005567    .6222424
             |
       _cons |   4.500374   .1137837    39.55   0.000     4.277314    4.723435
-------------+----------------------------------------------------------------
     sigma_u |  1.5297196
     sigma_e |  .82081923
         rho |  .77644593   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1169352476166449

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    132,492
Group variable: firm_person                     Number of groups  =     15,330

R-sq:                                           Obs per group:
     within  = 0.1169                                         min =          1
     between = 0.0680                                         avg =        8.6
     overall = 0.0678                                         max =         25

                                                F(78,5521)        =      22.53
corr(u_i, Xb)  = -0.0092                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,522 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0734248   .0729742     1.01   0.314    -.0696335     .216483
      during |   .0083082   .0175584     0.47   0.636    -.0261132    .0427296
       after |  -.0216716   .0318421    -0.68   0.496    -.0840947    .0407515
during_expat |  -.1351788   .0720142    -1.88   0.061     -.276355    .0059975
 after_expat |  -.2613712   .0920529    -2.84   0.005     -.441831   -.0809113
             |
    ind_year |
          2  |   .1258895   .0656163     1.92   0.055    -.0027444    .2545234
          3  |   .6838954   .0787237     8.69   0.000     .5295661    .8382248
          4  |   .8585921   .0833626    10.30   0.000     .6951686    1.022016
          5  |   .9974025   .0908708    10.98   0.000       .81926    1.175545
          6  |   1.240539     .09696    12.79   0.000     1.050459    1.430618
          7  |   1.494889    .100253    14.91   0.000     1.298353    1.691424
          8  |   1.728867   .1050306    16.46   0.000     1.522966    1.934768
          9  |   1.871273   .1112324    16.82   0.000     1.653213    2.089332
         10  |   2.015376   .1172245    17.19   0.000      1.78557    2.245183
         11  |   2.157833   .1239221    17.41   0.000     1.914897    2.400769
         12  |   2.204261   .1304577    16.90   0.000     1.948513    2.460009
         13  |   2.284074   .1377002    16.59   0.000     2.014127     2.55402
         14  |   2.284906   .1446296    15.80   0.000     2.001375    2.568437
         15  |   2.276033    .151104    15.06   0.000      1.97981    2.572256
         16  |   2.361903   .1575093    15.00   0.000     2.053123    2.670683
         17  |   2.390155   .1643662    14.54   0.000     2.067933    2.712378
         18  |   2.406915    .170672    14.10   0.000     2.072331      2.7415
         19  |      2.366   .1772024    13.35   0.000     2.018614    2.713387
         20  |   2.375184   .1837502    12.93   0.000     2.014961    2.735406
         21  |   2.409137   .1896533    12.70   0.000     2.037342    2.780932
         22  |   2.454149   .1952495    12.57   0.000     2.071383    2.836915
         23  |   2.550802   .2011223    12.68   0.000     2.156523    2.945081
         24  |    2.00816   .2106563     9.53   0.000     1.595191     2.42113
         25  |   2.075967   .2226325     9.32   0.000      1.63952    2.512414
         26  |   .5498347   .1765947     3.11   0.002     .2036395      .89603
         27  |   .6146711   .1510469     4.07   0.000     .3185598    .9107824
         28  |   .8832057   .1380507     6.40   0.000     .6125719    1.153839
         29  |    1.07099   .1357262     7.89   0.000     .8049136    1.337067
         30  |   1.106347   .1314851     8.41   0.000      .848584    1.364109
         31  |    1.30566   .1289312    10.13   0.000     1.052904    1.558416
         32  |   1.563932   .1250458    12.51   0.000     1.318793    1.809071
         33  |   1.650518   .1255036    13.15   0.000     1.404481    1.896554
         34  |   1.809757   .1294741    13.98   0.000     1.555937    2.063577
         35  |   1.873183   .1329493    14.09   0.000      1.61255    2.133816
         36  |   2.037179   .1355696    15.03   0.000     1.771409    2.302949
         37  |   2.131775   .1413425    15.08   0.000     1.854688    2.408862
         38  |    2.23385   .1473144    15.16   0.000     1.945056    2.522645
         39  |   2.310935   .1525368    15.15   0.000     2.011902    2.609967
         40  |   2.347912   .1585089    14.81   0.000     2.037172    2.658652
         41  |   2.399449   .1656898    14.48   0.000     2.074632    2.724266
         42  |   2.426256   .1731189    14.01   0.000     2.086875    2.765637
         43  |   2.488377   .1807461    13.77   0.000     2.134043     2.84271
         44  |   2.492632   .1885606    13.22   0.000     2.122979    2.862285
         45  |   2.547602   .1941335    13.12   0.000     2.167024     2.92818
         46  |   2.542629   .2007745    12.66   0.000     2.149032    2.936226
         47  |   2.600034     .20517    12.67   0.000      2.19782    3.002248
         48  |   2.686321   .2109842    12.73   0.000     2.272708    3.099933
         49  |   2.412126   .2215464    10.89   0.000     1.977808    2.846444
         50  |   2.547901   .2284112    11.15   0.000     2.100125    2.995677
             |
     age_cat |
          1  |    .140432   .0788662     1.78   0.075    -.0141767    .2950408
          2  |   .1729427   .0849837     2.04   0.042     .0063413    .3395442
          3  |   .2034232   .0882803     2.30   0.021     .0303589    .3764874
          4  |   .1917948   .0923856     2.08   0.038     .0106827     .372907
          5  |   .1703513   .0969713     1.76   0.079    -.0197505    .3604532
          6  |   .1288164   .1022378     1.26   0.208      -.07161    .3292428
          7  |    .126793    .107148     1.18   0.237    -.0832592    .3368451
          8  |   .0987847   .1136977     0.87   0.385    -.1241075    .3216769
          9  |   .0795645   .1196863     0.66   0.506    -.1550678    .3141968
         10  |   .0837912   .1253642     0.67   0.504     -.161972    .3295544
         11  |   .0666904   .1317006     0.51   0.613    -.1914946    .3248755
         12  |   .0613318    .137908     0.44   0.657    -.2090222    .3316858
         13  |   .0399143    .144932     0.28   0.783    -.2442094     .324038
         14  |   .0358589   .1518607     0.24   0.813    -.2618477    .3335656
         15  |   .0198022   .1588304     0.12   0.901    -.2915679    .3311723
         16  |  -.0048743    .165818    -0.03   0.977    -.3299428    .3201941
         17  |  -.0301397   .1731479    -0.17   0.862    -.3695778    .3092984
         18  |  -.0566959   .1803247    -0.31   0.753    -.4102033    .2968114
         19  |  -.0742064    .187587    -0.40   0.692    -.4419507    .2935379
         20  |  -.0964505   .2017053    -0.48   0.633    -.4918723    .2989713
         25  |  -.2113431   .2299906    -0.92   0.358    -.6622151     .239529
         30  |  -.2886912   .2709676    -1.07   0.287    -.8198945     .242512
         40  |  -.1525966   .3038811    -0.50   0.616    -.7483231      .44313
         50  |  -.0391571    .337381    -0.12   0.908    -.7005567    .6222424
             |
       _cons |   4.500374   .1137837    39.55   0.000     4.277314    4.723435
-------------+----------------------------------------------------------------
     sigma_u |  1.5297196
     sigma_e |  .82081923
         rho |  .77644593   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    122430
Group variable: firm_person                     Number of groups   =     14152

R-sq:  within  = 0.1281                         Obs per group: min =         1
       between = 0.1002                                        avg =       8.7
       overall = 0.0932                                        max =        25

                                                F(78,4657)         =     19.99
corr(u_i, Xb)  = 0.0434                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,658 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0407585   .0708333     0.58   0.565    -.0981083    .1796254
      during |   .0300028   .0193369     1.55   0.121    -.0079067    .0679123
       after |   .0486981   .0335127     1.45   0.146    -.0170027    .1143989
during_expat |  -.0274059   .0656927    -0.42   0.677    -.1561946    .1013828
 after_expat |  -.1219885   .0828518    -1.47   0.141    -.2844173    .0404402
             |
    ind_year |
          2  |   .0989314    .064973     1.52   0.128    -.0284465    .2263092
          3  |   .6821366   .0789147     8.64   0.000     .5274264    .8368469
          4  |   .8046846   .0848478     9.48   0.000     .6383428    .9710264
          5  |   .9336537   .0932116    10.02   0.000     .7509149    1.116393
          6  |   1.190254   .0986312    12.07   0.000     .9968902    1.383618
          7  |   1.428623   .1006661    14.19   0.000     1.231269    1.625976
          8  |   1.581992   .1050721    15.06   0.000     1.376001    1.787983
          9  |   1.758538   .1105296    15.91   0.000     1.541848    1.975229
         10  |   1.898017   .1178269    16.11   0.000     1.667021    2.129014
         11  |   1.994088   .1255127    15.89   0.000     1.748023    2.240152
         12  |   2.045501    .131489    15.56   0.000      1.78772    2.303281
         13  |   2.110065   .1381817    15.27   0.000     1.839164    2.380967
         14  |   2.120022   .1440771    14.71   0.000     1.837563    2.402481
         15  |   2.107432   .1504059    14.01   0.000     1.812565    2.402299
         16  |   2.164954   .1570001    13.79   0.000     1.857159    2.472748
         17  |   2.189118    .163202    13.41   0.000     1.869164    2.509071
         18  |    2.22861   .1695319    13.15   0.000     1.896247    2.560973
         19  |   2.191379   .1756996    12.47   0.000     1.846925    2.535834
         20  |   2.194747    .181857    12.07   0.000     1.838222    2.551273
         21  |    2.22175   .1874813    11.85   0.000     1.854198    2.589302
         22  |   2.271078   .1923283    11.81   0.000     1.894024    2.648133
         23  |   2.364467   .1976393    11.96   0.000        1.977    2.751933
         24  |   1.840418   .2084576     8.83   0.000     1.431742    2.249093
         25  |   1.892883   .2212296     8.56   0.000     1.459168    2.326598
         26  |   .4897265   .1414756     3.46   0.001     .2123674    .7670856
         27  |   .5132298   .1309711     3.92   0.000     .2564645    .7699951
         28  |   .7446639   .1229565     6.06   0.000     .5036108     .985717
         29  |   .9229601   .1208427     7.64   0.000     .6860513    1.159869
         30  |   1.011143    .119441     8.47   0.000     .7769817    1.245304
         31  |    1.16017    .121873     9.52   0.000     .9212406    1.399098
         32  |   1.378503   .1219609    11.30   0.000     1.139402    1.617604
         33  |   1.417056   .1242519    11.40   0.000     1.173463    1.660649
         34  |   1.544354   .1283433    12.03   0.000      1.29274    1.795967
         35  |   1.611407   .1330035    12.12   0.000     1.350657    1.872157
         36  |    1.76045   .1361215    12.93   0.000     1.493587    2.027312
         37  |   1.856925   .1419316    13.08   0.000     1.578671    2.135178
         38  |    1.89222   .1487759    12.72   0.000     1.600549    2.183891
         39  |   1.943483   .1534451    12.67   0.000     1.642658    2.244308
         40  |   1.954384    .159473    12.26   0.000     1.641742    2.267027
         41  |   1.998828   .1658085    12.06   0.000     1.673764    2.323891
         42  |   2.078227   .1735409    11.98   0.000     1.738005     2.41845
         43  |   2.138431   .1803549    11.86   0.000      1.78485    2.492012
         44  |   2.124258   .1884898    11.27   0.000     1.754729    2.493787
         45  |    2.17626   .1942907    11.20   0.000     1.795359    2.557162
         46  |   2.175396   .2003918    10.86   0.000     1.782533    2.568259
         47  |   2.244203   .2040535    11.00   0.000     1.844162    2.644245
         48  |   2.313327   .2097355    11.03   0.000     1.902146    2.724508
         49  |   2.057827   .2184056     9.42   0.000     1.629648    2.486005
         50  |   2.230612   .2252522     9.90   0.000     1.789011    2.672213
             |
     age_cat |
          1  |   .0589355   .0968784     0.61   0.543    -.1309921    .2488631
          2  |   .1469881   .1029015     1.43   0.153    -.0547476    .3487239
          3  |   .1449768   .1070325     1.35   0.176    -.0648577    .3548112
          4  |   .1717288   .1105148     1.55   0.120    -.0449325    .3883902
          5  |   .1964377    .115194     1.71   0.088     -.029397    .4222725
          6  |   .1530216   .1195693     1.28   0.201    -.0813908    .3874339
          7  |   .1556636   .1244215     1.25   0.211    -.0882613    .3995886
          8  |    .158071   .1291825     1.22   0.221    -.0951879    .4113298
          9  |   .1643441   .1341401     1.23   0.221    -.0986341    .4273223
         10  |    .142557   .1401614     1.02   0.309    -.1322258    .4173397
         11  |   .1394619   .1455387     0.96   0.338    -.1458628    .4247866
         12  |   .1400682   .1513957     0.93   0.355    -.1567391    .4368756
         13  |   .1336244   .1577298     0.85   0.397    -.1756006    .4428494
         14  |   .1393495   .1639786     0.85   0.395    -.1821261    .4608251
         15  |   .1273477    .170341     0.75   0.455    -.2066014    .4612967
         16  |   .1097046   .1764229     0.62   0.534    -.2361678     .455577
         17  |   .0939069   .1827371     0.51   0.607    -.2643444    .4521581
         18  |   .0732255   .1893897     0.39   0.699    -.2980681     .444519
         19  |   .0505619   .1959823     0.26   0.796    -.3336563      .43478
         20  |   .0120354   .2085401     0.06   0.954    -.3968019    .4208728
         25  |  -.1036178   .2347432    -0.44   0.659    -.5638256      .35659
         30  |  -.1419498   .2741588    -0.52   0.605    -.6794308    .3955312
         40  |  -.0572796   .3027772    -0.19   0.850    -.6508663    .5363071
         50  |   .0676462   .3373199     0.20   0.841    -.5936605    .7289529
             |
       _cons |   4.472372   .1327287    33.70   0.000      4.21216    4.732583
-------------+----------------------------------------------------------------
     sigma_u |  1.5226648
     sigma_e |  .81463228
         rho |  .77746614   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1281435297596379

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    122,430
Group variable: firm_person                     Number of groups  =     14,152

R-sq:                                           Obs per group:
     within  = 0.1281                                         min =          1
     between = 0.1002                                         avg =        8.7
     overall = 0.0932                                         max =         25

                                                F(78,4657)        =      19.99
corr(u_i, Xb)  = 0.0434                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,658 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0407585   .0708333     0.58   0.565    -.0981083    .1796254
      during |   .0300028   .0193369     1.55   0.121    -.0079067    .0679123
       after |   .0486981   .0335127     1.45   0.146    -.0170027    .1143989
during_expat |  -.0274059   .0656927    -0.42   0.677    -.1561946    .1013828
 after_expat |  -.1219885   .0828518    -1.47   0.141    -.2844173    .0404402
             |
    ind_year |
          2  |   .0989314    .064973     1.52   0.128    -.0284465    .2263092
          3  |   .6821366   .0789147     8.64   0.000     .5274264    .8368469
          4  |   .8046846   .0848478     9.48   0.000     .6383428    .9710264
          5  |   .9336537   .0932116    10.02   0.000     .7509149    1.116393
          6  |   1.190254   .0986312    12.07   0.000     .9968902    1.383618
          7  |   1.428623   .1006661    14.19   0.000     1.231269    1.625976
          8  |   1.581992   .1050721    15.06   0.000     1.376001    1.787983
          9  |   1.758538   .1105296    15.91   0.000     1.541848    1.975229
         10  |   1.898017   .1178269    16.11   0.000     1.667021    2.129014
         11  |   1.994088   .1255127    15.89   0.000     1.748023    2.240152
         12  |   2.045501    .131489    15.56   0.000      1.78772    2.303281
         13  |   2.110065   .1381817    15.27   0.000     1.839164    2.380967
         14  |   2.120022   .1440771    14.71   0.000     1.837563    2.402481
         15  |   2.107432   .1504059    14.01   0.000     1.812565    2.402299
         16  |   2.164954   .1570001    13.79   0.000     1.857159    2.472748
         17  |   2.189118    .163202    13.41   0.000     1.869164    2.509071
         18  |    2.22861   .1695319    13.15   0.000     1.896247    2.560973
         19  |   2.191379   .1756996    12.47   0.000     1.846925    2.535834
         20  |   2.194747    .181857    12.07   0.000     1.838222    2.551273
         21  |    2.22175   .1874813    11.85   0.000     1.854198    2.589302
         22  |   2.271078   .1923283    11.81   0.000     1.894024    2.648133
         23  |   2.364467   .1976393    11.96   0.000        1.977    2.751933
         24  |   1.840418   .2084576     8.83   0.000     1.431742    2.249093
         25  |   1.892883   .2212296     8.56   0.000     1.459168    2.326598
         26  |   .4897265   .1414756     3.46   0.001     .2123674    .7670856
         27  |   .5132298   .1309711     3.92   0.000     .2564645    .7699951
         28  |   .7446639   .1229565     6.06   0.000     .5036108     .985717
         29  |   .9229601   .1208427     7.64   0.000     .6860513    1.159869
         30  |   1.011143    .119441     8.47   0.000     .7769817    1.245304
         31  |    1.16017    .121873     9.52   0.000     .9212406    1.399098
         32  |   1.378503   .1219609    11.30   0.000     1.139402    1.617604
         33  |   1.417056   .1242519    11.40   0.000     1.173463    1.660649
         34  |   1.544354   .1283433    12.03   0.000      1.29274    1.795967
         35  |   1.611407   .1330035    12.12   0.000     1.350657    1.872157
         36  |    1.76045   .1361215    12.93   0.000     1.493587    2.027312
         37  |   1.856925   .1419316    13.08   0.000     1.578671    2.135178
         38  |    1.89222   .1487759    12.72   0.000     1.600549    2.183891
         39  |   1.943483   .1534451    12.67   0.000     1.642658    2.244308
         40  |   1.954384    .159473    12.26   0.000     1.641742    2.267027
         41  |   1.998828   .1658085    12.06   0.000     1.673764    2.323891
         42  |   2.078227   .1735409    11.98   0.000     1.738005     2.41845
         43  |   2.138431   .1803549    11.86   0.000      1.78485    2.492012
         44  |   2.124258   .1884898    11.27   0.000     1.754729    2.493787
         45  |    2.17626   .1942907    11.20   0.000     1.795359    2.557162
         46  |   2.175396   .2003918    10.86   0.000     1.782533    2.568259
         47  |   2.244203   .2040535    11.00   0.000     1.844162    2.644245
         48  |   2.313327   .2097355    11.03   0.000     1.902146    2.724508
         49  |   2.057827   .2184056     9.42   0.000     1.629648    2.486005
         50  |   2.230612   .2252522     9.90   0.000     1.789011    2.672213
             |
     age_cat |
          1  |   .0589355   .0968784     0.61   0.543    -.1309921    .2488631
          2  |   .1469881   .1029015     1.43   0.153    -.0547476    .3487239
          3  |   .1449768   .1070325     1.35   0.176    -.0648577    .3548112
          4  |   .1717288   .1105148     1.55   0.120    -.0449325    .3883902
          5  |   .1964377    .115194     1.71   0.088     -.029397    .4222725
          6  |   .1530216   .1195693     1.28   0.201    -.0813908    .3874339
          7  |   .1556636   .1244215     1.25   0.211    -.0882613    .3995886
          8  |    .158071   .1291825     1.22   0.221    -.0951879    .4113298
          9  |   .1643441   .1341401     1.23   0.221    -.0986341    .4273223
         10  |    .142557   .1401614     1.02   0.309    -.1322258    .4173397
         11  |   .1394619   .1455387     0.96   0.338    -.1458628    .4247866
         12  |   .1400682   .1513957     0.93   0.355    -.1567391    .4368756
         13  |   .1336244   .1577298     0.85   0.397    -.1756006    .4428494
         14  |   .1393495   .1639786     0.85   0.395    -.1821261    .4608251
         15  |   .1273477    .170341     0.75   0.455    -.2066014    .4612967
         16  |   .1097046   .1764229     0.62   0.534    -.2361678     .455577
         17  |   .0939069   .1827371     0.51   0.607    -.2643444    .4521581
         18  |   .0732255   .1893897     0.39   0.699    -.2980681     .444519
         19  |   .0505619   .1959823     0.26   0.796    -.3336563      .43478
         20  |   .0120354   .2085401     0.06   0.954    -.3968019    .4208728
         25  |  -.1036178   .2347432    -0.44   0.659    -.5638256      .35659
         30  |  -.1419498   .2741588    -0.52   0.605    -.6794308    .3955312
         40  |  -.0572796   .3027772    -0.19   0.850    -.6508663    .5363071
         50  |   .0676462   .3373199     0.20   0.841    -.5936605    .7289529
             |
       _cons |   4.472372   .1327287    33.70   0.000      4.21216    4.732583
-------------+----------------------------------------------------------------
     sigma_u |  1.5226648
     sigma_e |  .81463228
         rho |  .77746614   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    382405
Group variable: firm_person                     Number of groups   =     40681

R-sq:  within  = 0.1841                         Obs per group: min =         1
       between = 0.1451                                        avg =       9.4
       overall = 0.1315                                        max =        25

                                                F(78,14145)        =    100.19
corr(u_i, Xb)  = 0.0762                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,146 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0673855   .0230837     2.92   0.004     .0221383    .1126326
      during |   .0244747   .0071572     3.42   0.001     .0104456    .0385037
       after |   .0477194   .0125383     3.81   0.000     .0231427    .0722961
during_expat |   .0534132   .0143849     3.71   0.000      .025217    .0816094
 after_expat |    .069015   .0194623     3.55   0.000     .0308662    .1071637
             |
    ind_year |
          2  |   .0681273   .0252123     2.70   0.007     .0187078    .1175469
          3  |   .2287367   .0323648     7.07   0.000     .1652974    .2921759
          4  |    .394273    .034728    11.35   0.000     .3262015    .4623446
          5  |   .5453454   .0375561    14.52   0.000     .4717306    .6189602
          6  |     .70555   .0408092    17.29   0.000     .6255586    .7855415
          7  |   .8472099   .0426805    19.85   0.000     .7635505    .9308693
          8  |   .9280022   .0446658    20.78   0.000     .8404513    1.015553
          9  |   1.035657   .0468895    22.09   0.000     .9437478    1.127567
         10  |   1.147774   .0492787    23.29   0.000     1.051181    1.244366
         11  |   1.210245   .0519166    23.31   0.000     1.108481    1.312008
         12  |   1.233179   .0545422    22.61   0.000     1.126269    1.340089
         13  |   1.286673   .0573063    22.45   0.000     1.174345    1.399001
         14  |   1.324233   .0597416    22.17   0.000     1.207132    1.441334
         15  |   1.384804   .0625587    22.14   0.000      1.26218    1.507427
         16  |   1.409318   .0648086    21.75   0.000     1.282285    1.536352
         17  |   1.456504   .0675444    21.56   0.000     1.324108      1.5889
         18  |   1.395107   .0701591    19.88   0.000     1.257586    1.532629
         19  |   1.424175   .0727987    19.56   0.000      1.28148     1.56687
         20  |   1.465226   .0751241    19.50   0.000     1.317973     1.61248
         21  |   1.481273   .0773505    19.15   0.000     1.329656     1.63289
         22  |   1.536421   .0796536    19.29   0.000     1.380289    1.692553
         23  |   1.589221   .0819408    19.39   0.000     1.428607    1.749836
         24  |   1.618428    .084163    19.23   0.000     1.453458    1.783399
         25  |   1.608168   .0865505    18.58   0.000     1.438518    1.777819
         26  |  -.4227117   .0557594    -7.58   0.000    -.5320075   -.3134158
         27  |  -.2891866   .0532687    -5.43   0.000    -.3936003    -.184773
         28  |  -.0717625   .0510512    -1.41   0.160    -.1718296    .0283046
         29  |   .1541133   .0505288     3.05   0.002     .0550702    .2531564
         30  |   .3321294   .0493715     6.73   0.000     .2353546    .4289041
         31  |   .4775678   .0503234     9.49   0.000     .3789272    .5762083
         32  |   .6297373   .0520313    12.10   0.000      .527749    .7317256
         33  |   .7023971   .0528107    13.30   0.000     .5988813     .805913
         34  |    .835472    .054562    15.31   0.000     .7285232    .9424208
         35  |   .9256938   .0560988    16.50   0.000     .8157328    1.035655
         36  |   .9704356   .0579529    16.75   0.000     .8568403    1.084031
         37  |     1.0404   .0600909    17.31   0.000     .9226139    1.158186
         38  |   1.127886   .0622671    18.11   0.000     1.005835    1.249938
         39  |   1.183448   .0647127    18.29   0.000     1.056603    1.310294
         40  |   1.284616    .067599    19.00   0.000     1.152113    1.417119
         41  |   1.347354    .069358    19.43   0.000     1.211403    1.483305
         42  |   1.409492    .071273    19.78   0.000     1.269787    1.549196
         43  |   1.376696   .0738031    18.65   0.000     1.232032    1.521359
         44  |   1.448561   .0763289    18.98   0.000     1.298947    1.598176
         45  |   1.517054   .0787375    19.27   0.000     1.362718     1.67139
         46  |   1.529778   .0811088    18.86   0.000     1.370794    1.688762
         47  |   1.562312   .0829285    18.84   0.000     1.399761    1.724862
         48  |   1.621538   .0848533    19.11   0.000     1.455214    1.787862
         49  |   1.605885   .0878492    18.28   0.000     1.433689    1.778081
         50  |    1.63227   .0896609    18.20   0.000     1.456523    1.808017
             |
     age_cat |
          1  |   .3259158   .0255981    12.73   0.000     .2757403    .3760914
          2  |   .3754505   .0274794    13.66   0.000     .3215873    .4293137
          3  |   .3834546   .0292055    13.13   0.000      .326208    .4407012
          4  |   .3870221   .0308861    12.53   0.000     .3264812     .447563
          5  |   .3779227   .0329628    11.47   0.000     .3133112    .4425343
          6  |   .3655408    .035165    10.40   0.000     .2966128    .4344688
          7  |   .3768426   .0373164    10.10   0.000     .3036975    .4499876
          8  |   .3677849   .0397901     9.24   0.000     .2897911    .4457787
          9  |   .3574513   .0423821     8.43   0.000     .2743768    .4405258
         10  |   .3567753   .0449073     7.94   0.000      .268751    .4447995
         11  |   .3557698    .047623     7.47   0.000     .2624225    .4491171
         12  |   .3512025   .0502858     6.98   0.000     .2526357    .4497692
         13  |   .3464306   .0530236     6.53   0.000     .2424975    .4503638
         14  |   .3468404   .0558004     6.22   0.000     .2374643    .4562164
         15  |   .3483912   .0585826     5.95   0.000     .2335615    .4632208
         16  |    .337185   .0614079     5.49   0.000     .2168174    .4575526
         17  |   .3242351   .0643714     5.04   0.000     .1980586    .4504115
         18  |   .3272724   .0671581     4.87   0.000     .1956338    .4589111
         19  |   .3075134   .0702271     4.38   0.000     .1698591    .4451677
         20  |   .2810518   .0756434     3.72   0.000     .1327808    .4293228
         25  |   .2456247   .0849791     2.89   0.004     .0790546    .4121949
         30  |   .2184485    .111033     1.97   0.049     .0008093    .4360877
         40  |   .2415331   .1259995     1.92   0.055    -.0054425    .4885087
         50  |   .2723595   .1378774     1.98   0.048     .0021016    .5426174
             |
       _cons |   7.632135   .0451044   169.21   0.000     7.543725    7.720546
-------------+----------------------------------------------------------------
     sigma_u |   1.206272
     sigma_e |   .5688164
         rho |   .8180906   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1840837631079206

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    382,405
Group variable: firm_person                     Number of groups  =     40,681

R-sq:                                           Obs per group:
     within  = 0.1841                                         min =          1
     between = 0.1451                                         avg =        9.4
     overall = 0.1315                                         max =         25

                                                F(78,14145)       =     100.19
corr(u_i, Xb)  = 0.0762                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,146 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0673855   .0230837     2.92   0.004     .0221383    .1126326
      during |   .0244747   .0071572     3.42   0.001     .0104456    .0385037
       after |   .0477194   .0125383     3.81   0.000     .0231427    .0722961
during_expat |   .0534132   .0143849     3.71   0.000      .025217    .0816094
 after_expat |    .069015   .0194623     3.55   0.000     .0308662    .1071637
             |
    ind_year |
          2  |   .0681273   .0252123     2.70   0.007     .0187078    .1175469
          3  |   .2287367   .0323648     7.07   0.000     .1652974    .2921759
          4  |    .394273    .034728    11.35   0.000     .3262015    .4623446
          5  |   .5453454   .0375561    14.52   0.000     .4717306    .6189602
          6  |     .70555   .0408092    17.29   0.000     .6255586    .7855415
          7  |   .8472099   .0426805    19.85   0.000     .7635505    .9308693
          8  |   .9280022   .0446658    20.78   0.000     .8404513    1.015553
          9  |   1.035657   .0468895    22.09   0.000     .9437478    1.127567
         10  |   1.147774   .0492787    23.29   0.000     1.051181    1.244366
         11  |   1.210245   .0519166    23.31   0.000     1.108481    1.312008
         12  |   1.233179   .0545422    22.61   0.000     1.126269    1.340089
         13  |   1.286673   .0573063    22.45   0.000     1.174345    1.399001
         14  |   1.324233   .0597416    22.17   0.000     1.207132    1.441334
         15  |   1.384804   .0625587    22.14   0.000      1.26218    1.507427
         16  |   1.409318   .0648086    21.75   0.000     1.282285    1.536352
         17  |   1.456504   .0675444    21.56   0.000     1.324108      1.5889
         18  |   1.395107   .0701591    19.88   0.000     1.257586    1.532629
         19  |   1.424175   .0727987    19.56   0.000      1.28148     1.56687
         20  |   1.465226   .0751241    19.50   0.000     1.317973     1.61248
         21  |   1.481273   .0773505    19.15   0.000     1.329656     1.63289
         22  |   1.536421   .0796536    19.29   0.000     1.380289    1.692553
         23  |   1.589221   .0819408    19.39   0.000     1.428607    1.749836
         24  |   1.618428    .084163    19.23   0.000     1.453458    1.783399
         25  |   1.608168   .0865505    18.58   0.000     1.438518    1.777819
         26  |  -.4227117   .0557594    -7.58   0.000    -.5320075   -.3134158
         27  |  -.2891866   .0532687    -5.43   0.000    -.3936003    -.184773
         28  |  -.0717625   .0510512    -1.41   0.160    -.1718296    .0283046
         29  |   .1541133   .0505288     3.05   0.002     .0550702    .2531564
         30  |   .3321294   .0493715     6.73   0.000     .2353546    .4289041
         31  |   .4775678   .0503234     9.49   0.000     .3789272    .5762083
         32  |   .6297373   .0520313    12.10   0.000      .527749    .7317256
         33  |   .7023971   .0528107    13.30   0.000     .5988813     .805913
         34  |    .835472    .054562    15.31   0.000     .7285232    .9424208
         35  |   .9256938   .0560988    16.50   0.000     .8157328    1.035655
         36  |   .9704356   .0579529    16.75   0.000     .8568403    1.084031
         37  |     1.0404   .0600909    17.31   0.000     .9226139    1.158186
         38  |   1.127886   .0622671    18.11   0.000     1.005835    1.249938
         39  |   1.183448   .0647127    18.29   0.000     1.056603    1.310294
         40  |   1.284616    .067599    19.00   0.000     1.152113    1.417119
         41  |   1.347354    .069358    19.43   0.000     1.211403    1.483305
         42  |   1.409492    .071273    19.78   0.000     1.269787    1.549196
         43  |   1.376696   .0738031    18.65   0.000     1.232032    1.521359
         44  |   1.448561   .0763289    18.98   0.000     1.298947    1.598176
         45  |   1.517054   .0787375    19.27   0.000     1.362718     1.67139
         46  |   1.529778   .0811088    18.86   0.000     1.370794    1.688762
         47  |   1.562312   .0829285    18.84   0.000     1.399761    1.724862
         48  |   1.621538   .0848533    19.11   0.000     1.455214    1.787862
         49  |   1.605885   .0878492    18.28   0.000     1.433689    1.778081
         50  |    1.63227   .0896609    18.20   0.000     1.456523    1.808017
             |
     age_cat |
          1  |   .3259158   .0255981    12.73   0.000     .2757403    .3760914
          2  |   .3754505   .0274794    13.66   0.000     .3215873    .4293137
          3  |   .3834546   .0292055    13.13   0.000      .326208    .4407012
          4  |   .3870221   .0308861    12.53   0.000     .3264812     .447563
          5  |   .3779227   .0329628    11.47   0.000     .3133112    .4425343
          6  |   .3655408    .035165    10.40   0.000     .2966128    .4344688
          7  |   .3768426   .0373164    10.10   0.000     .3036975    .4499876
          8  |   .3677849   .0397901     9.24   0.000     .2897911    .4457787
          9  |   .3574513   .0423821     8.43   0.000     .2743768    .4405258
         10  |   .3567753   .0449073     7.94   0.000      .268751    .4447995
         11  |   .3557698    .047623     7.47   0.000     .2624225    .4491171
         12  |   .3512025   .0502858     6.98   0.000     .2526357    .4497692
         13  |   .3464306   .0530236     6.53   0.000     .2424975    .4503638
         14  |   .3468404   .0558004     6.22   0.000     .2374643    .4562164
         15  |   .3483912   .0585826     5.95   0.000     .2335615    .4632208
         16  |    .337185   .0614079     5.49   0.000     .2168174    .4575526
         17  |   .3242351   .0643714     5.04   0.000     .1980586    .4504115
         18  |   .3272724   .0671581     4.87   0.000     .1956338    .4589111
         19  |   .3075134   .0702271     4.38   0.000     .1698591    .4451677
         20  |   .2810518   .0756434     3.72   0.000     .1327808    .4293228
         25  |   .2456247   .0849791     2.89   0.004     .0790546    .4121949
         30  |   .2184485    .111033     1.97   0.049     .0008093    .4360877
         40  |   .2415331   .1259995     1.92   0.055    -.0054425    .4885087
         50  |   .2723595   .1378774     1.98   0.048     .0021016    .5426174
             |
       _cons |   7.632135   .0451044   169.21   0.000     7.543725    7.720546
-------------+----------------------------------------------------------------
     sigma_u |   1.206272
     sigma_e |   .5688164
         rho |   .8180906   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1, 14145) =   11.69
            Prob > F =    0.0006

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14145) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1, 14145) =    6.94
            Prob > F =    0.0084

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14145) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1, 14145) =   13.79
            Prob > F =    0.0002

 ( 1)  during_expat = 0

       F(  1, 14145) =   13.79
            Prob > F =    0.0002
variable label was str12 now str14
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1, 14145) =    1.33
            Prob > F =    0.2492

 ( 1)  after_expat = 0

       F(  1, 14145) =   12.57
            Prob > F =    0.0004
(1 real change made)
(file output/figure/baseline_lnQL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    127139
Group variable: firm_person                     Number of groups   =     14598

R-sq:  within  = 0.2837                         Obs per group: min =         1
       between = 0.2501                                        avg =       8.7
       overall = 0.2297                                        max =        25

                                                F(53,5219)         =     84.16
corr(u_i, Xb)  = 0.1406                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,220 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .053312   .0298533     1.79   0.074     -.005213     .111837
      during |  -.0069534   .0114137    -0.61   0.542    -.0293289    .0154222
       after |   .0340284   .0198937     1.71   0.087    -.0049716    .0730285
during_expat |   .1189492   .0186701     6.37   0.000      .082348    .1555505
 after_expat |   .1686177   .0259112     6.51   0.000      .117821    .2194145
             |
    ind_year |
         27  |   .1311026   .0308508     4.25   0.000     .0706221    .1915831
         28  |   .3265335    .034233     9.54   0.000     .2594224    .3936446
         29  |   .5338343   .0417458    12.79   0.000      .451995    .6156735
         30  |   .6852083   .0431768    15.87   0.000     .6005637    .7698529
         31  |   .8190627   .0476311    17.20   0.000     .7256858    .9124396
         32  |   .9548574   .0519051    18.40   0.000     .8531016    1.056613
         33  |   1.009084   .0553097    18.24   0.000     .9006543    1.117515
         34  |   1.141407   .0595287    19.17   0.000     1.024706    1.258109
         35  |   1.220484    .063741    19.15   0.000     1.095525    1.345443
         36  |   1.243588   .0674718    18.43   0.000     1.111315    1.375861
         37  |   1.299948   .0718157    18.10   0.000     1.159159    1.440737
         38  |   1.382034   .0762035    18.14   0.000     1.232644    1.531425
         39  |   1.423649   .0807026    17.64   0.000     1.265438     1.58186
         40  |   1.516428    .085948    17.64   0.000     1.347934    1.684922
         41  |   1.567241   .0895059    17.51   0.000     1.391772     1.74271
         42  |   1.616604   .0932604    17.33   0.000     1.433774    1.799433
         43  |    1.56351   .0973654    16.06   0.000     1.372633    1.754387
         44  |   1.626272   .1016207    16.00   0.000     1.427053    1.825491
         45  |    1.69272   .1056945    16.02   0.000     1.485515    1.899926
         46  |   1.693474   .1095756    15.45   0.000      1.47866    1.908288
         47  |   1.722876   .1126308    15.30   0.000     1.502073     1.94368
         48  |   1.779875    .115641    15.39   0.000      1.55317     2.00658
         49  |   1.756136   .1201284    14.62   0.000     1.520634    1.991638
         50  |    1.77522   .1228848    14.45   0.000     1.534314    2.016125
             |
     age_cat |
          1  |   .3146715   .0462875     6.80   0.000     .2239286    .4054144
          2  |   .4180979   .0493185     8.48   0.000      .321413    .5147828
          3  |   .4227584   .0529446     7.98   0.000     .3189648     .526552
          4  |   .4617351   .0551963     8.37   0.000     .3535272     .569943
          5  |   .4703179   .0581103     8.09   0.000     .3563973    .5842384
          6  |   .4820969   .0610476     7.90   0.000     .3624181    .6017757
          7  |   .4964768   .0643657     7.71   0.000     .3702931    .6226604
          8  |   .5084757   .0677966     7.50   0.000      .375566    .6413853
          9  |    .510974   .0713006     7.17   0.000      .371195    .6507531
         10  |   .5236176   .0750632     6.98   0.000     .3764624    .6707728
         11  |   .5229207   .0786139     6.65   0.000     .3688046    .6770369
         12  |   .5252328   .0824415     6.37   0.000     .3636129    .6868527
         13  |   .5366412   .0863835     6.21   0.000     .3672934    .7059891
         14  |   .5266094   .0903384     5.83   0.000     .3495083    .7037105
         15  |   .5342588   .0943147     5.66   0.000     .3493625    .7191552
         16  |   .5539445   .0982525     5.64   0.000     .3613285    .7465605
         17  |    .551418   .1022861     5.39   0.000     .3508945    .7519415
         18  |   .5739801   .1064816     5.39   0.000     .3652315    .7827287
         19  |    .569444   .1102444     5.17   0.000     .3533188    .7855693
         20  |    .561733   .1184994     4.74   0.000     .3294247    .7940414
         25  |   .5565311   .1315021     4.23   0.000     .2987319    .8143302
         30  |   .4326366   .1669939     2.59   0.010     .1052587    .7600145
         40  |   .4088462   .1916611     2.13   0.033     .0331103    .7845821
         50  |   .3415934   .2066049     1.65   0.098    -.0634388    .7466256
             |
       _cons |   7.132712   .0550861   129.48   0.000      7.02472    7.240703
-------------+----------------------------------------------------------------
     sigma_u |  1.0709858
     sigma_e |  .48576138
         rho |  .82937928   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2837437318460331

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    127,139
Group variable: firm_person                     Number of groups  =     14,598

R-sq:                                           Obs per group:
     within  = 0.2837                                         min =          1
     between = 0.2501                                         avg =        8.7
     overall = 0.2297                                         max =         25

                                                F(53,5219)        =      84.16
corr(u_i, Xb)  = 0.1406                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,220 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .053312   .0298533     1.79   0.074     -.005213     .111837
      during |  -.0069534   .0114137    -0.61   0.542    -.0293289    .0154222
       after |   .0340284   .0198937     1.71   0.087    -.0049716    .0730285
during_expat |   .1189492   .0186701     6.37   0.000      .082348    .1555505
 after_expat |   .1686177   .0259112     6.51   0.000      .117821    .2194145
             |
    ind_year |
         27  |   .1311026   .0308508     4.25   0.000     .0706221    .1915831
         28  |   .3265335    .034233     9.54   0.000     .2594224    .3936446
         29  |   .5338343   .0417458    12.79   0.000      .451995    .6156735
         30  |   .6852083   .0431768    15.87   0.000     .6005637    .7698529
         31  |   .8190627   .0476311    17.20   0.000     .7256858    .9124396
         32  |   .9548574   .0519051    18.40   0.000     .8531016    1.056613
         33  |   1.009084   .0553097    18.24   0.000     .9006543    1.117515
         34  |   1.141407   .0595287    19.17   0.000     1.024706    1.258109
         35  |   1.220484    .063741    19.15   0.000     1.095525    1.345443
         36  |   1.243588   .0674718    18.43   0.000     1.111315    1.375861
         37  |   1.299948   .0718157    18.10   0.000     1.159159    1.440737
         38  |   1.382034   .0762035    18.14   0.000     1.232644    1.531425
         39  |   1.423649   .0807026    17.64   0.000     1.265438     1.58186
         40  |   1.516428    .085948    17.64   0.000     1.347934    1.684922
         41  |   1.567241   .0895059    17.51   0.000     1.391772     1.74271
         42  |   1.616604   .0932604    17.33   0.000     1.433774    1.799433
         43  |    1.56351   .0973654    16.06   0.000     1.372633    1.754387
         44  |   1.626272   .1016207    16.00   0.000     1.427053    1.825491
         45  |    1.69272   .1056945    16.02   0.000     1.485515    1.899926
         46  |   1.693474   .1095756    15.45   0.000      1.47866    1.908288
         47  |   1.722876   .1126308    15.30   0.000     1.502073     1.94368
         48  |   1.779875    .115641    15.39   0.000      1.55317     2.00658
         49  |   1.756136   .1201284    14.62   0.000     1.520634    1.991638
         50  |    1.77522   .1228848    14.45   0.000     1.534314    2.016125
             |
     age_cat |
          1  |   .3146715   .0462875     6.80   0.000     .2239286    .4054144
          2  |   .4180979   .0493185     8.48   0.000      .321413    .5147828
          3  |   .4227584   .0529446     7.98   0.000     .3189648     .526552
          4  |   .4617351   .0551963     8.37   0.000     .3535272     .569943
          5  |   .4703179   .0581103     8.09   0.000     .3563973    .5842384
          6  |   .4820969   .0610476     7.90   0.000     .3624181    .6017757
          7  |   .4964768   .0643657     7.71   0.000     .3702931    .6226604
          8  |   .5084757   .0677966     7.50   0.000      .375566    .6413853
          9  |    .510974   .0713006     7.17   0.000      .371195    .6507531
         10  |   .5236176   .0750632     6.98   0.000     .3764624    .6707728
         11  |   .5229207   .0786139     6.65   0.000     .3688046    .6770369
         12  |   .5252328   .0824415     6.37   0.000     .3636129    .6868527
         13  |   .5366412   .0863835     6.21   0.000     .3672934    .7059891
         14  |   .5266094   .0903384     5.83   0.000     .3495083    .7037105
         15  |   .5342588   .0943147     5.66   0.000     .3493625    .7191552
         16  |   .5539445   .0982525     5.64   0.000     .3613285    .7465605
         17  |    .551418   .1022861     5.39   0.000     .3508945    .7519415
         18  |   .5739801   .1064816     5.39   0.000     .3652315    .7827287
         19  |    .569444   .1102444     5.17   0.000     .3533188    .7855693
         20  |    .561733   .1184994     4.74   0.000     .3294247    .7940414
         25  |   .5565311   .1315021     4.23   0.000     .2987319    .8143302
         30  |   .4326366   .1669939     2.59   0.010     .1052587    .7600145
         40  |   .4088462   .1916611     2.13   0.033     .0331103    .7845821
         50  |   .3415934   .2066049     1.65   0.098    -.0634388    .7466256
             |
       _cons |   7.132712   .0550861   129.48   0.000      7.02472    7.240703
-------------+----------------------------------------------------------------
     sigma_u |  1.0709858
     sigma_e |  .48576138
         rho |  .82937928   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1,  5219) =    0.37
            Prob > F =    0.5424

 ( 1) = 0
       Constraint 1 dropped

       F(  0,  5219) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1,  5219) =    8.58
            Prob > F =    0.0034

 ( 1) = 0
       Constraint 1 dropped

       F(  0,  5219) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1,  5219) =   40.59
            Prob > F =    0.0000

 ( 1)  during_expat = 0

       F(  1,  5219) =   40.59
            Prob > F =    0.0000
variable label was str12 now str14
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1,  5219) =    6.78
            Prob > F =    0.0093

 ( 1)  after_expat = 0

       F(  1,  5219) =   42.35
            Prob > F =    0.0000
(1 real change made)
(file output/figure/manufacturing_lnQL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    265452
Group variable: firm_person                     Number of groups   =     28209

R-sq:  within  = 0.1759                         Obs per group: min =         1
       between = 0.1312                                        avg =       9.4
       overall = 0.1216                                        max =        25

                                                F(78,10918)        =     73.03
corr(u_i, Xb)  = 0.0570                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0938741    .029454     3.19   0.001     .0361388    .1516093
      during |     .03581    .008026     4.46   0.000     .0200776    .0515425
       after |   .0646656   .0141965     4.56   0.000     .0368379    .0924932
during_expat |    .126193   .0344618     3.66   0.000     .0586416    .1937444
 after_expat |   .1904323   .0405842     4.69   0.000     .1108799    .2699848
             |
    ind_year |
          2  |   .0633601   .0285048     2.22   0.026     .0074856    .1192346
          3  |   .2283886   .0362704     6.30   0.000     .1572921    .2994852
          4  |   .4076169   .0383611    10.63   0.000     .3324223    .4828116
          5  |   .5370623   .0418045    12.85   0.000     .4551178    .6190067
          6  |   .6956218   .0455206    15.28   0.000     .6063931    .7848505
          7  |   .8327508   .0475665    17.51   0.000     .7395119    .9259897
          8  |   .9183231   .0496911    18.48   0.000     .8209196    1.015727
          9  |   1.033878   .0520587    19.86   0.000     .9318331    1.135922
         10  |   1.154303   .0545816    21.15   0.000     1.047313    1.261293
         11  |   1.213906    .057385    21.15   0.000     1.101421    1.326391
         12  |   1.235654   .0601639    20.54   0.000     1.117722    1.353587
         13  |   1.282315   .0631861    20.29   0.000     1.158459    1.406171
         14  |    1.31783   .0657452    20.04   0.000     1.188957    1.446702
         15  |   1.386122   .0688202    20.14   0.000     1.251222    1.521022
         16  |   1.415048     .07108    19.91   0.000     1.275718    1.554378
         17  |   1.468213   .0739051    19.87   0.000     1.323346    1.613081
         18  |    1.40149   .0765988    18.30   0.000     1.251343    1.551638
         19  |   1.429759   .0792988    18.03   0.000     1.274319    1.585199
         20  |   1.469317   .0815895    18.01   0.000     1.309387    1.629248
         21  |   1.489097   .0839865    17.73   0.000     1.324468    1.653725
         22  |   1.548286   .0863434    17.93   0.000     1.379038    1.717535
         23  |   1.595503   .0885735    18.01   0.000     1.421883    1.769123
         24  |    1.63044   .0908998    17.94   0.000      1.45226    1.808621
         25  |     1.6225   .0932865    17.39   0.000     1.439642    1.805359
         26  |  -.3848057   .0619679    -6.21   0.000     -.506274   -.2633374
         27  |  -.2335017   .0605279    -3.86   0.000    -.3521473   -.1148561
         28  |  -.0523068   .0588054    -0.89   0.374     -.167576    .0629623
         29  |   .1639123   .0575115     2.85   0.004     .0511794    .2766453
         30  |   .3512177   .0564844     6.22   0.000     .2404981    .4619374
         31  |   .4817199   .0575865     8.37   0.000     .3688398    .5945999
         32  |   .6426006   .0590331    10.89   0.000      .526885    .7583162
         33  |   .7025127   .0598888    11.73   0.000     .5851198    .8199055
         34  |   .8347123   .0616847    13.53   0.000     .7137991    .9556255
         35  |   .9256021   .0634395    14.59   0.000     .8012492    1.049955
         36  |   .9741772   .0651878    14.94   0.000     .8463973    1.101957
         37  |   1.034199   .0674524    15.33   0.000     .9019799    1.166418
         38  |    1.13087   .0695357    16.26   0.000      .994567    1.267172
         39  |   1.168778   .0720079    16.23   0.000     1.027629    1.309926
         40  |   1.263845   .0751055    16.83   0.000     1.116625    1.411065
         41  |   1.341595   .0765619    17.52   0.000     1.191519     1.49167
         42  |   1.406894    .078542    17.91   0.000     1.252938    1.560851
         43  |    1.37452    .081232    16.92   0.000     1.215291     1.53375
         44  |   1.426617   .0838703    17.01   0.000     1.262216    1.591018
         45  |   1.506962   .0861377    17.49   0.000     1.338116    1.675807
         46  |   1.511315   .0889227    17.00   0.000      1.33701     1.68562
         47  |    1.53503   .0905039    16.96   0.000     1.357626    1.712434
         48  |   1.593673   .0925056    17.23   0.000     1.412345    1.775001
         49  |   1.585608   .0958935    16.54   0.000     1.397639    1.773576
         50  |   1.604901   .0975495    16.45   0.000     1.413686    1.796115
             |
     age_cat |
          1  |   .3044358   .0272748    11.16   0.000     .2509723    .3578994
          2  |   .3102078   .0298561    10.39   0.000     .2516844    .3687312
          3  |   .3004909   .0319655     9.40   0.000     .2378327    .3631491
          4  |   .2969888    .033937     8.75   0.000     .2304662    .3635115
          5  |   .2864136   .0362354     7.90   0.000     .2153857    .3574415
          6  |   .2647265   .0386151     6.86   0.000     .1890339    .3404192
          7  |   .2809443   .0408896     6.87   0.000     .2007933    .3610952
          8  |   .2776819   .0435811     6.37   0.000      .192255    .3631088
          9  |   .2660895   .0463474     5.74   0.000     .1752402    .3569388
         10  |   .2616912   .0490166     5.34   0.000     .1656099    .3577726
         11  |   .2603724   .0519569     5.01   0.000     .1585275    .3622172
         12  |   .2674664   .0547897     4.88   0.000     .1600687    .3748642
         13  |   .2584634   .0576804     4.48   0.000     .1453993    .3715275
         14  |   .2594314   .0605967     4.28   0.000     .1406508    .3782119
         15  |   .2601094   .0635047     4.10   0.000     .1356287    .3845901
         16  |   .2485366   .0664589     3.74   0.000     .1182652     .378808
         17  |   .2327568   .0695846     3.34   0.001     .0963584    .3691551
         18  |   .2342508   .0725184     3.23   0.001     .0921015    .3764001
         19  |   .2171745   .0757359     2.87   0.004     .0687183    .3656306
         20  |   .1869487   .0814177     2.30   0.022     .0273553     .346542
         25  |   .1506076    .091474     1.65   0.100     -.028698    .3299132
         30  |   .1193504   .1187608     1.00   0.315    -.1134423    .3521432
         40  |   .1476876   .1339391     1.10   0.270    -.1148573    .4102325
         50  |   .1711894     .14651     1.17   0.243    -.1159968    .4583756
             |
       _cons |   7.579635   .0490135   154.64   0.000     7.483559     7.67571
-------------+----------------------------------------------------------------
     sigma_u |  1.1533629
     sigma_e |  .57052035
         rho |  .80341504   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1758973921178156

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    265,452
Group variable: firm_person                     Number of groups  =     28,209

R-sq:                                           Obs per group:
     within  = 0.1759                                         min =          1
     between = 0.1312                                         avg =        9.4
     overall = 0.1216                                         max =         25

                                                F(78,10918)       =      73.03
corr(u_i, Xb)  = 0.0570                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0938741    .029454     3.19   0.001     .0361388    .1516093
      during |     .03581    .008026     4.46   0.000     .0200776    .0515425
       after |   .0646656   .0141965     4.56   0.000     .0368379    .0924932
during_expat |    .126193   .0344618     3.66   0.000     .0586416    .1937444
 after_expat |   .1904323   .0405842     4.69   0.000     .1108799    .2699848
             |
    ind_year |
          2  |   .0633601   .0285048     2.22   0.026     .0074856    .1192346
          3  |   .2283886   .0362704     6.30   0.000     .1572921    .2994852
          4  |   .4076169   .0383611    10.63   0.000     .3324223    .4828116
          5  |   .5370623   .0418045    12.85   0.000     .4551178    .6190067
          6  |   .6956218   .0455206    15.28   0.000     .6063931    .7848505
          7  |   .8327508   .0475665    17.51   0.000     .7395119    .9259897
          8  |   .9183231   .0496911    18.48   0.000     .8209196    1.015727
          9  |   1.033878   .0520587    19.86   0.000     .9318331    1.135922
         10  |   1.154303   .0545816    21.15   0.000     1.047313    1.261293
         11  |   1.213906    .057385    21.15   0.000     1.101421    1.326391
         12  |   1.235654   .0601639    20.54   0.000     1.117722    1.353587
         13  |   1.282315   .0631861    20.29   0.000     1.158459    1.406171
         14  |    1.31783   .0657452    20.04   0.000     1.188957    1.446702
         15  |   1.386122   .0688202    20.14   0.000     1.251222    1.521022
         16  |   1.415048     .07108    19.91   0.000     1.275718    1.554378
         17  |   1.468213   .0739051    19.87   0.000     1.323346    1.613081
         18  |    1.40149   .0765988    18.30   0.000     1.251343    1.551638
         19  |   1.429759   .0792988    18.03   0.000     1.274319    1.585199
         20  |   1.469317   .0815895    18.01   0.000     1.309387    1.629248
         21  |   1.489097   .0839865    17.73   0.000     1.324468    1.653725
         22  |   1.548286   .0863434    17.93   0.000     1.379038    1.717535
         23  |   1.595503   .0885735    18.01   0.000     1.421883    1.769123
         24  |    1.63044   .0908998    17.94   0.000      1.45226    1.808621
         25  |     1.6225   .0932865    17.39   0.000     1.439642    1.805359
         26  |  -.3848057   .0619679    -6.21   0.000     -.506274   -.2633374
         27  |  -.2335017   .0605279    -3.86   0.000    -.3521473   -.1148561
         28  |  -.0523068   .0588054    -0.89   0.374     -.167576    .0629623
         29  |   .1639123   .0575115     2.85   0.004     .0511794    .2766453
         30  |   .3512177   .0564844     6.22   0.000     .2404981    .4619374
         31  |   .4817199   .0575865     8.37   0.000     .3688398    .5945999
         32  |   .6426006   .0590331    10.89   0.000      .526885    .7583162
         33  |   .7025127   .0598888    11.73   0.000     .5851198    .8199055
         34  |   .8347123   .0616847    13.53   0.000     .7137991    .9556255
         35  |   .9256021   .0634395    14.59   0.000     .8012492    1.049955
         36  |   .9741772   .0651878    14.94   0.000     .8463973    1.101957
         37  |   1.034199   .0674524    15.33   0.000     .9019799    1.166418
         38  |    1.13087   .0695357    16.26   0.000      .994567    1.267172
         39  |   1.168778   .0720079    16.23   0.000     1.027629    1.309926
         40  |   1.263845   .0751055    16.83   0.000     1.116625    1.411065
         41  |   1.341595   .0765619    17.52   0.000     1.191519     1.49167
         42  |   1.406894    .078542    17.91   0.000     1.252938    1.560851
         43  |    1.37452    .081232    16.92   0.000     1.215291     1.53375
         44  |   1.426617   .0838703    17.01   0.000     1.262216    1.591018
         45  |   1.506962   .0861377    17.49   0.000     1.338116    1.675807
         46  |   1.511315   .0889227    17.00   0.000      1.33701     1.68562
         47  |    1.53503   .0905039    16.96   0.000     1.357626    1.712434
         48  |   1.593673   .0925056    17.23   0.000     1.412345    1.775001
         49  |   1.585608   .0958935    16.54   0.000     1.397639    1.773576
         50  |   1.604901   .0975495    16.45   0.000     1.413686    1.796115
             |
     age_cat |
          1  |   .3044358   .0272748    11.16   0.000     .2509723    .3578994
          2  |   .3102078   .0298561    10.39   0.000     .2516844    .3687312
          3  |   .3004909   .0319655     9.40   0.000     .2378327    .3631491
          4  |   .2969888    .033937     8.75   0.000     .2304662    .3635115
          5  |   .2864136   .0362354     7.90   0.000     .2153857    .3574415
          6  |   .2647265   .0386151     6.86   0.000     .1890339    .3404192
          7  |   .2809443   .0408896     6.87   0.000     .2007933    .3610952
          8  |   .2776819   .0435811     6.37   0.000      .192255    .3631088
          9  |   .2660895   .0463474     5.74   0.000     .1752402    .3569388
         10  |   .2616912   .0490166     5.34   0.000     .1656099    .3577726
         11  |   .2603724   .0519569     5.01   0.000     .1585275    .3622172
         12  |   .2674664   .0547897     4.88   0.000     .1600687    .3748642
         13  |   .2584634   .0576804     4.48   0.000     .1453993    .3715275
         14  |   .2594314   .0605967     4.28   0.000     .1406508    .3782119
         15  |   .2601094   .0635047     4.10   0.000     .1356287    .3845901
         16  |   .2485366   .0664589     3.74   0.000     .1182652     .378808
         17  |   .2327568   .0695846     3.34   0.001     .0963584    .3691551
         18  |   .2342508   .0725184     3.23   0.001     .0921015    .3764001
         19  |   .2171745   .0757359     2.87   0.004     .0687183    .3656306
         20  |   .1869487   .0814177     2.30   0.022     .0273553     .346542
         25  |   .1506076    .091474     1.65   0.100     -.028698    .3299132
         30  |   .1193504   .1187608     1.00   0.315    -.1134423    .3521432
         40  |   .1476876   .1339391     1.10   0.270    -.1148573    .4102325
         50  |   .1711894     .14651     1.17   0.243    -.1159968    .4583756
             |
       _cons |   7.579635   .0490135   154.64   0.000     7.483559     7.67571
-------------+----------------------------------------------------------------
     sigma_u |  1.1533629
     sigma_e |  .57052035
         rho |  .80341504   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1, 10918) =   19.91
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1, 10918) =    8.30
            Prob > F =    0.0040

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1, 10918) =   13.41
            Prob > F =    0.0003

 ( 1)  during_expat = 0

       F(  1, 10918) =   13.41
            Prob > F =    0.0003
variable label was str12 now str14
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1, 10918) =    4.95
            Prob > F =    0.0261

 ( 1)  after_expat = 0

       F(  1, 10918) =   22.02
            Prob > F =    0.0000
(1 real change made)
(file output/figure/acquisitions_lnQL_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    265452
Group variable: firm_person                     Number of groups   =     28209

R-sq:  within  = 0.1755                         Obs per group: min =         1
       between = 0.1289                                        avg =       9.4
       overall = 0.1198                                        max =        25

                                                F(82,10918)        =     68.19
corr(u_i, Xb)  = 0.0488                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0945027    .029482     3.21   0.001     .0367126    .1522928
   during_DD |   .0264757   .0082443     3.21   0.001     .0103155    .0426359
   during_DE |   .1380296   .0541809     2.55   0.011     .0318252    .2442339
   during_ED |   .0024989   .0205501     0.12   0.903    -.0377831     .042781
   during_EE |   .1524561   .0490616     3.11   0.002     .0562864    .2486258
    after_DD |    .033159   .0151906     2.18   0.029     .0033827    .0629352
    after_DE |   .2484841   .0561229     4.43   0.000      .138473    .3584952
    after_ED |   .0587687   .0338779     1.73   0.083    -.0076381    .1251756
    after_EE |   .2087984   .0587147     3.56   0.000     .0937069    .3238899
             |
    ind_year |
          2  |   .0665953   .0285814     2.33   0.020     .0105706      .12262
          3  |   .2338922   .0364175     6.42   0.000     .1625074     .305277
          4  |   .4144953    .038571    10.75   0.000     .3388892    .4901014
          5  |   .5451443   .0421115    12.95   0.000     .4625981    .6276905
          6  |   .7050669   .0458087    15.39   0.000     .6152735    .7948603
          7  |   .8435996    .047894    17.61   0.000     .7497188    .9374805
          8  |    .930432   .0500699    18.58   0.000      .832286    1.028578
          9  |   1.047533   .0525332    19.94   0.000     .9445584    1.150508
         10  |   1.169158   .0550352    21.24   0.000     1.061279    1.277037
         11  |   1.230053   .0577928    21.28   0.000     1.116768    1.343337
         12  |   1.252883   .0605201    20.70   0.000     1.134253    1.371513
         13  |    1.30128   .0634918    20.50   0.000     1.176824    1.425736
         14  |   1.338459   .0660035    20.28   0.000      1.20908    1.467838
         15  |   1.408136    .069028    20.40   0.000     1.272829    1.543444
         16  |   1.438526   .0712119    20.20   0.000     1.298938    1.578115
         17  |   1.494021   .0739582    20.20   0.000      1.34905    1.638993
         18  |   1.428834   .0766254    18.65   0.000     1.278634    1.579034
         19  |   1.458915   .0792184    18.42   0.000     1.303633    1.614198
         20  |   1.500259   .0814748    18.41   0.000     1.340553    1.659964
         21  |   1.521565   .0837994    18.16   0.000     1.357303    1.685827
         22  |    1.58243   .0861147    18.38   0.000     1.413629     1.75123
         23  |   1.631021   .0882858    18.47   0.000     1.457965    1.804078
         24  |   1.667903   .0906027    18.41   0.000     1.490305    1.845501
         25  |   1.662223   .0929318    17.89   0.000      1.48006    1.844386
         26  |  -.3859025   .0620446    -6.22   0.000    -.5075212   -.2642837
         27  |  -.2311793   .0605877    -3.82   0.000    -.3499423   -.1124164
         28  |  -.0473287   .0589223    -0.80   0.422    -.1628271    .0681697
         29  |   .1708582   .0576827     2.96   0.003     .0577897    .2839267
         30  |   .3593188   .0566986     6.34   0.000     .2481793    .4704583
         31  |   .4913467   .0578381     8.50   0.000     .3779735    .6047199
         32  |   .6539174   .0593181    11.02   0.000     .5376432    .7701916
         33  |   .7145768   .0602648    11.86   0.000     .5964468    .8327067
         34  |    .848232   .0620792    13.66   0.000     .7265454    .9699186
         35  |   .9400508   .0638988    14.71   0.000     .8147976    1.065304
         36  |   .9898698   .0656508    15.08   0.000     .8611823    1.118557
         37  |   1.051011   .0679413    15.47   0.000     .9178334    1.184188
         38  |   1.149542   .0699837    16.43   0.000     1.012361    1.286723
         39  |   1.189295   .0724153    16.42   0.000     1.047348    1.331242
         40  |   1.286033   .0754668    17.04   0.000     1.138104    1.433961
         41  |    1.36514   .0768821    17.76   0.000     1.214437    1.515843
         42  |   1.432459   .0787882    18.18   0.000      1.27802    1.586898
         43  |   1.401522   .0814479    17.21   0.000     1.241869    1.561175
         44  |   1.455036   .0840514    17.31   0.000      1.29028    1.619792
         45  |   1.536969   .0862691    17.82   0.000     1.367865    1.706072
         46  |   1.542827   .0889922    17.34   0.000     1.368386    1.717268
         47  |   1.567895   .0905017    17.32   0.000     1.390495    1.745295
         48  |   1.627992   .0924577    17.61   0.000     1.446759    1.809226
         49  |   1.621927   .0958382    16.92   0.000     1.434067    1.809788
         50  |   1.642881   .0974289    16.86   0.000     1.451903    1.833859
             |
     age_cat |
          1  |   .3069192   .0272891    11.25   0.000     .2534276    .3604108
          2  |    .315725   .0298663    10.57   0.000     .2571816    .3742684
          3  |   .3079323    .032026     9.62   0.000     .2451554    .3707092
          4  |   .3054831   .0340289     8.98   0.000     .2387802     .372186
          5  |   .2956239   .0363702     8.13   0.000     .2243318    .3669161
          6  |   .2744194   .0387614     7.08   0.000     .1984401    .3503987
          7  |   .2907256   .0410766     7.08   0.000      .210208    .3712433
          8  |   .2874925   .0437904     6.57   0.000     .2016553    .3733296
          9  |   .2759948   .0465918     5.92   0.000     .1846664    .3673232
         10  |   .2716246   .0492821     5.51   0.000     .1750228    .3682264
         11  |   .2700427   .0522175     5.17   0.000     .1676869    .3723985
         12  |   .2767855   .0550768     5.03   0.000     .1688251    .3847459
         13  |   .2673455   .0580013     4.61   0.000     .1536525    .3810385
         14  |   .2678003    .060938     4.39   0.000     .1483508    .3872497
         15  |   .2679307   .0638702     4.19   0.000     .1427335    .3931279
         16  |   .2559234   .0668401     3.83   0.000     .1249047    .3869422
         17  |   .2395548   .0699786     3.42   0.001     .1023841    .3767255
         18  |   .2403334   .0729284     3.30   0.001     .0973805    .3832864
         19  |   .2225076   .0761617     2.92   0.003     .0732169    .3717984
         20  |   .1907022    .081873     2.33   0.020     .0302163    .3511882
         25  |   .1517631   .0919427     1.65   0.099    -.0284613    .3319875
         30  |    .118973   .1192075     1.00   0.318    -.1146953    .3526413
         40  |   .1495935   .1344494     1.11   0.266    -.1139516    .4131387
         50  |   .1742803   .1469076     1.19   0.236    -.1136853    .4622459
             |
       _cons |    7.56484   .0492688   153.54   0.000     7.468264    7.661415
-------------+----------------------------------------------------------------
     sigma_u |  1.1538466
     sigma_e |  .57065518
         rho |  .80347283   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1755217307143658

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    265,452
Group variable: firm_person                     Number of groups  =     28,209

R-sq:                                           Obs per group:
     within  = 0.1755                                         min =          1
     between = 0.1289                                         avg =        9.4
     overall = 0.1198                                         max =         25

                                                F(82,10918)       =      68.19
corr(u_i, Xb)  = 0.0488                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0945027    .029482     3.21   0.001     .0367126    .1522928
   during_DD |   .0264757   .0082443     3.21   0.001     .0103155    .0426359
   during_DE |   .1380296   .0541809     2.55   0.011     .0318252    .2442339
   during_ED |   .0024989   .0205501     0.12   0.903    -.0377831     .042781
   during_EE |   .1524561   .0490616     3.11   0.002     .0562864    .2486258
    after_DD |    .033159   .0151906     2.18   0.029     .0033827    .0629352
    after_DE |   .2484841   .0561229     4.43   0.000      .138473    .3584952
    after_ED |   .0587687   .0338779     1.73   0.083    -.0076381    .1251756
    after_EE |   .2087984   .0587147     3.56   0.000     .0937069    .3238899
             |
    ind_year |
          2  |   .0665953   .0285814     2.33   0.020     .0105706      .12262
          3  |   .2338922   .0364175     6.42   0.000     .1625074     .305277
          4  |   .4144953    .038571    10.75   0.000     .3388892    .4901014
          5  |   .5451443   .0421115    12.95   0.000     .4625981    .6276905
          6  |   .7050669   .0458087    15.39   0.000     .6152735    .7948603
          7  |   .8435996    .047894    17.61   0.000     .7497188    .9374805
          8  |    .930432   .0500699    18.58   0.000      .832286    1.028578
          9  |   1.047533   .0525332    19.94   0.000     .9445584    1.150508
         10  |   1.169158   .0550352    21.24   0.000     1.061279    1.277037
         11  |   1.230053   .0577928    21.28   0.000     1.116768    1.343337
         12  |   1.252883   .0605201    20.70   0.000     1.134253    1.371513
         13  |    1.30128   .0634918    20.50   0.000     1.176824    1.425736
         14  |   1.338459   .0660035    20.28   0.000      1.20908    1.467838
         15  |   1.408136    .069028    20.40   0.000     1.272829    1.543444
         16  |   1.438526   .0712119    20.20   0.000     1.298938    1.578115
         17  |   1.494021   .0739582    20.20   0.000      1.34905    1.638993
         18  |   1.428834   .0766254    18.65   0.000     1.278634    1.579034
         19  |   1.458915   .0792184    18.42   0.000     1.303633    1.614198
         20  |   1.500259   .0814748    18.41   0.000     1.340553    1.659964
         21  |   1.521565   .0837994    18.16   0.000     1.357303    1.685827
         22  |    1.58243   .0861147    18.38   0.000     1.413629     1.75123
         23  |   1.631021   .0882858    18.47   0.000     1.457965    1.804078
         24  |   1.667903   .0906027    18.41   0.000     1.490305    1.845501
         25  |   1.662223   .0929318    17.89   0.000      1.48006    1.844386
         26  |  -.3859025   .0620446    -6.22   0.000    -.5075212   -.2642837
         27  |  -.2311793   .0605877    -3.82   0.000    -.3499423   -.1124164
         28  |  -.0473287   .0589223    -0.80   0.422    -.1628271    .0681697
         29  |   .1708582   .0576827     2.96   0.003     .0577897    .2839267
         30  |   .3593188   .0566986     6.34   0.000     .2481793    .4704583
         31  |   .4913467   .0578381     8.50   0.000     .3779735    .6047199
         32  |   .6539174   .0593181    11.02   0.000     .5376432    .7701916
         33  |   .7145768   .0602648    11.86   0.000     .5964468    .8327067
         34  |    .848232   .0620792    13.66   0.000     .7265454    .9699186
         35  |   .9400508   .0638988    14.71   0.000     .8147976    1.065304
         36  |   .9898698   .0656508    15.08   0.000     .8611823    1.118557
         37  |   1.051011   .0679413    15.47   0.000     .9178334    1.184188
         38  |   1.149542   .0699837    16.43   0.000     1.012361    1.286723
         39  |   1.189295   .0724153    16.42   0.000     1.047348    1.331242
         40  |   1.286033   .0754668    17.04   0.000     1.138104    1.433961
         41  |    1.36514   .0768821    17.76   0.000     1.214437    1.515843
         42  |   1.432459   .0787882    18.18   0.000      1.27802    1.586898
         43  |   1.401522   .0814479    17.21   0.000     1.241869    1.561175
         44  |   1.455036   .0840514    17.31   0.000      1.29028    1.619792
         45  |   1.536969   .0862691    17.82   0.000     1.367865    1.706072
         46  |   1.542827   .0889922    17.34   0.000     1.368386    1.717268
         47  |   1.567895   .0905017    17.32   0.000     1.390495    1.745295
         48  |   1.627992   .0924577    17.61   0.000     1.446759    1.809226
         49  |   1.621927   .0958382    16.92   0.000     1.434067    1.809788
         50  |   1.642881   .0974289    16.86   0.000     1.451903    1.833859
             |
     age_cat |
          1  |   .3069192   .0272891    11.25   0.000     .2534276    .3604108
          2  |    .315725   .0298663    10.57   0.000     .2571816    .3742684
          3  |   .3079323    .032026     9.62   0.000     .2451554    .3707092
          4  |   .3054831   .0340289     8.98   0.000     .2387802     .372186
          5  |   .2956239   .0363702     8.13   0.000     .2243318    .3669161
          6  |   .2744194   .0387614     7.08   0.000     .1984401    .3503987
          7  |   .2907256   .0410766     7.08   0.000      .210208    .3712433
          8  |   .2874925   .0437904     6.57   0.000     .2016553    .3733296
          9  |   .2759948   .0465918     5.92   0.000     .1846664    .3673232
         10  |   .2716246   .0492821     5.51   0.000     .1750228    .3682264
         11  |   .2700427   .0522175     5.17   0.000     .1676869    .3723985
         12  |   .2767855   .0550768     5.03   0.000     .1688251    .3847459
         13  |   .2673455   .0580013     4.61   0.000     .1536525    .3810385
         14  |   .2678003    .060938     4.39   0.000     .1483508    .3872497
         15  |   .2679307   .0638702     4.19   0.000     .1427335    .3931279
         16  |   .2559234   .0668401     3.83   0.000     .1249047    .3869422
         17  |   .2395548   .0699786     3.42   0.001     .1023841    .3767255
         18  |   .2403334   .0729284     3.30   0.001     .0973805    .3832864
         19  |   .2225076   .0761617     2.92   0.003     .0732169    .3717984
         20  |   .1907022    .081873     2.33   0.020     .0302163    .3511882
         25  |   .1517631   .0919427     1.65   0.099    -.0284613    .3319875
         30  |    .118973   .1192075     1.00   0.318    -.1146953    .3526413
         40  |   .1495935   .1344494     1.11   0.266    -.1139516    .4131387
         50  |   .1742803   .1469076     1.19   0.236    -.1136853    .4622459
             |
       _cons |    7.56484   .0492688   153.54   0.000     7.468264    7.661415
-------------+----------------------------------------------------------------
     sigma_u |  1.1538466
     sigma_e |  .57065518
         rho |  .80347283   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[du
> ring_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle(`title') legend(off) 
> aspect(0.67))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 10918) =   10.31
            Prob > F =    0.0013

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 10918) =    6.49
            Prob > F =    0.0109

 ( 1)  - during_DD + during_DE = 0

       F(  1, 10918) =    4.15
            Prob > F =    0.0417
variable label was str11 now str13
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 10918) =    0.01
            Prob > F =    0.9032

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 10918) =    9.66
            Prob > F =    0.0019

 ( 1)  - during_ED + during_EE = 0

       F(  1, 10918) =    8.16
            Prob > F =    0.0043
(1 real change made)

. 
. graph export output/figure/`fname'_tree.png, width(800) replace
(file output/figure/lnQL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    177613
Group variable: firm_person                     Number of groups   =     19465

R-sq:  within  = 0.2308                         Obs per group: min =         1
       between = 0.1700                                        avg =       9.1
       overall = 0.1587                                        max =        25

                                                F(78,6772)         =     64.16
corr(u_i, Xb)  = 0.0867                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 6,773 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1224835   .0393325     3.11   0.002     .0453794    .1995876
      during |   .0598994   .0100799     5.94   0.000     .0401396    .0796593
       after |   .1121815   .0177024     6.34   0.000     .0774791    .1468838
during_expat |   .1002483   .0376238     2.66   0.008     .0264938    .1740028
 after_expat |   .1724743   .0454087     3.80   0.000      .083459    .2614895
             |
    ind_year |
          2  |   .0487966   .0319541     1.53   0.127    -.0138436    .1114368
          3  |   .2285481   .0384597     5.94   0.000      .153155    .3039413
          4  |    .415992   .0407818    10.20   0.000     .3360468    .4959372
          5  |   .5511325   .0463362    11.89   0.000     .4602989     .641966
          6  |   .7071717   .0505553    13.99   0.000     .6080675    .8062759
          7  |   .8293171   .0540164    15.35   0.000      .723428    .9352063
          8  |    .908645   .0568016    16.00   0.000     .7972961    1.019994
          9  |   1.009004   .0596399    16.92   0.000     .8920912    1.125917
         10  |   1.125866   .0625818    17.99   0.000     1.003186    1.248546
         11  |   1.198473   .0663748    18.06   0.000     1.068357    1.328588
         12  |   1.195435   .0700223    17.07   0.000      1.05817    1.332701
         13  |   1.235498   .0737187    16.76   0.000     1.090986    1.380009
         14  |    1.27307    .076497    16.64   0.000     1.123111    1.423028
         15  |   1.332278   .0804822    16.55   0.000     1.174508    1.490048
         16  |   1.366547   .0826233    16.54   0.000     1.204579    1.528514
         17  |   1.439508   .0857137    16.79   0.000     1.271483    1.607534
         18  |   1.371808   .0885421    15.49   0.000     1.198237    1.545378
         19  |   1.390006   .0910279    15.27   0.000     1.211562    1.568449
         20  |   1.444535   .0935622    15.44   0.000     1.261124    1.627946
         21  |   1.475303   .0958456    15.39   0.000     1.287415     1.66319
         22  |   1.518585   .0987714    15.37   0.000     1.324962    1.712208
         23  |    1.54068   .1010083    15.25   0.000     1.342672    1.738688
         24  |   1.579839   .1030529    15.33   0.000     1.377823    1.781855
         25  |   1.581174   .1049776    15.06   0.000     1.375384    1.786963
         26  |  -.2850662   .0716799    -3.98   0.000    -.4255813   -.1445512
         27  |  -.1472928   .0697957    -2.11   0.035    -.2841144   -.0104713
         28  |   .0048916    .066629     0.07   0.941    -.1257222    .1355054
         29  |   .2011127   .0671711     2.99   0.003     .0694362    .3327891
         30  |   .3741796   .0665325     5.62   0.000      .243755    .5046043
         31  |   .4840889   .0670479     7.22   0.000     .3526539     .615524
         32  |   .6415247   .0682569     9.40   0.000     .5077197    .7753297
         33  |   .6971167   .0687446    10.14   0.000     .5623557    .8318777
         34  |   .8326714   .0709735    11.73   0.000      .693541    .9718018
         35  |   .9022649   .0731722    12.33   0.000     .7588245    1.045705
         36  |   .9485891   .0748916    12.67   0.000     .8017781      1.0954
         37  |   1.016794   .0773382    13.15   0.000     .8651867    1.168401
         38  |   1.085751   .0795329    13.65   0.000     .9298411     1.24166
         39  |   1.128286   .0825675    13.67   0.000     .9664277    1.290144
         40  |   1.218438   .0857771    14.20   0.000     1.050288    1.386588
         41  |   1.283413     .08785    14.61   0.000     1.111199    1.455627
         42  |   1.351831   .0897302    15.07   0.000     1.175931     1.52773
         43  |    1.28796   .0924934    13.92   0.000     1.106643    1.469276
         44  |   1.337622   .0947266    14.12   0.000     1.151929    1.523316
         45  |   1.436951   .0973546    14.76   0.000     1.246106    1.627797
         46  |    1.43011   .1006282    14.21   0.000     1.232847    1.627372
         47  |   1.456895   .1023002    14.24   0.000     1.256355    1.657436
         48  |   1.515752   .1043312    14.53   0.000      1.31123    1.720274
         49  |   1.509578   .1089173    13.86   0.000     1.296065     1.72309
         50  |   1.516835   .1100026    13.79   0.000     1.301195    1.732474
             |
     age_cat |
          1  |   .3528398   .0325557    10.84   0.000     .2890205    .4166592
          2  |   .3819949   .0357892    10.67   0.000     .3118369     .452153
          3  |   .4048445   .0380062    10.65   0.000     .3303405    .4793486
          4  |    .412116   .0401896    10.25   0.000     .3333317    .4909003
          5  |   .4196584   .0429122     9.78   0.000      .335537    .5037798
          6  |   .4308841    .045496     9.47   0.000     .3416977    .5200704
          7  |   .4422849   .0484862     9.12   0.000     .3472368    .5373331
          8  |   .4582854   .0517925     8.85   0.000     .3567558     .559815
          9  |    .460715   .0549972     8.38   0.000     .3529032    .5685268
         10  |   .4582657   .0580406     7.90   0.000      .344488    .5720435
         11  |   .4754849   .0615435     7.73   0.000     .3548402    .5961296
         12  |   .4853553    .065041     7.46   0.000     .3578544    .6128561
         13  |   .4853714   .0682157     7.12   0.000     .3516473    .6190955
         14  |   .4989971   .0712948     7.00   0.000     .3592368    .6387573
         15  |   .5072517   .0742854     6.83   0.000     .3616289    .6528745
         16  |   .5099952   .0775012     6.58   0.000     .3580685    .6619219
         17  |    .482521   .0806685     5.98   0.000     .3243853    .6406566
         18  |   .4865749   .0836002     5.82   0.000     .3226921    .6504576
         19  |   .4858021   .0868785     5.59   0.000      .315493    .6561112
         20  |   .4593569   .0930048     4.94   0.000     .2770383    .6416756
         25  |   .4046786   .1040553     3.89   0.000     .2006975    .6086597
         30  |   .4129086   .1315042     3.14   0.002     .1551191    .6706981
         40  |   .4353472   .1475396     2.95   0.003     .1461232    .7245711
         50  |   .4867335   .1609424     3.02   0.003     .1712357    .8022312
             |
       _cons |   7.300628    .057352   127.30   0.000       7.1882    7.413056
-------------+----------------------------------------------------------------
     sigma_u |  1.1428995
     sigma_e |  .53434154
         rho |  .82062343   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2308189334284463

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    177,613
Group variable: firm_person                     Number of groups  =     19,465

R-sq:                                           Obs per group:
     within  = 0.2308                                         min =          1
     between = 0.1700                                         avg =        9.1
     overall = 0.1587                                         max =         25

                                                F(78,6772)        =      64.16
corr(u_i, Xb)  = 0.0867                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 6,773 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1224835   .0393325     3.11   0.002     .0453794    .1995876
      during |   .0598994   .0100799     5.94   0.000     .0401396    .0796593
       after |   .1121815   .0177024     6.34   0.000     .0774791    .1468838
during_expat |   .1002483   .0376238     2.66   0.008     .0264938    .1740028
 after_expat |   .1724743   .0454087     3.80   0.000      .083459    .2614895
             |
    ind_year |
          2  |   .0487966   .0319541     1.53   0.127    -.0138436    .1114368
          3  |   .2285481   .0384597     5.94   0.000      .153155    .3039413
          4  |    .415992   .0407818    10.20   0.000     .3360468    .4959372
          5  |   .5511325   .0463362    11.89   0.000     .4602989     .641966
          6  |   .7071717   .0505553    13.99   0.000     .6080675    .8062759
          7  |   .8293171   .0540164    15.35   0.000      .723428    .9352063
          8  |    .908645   .0568016    16.00   0.000     .7972961    1.019994
          9  |   1.009004   .0596399    16.92   0.000     .8920912    1.125917
         10  |   1.125866   .0625818    17.99   0.000     1.003186    1.248546
         11  |   1.198473   .0663748    18.06   0.000     1.068357    1.328588
         12  |   1.195435   .0700223    17.07   0.000      1.05817    1.332701
         13  |   1.235498   .0737187    16.76   0.000     1.090986    1.380009
         14  |    1.27307    .076497    16.64   0.000     1.123111    1.423028
         15  |   1.332278   .0804822    16.55   0.000     1.174508    1.490048
         16  |   1.366547   .0826233    16.54   0.000     1.204579    1.528514
         17  |   1.439508   .0857137    16.79   0.000     1.271483    1.607534
         18  |   1.371808   .0885421    15.49   0.000     1.198237    1.545378
         19  |   1.390006   .0910279    15.27   0.000     1.211562    1.568449
         20  |   1.444535   .0935622    15.44   0.000     1.261124    1.627946
         21  |   1.475303   .0958456    15.39   0.000     1.287415     1.66319
         22  |   1.518585   .0987714    15.37   0.000     1.324962    1.712208
         23  |    1.54068   .1010083    15.25   0.000     1.342672    1.738688
         24  |   1.579839   .1030529    15.33   0.000     1.377823    1.781855
         25  |   1.581174   .1049776    15.06   0.000     1.375384    1.786963
         26  |  -.2850662   .0716799    -3.98   0.000    -.4255813   -.1445512
         27  |  -.1472928   .0697957    -2.11   0.035    -.2841144   -.0104713
         28  |   .0048916    .066629     0.07   0.941    -.1257222    .1355054
         29  |   .2011127   .0671711     2.99   0.003     .0694362    .3327891
         30  |   .3741796   .0665325     5.62   0.000      .243755    .5046043
         31  |   .4840889   .0670479     7.22   0.000     .3526539     .615524
         32  |   .6415247   .0682569     9.40   0.000     .5077197    .7753297
         33  |   .6971167   .0687446    10.14   0.000     .5623557    .8318777
         34  |   .8326714   .0709735    11.73   0.000      .693541    .9718018
         35  |   .9022649   .0731722    12.33   0.000     .7588245    1.045705
         36  |   .9485891   .0748916    12.67   0.000     .8017781      1.0954
         37  |   1.016794   .0773382    13.15   0.000     .8651867    1.168401
         38  |   1.085751   .0795329    13.65   0.000     .9298411     1.24166
         39  |   1.128286   .0825675    13.67   0.000     .9664277    1.290144
         40  |   1.218438   .0857771    14.20   0.000     1.050288    1.386588
         41  |   1.283413     .08785    14.61   0.000     1.111199    1.455627
         42  |   1.351831   .0897302    15.07   0.000     1.175931     1.52773
         43  |    1.28796   .0924934    13.92   0.000     1.106643    1.469276
         44  |   1.337622   .0947266    14.12   0.000     1.151929    1.523316
         45  |   1.436951   .0973546    14.76   0.000     1.246106    1.627797
         46  |    1.43011   .1006282    14.21   0.000     1.232847    1.627372
         47  |   1.456895   .1023002    14.24   0.000     1.256355    1.657436
         48  |   1.515752   .1043312    14.53   0.000      1.31123    1.720274
         49  |   1.509578   .1089173    13.86   0.000     1.296065     1.72309
         50  |   1.516835   .1100026    13.79   0.000     1.301195    1.732474
             |
     age_cat |
          1  |   .3528398   .0325557    10.84   0.000     .2890205    .4166592
          2  |   .3819949   .0357892    10.67   0.000     .3118369     .452153
          3  |   .4048445   .0380062    10.65   0.000     .3303405    .4793486
          4  |    .412116   .0401896    10.25   0.000     .3333317    .4909003
          5  |   .4196584   .0429122     9.78   0.000      .335537    .5037798
          6  |   .4308841    .045496     9.47   0.000     .3416977    .5200704
          7  |   .4422849   .0484862     9.12   0.000     .3472368    .5373331
          8  |   .4582854   .0517925     8.85   0.000     .3567558     .559815
          9  |    .460715   .0549972     8.38   0.000     .3529032    .5685268
         10  |   .4582657   .0580406     7.90   0.000      .344488    .5720435
         11  |   .4754849   .0615435     7.73   0.000     .3548402    .5961296
         12  |   .4853553    .065041     7.46   0.000     .3578544    .6128561
         13  |   .4853714   .0682157     7.12   0.000     .3516473    .6190955
         14  |   .4989971   .0712948     7.00   0.000     .3592368    .6387573
         15  |   .5072517   .0742854     6.83   0.000     .3616289    .6528745
         16  |   .5099952   .0775012     6.58   0.000     .3580685    .6619219
         17  |    .482521   .0806685     5.98   0.000     .3243853    .6406566
         18  |   .4865749   .0836002     5.82   0.000     .3226921    .6504576
         19  |   .4858021   .0868785     5.59   0.000      .315493    .6561112
         20  |   .4593569   .0930048     4.94   0.000     .2770383    .6416756
         25  |   .4046786   .1040553     3.89   0.000     .2006975    .6086597
         30  |   .4129086   .1315042     3.14   0.002     .1551191    .6706981
         40  |   .4353472   .1475396     2.95   0.003     .1461232    .7245711
         50  |   .4867335   .1609424     3.02   0.003     .1712357    .8022312
             |
       _cons |   7.300628    .057352   127.30   0.000       7.1882    7.413056
-------------+----------------------------------------------------------------
     sigma_u |  1.1428995
     sigma_e |  .53434154
         rho |  .82062343   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    156204
Group variable: firm_person                     Number of groups   =     16977

R-sq:  within  = 0.1483                         Obs per group: min =         1
       between = 0.1359                                        avg =       9.2
       overall = 0.1112                                        max =        25

                                                F(78,6146)         =     33.85
corr(u_i, Xb)  = 0.0684                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 6,147 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1017413   .0390179     2.61   0.009     .0252524    .1782301
      during |   .0507155   .0106946     4.74   0.000     .0297503    .0716807
       after |   .0865495   .0192255     4.50   0.000     .0488608    .1242382
during_expat |   .1388532   .0359026     3.87   0.000     .0684714    .2092349
 after_expat |   .2221924   .0451535     4.92   0.000     .1336757    .3107092
             |
    ind_year |
          2  |    .109972   .0509676     2.16   0.031     .0100576    .2098864
          3  |   .2777651   .0621622     4.47   0.000     .1559055    .3996247
          4  |   .4861807   .0622559     7.81   0.000     .3641374     .608224
          5  |   .6534524   .0668959     9.77   0.000      .522313    .7845919
          6  |   .7890552   .0709254    11.13   0.000     .6500166    .9280938
          7  |   .9216972   .0748203    12.32   0.000     .7750232    1.068371
          8  |   1.010228   .0771667    13.09   0.000     .8589541    1.161502
          9  |   1.133043   .0802222    14.12   0.000      .975779    1.290306
         10  |   1.228286   .0827639    14.84   0.000      1.06604    1.390532
         11  |   1.261556   .0867337    14.55   0.000     1.091528    1.431585
         12  |   1.288854   .0898479    14.34   0.000      1.11272    1.464987
         13  |   1.317241   .0936854    14.06   0.000     1.133584    1.500897
         14  |   1.351099   .0965285    14.00   0.000      1.16187    1.540329
         15  |   1.407596   .1005863    13.99   0.000     1.210411     1.60478
         16  |   1.434604   .1033345    13.88   0.000     1.232032    1.637176
         17  |   1.479822   .1066443    13.88   0.000     1.270762    1.688882
         18  |   1.399062   .1098497    12.74   0.000     1.183718    1.614406
         19  |   1.415576    .113371    12.49   0.000     1.193329    1.637823
         20  |   1.480094   .1161569    12.74   0.000     1.252386    1.707802
         21  |   1.496337   .1187865    12.60   0.000     1.263474      1.7292
         22  |   1.541081   .1220362    12.63   0.000     1.301848    1.780315
         23  |   1.587303   .1246453    12.73   0.000     1.342955    1.831652
         24  |    1.59828   .1275553    12.53   0.000     1.348227    1.848333
         25  |   1.582936   .1305174    12.13   0.000     1.327076    1.838796
         26  |  -.3324626   .0954307    -3.48   0.000    -.5195402   -.1453849
         27  |  -.1262623   .0935477    -1.35   0.177    -.3096485    .0571239
         28  |   .0188455   .0944858     0.20   0.842    -.1663797    .2040707
         29  |   .2355219   .0919989     2.56   0.010     .0551718    .4158719
         30  |   .4117712   .0886261     4.65   0.000     .2380331    .5855094
         31  |   .5537897   .0889543     6.23   0.000     .3794082    .7281713
         32  |   .7180635   .0901032     7.97   0.000     .5414298    .8946973
         33  |   .7577625   .0905832     8.37   0.000     .5801878    .9353372
         34  |   .8855697   .0924909     9.57   0.000     .7042553    1.066884
         35  |   .9947129   .0940549    10.58   0.000     .8103323    1.179093
         36  |   1.020542   .0954024    10.70   0.000     .8335195    1.207564
         37  |   1.081133   .0977701    11.06   0.000     .8894693    1.272797
         38  |   1.174842   .1001843    11.73   0.000     .9784458    1.371238
         39  |   1.196262    .103014    11.61   0.000     .9943186    1.398206
         40  |   1.284953   .1065803    12.06   0.000     1.076018    1.493888
         41  |   1.362907   .1086041    12.55   0.000     1.150005    1.575809
         42  |   1.432356    .111141    12.89   0.000     1.214481    1.650231
         43  |   1.386194   .1143975    12.12   0.000     1.161935    1.610453
         44  |   1.435387   .1178428    12.18   0.000     1.204374      1.6664
         45  |   1.502591   .1204225    12.48   0.000     1.266521    1.738661
         46  |   1.524119   .1234871    12.34   0.000     1.282041    1.766197
         47  |   1.515948   .1259971    12.03   0.000      1.26895    1.762947
         48  |   1.566189   .1285996    12.18   0.000     1.314089    1.818289
         49  |   1.545206   .1335538    11.57   0.000     1.283394    1.807018
         50  |   1.574192   .1352959    11.64   0.000     1.308964    1.839419
             |
     age_cat |
          1  |   .3097707   .0447814     6.92   0.000     .2219835     .397558
          2  |   .3053207   .0483549     6.31   0.000     .2105281    .4001133
          3  |   .2809622   .0511952     5.49   0.000     .1806016    .3813228
          4  |   .2557077   .0530315     4.82   0.000     .1517475    .3596679
          5  |    .261383   .0554509     4.71   0.000     .1526798    .3700861
          6  |   .2383715   .0580238     4.11   0.000     .1246246    .3521184
          7  |   .2508302   .0605926     4.14   0.000     .1320475    .3696129
          8  |   .2440108   .0637389     3.83   0.000     .1190603    .3689613
          9  |   .2375701   .0669023     3.55   0.000     .1064181    .3687221
         10  |   .2237401   .0702929     3.18   0.001     .0859414    .3615387
         11  |   .2241812   .0739545     3.03   0.002     .0792046    .3691579
         12  |     .22668   .0774327     2.93   0.003     .0748848    .3784753
         13  |   .2142275   .0810107     2.64   0.008      .055418    .3730369
         14  |   .2214757   .0843154     2.63   0.009      .056188    .3867634
         15  |   .2275669   .0879396     2.59   0.010     .0551746    .3999593
         16  |   .2208573   .0916058     2.41   0.016     .0412778    .4004368
         17  |   .2162541   .0953565     2.27   0.023     .0293219    .4031863
         18  |   .2234524   .0990816     2.26   0.024     .0292178    .4176869
         19  |   .2086142   .1031281     2.02   0.043     .0064471    .4107813
         20  |   .1879638   .1110811     1.69   0.091     -.029794    .4057215
         25  |   .1562847   .1250647     1.25   0.211    -.0888858    .4014552
         30  |   .1194818   .1536137     0.78   0.437    -.1816549    .4206185
         40  |    .213225   .1712323     1.25   0.213    -.1224503    .5489003
         50  |   .2567043   .1873036     1.37   0.171    -.1104763     .623885
             |
       _cons |   7.784856    .081781    95.19   0.000     7.624536    7.945175
-------------+----------------------------------------------------------------
     sigma_u |  1.1538337
     sigma_e |  .56341677
         rho |  .80746961   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1483118588803655

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    156,204
Group variable: firm_person                     Number of groups  =     16,977

R-sq:                                           Obs per group:
     within  = 0.1483                                         min =          1
     between = 0.1359                                         avg =        9.2
     overall = 0.1112                                         max =         25

                                                F(78,6146)        =      33.85
corr(u_i, Xb)  = 0.0684                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 6,147 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .1017413   .0390179     2.61   0.009     .0252524    .1782301
      during |   .0507155   .0106946     4.74   0.000     .0297503    .0716807
       after |   .0865495   .0192255     4.50   0.000     .0488608    .1242382
during_expat |   .1388532   .0359026     3.87   0.000     .0684714    .2092349
 after_expat |   .2221924   .0451535     4.92   0.000     .1336757    .3107092
             |
    ind_year |
          2  |    .109972   .0509676     2.16   0.031     .0100576    .2098864
          3  |   .2777651   .0621622     4.47   0.000     .1559055    .3996247
          4  |   .4861807   .0622559     7.81   0.000     .3641374     .608224
          5  |   .6534524   .0668959     9.77   0.000      .522313    .7845919
          6  |   .7890552   .0709254    11.13   0.000     .6500166    .9280938
          7  |   .9216972   .0748203    12.32   0.000     .7750232    1.068371
          8  |   1.010228   .0771667    13.09   0.000     .8589541    1.161502
          9  |   1.133043   .0802222    14.12   0.000      .975779    1.290306
         10  |   1.228286   .0827639    14.84   0.000      1.06604    1.390532
         11  |   1.261556   .0867337    14.55   0.000     1.091528    1.431585
         12  |   1.288854   .0898479    14.34   0.000      1.11272    1.464987
         13  |   1.317241   .0936854    14.06   0.000     1.133584    1.500897
         14  |   1.351099   .0965285    14.00   0.000      1.16187    1.540329
         15  |   1.407596   .1005863    13.99   0.000     1.210411     1.60478
         16  |   1.434604   .1033345    13.88   0.000     1.232032    1.637176
         17  |   1.479822   .1066443    13.88   0.000     1.270762    1.688882
         18  |   1.399062   .1098497    12.74   0.000     1.183718    1.614406
         19  |   1.415576    .113371    12.49   0.000     1.193329    1.637823
         20  |   1.480094   .1161569    12.74   0.000     1.252386    1.707802
         21  |   1.496337   .1187865    12.60   0.000     1.263474      1.7292
         22  |   1.541081   .1220362    12.63   0.000     1.301848    1.780315
         23  |   1.587303   .1246453    12.73   0.000     1.342955    1.831652
         24  |    1.59828   .1275553    12.53   0.000     1.348227    1.848333
         25  |   1.582936   .1305174    12.13   0.000     1.327076    1.838796
         26  |  -.3324626   .0954307    -3.48   0.000    -.5195402   -.1453849
         27  |  -.1262623   .0935477    -1.35   0.177    -.3096485    .0571239
         28  |   .0188455   .0944858     0.20   0.842    -.1663797    .2040707
         29  |   .2355219   .0919989     2.56   0.010     .0551718    .4158719
         30  |   .4117712   .0886261     4.65   0.000     .2380331    .5855094
         31  |   .5537897   .0889543     6.23   0.000     .3794082    .7281713
         32  |   .7180635   .0901032     7.97   0.000     .5414298    .8946973
         33  |   .7577625   .0905832     8.37   0.000     .5801878    .9353372
         34  |   .8855697   .0924909     9.57   0.000     .7042553    1.066884
         35  |   .9947129   .0940549    10.58   0.000     .8103323    1.179093
         36  |   1.020542   .0954024    10.70   0.000     .8335195    1.207564
         37  |   1.081133   .0977701    11.06   0.000     .8894693    1.272797
         38  |   1.174842   .1001843    11.73   0.000     .9784458    1.371238
         39  |   1.196262    .103014    11.61   0.000     .9943186    1.398206
         40  |   1.284953   .1065803    12.06   0.000     1.076018    1.493888
         41  |   1.362907   .1086041    12.55   0.000     1.150005    1.575809
         42  |   1.432356    .111141    12.89   0.000     1.214481    1.650231
         43  |   1.386194   .1143975    12.12   0.000     1.161935    1.610453
         44  |   1.435387   .1178428    12.18   0.000     1.204374      1.6664
         45  |   1.502591   .1204225    12.48   0.000     1.266521    1.738661
         46  |   1.524119   .1234871    12.34   0.000     1.282041    1.766197
         47  |   1.515948   .1259971    12.03   0.000      1.26895    1.762947
         48  |   1.566189   .1285996    12.18   0.000     1.314089    1.818289
         49  |   1.545206   .1335538    11.57   0.000     1.283394    1.807018
         50  |   1.574192   .1352959    11.64   0.000     1.308964    1.839419
             |
     age_cat |
          1  |   .3097707   .0447814     6.92   0.000     .2219835     .397558
          2  |   .3053207   .0483549     6.31   0.000     .2105281    .4001133
          3  |   .2809622   .0511952     5.49   0.000     .1806016    .3813228
          4  |   .2557077   .0530315     4.82   0.000     .1517475    .3596679
          5  |    .261383   .0554509     4.71   0.000     .1526798    .3700861
          6  |   .2383715   .0580238     4.11   0.000     .1246246    .3521184
          7  |   .2508302   .0605926     4.14   0.000     .1320475    .3696129
          8  |   .2440108   .0637389     3.83   0.000     .1190603    .3689613
          9  |   .2375701   .0669023     3.55   0.000     .1064181    .3687221
         10  |   .2237401   .0702929     3.18   0.001     .0859414    .3615387
         11  |   .2241812   .0739545     3.03   0.002     .0792046    .3691579
         12  |     .22668   .0774327     2.93   0.003     .0748848    .3784753
         13  |   .2142275   .0810107     2.64   0.008      .055418    .3730369
         14  |   .2214757   .0843154     2.63   0.009      .056188    .3867634
         15  |   .2275669   .0879396     2.59   0.010     .0551746    .3999593
         16  |   .2208573   .0916058     2.41   0.016     .0412778    .4004368
         17  |   .2162541   .0953565     2.27   0.023     .0293219    .4031863
         18  |   .2234524   .0990816     2.26   0.024     .0292178    .4176869
         19  |   .2086142   .1031281     2.02   0.043     .0064471    .4107813
         20  |   .1879638   .1110811     1.69   0.091     -.029794    .4057215
         25  |   .1562847   .1250647     1.25   0.211    -.0888858    .4014552
         30  |   .1194818   .1536137     0.78   0.437    -.1816549    .4206185
         40  |    .213225   .1712323     1.25   0.213    -.1224503    .5489003
         50  |   .2567043   .1873036     1.37   0.171    -.1104763     .623885
             |
       _cons |   7.784856    .081781    95.19   0.000     7.624536    7.945175
-------------+----------------------------------------------------------------
     sigma_u |  1.1538337
     sigma_e |  .56341677
         rho |  .80746961   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    144967
Group variable: firm_person                     Number of groups   =     15682

R-sq:  within  = 0.1118                         Obs per group: min =         1
       between = 0.1299                                        avg =       9.2
       overall = 0.0912                                        max =        25

                                                F(78,5715)         =     21.49
corr(u_i, Xb)  = 0.0522                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,716 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0545665   .0400459     1.36   0.173    -.0239387    .1330717
      during |   .0024772   .0109191     0.23   0.821    -.0189285    .0238828
       after |   .0273109   .0192481     1.42   0.156    -.0104226    .0650445
during_expat |   .1188198    .045532     2.61   0.009     .0295599    .2080798
 after_expat |    .200473     .05621     3.57   0.000       .09028    .3106659
             |
    ind_year |
          2  |   .0894452   .0410457     2.18   0.029     .0089799    .1699104
          3  |   .2585438   .0498832     5.18   0.000     .1607539    .3563338
          4  |   .4424475   .0531828     8.32   0.000      .338189     .546706
          5  |   .5832613   .0581578    10.03   0.000     .4692501    .6972726
          6  |    .709509   .0650176    10.91   0.000     .5820499    .8369681
          7  |   .8416508   .0680759    12.36   0.000     .7081962    .9751053
          8  |   .9140943   .0701688    13.03   0.000     .7765369    1.051652
          9  |    1.01636   .0731484    13.89   0.000     .8729615    1.159759
         10  |   1.115834   .0763097    14.62   0.000     .9662385    1.265431
         11  |   1.147683   .0806848    14.22   0.000     .9895099    1.305856
         12  |   1.154598   .0843271    13.69   0.000     .9892847    1.319911
         13  |   1.193196   .0884972    13.48   0.000     1.019708    1.366684
         14  |   1.212588    .091854    13.20   0.000     1.032519    1.392657
         15  |   1.283464   .0960372    13.36   0.000     1.095195    1.471734
         16  |   1.307559   .0992681    13.17   0.000     1.112956    1.502163
         17  |   1.354398   .1029276    13.16   0.000     1.152621    1.556175
         18  |   1.273788   .1063517    11.98   0.000     1.065298    1.482278
         19  |   1.285466   .1098991    11.70   0.000     1.070022     1.50091
         20  |   1.340566   .1132552    11.84   0.000     1.118543     1.56259
         21  |   1.356914    .116259    11.67   0.000     1.129002    1.584826
         22  |   1.408581   .1195286    11.78   0.000      1.17426    1.642903
         23  |   1.442478   .1226132    11.76   0.000      1.20211    1.682846
         24  |   1.477175   .1255946    11.76   0.000     1.230962    1.723388
         25  |   1.456483   .1288348    11.31   0.000     1.203918    1.709048
         26  |  -.5695101   .0918343    -6.20   0.000    -.7495402     -.38948
         27  |  -.3431637   .0951013    -3.61   0.000    -.5295983   -.1567292
         28  |  -.1566036   .0949581    -1.65   0.099    -.3427575    .0295503
         29  |   .1093103   .0888772     1.23   0.219    -.0649226    .2835432
         30  |   .2316293   .0854995     2.71   0.007      .064018    .3992407
         31  |   .3978658   .0844851     4.71   0.000     .2322429    .5634886
         32  |    .538358   .0847479     6.35   0.000       .37222    .7044961
         33  |   .5496983   .0847477     6.49   0.000     .3835607     .715836
         34  |   .7081456    .087203     8.12   0.000     .5371946    .8790966
         35  |   .7955765    .089199     8.92   0.000     .6207126    .9704405
         36  |   .8104629   .0906096     8.94   0.000     .6328338    .9880919
         37  |   .8818756   .0926663     9.52   0.000     .7002144    1.063537
         38  |   .9873348   .0955583    10.33   0.000     .8000044    1.174665
         39  |   1.014176   .0983429    10.31   0.000     .8213865    1.206965
         40  |   1.113039   .1024157    10.87   0.000     .9122654    1.313813
         41  |   1.183738   .1051968    11.25   0.000     .9775124    1.389964
         42  |   1.252607   .1077638    11.62   0.000     1.041349    1.463865
         43  |   1.188803    .111393    10.67   0.000     .9704302    1.407175
         44  |   1.252118   .1146405    10.92   0.000     1.027379    1.476857
         45  |   1.331033   .1177933    11.30   0.000     1.100114    1.561953
         46  |    1.33049   .1216888    10.93   0.000     1.091934    1.569046
         47  |   1.337239   .1238068    10.80   0.000     1.094531    1.579947
         48  |   1.398151   .1270742    11.00   0.000     1.149037    1.647265
         49  |   1.362769   .1329584    10.25   0.000     1.102121    1.623418
         50  |   1.383413   .1343618    10.30   0.000     1.120013    1.646813
             |
     age_cat |
          1  |    .189708   .0477598     3.97   0.000     .0960806    .2833354
          2  |   .1431435   .0506138     2.83   0.005     .0439212    .2423658
          3  |   .0663599   .0535597     1.24   0.215    -.0386373    .1713571
          4  |   .0266322   .0550728     0.48   0.629    -.0813313    .1345957
          5  |   .0062523   .0575302     0.11   0.913    -.1065287    .1190333
          6  |  -.0121845   .0599576    -0.20   0.839    -.1297242    .1053552
          7  |  -.0062073    .062692    -0.10   0.921    -.1291074    .1166928
          8  |  -.0214377   .0657658    -0.33   0.744    -.1503636    .1074881
          9  |  -.0407088   .0693139    -0.59   0.557    -.1765904    .0951728
         10  |  -.0436989   .0723987    -0.60   0.546    -.1856278      .09823
         11  |  -.0372434   .0758748    -0.49   0.624    -.1859867    .1114999
         12  |  -.0359786   .0795843    -0.45   0.651     -.191994    .1200368
         13  |  -.0563144   .0832844    -0.68   0.499    -.2195834    .1069547
         14  |  -.0553737   .0871713    -0.64   0.525    -.2262624     .115515
         15  |  -.0628373   .0909904    -0.69   0.490    -.2412128    .1155383
         16  |  -.0762123    .094725    -0.80   0.421    -.2619092    .1094847
         17  |  -.0833944   .0986056    -0.85   0.398    -.2766988      .10991
         18  |  -.0842536   .1025542    -0.82   0.411    -.2852987    .1167915
         19  |  -.0852276   .1067437    -0.80   0.425    -.2944856    .1240305
         20  |   -.115562   .1149301    -1.01   0.315    -.3408686    .1097445
         25  |  -.1490634   .1291649    -1.15   0.249    -.4022756    .1041488
         30  |  -.1611992   .1590171    -1.01   0.311    -.4729331    .1505346
         40  |  -.0626221   .1765951    -0.35   0.723    -.4088154    .2835712
         50  |   .0048887   .1923044     0.03   0.980    -.3721008    .3818783
             |
       _cons |   8.495159   .0757907   112.09   0.000      8.34658    8.643737
-------------+----------------------------------------------------------------
     sigma_u |  1.1387795
     sigma_e |  .54683924
         rho |  .81261848   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1117723082010336

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    144,967
Group variable: firm_person                     Number of groups  =     15,682

R-sq:                                           Obs per group:
     within  = 0.1118                                         min =          1
     between = 0.1299                                         avg =        9.2
     overall = 0.0912                                         max =         25

                                                F(78,5715)        =      21.49
corr(u_i, Xb)  = 0.0522                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,716 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0545665   .0400459     1.36   0.173    -.0239387    .1330717
      during |   .0024772   .0109191     0.23   0.821    -.0189285    .0238828
       after |   .0273109   .0192481     1.42   0.156    -.0104226    .0650445
during_expat |   .1188198    .045532     2.61   0.009     .0295599    .2080798
 after_expat |    .200473     .05621     3.57   0.000       .09028    .3106659
             |
    ind_year |
          2  |   .0894452   .0410457     2.18   0.029     .0089799    .1699104
          3  |   .2585438   .0498832     5.18   0.000     .1607539    .3563338
          4  |   .4424475   .0531828     8.32   0.000      .338189     .546706
          5  |   .5832613   .0581578    10.03   0.000     .4692501    .6972726
          6  |    .709509   .0650176    10.91   0.000     .5820499    .8369681
          7  |   .8416508   .0680759    12.36   0.000     .7081962    .9751053
          8  |   .9140943   .0701688    13.03   0.000     .7765369    1.051652
          9  |    1.01636   .0731484    13.89   0.000     .8729615    1.159759
         10  |   1.115834   .0763097    14.62   0.000     .9662385    1.265431
         11  |   1.147683   .0806848    14.22   0.000     .9895099    1.305856
         12  |   1.154598   .0843271    13.69   0.000     .9892847    1.319911
         13  |   1.193196   .0884972    13.48   0.000     1.019708    1.366684
         14  |   1.212588    .091854    13.20   0.000     1.032519    1.392657
         15  |   1.283464   .0960372    13.36   0.000     1.095195    1.471734
         16  |   1.307559   .0992681    13.17   0.000     1.112956    1.502163
         17  |   1.354398   .1029276    13.16   0.000     1.152621    1.556175
         18  |   1.273788   .1063517    11.98   0.000     1.065298    1.482278
         19  |   1.285466   .1098991    11.70   0.000     1.070022     1.50091
         20  |   1.340566   .1132552    11.84   0.000     1.118543     1.56259
         21  |   1.356914    .116259    11.67   0.000     1.129002    1.584826
         22  |   1.408581   .1195286    11.78   0.000      1.17426    1.642903
         23  |   1.442478   .1226132    11.76   0.000      1.20211    1.682846
         24  |   1.477175   .1255946    11.76   0.000     1.230962    1.723388
         25  |   1.456483   .1288348    11.31   0.000     1.203918    1.709048
         26  |  -.5695101   .0918343    -6.20   0.000    -.7495402     -.38948
         27  |  -.3431637   .0951013    -3.61   0.000    -.5295983   -.1567292
         28  |  -.1566036   .0949581    -1.65   0.099    -.3427575    .0295503
         29  |   .1093103   .0888772     1.23   0.219    -.0649226    .2835432
         30  |   .2316293   .0854995     2.71   0.007      .064018    .3992407
         31  |   .3978658   .0844851     4.71   0.000     .2322429    .5634886
         32  |    .538358   .0847479     6.35   0.000       .37222    .7044961
         33  |   .5496983   .0847477     6.49   0.000     .3835607     .715836
         34  |   .7081456    .087203     8.12   0.000     .5371946    .8790966
         35  |   .7955765    .089199     8.92   0.000     .6207126    .9704405
         36  |   .8104629   .0906096     8.94   0.000     .6328338    .9880919
         37  |   .8818756   .0926663     9.52   0.000     .7002144    1.063537
         38  |   .9873348   .0955583    10.33   0.000     .8000044    1.174665
         39  |   1.014176   .0983429    10.31   0.000     .8213865    1.206965
         40  |   1.113039   .1024157    10.87   0.000     .9122654    1.313813
         41  |   1.183738   .1051968    11.25   0.000     .9775124    1.389964
         42  |   1.252607   .1077638    11.62   0.000     1.041349    1.463865
         43  |   1.188803    .111393    10.67   0.000     .9704302    1.407175
         44  |   1.252118   .1146405    10.92   0.000     1.027379    1.476857
         45  |   1.331033   .1177933    11.30   0.000     1.100114    1.561953
         46  |    1.33049   .1216888    10.93   0.000     1.091934    1.569046
         47  |   1.337239   .1238068    10.80   0.000     1.094531    1.579947
         48  |   1.398151   .1270742    11.00   0.000     1.149037    1.647265
         49  |   1.362769   .1329584    10.25   0.000     1.102121    1.623418
         50  |   1.383413   .1343618    10.30   0.000     1.120013    1.646813
             |
     age_cat |
          1  |    .189708   .0477598     3.97   0.000     .0960806    .2833354
          2  |   .1431435   .0506138     2.83   0.005     .0439212    .2423658
          3  |   .0663599   .0535597     1.24   0.215    -.0386373    .1713571
          4  |   .0266322   .0550728     0.48   0.629    -.0813313    .1345957
          5  |   .0062523   .0575302     0.11   0.913    -.1065287    .1190333
          6  |  -.0121845   .0599576    -0.20   0.839    -.1297242    .1053552
          7  |  -.0062073    .062692    -0.10   0.921    -.1291074    .1166928
          8  |  -.0214377   .0657658    -0.33   0.744    -.1503636    .1074881
          9  |  -.0407088   .0693139    -0.59   0.557    -.1765904    .0951728
         10  |  -.0436989   .0723987    -0.60   0.546    -.1856278      .09823
         11  |  -.0372434   .0758748    -0.49   0.624    -.1859867    .1114999
         12  |  -.0359786   .0795843    -0.45   0.651     -.191994    .1200368
         13  |  -.0563144   .0832844    -0.68   0.499    -.2195834    .1069547
         14  |  -.0553737   .0871713    -0.64   0.525    -.2262624     .115515
         15  |  -.0628373   .0909904    -0.69   0.490    -.2412128    .1155383
         16  |  -.0762123    .094725    -0.80   0.421    -.2619092    .1094847
         17  |  -.0833944   .0986056    -0.85   0.398    -.2766988      .10991
         18  |  -.0842536   .1025542    -0.82   0.411    -.2852987    .1167915
         19  |  -.0852276   .1067437    -0.80   0.425    -.2944856    .1240305
         20  |   -.115562   .1149301    -1.01   0.315    -.3408686    .1097445
         25  |  -.1490634   .1291649    -1.15   0.249    -.4022756    .1041488
         30  |  -.1611992   .1590171    -1.01   0.311    -.4729331    .1505346
         40  |  -.0626221   .1765951    -0.35   0.723    -.4088154    .2835712
         50  |   .0048887   .1923044     0.03   0.980    -.3721008    .3818783
             |
       _cons |   8.495159   .0757907   112.09   0.000      8.34658    8.643737
-------------+----------------------------------------------------------------
     sigma_u |  1.1387795
     sigma_e |  .54683924
         rho |  .81261848   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    132749
Group variable: firm_person                     Number of groups   =     14465

R-sq:  within  = 0.2010                         Obs per group: min =         1
       between = 0.1773                                        avg =       9.2
       overall = 0.1557                                        max =        25

                                                F(78,4832)         =     41.10
corr(u_i, Xb)  = 0.0973                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,833 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0899858   .0411339     2.19   0.029     .0093446     .170627
      during |   .0385141   .0121461     3.17   0.002     .0147022     .062326
       after |   .1110308   .0211081     5.26   0.000     .0696493    .1524123
during_expat |   .1341318   .0408247     3.29   0.001     .0540968    .2141668
 after_expat |   .1981173    .047026     4.21   0.000      .105925    .2903096
             |
    ind_year |
          2  |   .0689698    .040113     1.72   0.086    -.0096698    .1476095
          3  |   .2894896   .0494486     5.85   0.000     .1925478    .3864314
          4  |     .48156   .0523762     9.19   0.000     .3788788    .5842412
          5  |   .6220966     .06062    10.26   0.000     .5032539    .7409392
          6  |   .7564006   .0672566    11.25   0.000      .624547    .8882541
          7  |   .8875131   .0697131    12.73   0.000     .7508437    1.024182
          8  |   .9399348   .0724653    12.97   0.000     .7978699       1.082
          9  |   1.069318   .0755884    14.15   0.000     .9211303    1.217506
         10  |   1.168827   .0783811    14.91   0.000     1.015164    1.322489
         11  |   1.216629   .0824449    14.76   0.000     1.054999    1.378259
         12  |   1.208959   .0864399    13.99   0.000     1.039497    1.378421
         13  |   1.243905   .0905293    13.74   0.000     1.066427    1.421384
         14  |   1.249893   .0935444    13.36   0.000     1.066503    1.433282
         15  |   1.324139   .0975765    13.57   0.000     1.132844    1.515433
         16  |   1.338291   .1002219    13.35   0.000      1.14181    1.534771
         17  |   1.378785   .1033517    13.34   0.000     1.176169    1.581401
         18  |    1.29819   .1064993    12.19   0.000     1.089403    1.506977
         19  |    1.33402   .1087833    12.26   0.000     1.120755    1.547285
         20  |   1.399776   .1115086    12.55   0.000     1.181168    1.618383
         21  |    1.40718   .1134604    12.40   0.000     1.184745    1.629614
         22  |    1.45523   .1167435    12.47   0.000      1.22636      1.6841
         23  |   1.471325    .119229    12.34   0.000     1.237582    1.705068
         24  |   1.506369   .1217613    12.37   0.000     1.267662    1.745077
         25  |   1.496241   .1240291    12.06   0.000     1.253087    1.739394
         26  |  -.5247251   .0838795    -6.26   0.000     -.689167   -.3602832
         27  |  -.3194993   .0849642    -3.76   0.000    -.4860677   -.1529308
         28  |  -.1346229   .0822209    -1.64   0.102    -.2958133    .0265675
         29  |   .0971378   .0817915     1.19   0.235    -.0632108    .2574863
         30  |   .2596965   .0814159     3.19   0.001     .1000843    .4193086
         31  |   .4110138    .081499     5.04   0.000     .2512386     .570789
         32  |   .5799796   .0830089     6.99   0.000     .4172444    .7427149
         33  |   .6400574   .0837378     7.64   0.000     .4758932    .8042216
         34  |   .7884578   .0863379     9.13   0.000     .6191962    .9577193
         35  |   .8546472   .0887363     9.63   0.000     .6806836    1.028611
         36  |   .8854519   .0909118     9.74   0.000     .7072234     1.06368
         37  |   .9549956   .0927827    10.29   0.000     .7730993    1.136892
         38  |   1.024293   .0957981    10.69   0.000     .8364855    1.212101
         39  |   1.055465   .0985767    10.71   0.000     .8622099     1.24872
         40  |   1.162053   .1019506    11.40   0.000     .9621829    1.361922
         41  |   1.220636   .1042125    11.71   0.000     1.016332    1.424939
         42  |   1.285393   .1068308    12.03   0.000     1.075956     1.49483
         43  |   1.217872    .109693    11.10   0.000     1.002824     1.43292
         44  |   1.264893   .1125957    11.23   0.000     1.044154    1.485632
         45  |   1.369659   .1149357    11.92   0.000     1.144333    1.594986
         46  |   1.342527   .1185936    11.32   0.000     1.110029    1.575024
         47  |   1.361907   .1199432    11.35   0.000     1.126763     1.59705
         48  |   1.433218   .1221772    11.73   0.000     1.193696    1.672741
         49  |   1.424359   .1263748    11.27   0.000     1.176607    1.672111
         50  |   1.420838   .1290529    11.01   0.000     1.167836     1.67384
             |
     age_cat |
          1  |   .3619148   .0588065     6.15   0.000     .2466273    .4772024
          2  |   .3191446   .0633216     5.04   0.000     .1950055    .4432837
          3  |   .2860187   .0666666     4.29   0.000     .1553218    .4167157
          4  |   .2567332   .0690335     3.72   0.000      .121396    .3920703
          5  |   .2508606   .0712039     3.52   0.000     .1112686    .3904526
          6  |   .2487559   .0729766     3.41   0.001     .1056886    .3918232
          7  |   .2352268   .0750263     3.14   0.002     .0881412    .3823124
          8  |   .2358918    .077913     3.03   0.002     .0831469    .3886367
          9  |   .2372314   .0804961     2.95   0.003     .0794225    .3950403
         10  |   .2296757   .0837012     2.74   0.006     .0655833    .3937682
         11  |   .2433803   .0866282     2.81   0.005     .0735496    .4132109
         12  |   .2588985   .0896212     2.89   0.004     .0832002    .4345968
         13  |   .2448927   .0930405     2.63   0.009     .0624909    .4272944
         14  |   .2589453   .0961484     2.69   0.007     .0704507    .4474399
         15  |   .2596306   .0992734     2.62   0.009     .0650095    .4542517
         16  |   .2779335   .1023139     2.72   0.007     .0773516    .4785153
         17  |   .2492107   .1053299     2.37   0.018     .0427162    .4557051
         18  |   .2656832   .1085377     2.45   0.014     .0528999    .4784665
         19  |   .2446803   .1120632     2.18   0.029     .0249855    .4643751
         20  |   .2325116   .1183487     1.96   0.050     .0004943     .464529
         25  |   .1988204   .1299474     1.53   0.126    -.0559356    .4535765
         30  |   .2275766   .1578954     1.44   0.150    -.0819702    .5371233
         40  |   .2879701   .1738917     1.66   0.098    -.0529367     .628877
         50  |   .3465076   .1878042     1.85   0.065    -.0216741    .7146893
             |
       _cons |   7.809877   .0877493    89.00   0.000     7.637849    7.981906
-------------+----------------------------------------------------------------
     sigma_u |  1.1429142
     sigma_e |  .53024448
         rho |  .82288204   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2009899814726758

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    132,749
Group variable: firm_person                     Number of groups  =     14,465

R-sq:                                           Obs per group:
     within  = 0.2010                                         min =          1
     between = 0.1773                                         avg =        9.2
     overall = 0.1557                                         max =         25

                                                F(78,4832)        =      41.10
corr(u_i, Xb)  = 0.0973                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,833 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0899858   .0411339     2.19   0.029     .0093446     .170627
      during |   .0385141   .0121461     3.17   0.002     .0147022     .062326
       after |   .1110308   .0211081     5.26   0.000     .0696493    .1524123
during_expat |   .1341318   .0408247     3.29   0.001     .0540968    .2141668
 after_expat |   .1981173    .047026     4.21   0.000      .105925    .2903096
             |
    ind_year |
          2  |   .0689698    .040113     1.72   0.086    -.0096698    .1476095
          3  |   .2894896   .0494486     5.85   0.000     .1925478    .3864314
          4  |     .48156   .0523762     9.19   0.000     .3788788    .5842412
          5  |   .6220966     .06062    10.26   0.000     .5032539    .7409392
          6  |   .7564006   .0672566    11.25   0.000      .624547    .8882541
          7  |   .8875131   .0697131    12.73   0.000     .7508437    1.024182
          8  |   .9399348   .0724653    12.97   0.000     .7978699       1.082
          9  |   1.069318   .0755884    14.15   0.000     .9211303    1.217506
         10  |   1.168827   .0783811    14.91   0.000     1.015164    1.322489
         11  |   1.216629   .0824449    14.76   0.000     1.054999    1.378259
         12  |   1.208959   .0864399    13.99   0.000     1.039497    1.378421
         13  |   1.243905   .0905293    13.74   0.000     1.066427    1.421384
         14  |   1.249893   .0935444    13.36   0.000     1.066503    1.433282
         15  |   1.324139   .0975765    13.57   0.000     1.132844    1.515433
         16  |   1.338291   .1002219    13.35   0.000      1.14181    1.534771
         17  |   1.378785   .1033517    13.34   0.000     1.176169    1.581401
         18  |    1.29819   .1064993    12.19   0.000     1.089403    1.506977
         19  |    1.33402   .1087833    12.26   0.000     1.120755    1.547285
         20  |   1.399776   .1115086    12.55   0.000     1.181168    1.618383
         21  |    1.40718   .1134604    12.40   0.000     1.184745    1.629614
         22  |    1.45523   .1167435    12.47   0.000      1.22636      1.6841
         23  |   1.471325    .119229    12.34   0.000     1.237582    1.705068
         24  |   1.506369   .1217613    12.37   0.000     1.267662    1.745077
         25  |   1.496241   .1240291    12.06   0.000     1.253087    1.739394
         26  |  -.5247251   .0838795    -6.26   0.000     -.689167   -.3602832
         27  |  -.3194993   .0849642    -3.76   0.000    -.4860677   -.1529308
         28  |  -.1346229   .0822209    -1.64   0.102    -.2958133    .0265675
         29  |   .0971378   .0817915     1.19   0.235    -.0632108    .2574863
         30  |   .2596965   .0814159     3.19   0.001     .1000843    .4193086
         31  |   .4110138    .081499     5.04   0.000     .2512386     .570789
         32  |   .5799796   .0830089     6.99   0.000     .4172444    .7427149
         33  |   .6400574   .0837378     7.64   0.000     .4758932    .8042216
         34  |   .7884578   .0863379     9.13   0.000     .6191962    .9577193
         35  |   .8546472   .0887363     9.63   0.000     .6806836    1.028611
         36  |   .8854519   .0909118     9.74   0.000     .7072234     1.06368
         37  |   .9549956   .0927827    10.29   0.000     .7730993    1.136892
         38  |   1.024293   .0957981    10.69   0.000     .8364855    1.212101
         39  |   1.055465   .0985767    10.71   0.000     .8622099     1.24872
         40  |   1.162053   .1019506    11.40   0.000     .9621829    1.361922
         41  |   1.220636   .1042125    11.71   0.000     1.016332    1.424939
         42  |   1.285393   .1068308    12.03   0.000     1.075956     1.49483
         43  |   1.217872    .109693    11.10   0.000     1.002824     1.43292
         44  |   1.264893   .1125957    11.23   0.000     1.044154    1.485632
         45  |   1.369659   .1149357    11.92   0.000     1.144333    1.594986
         46  |   1.342527   .1185936    11.32   0.000     1.110029    1.575024
         47  |   1.361907   .1199432    11.35   0.000     1.126763     1.59705
         48  |   1.433218   .1221772    11.73   0.000     1.193696    1.672741
         49  |   1.424359   .1263748    11.27   0.000     1.176607    1.672111
         50  |   1.420838   .1290529    11.01   0.000     1.167836     1.67384
             |
     age_cat |
          1  |   .3619148   .0588065     6.15   0.000     .2466273    .4772024
          2  |   .3191446   .0633216     5.04   0.000     .1950055    .4432837
          3  |   .2860187   .0666666     4.29   0.000     .1553218    .4167157
          4  |   .2567332   .0690335     3.72   0.000      .121396    .3920703
          5  |   .2508606   .0712039     3.52   0.000     .1112686    .3904526
          6  |   .2487559   .0729766     3.41   0.001     .1056886    .3918232
          7  |   .2352268   .0750263     3.14   0.002     .0881412    .3823124
          8  |   .2358918    .077913     3.03   0.002     .0831469    .3886367
          9  |   .2372314   .0804961     2.95   0.003     .0794225    .3950403
         10  |   .2296757   .0837012     2.74   0.006     .0655833    .3937682
         11  |   .2433803   .0866282     2.81   0.005     .0735496    .4132109
         12  |   .2588985   .0896212     2.89   0.004     .0832002    .4345968
         13  |   .2448927   .0930405     2.63   0.009     .0624909    .4272944
         14  |   .2589453   .0961484     2.69   0.007     .0704507    .4474399
         15  |   .2596306   .0992734     2.62   0.009     .0650095    .4542517
         16  |   .2779335   .1023139     2.72   0.007     .0773516    .4785153
         17  |   .2492107   .1053299     2.37   0.018     .0427162    .4557051
         18  |   .2656832   .1085377     2.45   0.014     .0528999    .4784665
         19  |   .2446803   .1120632     2.18   0.029     .0249855    .4643751
         20  |   .2325116   .1183487     1.96   0.050     .0004943     .464529
         25  |   .1988204   .1299474     1.53   0.126    -.0559356    .4535765
         30  |   .2275766   .1578954     1.44   0.150    -.0819702    .5371233
         40  |   .2879701   .1738917     1.66   0.098    -.0529367     .628877
         50  |   .3465076   .1878042     1.85   0.065    -.0216741    .7146893
             |
       _cons |   7.809877   .0877493    89.00   0.000     7.637849    7.981906
-------------+----------------------------------------------------------------
     sigma_u |  1.1429142
     sigma_e |  .53024448
         rho |  .82288204   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    382405
Group variable: firm_person                     Number of groups   =     40681

R-sq:  within  = 0.0392                         Obs per group: min =         1
       between = 0.1086                                        avg =       9.4
       overall = 0.0788                                        max =        25

                                                F(78,14145)        =     24.81
corr(u_i, Xb)  = 0.1535                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,146 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0287027   .0111732     2.57   0.010     .0068019    .0506036
      during |  -.0049608   .0033965    -1.46   0.144    -.0116183    .0016968
       after |  -.0192071   .0055314    -3.47   0.001    -.0300493   -.0083648
during_expat |  -.0002362   .0059529    -0.04   0.968    -.0119047    .0114322
 after_expat |  -.0062586   .0079813    -0.78   0.433    -.0219029    .0093857
             |
    ind_year |
          2  |   -.011199   .0125317    -0.89   0.372    -.0357629    .0133648
          3  |  -.0281013   .0141278    -1.99   0.047    -.0557936   -.0004089
          4  |  -.0444519    .015289    -2.91   0.004    -.0744204   -.0144835
          5  |  -.0371746   .0166283    -2.24   0.025    -.0697683    -.004581
          6  |  -.0650304   .0174046    -3.74   0.000    -.0991457   -.0309152
          7  |  -.0673743   .0181819    -3.71   0.000    -.1030131   -.0317354
          8  |  -.0811911   .0191865    -4.23   0.000    -.1187991   -.0435831
          9  |  -.0908614   .0204396    -4.45   0.000    -.1309257   -.0507971
         10  |  -.0910109   .0213167    -4.27   0.000    -.1327945   -.0492273
         11  |  -.0945467   .0223762    -4.23   0.000     -.138407   -.0506864
         12  |  -.1044063   .0234682    -4.45   0.000    -.1504071   -.0584055
         13  |  -.1011506    .024606    -4.11   0.000    -.1493815   -.0529197
         14  |  -.0945077   .0257992    -3.66   0.000    -.1450776   -.0439378
         15  |  -.0896822   .0269134    -3.33   0.001    -.1424361   -.0369283
         16  |   -.074547   .0280738    -2.66   0.008    -.1295753   -.0195186
         17  |  -.0626981   .0293454    -2.14   0.033     -.120219   -.0051772
         18  |  -.0563375   .0305516    -1.84   0.065    -.1162227    .0035477
         19  |  -.0577432   .0317019    -1.82   0.069    -.1198831    .0043966
         20  |  -.0547695   .0327947    -1.67   0.095    -.1190514    .0095124
         21  |  -.0553621   .0338304    -1.64   0.102    -.1216741      .01095
         22  |  -.0456993   .0347721    -1.31   0.189    -.1138572    .0224586
         23  |  -.0599932   .0356616    -1.68   0.093    -.1298947    .0099083
         24  |  -.1499795   .0367032    -4.09   0.000    -.2219227   -.0780364
         25  |  -.1819755     .03795    -4.80   0.000    -.2563625   -.1075885
         26  |   .1188369   .0261109     4.55   0.000     .0676561    .1700177
         27  |   .0686954   .0239158     2.87   0.004     .0218172    .1155736
         28  |   .0852517   .0226369     3.77   0.000     .0408804     .129623
         29  |   .0589102   .0224149     2.63   0.009      .014974    .1028464
         30  |   .0634595   .0217134     2.92   0.003     .0208984    .1060205
         31  |    .039741   .0218866     1.82   0.069    -.0031597    .0826417
         32  |   .0367327   .0221338     1.66   0.097    -.0066526    .0801179
         33  |   .0331031   .0221589     1.49   0.135    -.0103313    .0765375
         34  |   .0186911   .0230341     0.81   0.417    -.0264587    .0638409
         35  |   .0178696   .0236808     0.75   0.450    -.0285478     .064287
         36  |   .0151894   .0246133     0.62   0.537    -.0330558    .0634347
         37  |   .0061323   .0254418     0.24   0.810    -.0437369    .0560015
         38  |    .008739   .0263694     0.33   0.740    -.0429485    .0604266
         39  |   .0010018   .0275765     0.04   0.971    -.0530518    .0550554
         40  |  -.0026592   .0284993    -0.09   0.926    -.0585216    .0532033
         41  |   .0074674   .0295073     0.25   0.800    -.0503708    .0653057
         42  |   .0068504   .0306329     0.22   0.823    -.0531941     .066895
         43  |   .0082337   .0318234     0.26   0.796    -.0541443    .0706118
         44  |   .0164697   .0329355     0.50   0.617    -.0480883    .0810276
         45  |    .019822   .0341445     0.58   0.562    -.0471057    .0867497
         46  |   .0243942   .0353165     0.69   0.490    -.0448307    .0936191
         47  |   .0247607   .0362809     0.68   0.495    -.0463546     .095876
         48  |   .0136201   .0371286     0.37   0.714    -.0591568    .0863971
         49  |  -.2106356   .0383649    -5.49   0.000    -.2858357   -.1354354
         50  |  -.2600452   .0396088    -6.57   0.000    -.3376836   -.1824068
             |
     age_cat |
          1  |   .0600882   .0085532     7.03   0.000     .0433227    .0768537
          2  |   .0931864   .0094527     9.86   0.000     .0746579    .1117148
          3  |   .1160843   .0102963    11.27   0.000     .0959022    .1362665
          4  |   .1460255   .0113342    12.88   0.000     .1238089    .1682421
          5  |   .1672816   .0123197    13.58   0.000     .1431334    .1914298
          6  |   .1794165   .0134775    13.31   0.000     .1529989    .2058341
          7  |   .1889539   .0146414    12.91   0.000     .1602549    .2176529
          8  |   .2039882   .0158121    12.90   0.000     .1729944     .234982
          9  |   .2147233   .0171028    12.55   0.000     .1811995     .248247
         10  |   .2201973   .0183998    11.97   0.000     .1841314    .2562633
         11  |   .2347843   .0196787    11.93   0.000     .1962115    .2733572
         12  |   .2424535   .0209493    11.57   0.000     .2013902    .2835168
         13  |   .2461996   .0223049    11.04   0.000     .2024791    .2899202
         14  |   .2546296   .0236572    10.76   0.000     .2082583    .3010009
         15  |    .267132   .0249053    10.73   0.000     .2183143    .3159497
         16  |   .2777856   .0262686    10.57   0.000     .2262957    .3292755
         17  |   .2835977   .0276061    10.27   0.000     .2294861    .3377093
         18  |   .2860945   .0290221     9.86   0.000     .2292074    .3429815
         19  |   .2886381   .0305323     9.45   0.000     .2287908    .3484855
         20  |   .2919527    .032753     8.91   0.000     .2277526    .3561528
         25  |   .2890722   .0372762     7.75   0.000     .2160059    .3621385
         30  |   .3121075   .0513529     6.08   0.000      .211449     .412766
         40  |   .2877206   .0570002     5.05   0.000     .1759926    .3994486
         50  |   .2276471   .0620453     3.67   0.000     .1060301    .3492641
             |
       _cons |   .2678822   .0177275    15.11   0.000      .233134    .3026303
-------------+----------------------------------------------------------------
     sigma_u |  .41204522
     sigma_e |  .28325626
         rho |   .6790833   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0391808374268477

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    382,405
Group variable: firm_person                     Number of groups  =     40,681

R-sq:                                           Obs per group:
     within  = 0.0392                                         min =          1
     between = 0.1086                                         avg =        9.4
     overall = 0.0788                                         max =         25

                                                F(78,14145)       =      24.81
corr(u_i, Xb)  = 0.1535                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,146 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0287027   .0111732     2.57   0.010     .0068019    .0506036
      during |  -.0049608   .0033965    -1.46   0.144    -.0116183    .0016968
       after |  -.0192071   .0055314    -3.47   0.001    -.0300493   -.0083648
during_expat |  -.0002362   .0059529    -0.04   0.968    -.0119047    .0114322
 after_expat |  -.0062586   .0079813    -0.78   0.433    -.0219029    .0093857
             |
    ind_year |
          2  |   -.011199   .0125317    -0.89   0.372    -.0357629    .0133648
          3  |  -.0281013   .0141278    -1.99   0.047    -.0557936   -.0004089
          4  |  -.0444519    .015289    -2.91   0.004    -.0744204   -.0144835
          5  |  -.0371746   .0166283    -2.24   0.025    -.0697683    -.004581
          6  |  -.0650304   .0174046    -3.74   0.000    -.0991457   -.0309152
          7  |  -.0673743   .0181819    -3.71   0.000    -.1030131   -.0317354
          8  |  -.0811911   .0191865    -4.23   0.000    -.1187991   -.0435831
          9  |  -.0908614   .0204396    -4.45   0.000    -.1309257   -.0507971
         10  |  -.0910109   .0213167    -4.27   0.000    -.1327945   -.0492273
         11  |  -.0945467   .0223762    -4.23   0.000     -.138407   -.0506864
         12  |  -.1044063   .0234682    -4.45   0.000    -.1504071   -.0584055
         13  |  -.1011506    .024606    -4.11   0.000    -.1493815   -.0529197
         14  |  -.0945077   .0257992    -3.66   0.000    -.1450776   -.0439378
         15  |  -.0896822   .0269134    -3.33   0.001    -.1424361   -.0369283
         16  |   -.074547   .0280738    -2.66   0.008    -.1295753   -.0195186
         17  |  -.0626981   .0293454    -2.14   0.033     -.120219   -.0051772
         18  |  -.0563375   .0305516    -1.84   0.065    -.1162227    .0035477
         19  |  -.0577432   .0317019    -1.82   0.069    -.1198831    .0043966
         20  |  -.0547695   .0327947    -1.67   0.095    -.1190514    .0095124
         21  |  -.0553621   .0338304    -1.64   0.102    -.1216741      .01095
         22  |  -.0456993   .0347721    -1.31   0.189    -.1138572    .0224586
         23  |  -.0599932   .0356616    -1.68   0.093    -.1298947    .0099083
         24  |  -.1499795   .0367032    -4.09   0.000    -.2219227   -.0780364
         25  |  -.1819755     .03795    -4.80   0.000    -.2563625   -.1075885
         26  |   .1188369   .0261109     4.55   0.000     .0676561    .1700177
         27  |   .0686954   .0239158     2.87   0.004     .0218172    .1155736
         28  |   .0852517   .0226369     3.77   0.000     .0408804     .129623
         29  |   .0589102   .0224149     2.63   0.009      .014974    .1028464
         30  |   .0634595   .0217134     2.92   0.003     .0208984    .1060205
         31  |    .039741   .0218866     1.82   0.069    -.0031597    .0826417
         32  |   .0367327   .0221338     1.66   0.097    -.0066526    .0801179
         33  |   .0331031   .0221589     1.49   0.135    -.0103313    .0765375
         34  |   .0186911   .0230341     0.81   0.417    -.0264587    .0638409
         35  |   .0178696   .0236808     0.75   0.450    -.0285478     .064287
         36  |   .0151894   .0246133     0.62   0.537    -.0330558    .0634347
         37  |   .0061323   .0254418     0.24   0.810    -.0437369    .0560015
         38  |    .008739   .0263694     0.33   0.740    -.0429485    .0604266
         39  |   .0010018   .0275765     0.04   0.971    -.0530518    .0550554
         40  |  -.0026592   .0284993    -0.09   0.926    -.0585216    .0532033
         41  |   .0074674   .0295073     0.25   0.800    -.0503708    .0653057
         42  |   .0068504   .0306329     0.22   0.823    -.0531941     .066895
         43  |   .0082337   .0318234     0.26   0.796    -.0541443    .0706118
         44  |   .0164697   .0329355     0.50   0.617    -.0480883    .0810276
         45  |    .019822   .0341445     0.58   0.562    -.0471057    .0867497
         46  |   .0243942   .0353165     0.69   0.490    -.0448307    .0936191
         47  |   .0247607   .0362809     0.68   0.495    -.0463546     .095876
         48  |   .0136201   .0371286     0.37   0.714    -.0591568    .0863971
         49  |  -.2106356   .0383649    -5.49   0.000    -.2858357   -.1354354
         50  |  -.2600452   .0396088    -6.57   0.000    -.3376836   -.1824068
             |
     age_cat |
          1  |   .0600882   .0085532     7.03   0.000     .0433227    .0768537
          2  |   .0931864   .0094527     9.86   0.000     .0746579    .1117148
          3  |   .1160843   .0102963    11.27   0.000     .0959022    .1362665
          4  |   .1460255   .0113342    12.88   0.000     .1238089    .1682421
          5  |   .1672816   .0123197    13.58   0.000     .1431334    .1914298
          6  |   .1794165   .0134775    13.31   0.000     .1529989    .2058341
          7  |   .1889539   .0146414    12.91   0.000     .1602549    .2176529
          8  |   .2039882   .0158121    12.90   0.000     .1729944     .234982
          9  |   .2147233   .0171028    12.55   0.000     .1811995     .248247
         10  |   .2201973   .0183998    11.97   0.000     .1841314    .2562633
         11  |   .2347843   .0196787    11.93   0.000     .1962115    .2733572
         12  |   .2424535   .0209493    11.57   0.000     .2013902    .2835168
         13  |   .2461996   .0223049    11.04   0.000     .2024791    .2899202
         14  |   .2546296   .0236572    10.76   0.000     .2082583    .3010009
         15  |    .267132   .0249053    10.73   0.000     .2183143    .3159497
         16  |   .2777856   .0262686    10.57   0.000     .2262957    .3292755
         17  |   .2835977   .0276061    10.27   0.000     .2294861    .3377093
         18  |   .2860945   .0290221     9.86   0.000     .2292074    .3429815
         19  |   .2886381   .0305323     9.45   0.000     .2287908    .3484855
         20  |   .2919527    .032753     8.91   0.000     .2277526    .3561528
         25  |   .2890722   .0372762     7.75   0.000     .2160059    .3621385
         30  |   .3121075   .0513529     6.08   0.000      .211449     .412766
         40  |   .2877206   .0570002     5.05   0.000     .1759926    .3994486
         50  |   .2276471   .0620453     3.67   0.000     .1060301    .3492641
             |
       _cons |   .2678822   .0177275    15.11   0.000      .233134    .3026303
-------------+----------------------------------------------------------------
     sigma_u |  .41204522
     sigma_e |  .28325626
         rho |   .6790833   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1, 14145) =    2.13
            Prob > F =    0.1442

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14145) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1, 14145) =   13.77
            Prob > F =    0.0002

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14145) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1, 14145) =    0.00
            Prob > F =    0.9683

 ( 1)  during_expat = 0

       F(  1, 14145) =    0.00
            Prob > F =    0.9683
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1, 14145) =    0.95
            Prob > F =    0.3306

 ( 1)  after_expat = 0

       F(  1, 14145) =    0.61
            Prob > F =    0.4330
(file output/figure/baseline_exporter_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    127139
Group variable: firm_person                     Number of groups   =     14598

R-sq:  within  = 0.0585                         Obs per group: min =         1
       between = 0.0244                                        avg =       8.7
       overall = 0.0222                                        max =        25

                                                F(53,5219)         =     18.26
corr(u_i, Xb)  = -0.0480                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,220 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0279425    .019216     1.45   0.146     -.009729    .0656139
      during |  -.0114257   .0065506    -1.74   0.081    -.0242676    .0014162
       after |   -.027175   .0104972    -2.59   0.010    -.0477539    -.006596
during_expat |  -.0136359   .0083945    -1.62   0.104    -.0300926    .0028208
 after_expat |  -.0300159   .0113718    -2.64   0.008    -.0523095   -.0077224
             |
    ind_year |
         27  |  -.0538581   .0158777    -3.39   0.001    -.0849852   -.0227311
         28  |  -.0338077   .0179624    -1.88   0.060    -.0690216    .0014062
         29  |  -.0683932   .0199757    -3.42   0.001    -.1075539   -.0292325
         30  |  -.0574552   .0231986    -2.48   0.013    -.1029341   -.0119763
         31  |  -.0819296   .0255722    -3.20   0.001    -.1320619   -.0317974
         32  |  -.0853076   .0281157    -3.03   0.002    -.1404262   -.0301889
         33  |   -.093105   .0304926    -3.05   0.002    -.1528832   -.0333268
         34  |  -.1102093   .0331932    -3.32   0.001    -.1752818   -.0451368
         35  |  -.1159105    .035341    -3.28   0.001    -.1851937   -.0466273
         36  |  -.1212348   .0380558    -3.19   0.001    -.1958401   -.0466296
         37  |  -.1349987    .040358    -3.35   0.001    -.2141174     -.05588
         38  |  -.1361707   .0428634    -3.18   0.001     -.220201   -.0521404
         39  |  -.1464489   .0455256    -3.22   0.001    -.2356982   -.0571997
         40  |  -.1543422   .0476835    -3.24   0.001    -.2478218   -.0608627
         41  |  -.1455391   .0502903    -2.89   0.004    -.2441291   -.0469491
         42  |  -.1476892   .0527452    -2.80   0.005    -.2510919   -.0442865
         43  |  -.1449849   .0553353    -2.62   0.009    -.2534651   -.0365046
         44  |  -.1413076   .0577306    -2.45   0.014    -.2544837   -.0281315
         45  |  -.1400744   .0603775    -2.32   0.020    -.2584396   -.0217091
         46  |  -.1364222   .0627937    -2.17   0.030     -.259524   -.0133203
         47  |  -.1361612   .0648081    -2.10   0.036    -.2632122   -.0091102
         48  |  -.1493516   .0666699    -2.24   0.025    -.2800524   -.0186507
         49  |  -.3853632   .0688357    -5.60   0.000      -.52031   -.2504164
         50  |  -.4348476   .0712264    -6.11   0.000    -.5744812    -.295214
             |
     age_cat |
          1  |   .1032955   .0172128     6.00   0.000     .0695512    .1370399
          2  |   .1374808   .0189044     7.27   0.000     .1004203    .1745414
          3  |   .1677975   .0202896     8.27   0.000     .1280213    .2075737
          4  |   .1987412   .0226111     8.79   0.000      .154414    .2430684
          5  |   .2130496   .0245661     8.67   0.000     .1648897    .2612095
          6  |   .2368739   .0268778     8.81   0.000     .1841821    .2895657
          7  |   .2474977   .0293092     8.44   0.000     .1900394     .304956
          8  |   .2575265   .0317112     8.12   0.000     .1953593    .3196937
          9  |   .2833259   .0339674     8.34   0.000     .2167357    .3499162
         10  |   .2892636   .0364901     7.93   0.000     .2177278    .3607994
         11  |   .3077791   .0388736     7.92   0.000     .2315706    .3839876
         12  |    .321929    .041227     7.81   0.000     .2411068    .4027512
         13  |   .3340607   .0437768     7.63   0.000     .2482398    .4198816
         14  |   .3439087   .0464001     7.41   0.000      .252945    .4348724
         15  |   .3707675   .0488724     7.59   0.000     .2749571    .4665779
         16  |   .3717435   .0513433     7.24   0.000     .2710891    .4723979
         17  |   .3823923   .0538537     7.10   0.000     .2768166    .4879681
         18  |   .3815568   .0564855     6.75   0.000     .2708215    .4922921
         19  |   .3803305   .0596027     6.38   0.000     .2634843    .4971767
         20  |   .3903258   .0641187     6.09   0.000     .2646264    .5160252
         25  |   .3690615    .072683     5.08   0.000     .2265724    .5115507
         30  |   .4323258   .0956891     4.52   0.000     .2447351    .6199165
         40  |   .3088891   .1165206     2.65   0.008       .08046    .5373183
         50  |   .2229482    .127753     1.75   0.081    -.0275012    .4733975
             |
       _cons |   .5363519   .0252265    21.26   0.000     .4868975    .5858063
-------------+----------------------------------------------------------------
     sigma_u |   .3695055
     sigma_e |  .28694838
         rho |  .62380414   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0585488532398616

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    127,139
Group variable: firm_person                     Number of groups  =     14,598

R-sq:                                           Obs per group:
     within  = 0.0585                                         min =          1
     between = 0.0244                                         avg =        8.7
     overall = 0.0222                                         max =         25

                                                F(53,5219)        =      18.26
corr(u_i, Xb)  = -0.0480                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,220 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0279425    .019216     1.45   0.146     -.009729    .0656139
      during |  -.0114257   .0065506    -1.74   0.081    -.0242676    .0014162
       after |   -.027175   .0104972    -2.59   0.010    -.0477539    -.006596
during_expat |  -.0136359   .0083945    -1.62   0.104    -.0300926    .0028208
 after_expat |  -.0300159   .0113718    -2.64   0.008    -.0523095   -.0077224
             |
    ind_year |
         27  |  -.0538581   .0158777    -3.39   0.001    -.0849852   -.0227311
         28  |  -.0338077   .0179624    -1.88   0.060    -.0690216    .0014062
         29  |  -.0683932   .0199757    -3.42   0.001    -.1075539   -.0292325
         30  |  -.0574552   .0231986    -2.48   0.013    -.1029341   -.0119763
         31  |  -.0819296   .0255722    -3.20   0.001    -.1320619   -.0317974
         32  |  -.0853076   .0281157    -3.03   0.002    -.1404262   -.0301889
         33  |   -.093105   .0304926    -3.05   0.002    -.1528832   -.0333268
         34  |  -.1102093   .0331932    -3.32   0.001    -.1752818   -.0451368
         35  |  -.1159105    .035341    -3.28   0.001    -.1851937   -.0466273
         36  |  -.1212348   .0380558    -3.19   0.001    -.1958401   -.0466296
         37  |  -.1349987    .040358    -3.35   0.001    -.2141174     -.05588
         38  |  -.1361707   .0428634    -3.18   0.001     -.220201   -.0521404
         39  |  -.1464489   .0455256    -3.22   0.001    -.2356982   -.0571997
         40  |  -.1543422   .0476835    -3.24   0.001    -.2478218   -.0608627
         41  |  -.1455391   .0502903    -2.89   0.004    -.2441291   -.0469491
         42  |  -.1476892   .0527452    -2.80   0.005    -.2510919   -.0442865
         43  |  -.1449849   .0553353    -2.62   0.009    -.2534651   -.0365046
         44  |  -.1413076   .0577306    -2.45   0.014    -.2544837   -.0281315
         45  |  -.1400744   .0603775    -2.32   0.020    -.2584396   -.0217091
         46  |  -.1364222   .0627937    -2.17   0.030     -.259524   -.0133203
         47  |  -.1361612   .0648081    -2.10   0.036    -.2632122   -.0091102
         48  |  -.1493516   .0666699    -2.24   0.025    -.2800524   -.0186507
         49  |  -.3853632   .0688357    -5.60   0.000      -.52031   -.2504164
         50  |  -.4348476   .0712264    -6.11   0.000    -.5744812    -.295214
             |
     age_cat |
          1  |   .1032955   .0172128     6.00   0.000     .0695512    .1370399
          2  |   .1374808   .0189044     7.27   0.000     .1004203    .1745414
          3  |   .1677975   .0202896     8.27   0.000     .1280213    .2075737
          4  |   .1987412   .0226111     8.79   0.000      .154414    .2430684
          5  |   .2130496   .0245661     8.67   0.000     .1648897    .2612095
          6  |   .2368739   .0268778     8.81   0.000     .1841821    .2895657
          7  |   .2474977   .0293092     8.44   0.000     .1900394     .304956
          8  |   .2575265   .0317112     8.12   0.000     .1953593    .3196937
          9  |   .2833259   .0339674     8.34   0.000     .2167357    .3499162
         10  |   .2892636   .0364901     7.93   0.000     .2177278    .3607994
         11  |   .3077791   .0388736     7.92   0.000     .2315706    .3839876
         12  |    .321929    .041227     7.81   0.000     .2411068    .4027512
         13  |   .3340607   .0437768     7.63   0.000     .2482398    .4198816
         14  |   .3439087   .0464001     7.41   0.000      .252945    .4348724
         15  |   .3707675   .0488724     7.59   0.000     .2749571    .4665779
         16  |   .3717435   .0513433     7.24   0.000     .2710891    .4723979
         17  |   .3823923   .0538537     7.10   0.000     .2768166    .4879681
         18  |   .3815568   .0564855     6.75   0.000     .2708215    .4922921
         19  |   .3803305   .0596027     6.38   0.000     .2634843    .4971767
         20  |   .3903258   .0641187     6.09   0.000     .2646264    .5160252
         25  |   .3690615    .072683     5.08   0.000     .2265724    .5115507
         30  |   .4323258   .0956891     4.52   0.000     .2447351    .6199165
         40  |   .3088891   .1165206     2.65   0.008       .08046    .5373183
         50  |   .2229482    .127753     1.75   0.081    -.0275012    .4733975
             |
       _cons |   .5363519   .0252265    21.26   0.000     .4868975    .5858063
-------------+----------------------------------------------------------------
     sigma_u |   .3695055
     sigma_e |  .28694838
         rho |  .62380414   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1,  5219) =    3.04
            Prob > F =    0.0812

 ( 1) = 0
       Constraint 1 dropped

       F(  0,  5219) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1,  5219) =    4.21
            Prob > F =    0.0402

 ( 1) = 0
       Constraint 1 dropped

       F(  0,  5219) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1,  5219) =    2.64
            Prob > F =    0.1044

 ( 1)  during_expat = 0

       F(  1,  5219) =    2.64
            Prob > F =    0.1044
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1,  5219) =    2.94
            Prob > F =    0.0866

 ( 1)  after_expat = 0

       F(  1,  5219) =    6.97
            Prob > F =    0.0083
variable label was str12 now str13
(1 real change made)
(file output/figure/manufacturing_exporter_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    265452
Group variable: firm_person                     Number of groups   =     28209

R-sq:  within  = 0.0433                         Obs per group: min =         1
       between = 0.0663                                        avg =       9.4
       overall = 0.0549                                        max =        25

                                                F(78,10918)        =     20.66
corr(u_i, Xb)  = 0.0693                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0148921   .0132566     1.12   0.261    -.0110933    .0408774
      during |  -.0054383     .00382    -1.42   0.155    -.0129261    .0020495
       after |  -.0208064   .0062693    -3.32   0.001    -.0330954   -.0085175
during_expat |    .033921    .013944     2.43   0.015     .0065882    .0612539
 after_expat |   .0469389    .018387     2.55   0.011      .010897    .0829807
             |
    ind_year |
          2  |  -.0112022   .0133641    -0.84   0.402    -.0373982    .0149938
          3  |  -.0274249   .0153382    -1.79   0.074    -.0574906    .0026408
          4  |  -.0476305   .0166304    -2.86   0.004    -.0802291   -.0150319
          5  |  -.0437382   .0180257    -2.43   0.015    -.0790718   -.0084046
          6  |  -.0689771   .0189465    -3.64   0.000    -.1061156   -.0318386
          7  |  -.0788533   .0198049    -3.98   0.000    -.1176746   -.0400321
          8  |  -.0926423   .0208582    -4.44   0.000    -.1335281   -.0517566
          9  |  -.1004787    .022235    -4.52   0.000    -.1440633    -.056894
         10  |  -.1049001   .0231011    -4.54   0.000    -.1501825   -.0596177
         11  |  -.1110146   .0242527    -4.58   0.000    -.1585542   -.0634749
         12  |  -.1215817   .0254123    -4.78   0.000    -.1713943    -.071769
         13  |  -.1201913   .0266432    -4.51   0.000    -.1724168   -.0679657
         14  |  -.1175427   .0279454    -4.21   0.000    -.1723207   -.0627647
         15  |   -.112967   .0291029    -3.88   0.000    -.1700141     -.05592
         16  |  -.0979114   .0303139    -3.23   0.001    -.1573321   -.0384906
         17  |  -.0835018   .0316699    -2.64   0.008    -.1455806    -.021423
         18  |   -.075675   .0329523    -2.30   0.022    -.1402674   -.0110826
         19  |   -.078488   .0341371    -2.30   0.022    -.1454029    -.011573
         20  |  -.0765689   .0352687    -2.17   0.030    -.1457019   -.0074359
         21  |  -.0837824   .0363537    -2.30   0.021    -.1550422   -.0125226
         22  |  -.0742279   .0372968    -1.99   0.047    -.1473364   -.0011194
         23  |    -.08886   .0382061    -2.33   0.020    -.1637509   -.0139692
         24  |  -.1817878   .0392508    -4.63   0.000    -.2587265    -.104849
         25  |  -.2142404   .0405713    -5.28   0.000    -.2937674   -.1347133
         26  |   .0990593   .0313474     3.16   0.002     .0376126     .160506
         27  |   .0409801   .0281703     1.45   0.146    -.0142387     .096199
         28  |   .0727146   .0263669     2.76   0.006     .0210307    .1243985
         29  |   .0410254   .0260049     1.58   0.115    -.0099489    .0919997
         30  |   .0431243   .0250635     1.72   0.085    -.0060047    .0922532
         31  |   .0182525   .0249493     0.73   0.464    -.0306526    .0671575
         32  |    .027848   .0249925     1.11   0.265    -.0211418    .0768378
         33  |   .0082896   .0248424     0.33   0.739    -.0404059    .0569852
         34  |  -.0009346   .0257768    -0.04   0.971    -.0514617    .0495925
         35  |  -.0015637   .0264125    -0.06   0.953     -.053337    .0502097
         36  |  -.0014605   .0273416    -0.05   0.957    -.0550551     .052134
         37  |  -.0150583   .0281778    -0.53   0.593    -.0702918    .0401752
         38  |  -.0176579   .0291205    -0.61   0.544    -.0747392    .0394235
         39  |  -.0249922   .0305491    -0.82   0.413     -.084874    .0348895
         40  |  -.0168106   .0313925    -0.54   0.592    -.0783456    .0447244
         41  |  -.0096837   .0324321    -0.30   0.765    -.0732566    .0538892
         42  |  -.0081446   .0335493    -0.24   0.808    -.0739072     .057618
         43  |  -.0037719   .0347325    -0.11   0.914    -.0718538      .06431
         44  |   .0053398   .0358889     0.15   0.882     -.065009    .0756886
         45  |   .0100555   .0371631     0.27   0.787     -.062791    .0829019
         46  |   .0130189   .0384295     0.34   0.735    -.0623098    .0883476
         47  |   .0197541   .0393286     0.50   0.615     -.057337    .0968453
         48  |   .0063958    .040103     0.16   0.873    -.0722134     .085005
         49  |  -.2541827   .0414578    -6.13   0.000    -.3354474   -.1729179
         50  |  -.3052798   .0428029    -7.13   0.000    -.3891812   -.2213784
             |
     age_cat |
          1  |   .0636641   .0095631     6.66   0.000     .0449187    .0824096
          2  |   .0924871   .0105866     8.74   0.000     .0717354    .1132388
          3  |   .1140418   .0115453     9.88   0.000     .0914109    .1366726
          4  |   .1457439   .0126669    11.51   0.000     .1209145    .1705733
          5  |   .1702204   .0137309    12.40   0.000     .1433054    .1971355
          6  |   .1851247   .0149574    12.38   0.000     .1558056    .2144439
          7  |   .1965115   .0162412    12.10   0.000     .1646758    .2283473
          8  |   .2169908   .0174838    12.41   0.000     .1827193    .2512622
          9  |   .2279189   .0188431    12.10   0.000     .1909829    .2648548
         10  |   .2348566   .0202181    11.62   0.000     .1952255    .2744876
         11  |   .2518405   .0215545    11.68   0.000     .2095897    .2940913
         12  |   .2637494   .0229107    11.51   0.000     .2188402    .3086586
         13  |   .2664678   .0243344    10.95   0.000      .218768    .3141677
         14  |   .2737475   .0257576    10.63   0.000      .223258    .3242371
         15  |   .2882777   .0270615    10.65   0.000     .2352322    .3413232
         16  |   .2953849   .0284974    10.37   0.000     .2395248     .351245
         17  |   .3039295   .0298774    10.17   0.000     .2453643    .3624947
         18  |   .3070759   .0313652     9.79   0.000     .2455943    .3685574
         19  |   .3121153   .0329476     9.47   0.000     .2475321    .3766985
         20  |   .3197763   .0351758     9.09   0.000     .2508254    .3887272
         25  |   .3206637   .0399115     8.03   0.000       .24243    .3988974
         30  |   .3612537   .0545537     6.62   0.000     .2543185    .4681888
         40  |   .3396211   .0603543     5.63   0.000     .2213156    .4579265
         50  |   .2835414   .0653588     4.34   0.000     .1554262    .4116566
             |
       _cons |   .1864024   .0192513     9.68   0.000     .1486662    .2241385
-------------+----------------------------------------------------------------
     sigma_u |  .39123747
     sigma_e |  .28693077
         rho |  .65025209   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0433012825786138

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    265,452
Group variable: firm_person                     Number of groups  =     28,209

R-sq:                                           Obs per group:
     within  = 0.0433                                         min =          1
     between = 0.0663                                         avg =        9.4
     overall = 0.0549                                         max =         25

                                                F(78,10918)       =      20.66
corr(u_i, Xb)  = 0.0693                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0148921   .0132566     1.12   0.261    -.0110933    .0408774
      during |  -.0054383     .00382    -1.42   0.155    -.0129261    .0020495
       after |  -.0208064   .0062693    -3.32   0.001    -.0330954   -.0085175
during_expat |    .033921    .013944     2.43   0.015     .0065882    .0612539
 after_expat |   .0469389    .018387     2.55   0.011      .010897    .0829807
             |
    ind_year |
          2  |  -.0112022   .0133641    -0.84   0.402    -.0373982    .0149938
          3  |  -.0274249   .0153382    -1.79   0.074    -.0574906    .0026408
          4  |  -.0476305   .0166304    -2.86   0.004    -.0802291   -.0150319
          5  |  -.0437382   .0180257    -2.43   0.015    -.0790718   -.0084046
          6  |  -.0689771   .0189465    -3.64   0.000    -.1061156   -.0318386
          7  |  -.0788533   .0198049    -3.98   0.000    -.1176746   -.0400321
          8  |  -.0926423   .0208582    -4.44   0.000    -.1335281   -.0517566
          9  |  -.1004787    .022235    -4.52   0.000    -.1440633    -.056894
         10  |  -.1049001   .0231011    -4.54   0.000    -.1501825   -.0596177
         11  |  -.1110146   .0242527    -4.58   0.000    -.1585542   -.0634749
         12  |  -.1215817   .0254123    -4.78   0.000    -.1713943    -.071769
         13  |  -.1201913   .0266432    -4.51   0.000    -.1724168   -.0679657
         14  |  -.1175427   .0279454    -4.21   0.000    -.1723207   -.0627647
         15  |   -.112967   .0291029    -3.88   0.000    -.1700141     -.05592
         16  |  -.0979114   .0303139    -3.23   0.001    -.1573321   -.0384906
         17  |  -.0835018   .0316699    -2.64   0.008    -.1455806    -.021423
         18  |   -.075675   .0329523    -2.30   0.022    -.1402674   -.0110826
         19  |   -.078488   .0341371    -2.30   0.022    -.1454029    -.011573
         20  |  -.0765689   .0352687    -2.17   0.030    -.1457019   -.0074359
         21  |  -.0837824   .0363537    -2.30   0.021    -.1550422   -.0125226
         22  |  -.0742279   .0372968    -1.99   0.047    -.1473364   -.0011194
         23  |    -.08886   .0382061    -2.33   0.020    -.1637509   -.0139692
         24  |  -.1817878   .0392508    -4.63   0.000    -.2587265    -.104849
         25  |  -.2142404   .0405713    -5.28   0.000    -.2937674   -.1347133
         26  |   .0990593   .0313474     3.16   0.002     .0376126     .160506
         27  |   .0409801   .0281703     1.45   0.146    -.0142387     .096199
         28  |   .0727146   .0263669     2.76   0.006     .0210307    .1243985
         29  |   .0410254   .0260049     1.58   0.115    -.0099489    .0919997
         30  |   .0431243   .0250635     1.72   0.085    -.0060047    .0922532
         31  |   .0182525   .0249493     0.73   0.464    -.0306526    .0671575
         32  |    .027848   .0249925     1.11   0.265    -.0211418    .0768378
         33  |   .0082896   .0248424     0.33   0.739    -.0404059    .0569852
         34  |  -.0009346   .0257768    -0.04   0.971    -.0514617    .0495925
         35  |  -.0015637   .0264125    -0.06   0.953     -.053337    .0502097
         36  |  -.0014605   .0273416    -0.05   0.957    -.0550551     .052134
         37  |  -.0150583   .0281778    -0.53   0.593    -.0702918    .0401752
         38  |  -.0176579   .0291205    -0.61   0.544    -.0747392    .0394235
         39  |  -.0249922   .0305491    -0.82   0.413     -.084874    .0348895
         40  |  -.0168106   .0313925    -0.54   0.592    -.0783456    .0447244
         41  |  -.0096837   .0324321    -0.30   0.765    -.0732566    .0538892
         42  |  -.0081446   .0335493    -0.24   0.808    -.0739072     .057618
         43  |  -.0037719   .0347325    -0.11   0.914    -.0718538      .06431
         44  |   .0053398   .0358889     0.15   0.882     -.065009    .0756886
         45  |   .0100555   .0371631     0.27   0.787     -.062791    .0829019
         46  |   .0130189   .0384295     0.34   0.735    -.0623098    .0883476
         47  |   .0197541   .0393286     0.50   0.615     -.057337    .0968453
         48  |   .0063958    .040103     0.16   0.873    -.0722134     .085005
         49  |  -.2541827   .0414578    -6.13   0.000    -.3354474   -.1729179
         50  |  -.3052798   .0428029    -7.13   0.000    -.3891812   -.2213784
             |
     age_cat |
          1  |   .0636641   .0095631     6.66   0.000     .0449187    .0824096
          2  |   .0924871   .0105866     8.74   0.000     .0717354    .1132388
          3  |   .1140418   .0115453     9.88   0.000     .0914109    .1366726
          4  |   .1457439   .0126669    11.51   0.000     .1209145    .1705733
          5  |   .1702204   .0137309    12.40   0.000     .1433054    .1971355
          6  |   .1851247   .0149574    12.38   0.000     .1558056    .2144439
          7  |   .1965115   .0162412    12.10   0.000     .1646758    .2283473
          8  |   .2169908   .0174838    12.41   0.000     .1827193    .2512622
          9  |   .2279189   .0188431    12.10   0.000     .1909829    .2648548
         10  |   .2348566   .0202181    11.62   0.000     .1952255    .2744876
         11  |   .2518405   .0215545    11.68   0.000     .2095897    .2940913
         12  |   .2637494   .0229107    11.51   0.000     .2188402    .3086586
         13  |   .2664678   .0243344    10.95   0.000      .218768    .3141677
         14  |   .2737475   .0257576    10.63   0.000      .223258    .3242371
         15  |   .2882777   .0270615    10.65   0.000     .2352322    .3413232
         16  |   .2953849   .0284974    10.37   0.000     .2395248     .351245
         17  |   .3039295   .0298774    10.17   0.000     .2453643    .3624947
         18  |   .3070759   .0313652     9.79   0.000     .2455943    .3685574
         19  |   .3121153   .0329476     9.47   0.000     .2475321    .3766985
         20  |   .3197763   .0351758     9.09   0.000     .2508254    .3887272
         25  |   .3206637   .0399115     8.03   0.000       .24243    .3988974
         30  |   .3612537   .0545537     6.62   0.000     .2543185    .4681888
         40  |   .3396211   .0603543     5.63   0.000     .2213156    .4579265
         50  |   .2835414   .0653588     4.34   0.000     .1554262    .4116566
             |
       _cons |   .1864024   .0192513     9.68   0.000     .1486662    .2241385
-------------+----------------------------------------------------------------
     sigma_u |  .39123747
     sigma_e |  .28693077
         rho |  .65025209   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str12
(1 real change made)

 ( 1)  during = 0

       F(  1, 10918) =    2.03
            Prob > F =    0.1546

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during + after = 0

       F(  1, 10918) =   12.57
            Prob > F =    0.0004

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_expat = 0

       F(  1, 10918) =    5.92
            Prob > F =    0.0150

 ( 1)  during_expat = 0

       F(  1, 10918) =    5.92
            Prob > F =    0.0150
variable label was str12 now str14
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  - during_expat + after_expat = 0

       F(  1, 10918) =    0.81
            Prob > F =    0.3673

 ( 1)  after_expat = 0

       F(  1, 10918) =    6.52
            Prob > F =    0.0107
(1 real change made)
(file output/figure/acquisitions_exporter_slope.png written in PNG format)

Fixed-effects (within) regression               Number of obs      =    265452
Group variable: firm_person                     Number of groups   =     28209

R-sq:  within  = 0.0432                         Obs per group: min =         1
       between = 0.0635                                        avg =       9.4
       overall = 0.0531                                        max =        25

                                                F(82,10918)        =     19.63
corr(u_i, Xb)  = 0.0635                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0146334    .013267     1.10   0.270    -.0113723     .040639
   during_DD |  -.0037003   .0039145    -0.95   0.345    -.0113734    .0039729
   during_DE |   .0298141   .0198497     1.50   0.133    -.0090949    .0687231
   during_ED |  -.0043761   .0101512    -0.43   0.666    -.0242742    .0155221
   during_EE |   .0169655   .0195752     0.87   0.386    -.0214054    .0553364
    after_DD |  -.0196855   .0064955    -3.03   0.002    -.0324179    -.006953
    after_DE |    .022148   .0232077     0.95   0.340    -.0233432    .0676393
    after_ED |  -.0096495   .0137185    -0.70   0.482    -.0365403    .0172413
    after_EE |   .0209267   .0264122     0.79   0.428    -.0308459    .0726994
             |
    ind_year |
          2  |  -.0116295   .0133949    -0.87   0.385    -.0378859    .0146269
          3  |  -.0281432   .0154328    -1.82   0.068    -.0583943    .0021078
          4  |  -.0486291   .0167791    -2.90   0.004    -.0815192   -.0157389
          5  |  -.0450005   .0182185    -2.47   0.014    -.0807122   -.0092889
          6  |  -.0705714   .0191972    -3.68   0.000    -.1082013   -.0329414
          7  |  -.0806728   .0201213    -4.01   0.000    -.1201141   -.0412314
          8  |  -.0947229   .0212247    -4.46   0.000    -.1363271   -.0531187
          9  |  -.1029257   .0226272    -4.55   0.000    -.1472791   -.0585724
         10  |   -.107683   .0234544    -4.59   0.000    -.1536579   -.0617081
         11  |  -.1141385   .0245536    -4.65   0.000    -.1622681   -.0660089
         12  |  -.1250144   .0256823    -4.87   0.000    -.1753563   -.0746726
         13  |  -.1239594   .0268758    -4.61   0.000    -.1766407    -.071278
         14  |  -.1216392   .0281561    -4.32   0.000    -.1768302   -.0664481
         15  |  -.1174827   .0292755    -4.01   0.000     -.174868   -.0600974
         16  |  -.1027748    .030446    -3.38   0.001    -.1624544   -.0430951
         17  |  -.0888727   .0317549    -2.80   0.005    -.1511181   -.0266273
         18  |  -.0814072   .0330046    -2.47   0.014    -.1461023   -.0167121
         19  |   -.084614   .0341389    -2.48   0.013    -.1515324   -.0176956
         20  |  -.0830961   .0352375    -2.36   0.018    -.1521681   -.0140242
         21  |  -.0906133   .0362799    -2.50   0.013    -.1617284   -.0194982
         22  |  -.0814484   .0371839    -2.19   0.029    -.1543355   -.0085613
         23  |  -.0963658   .0380662    -2.53   0.011    -.1709825   -.0217491
         24  |  -.1896694   .0390731    -4.85   0.000    -.2662597   -.1130791
         25  |  -.2225582   .0403504    -5.52   0.000    -.3016523    -.143464
         26  |   .0990692   .0313365     3.16   0.002      .037644    .1604945
         27  |    .040494   .0282247     1.43   0.151    -.0148315    .0958195
         28  |   .0718457   .0264983     2.71   0.007     .0199043    .1237871
         29  |   .0400432   .0261914     1.53   0.126    -.0112968    .0913831
         30  |   .0418292   .0252953     1.65   0.098    -.0077541    .0914125
         31  |   .0166705   .0252044     0.66   0.508    -.0327347    .0660756
         32  |   .0259681   .0252956     1.03   0.305    -.0236159    .0755521
         33  |   .0060888   .0251386     0.24   0.809    -.0431875    .0553651
         34  |  -.0035105    .026124    -0.13   0.893    -.0547184    .0476973
         35  |  -.0044125   .0267404    -0.17   0.869    -.0568285    .0480035
         36  |  -.0046392    .027647    -0.17   0.867    -.0588323    .0495539
         37  |  -.0185245   .0284756    -0.65   0.515    -.0743419     .037293
         38  |  -.0214138   .0293798    -0.73   0.466    -.0790036    .0361759
         39  |  -.0291633   .0307782    -0.95   0.343    -.0894941    .0311675
         40  |  -.0214066   .0315801    -0.68   0.498    -.0833093     .040496
         41  |  -.0146724   .0325638    -0.45   0.652    -.0785034    .0491587
         42  |  -.0135236   .0336507    -0.40   0.688     -.079485    .0524379
         43  |  -.0094584   .0348189    -0.27   0.786    -.0777097    .0587929
         44  |  -.0005884   .0359203    -0.02   0.987    -.0709987     .069822
         45  |   .0037835   .0371649     0.10   0.919    -.0690665    .0766335
         46  |   .0064461   .0383981     0.17   0.867    -.0688211    .0817134
         47  |   .0128498   .0392725     0.33   0.744    -.0641315    .0898312
         48  |  -.0008322   .0400186    -0.02   0.983    -.0792758    .0776114
         49  |  -.2617952   .0413329    -6.33   0.000    -.3428152   -.1807752
         50  |  -.3132098   .0426426    -7.35   0.000    -.3967969   -.2296226
             |
     age_cat |
          1  |   .0634729   .0095584     6.64   0.000     .0447366    .0822091
          2  |   .0921184   .0105733     8.71   0.000     .0713929    .1128439
          3  |   .1135989   .0115232     9.86   0.000     .0910113    .1361864
          4  |   .1452993   .0126519    11.48   0.000     .1204992    .1700993
          5  |   .1698385   .0137176    12.38   0.000     .1429495    .1967275
          6  |   .1848098    .014955    12.36   0.000     .1554953    .2141243
          7  |   .1963071   .0162491    12.08   0.000     .1644559    .2281583
          8  |   .2169358   .0175001    12.40   0.000     .1826324    .2512391
          9  |     .22799   .0188664    12.08   0.000     .1910084    .2649716
         10  |   .2350754   .0202473    11.61   0.000     .1953871    .2747638
         11  |   .2522286   .0215841    11.69   0.000     .2099199    .2945373
         12  |    .264308    .022939    11.52   0.000     .2193433    .3092726
         13  |   .2671788   .0243563    10.97   0.000      .219436    .3149216
         14  |   .2746699   .0257858    10.65   0.000      .224125    .3252148
         15  |   .2894096   .0270934    10.68   0.000     .2363017    .3425175
         16  |   .2967009    .028527    10.40   0.000     .2407828     .352619
         17  |   .3054743   .0299164    10.21   0.000     .2468328    .3641159
         18  |   .3088434   .0314023     9.84   0.000     .2472891    .3703976
         19  |   .3141131   .0329858     9.52   0.000     .2494549    .3787712
         20  |   .3222011   .0352138     9.15   0.000     .2531757    .3912265
         25  |   .3237992    .039928     8.11   0.000     .2455331    .4020654
         30  |   .3644223   .0545499     6.68   0.000     .2574946    .4713501
         40  |   .3419455   .0603516     5.67   0.000     .2236456    .4602455
         50  |   .2855003    .065366     4.37   0.000     .1573712    .4136294
             |
       _cons |   .1884546   .0194982     9.67   0.000     .1502346    .2266746
-------------+----------------------------------------------------------------
     sigma_u |  .39168384
     sigma_e |  .28694676
         rho |  .65074523   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0432107986866004

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    265,452
Group variable: firm_person                     Number of groups  =     28,209

R-sq:                                           Obs per group:
     within  = 0.0432                                         min =          1
     between = 0.0635                                         avg =        9.4
     overall = 0.0531                                         max =         25

                                                F(82,10918)       =      19.63
corr(u_i, Xb)  = 0.0635                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 10,919 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0146334    .013267     1.10   0.270    -.0113723     .040639
   during_DD |  -.0037003   .0039145    -0.95   0.345    -.0113734    .0039729
   during_DE |   .0298141   .0198497     1.50   0.133    -.0090949    .0687231
   during_ED |  -.0043761   .0101512    -0.43   0.666    -.0242742    .0155221
   during_EE |   .0169655   .0195752     0.87   0.386    -.0214054    .0553364
    after_DD |  -.0196855   .0064955    -3.03   0.002    -.0324179    -.006953
    after_DE |    .022148   .0232077     0.95   0.340    -.0233432    .0676393
    after_ED |  -.0096495   .0137185    -0.70   0.482    -.0365403    .0172413
    after_EE |   .0209267   .0264122     0.79   0.428    -.0308459    .0726994
             |
    ind_year |
          2  |  -.0116295   .0133949    -0.87   0.385    -.0378859    .0146269
          3  |  -.0281432   .0154328    -1.82   0.068    -.0583943    .0021078
          4  |  -.0486291   .0167791    -2.90   0.004    -.0815192   -.0157389
          5  |  -.0450005   .0182185    -2.47   0.014    -.0807122   -.0092889
          6  |  -.0705714   .0191972    -3.68   0.000    -.1082013   -.0329414
          7  |  -.0806728   .0201213    -4.01   0.000    -.1201141   -.0412314
          8  |  -.0947229   .0212247    -4.46   0.000    -.1363271   -.0531187
          9  |  -.1029257   .0226272    -4.55   0.000    -.1472791   -.0585724
         10  |   -.107683   .0234544    -4.59   0.000    -.1536579   -.0617081
         11  |  -.1141385   .0245536    -4.65   0.000    -.1622681   -.0660089
         12  |  -.1250144   .0256823    -4.87   0.000    -.1753563   -.0746726
         13  |  -.1239594   .0268758    -4.61   0.000    -.1766407    -.071278
         14  |  -.1216392   .0281561    -4.32   0.000    -.1768302   -.0664481
         15  |  -.1174827   .0292755    -4.01   0.000     -.174868   -.0600974
         16  |  -.1027748    .030446    -3.38   0.001    -.1624544   -.0430951
         17  |  -.0888727   .0317549    -2.80   0.005    -.1511181   -.0266273
         18  |  -.0814072   .0330046    -2.47   0.014    -.1461023   -.0167121
         19  |   -.084614   .0341389    -2.48   0.013    -.1515324   -.0176956
         20  |  -.0830961   .0352375    -2.36   0.018    -.1521681   -.0140242
         21  |  -.0906133   .0362799    -2.50   0.013    -.1617284   -.0194982
         22  |  -.0814484   .0371839    -2.19   0.029    -.1543355   -.0085613
         23  |  -.0963658   .0380662    -2.53   0.011    -.1709825   -.0217491
         24  |  -.1896694   .0390731    -4.85   0.000    -.2662597   -.1130791
         25  |  -.2225582   .0403504    -5.52   0.000    -.3016523    -.143464
         26  |   .0990692   .0313365     3.16   0.002      .037644    .1604945
         27  |    .040494   .0282247     1.43   0.151    -.0148315    .0958195
         28  |   .0718457   .0264983     2.71   0.007     .0199043    .1237871
         29  |   .0400432   .0261914     1.53   0.126    -.0112968    .0913831
         30  |   .0418292   .0252953     1.65   0.098    -.0077541    .0914125
         31  |   .0166705   .0252044     0.66   0.508    -.0327347    .0660756
         32  |   .0259681   .0252956     1.03   0.305    -.0236159    .0755521
         33  |   .0060888   .0251386     0.24   0.809    -.0431875    .0553651
         34  |  -.0035105    .026124    -0.13   0.893    -.0547184    .0476973
         35  |  -.0044125   .0267404    -0.17   0.869    -.0568285    .0480035
         36  |  -.0046392    .027647    -0.17   0.867    -.0588323    .0495539
         37  |  -.0185245   .0284756    -0.65   0.515    -.0743419     .037293
         38  |  -.0214138   .0293798    -0.73   0.466    -.0790036    .0361759
         39  |  -.0291633   .0307782    -0.95   0.343    -.0894941    .0311675
         40  |  -.0214066   .0315801    -0.68   0.498    -.0833093     .040496
         41  |  -.0146724   .0325638    -0.45   0.652    -.0785034    .0491587
         42  |  -.0135236   .0336507    -0.40   0.688     -.079485    .0524379
         43  |  -.0094584   .0348189    -0.27   0.786    -.0777097    .0587929
         44  |  -.0005884   .0359203    -0.02   0.987    -.0709987     .069822
         45  |   .0037835   .0371649     0.10   0.919    -.0690665    .0766335
         46  |   .0064461   .0383981     0.17   0.867    -.0688211    .0817134
         47  |   .0128498   .0392725     0.33   0.744    -.0641315    .0898312
         48  |  -.0008322   .0400186    -0.02   0.983    -.0792758    .0776114
         49  |  -.2617952   .0413329    -6.33   0.000    -.3428152   -.1807752
         50  |  -.3132098   .0426426    -7.35   0.000    -.3967969   -.2296226
             |
     age_cat |
          1  |   .0634729   .0095584     6.64   0.000     .0447366    .0822091
          2  |   .0921184   .0105733     8.71   0.000     .0713929    .1128439
          3  |   .1135989   .0115232     9.86   0.000     .0910113    .1361864
          4  |   .1452993   .0126519    11.48   0.000     .1204992    .1700993
          5  |   .1698385   .0137176    12.38   0.000     .1429495    .1967275
          6  |   .1848098    .014955    12.36   0.000     .1554953    .2141243
          7  |   .1963071   .0162491    12.08   0.000     .1644559    .2281583
          8  |   .2169358   .0175001    12.40   0.000     .1826324    .2512391
          9  |     .22799   .0188664    12.08   0.000     .1910084    .2649716
         10  |   .2350754   .0202473    11.61   0.000     .1953871    .2747638
         11  |   .2522286   .0215841    11.69   0.000     .2099199    .2945373
         12  |    .264308    .022939    11.52   0.000     .2193433    .3092726
         13  |   .2671788   .0243563    10.97   0.000      .219436    .3149216
         14  |   .2746699   .0257858    10.65   0.000      .224125    .3252148
         15  |   .2894096   .0270934    10.68   0.000     .2363017    .3425175
         16  |   .2967009    .028527    10.40   0.000     .2407828     .352619
         17  |   .3054743   .0299164    10.21   0.000     .2468328    .3641159
         18  |   .3088434   .0314023     9.84   0.000     .2472891    .3703976
         19  |   .3141131   .0329858     9.52   0.000     .2494549    .3787712
         20  |   .3222011   .0352138     9.15   0.000     .2531757    .3912265
         25  |   .3237992    .039928     8.11   0.000     .2455331    .4020654
         30  |   .3644223   .0545499     6.68   0.000     .2574946    .4713501
         40  |   .3419455   .0603516     5.67   0.000     .2236456    .4602455
         50  |   .2855003    .065366     4.37   0.000     .1573712    .4136294
             |
       _cons |   .1884546   .0194982     9.67   0.000     .1502346    .2266746
-------------+----------------------------------------------------------------
     sigma_u |  .39168384
     sigma_e |  .28694676
         rho |  .65074523   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[du
> ring_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle(`title') legend(off) 
> aspect(0.67))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 10918) =    0.89
            Prob > F =    0.3445

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 10918) =    2.26
            Prob > F =    0.1331

 ( 1)  - during_DD + during_DE = 0

       F(  1, 10918) =    2.78
            Prob > F =    0.0956
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 10918) =    0.19
            Prob > F =    0.6664

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 10918) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 10918) =    0.75
            Prob > F =    0.3861

 ( 1)  - during_ED + during_EE = 0

       F(  1, 10918) =    0.95
            Prob > F =    0.3292

. 
. graph export output/figure/`fname'_tree.png, width(800) replace
(file output/figure/exporter_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    177613
Group variable: firm_person                     Number of groups   =     19465

R-sq:  within  = 0.0291                         Obs per group: min =         1
       between = 0.0824                                        avg =       9.1
       overall = 0.0675                                        max =        25

                                                F(78,6772)         =      8.69
corr(u_i, Xb)  = 0.1219                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 6,773 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0050738   .0160884    -0.32   0.752    -.0366122    .0264646
      during |  -.0135624   .0047228    -2.87   0.004    -.0228205   -.0043043
       after |  -.0210619   .0079281    -2.66   0.008    -.0366036   -.0055203
during_expat |   .0402818   .0158673     2.54   0.011      .009177    .0713867
 after_expat |   .0663304   .0218827     3.03   0.002     .0234335    .1092273
             |
    ind_year |
          2  |   -.026538   .0151532    -1.75   0.080     -.056243    .0031671
          3  |  -.0470045   .0183791    -2.56   0.011    -.0830332   -.0109757
          4  |  -.0557379    .019734    -2.82   0.005    -.0944228    -.017053
          5  |   -.061062   .0210357    -2.90   0.004    -.1022985   -.0198255
          6  |  -.0978185    .022374    -4.37   0.000    -.1416787   -.0539583
          7  |  -.1064047   .0233486    -4.56   0.000    -.1521752   -.0606342
          8  |  -.1354135    .024686    -5.49   0.000    -.1838059   -.0870212
          9  |  -.1536445   .0262504    -5.85   0.000    -.2051035   -.1021856
         10  |  -.1526965   .0272316    -5.61   0.000     -.206079   -.0993141
         11  |  -.1673555   .0283911    -5.89   0.000     -.223011      -.1117
         12  |  -.1762919   .0298294    -5.91   0.000    -.2347668   -.1178169
         13  |  -.1783195   .0311609    -5.72   0.000    -.2394047   -.1172343
         14  |  -.1697558   .0326588    -5.20   0.000    -.2337773   -.1057344
         15  |  -.1689793   .0337765    -5.00   0.000    -.2351919   -.1027667
         16  |  -.1589995   .0348775    -4.56   0.000    -.2273702   -.0906287
         17  |  -.1484355   .0363983    -4.08   0.000    -.2197876   -.0770834
         18  |  -.1356992   .0378254    -3.59   0.000    -.2098489   -.0615495
         19  |  -.1411282   .0390327    -3.62   0.000    -.2176445   -.0646119
         20  |   -.132235   .0401567    -3.29   0.001    -.2109548   -.0535152
         21  |  -.1455821   .0411323    -3.54   0.000    -.2262142     -.06495
         22  |  -.1364539   .0419412    -3.25   0.001    -.2186719   -.0542359
         23  |  -.1514381   .0426994    -3.55   0.000    -.2351424   -.0677339
         24  |   -.208993   .0438135    -4.77   0.000    -.2948812   -.1231048
         25  |   -.233778   .0452151    -5.17   0.000    -.3224139   -.1451422
         26  |   .1000474   .0366392     2.73   0.006      .028223    .1718717
         27  |   .0486494   .0333925     1.46   0.145    -.0168104    .1141091
         28  |   .0730068   .0316306     2.31   0.021     .0110009    .1350128
         29  |   .0518114   .0315007     1.64   0.100    -.0099398    .1135627
         30  |   .0357784    .030602     1.17   0.242    -.0242111    .0957679
         31  |   .0304846   .0304726     1.00   0.317    -.0292513    .0902204
         32  |    .017521   .0306038     0.57   0.567    -.0424721    .0775141
         33  |   .0002708   .0302637     0.01   0.993    -.0590556    .0595971
         34  |   -.015227   .0312145    -0.49   0.626    -.0764172    .0459631
         35  |  -.0121117   .0318776    -0.38   0.704    -.0746017    .0503784
         36  |   -.033463   .0328354    -1.02   0.308    -.0978307    .0309047
         37  |  -.0507089   .0335683    -1.51   0.131    -.1165134    .0150956
         38  |  -.0472474   .0346649    -1.36   0.173    -.1152015    .0207068
         39  |  -.0660757   .0361717    -1.83   0.068    -.1369836    .0048321
         40  |  -.0610645   .0369824    -1.65   0.099    -.1335616    .0114326
         41  |  -.0591612   .0379766    -1.56   0.119    -.1336073    .0152849
         42  |  -.0667816   .0390577    -1.71   0.087    -.1433469    .0097838
         43  |  -.0589059   .0402739    -1.46   0.144    -.1378553    .0200436
         44  |  -.0576125     .04144    -1.39   0.164     -.138848    .0236229
         45  |  -.0582508    .042673    -1.37   0.172    -.1419034    .0254018
         46  |  -.0602575   .0440719    -1.37   0.172    -.1466522    .0261371
         47  |  -.0513421   .0449719    -1.14   0.254    -.1395012     .036817
         48  |  -.0570834   .0455141    -1.25   0.210    -.1463053    .0321384
         49  |  -.2683715   .0471901    -5.69   0.000     -.360879    -.175864
         50  |  -.3179872   .0488302    -6.51   0.000    -.4137098   -.2222647
             |
     age_cat |
          1  |   .0601029   .0134105     4.48   0.000     .0338142    .0863917
          2  |   .0737953   .0146353     5.04   0.000     .0451055     .102485
          3  |   .0929824   .0155753     5.97   0.000       .06245    .1235149
          4  |   .1225862   .0167447     7.32   0.000     .0897613     .155411
          5  |   .1465099   .0179287     8.17   0.000      .111364    .1816558
          6  |   .1513711   .0191214     7.92   0.000     .1138871    .1888551
          7  |   .1567474   .0205901     7.61   0.000     .1163844    .1971104
          8  |   .1767871   .0217638     8.12   0.000     .1341231    .2194511
          9  |   .1920846   .0233177     8.24   0.000     .1463746    .2377946
         10  |    .198723   .0248403     8.00   0.000     .1500282    .2474178
         11  |   .2183715    .026199     8.34   0.000     .1670133    .2697297
         12  |    .227785   .0276147     8.25   0.000     .1736515    .2819186
         13  |   .2280305   .0291093     7.83   0.000     .1709672    .2850939
         14  |   .2324397   .0305042     7.62   0.000     .1726419    .2922376
         15  |   .2479262   .0318968     7.77   0.000     .1853985    .3104539
         16  |    .256965   .0332767     7.72   0.000     .1917321    .3221978
         17  |   .2705068   .0347272     7.79   0.000     .2024305    .3385831
         18  |   .2697459   .0363079     7.43   0.000      .198571    .3409207
         19  |   .2761161   .0377412     7.32   0.000     .2021314    .3501008
         20  |   .2773798   .0401047     6.92   0.000     .1987621    .3559976
         25  |   .2874103   .0452117     6.36   0.000     .1987811    .3760395
         30  |   .3072248   .0586788     5.24   0.000     .1921959    .4222536
         40  |   .2848848   .0649656     4.39   0.000     .1575319    .4122377
         50  |   .2411072    .070276     3.43   0.001     .1033441    .3788704
             |
       _cons |   .2787964   .0247885    11.25   0.000     .2302031    .3273898
-------------+----------------------------------------------------------------
     sigma_u |  .40276725
     sigma_e |  .27227042
         rho |  .68635348   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0290807718567589

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    177,613
Group variable: firm_person                     Number of groups  =     19,465

R-sq:                                           Obs per group:
     within  = 0.0291                                         min =          1
     between = 0.0824                                         avg =        9.1
     overall = 0.0675                                         max =         25

                                                F(78,6772)        =       8.69
corr(u_i, Xb)  = 0.1219                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 6,773 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |  -.0050738   .0160884    -0.32   0.752    -.0366122    .0264646
      during |  -.0135624   .0047228    -2.87   0.004    -.0228205   -.0043043
       after |  -.0210619   .0079281    -2.66   0.008    -.0366036   -.0055203
during_expat |   .0402818   .0158673     2.54   0.011      .009177    .0713867
 after_expat |   .0663304   .0218827     3.03   0.002     .0234335    .1092273
             |
    ind_year |
          2  |   -.026538   .0151532    -1.75   0.080     -.056243    .0031671
          3  |  -.0470045   .0183791    -2.56   0.011    -.0830332   -.0109757
          4  |  -.0557379    .019734    -2.82   0.005    -.0944228    -.017053
          5  |   -.061062   .0210357    -2.90   0.004    -.1022985   -.0198255
          6  |  -.0978185    .022374    -4.37   0.000    -.1416787   -.0539583
          7  |  -.1064047   .0233486    -4.56   0.000    -.1521752   -.0606342
          8  |  -.1354135    .024686    -5.49   0.000    -.1838059   -.0870212
          9  |  -.1536445   .0262504    -5.85   0.000    -.2051035   -.1021856
         10  |  -.1526965   .0272316    -5.61   0.000     -.206079   -.0993141
         11  |  -.1673555   .0283911    -5.89   0.000     -.223011      -.1117
         12  |  -.1762919   .0298294    -5.91   0.000    -.2347668   -.1178169
         13  |  -.1783195   .0311609    -5.72   0.000    -.2394047   -.1172343
         14  |  -.1697558   .0326588    -5.20   0.000    -.2337773   -.1057344
         15  |  -.1689793   .0337765    -5.00   0.000    -.2351919   -.1027667
         16  |  -.1589995   .0348775    -4.56   0.000    -.2273702   -.0906287
         17  |  -.1484355   .0363983    -4.08   0.000    -.2197876   -.0770834
         18  |  -.1356992   .0378254    -3.59   0.000    -.2098489   -.0615495
         19  |  -.1411282   .0390327    -3.62   0.000    -.2176445   -.0646119
         20  |   -.132235   .0401567    -3.29   0.001    -.2109548   -.0535152
         21  |  -.1455821   .0411323    -3.54   0.000    -.2262142     -.06495
         22  |  -.1364539   .0419412    -3.25   0.001    -.2186719   -.0542359
         23  |  -.1514381   .0426994    -3.55   0.000    -.2351424   -.0677339
         24  |   -.208993   .0438135    -4.77   0.000    -.2948812   -.1231048
         25  |   -.233778   .0452151    -5.17   0.000    -.3224139   -.1451422
         26  |   .1000474   .0366392     2.73   0.006      .028223    .1718717
         27  |   .0486494   .0333925     1.46   0.145    -.0168104    .1141091
         28  |   .0730068   .0316306     2.31   0.021     .0110009    .1350128
         29  |   .0518114   .0315007     1.64   0.100    -.0099398    .1135627
         30  |   .0357784    .030602     1.17   0.242    -.0242111    .0957679
         31  |   .0304846   .0304726     1.00   0.317    -.0292513    .0902204
         32  |    .017521   .0306038     0.57   0.567    -.0424721    .0775141
         33  |   .0002708   .0302637     0.01   0.993    -.0590556    .0595971
         34  |   -.015227   .0312145    -0.49   0.626    -.0764172    .0459631
         35  |  -.0121117   .0318776    -0.38   0.704    -.0746017    .0503784
         36  |   -.033463   .0328354    -1.02   0.308    -.0978307    .0309047
         37  |  -.0507089   .0335683    -1.51   0.131    -.1165134    .0150956
         38  |  -.0472474   .0346649    -1.36   0.173    -.1152015    .0207068
         39  |  -.0660757   .0361717    -1.83   0.068    -.1369836    .0048321
         40  |  -.0610645   .0369824    -1.65   0.099    -.1335616    .0114326
         41  |  -.0591612   .0379766    -1.56   0.119    -.1336073    .0152849
         42  |  -.0667816   .0390577    -1.71   0.087    -.1433469    .0097838
         43  |  -.0589059   .0402739    -1.46   0.144    -.1378553    .0200436
         44  |  -.0576125     .04144    -1.39   0.164     -.138848    .0236229
         45  |  -.0582508    .042673    -1.37   0.172    -.1419034    .0254018
         46  |  -.0602575   .0440719    -1.37   0.172    -.1466522    .0261371
         47  |  -.0513421   .0449719    -1.14   0.254    -.1395012     .036817
         48  |  -.0570834   .0455141    -1.25   0.210    -.1463053    .0321384
         49  |  -.2683715   .0471901    -5.69   0.000     -.360879    -.175864
         50  |  -.3179872   .0488302    -6.51   0.000    -.4137098   -.2222647
             |
     age_cat |
          1  |   .0601029   .0134105     4.48   0.000     .0338142    .0863917
          2  |   .0737953   .0146353     5.04   0.000     .0451055     .102485
          3  |   .0929824   .0155753     5.97   0.000       .06245    .1235149
          4  |   .1225862   .0167447     7.32   0.000     .0897613     .155411
          5  |   .1465099   .0179287     8.17   0.000      .111364    .1816558
          6  |   .1513711   .0191214     7.92   0.000     .1138871    .1888551
          7  |   .1567474   .0205901     7.61   0.000     .1163844    .1971104
          8  |   .1767871   .0217638     8.12   0.000     .1341231    .2194511
          9  |   .1920846   .0233177     8.24   0.000     .1463746    .2377946
         10  |    .198723   .0248403     8.00   0.000     .1500282    .2474178
         11  |   .2183715    .026199     8.34   0.000     .1670133    .2697297
         12  |    .227785   .0276147     8.25   0.000     .1736515    .2819186
         13  |   .2280305   .0291093     7.83   0.000     .1709672    .2850939
         14  |   .2324397   .0305042     7.62   0.000     .1726419    .2922376
         15  |   .2479262   .0318968     7.77   0.000     .1853985    .3104539
         16  |    .256965   .0332767     7.72   0.000     .1917321    .3221978
         17  |   .2705068   .0347272     7.79   0.000     .2024305    .3385831
         18  |   .2697459   .0363079     7.43   0.000      .198571    .3409207
         19  |   .2761161   .0377412     7.32   0.000     .2021314    .3501008
         20  |   .2773798   .0401047     6.92   0.000     .1987621    .3559976
         25  |   .2874103   .0452117     6.36   0.000     .1987811    .3760395
         30  |   .3072248   .0586788     5.24   0.000     .1921959    .4222536
         40  |   .2848848   .0649656     4.39   0.000     .1575319    .4122377
         50  |   .2411072    .070276     3.43   0.001     .1033441    .3788704
             |
       _cons |   .2787964   .0247885    11.25   0.000     .2302031    .3273898
-------------+----------------------------------------------------------------
     sigma_u |  .40276725
     sigma_e |  .27227042
         rho |  .68635348   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    156204
Group variable: firm_person                     Number of groups   =     16977

R-sq:  within  = 0.0531                         Obs per group: min =         1
       between = 0.0415                                        avg =       9.2
       overall = 0.0414                                        max =        25

                                                F(78,6146)         =     14.71
corr(u_i, Xb)  = -0.0022                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 6,147 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0364314   .0183854     1.98   0.048     .0003897    .0724732
      during |   .0038957   .0053511     0.73   0.467    -.0065943    .0143858
       after |  -.0156174   .0086046    -1.82   0.070    -.0324854    .0012505
during_expat |   .0273704   .0151324     1.81   0.071    -.0022944    .0570351
 after_expat |     .04279    .022036     1.94   0.052    -.0004082    .0859883
             |
    ind_year |
          2  |  -.0112573   .0204013    -0.55   0.581     -.051251    .0287364
          3  |   -.009808   .0245127    -0.40   0.689    -.0578615    .0382455
          4  |  -.0385691   .0248332    -1.55   0.120    -.0872509    .0101127
          5  |  -.0433957    .026507    -1.64   0.102    -.0953587    .0085674
          6  |  -.0713397   .0276807    -2.58   0.010    -.1256035   -.0170758
          7  |  -.0918387    .028535    -3.22   0.001    -.1477772   -.0359002
          8  |  -.0982275   .0298451    -3.29   0.001    -.1567344   -.0397206
          9  |  -.1070031   .0313183    -3.42   0.001    -.1683979   -.0456083
         10  |  -.1021834    .032317    -3.16   0.002     -.165536   -.0388309
         11  |  -.1144696   .0335409    -3.41   0.001    -.1802215   -.0487176
         12  |  -.1267869   .0348424    -3.64   0.000    -.1950902   -.0584837
         13  |  -.1313494   .0364525    -3.60   0.000    -.2028091   -.0598897
         14  |  -.1280667   .0380085    -3.37   0.001    -.2025766   -.0535568
         15  |  -.1175695   .0392769    -2.99   0.003     -.194566    -.040573
         16  |  -.1041634    .040626    -2.56   0.010    -.1838046   -.0245221
         17  |  -.0941958   .0421992    -2.23   0.026    -.1769209   -.0114706
         18  |  -.0842801   .0436284    -1.93   0.053    -.1698069    .0012468
         19  |  -.0868474   .0449376    -1.93   0.053    -.1749408     .001246
         20  |  -.0875733   .0463334    -1.89   0.059     -.178403    .0032563
         21  |  -.1030366   .0475745    -2.17   0.030    -.1962993   -.0097739
         22  |  -.0866498   .0487008    -1.78   0.075    -.1821204    .0088209
         23  |  -.0998569   .0497346    -2.01   0.045    -.1973542   -.0023597
         24  |  -.2027975   .0510959    -3.97   0.000    -.3029633   -.1026317
         25  |  -.2415789   .0525785    -4.59   0.000    -.3446511   -.1385067
         26  |   .0683229   .0471277     1.45   0.147    -.0240639    .1607098
         27  |   .0282568    .041746     0.68   0.499    -.0535799    .1100935
         28  |   .0594865    .039189     1.52   0.129    -.0173377    .1363107
         29  |   .0150276   .0386171     0.39   0.697    -.0606754    .0907306
         30  |   .0122322   .0370051     0.33   0.741    -.0603108    .0847751
         31  |  -.0138009   .0361873    -0.38   0.703    -.0847407    .0571388
         32  |   .0087672   .0358725     0.24   0.807    -.0615555    .0790899
         33  |   -.000426   .0355936    -0.01   0.990    -.0702018    .0693499
         34  |  -.0061021   .0367903    -0.17   0.868    -.0782241    .0660198
         35  |  -.0132177   .0374666    -0.35   0.724    -.0866653      .06023
         36  |  -.0058397   .0383408    -0.15   0.879    -.0810012    .0693217
         37  |  -.0257788   .0391953    -0.66   0.511    -.1026154    .0510577
         38  |  -.0262296   .0405263    -0.65   0.518    -.1056754    .0532163
         39  |  -.0419669   .0419418    -1.00   0.317    -.1241874    .0402536
         40  |  -.0348326   .0427815    -0.81   0.416    -.1186994    .0490342
         41  |  -.0292792   .0440889    -0.66   0.507    -.1157088    .0571504
         42  |  -.0211925   .0452433    -0.47   0.640    -.1098852    .0675002
         43  |  -.0165346   .0468033    -0.35   0.724    -.1082855    .0752164
         44  |  -.0063783   .0481439    -0.13   0.895    -.1007571    .0880006
         45  |   -.004648    .049587    -0.09   0.925    -.1018559    .0925599
         46  |   .0021565   .0512248     0.04   0.966    -.0982619     .102575
         47  |   .0157238   .0522283     0.30   0.763    -.0866619    .1181094
         48  |  -.0012765   .0529901    -0.02   0.981    -.1051557    .1026026
         49  |  -.2551919    .054771    -4.66   0.000    -.3625623   -.1478215
         50  |  -.3050486   .0564954    -5.40   0.000    -.4157994   -.1942978
             |
     age_cat |
          1  |   .0693102   .0152927     4.53   0.000     .0393312    .0992891
          2  |   .1154623   .0166462     6.94   0.000       .08283    .1480947
          3  |   .1450819   .0179762     8.07   0.000     .1098423    .1803215
          4  |   .1793333   .0192045     9.34   0.000     .1416857    .2169809
          5  |    .212799   .0203494    10.46   0.000      .172907    .2526909
          6  |   .2301958   .0216312    10.64   0.000      .187791    .2726007
          7  |   .2422119   .0230405    10.51   0.000     .1970445    .2873794
          8  |   .2742663   .0244496    11.22   0.000     .2263365     .322196
          9  |   .2862324   .0260543    10.99   0.000     .2351568    .3373079
         10  |   .2962651   .0276788    10.70   0.000     .2420049    .3505254
         11  |   .3159814    .029261    10.80   0.000     .2586196    .3733432
         12  |   .3354393    .030851    10.87   0.000     .2749605    .3959181
         13  |   .3358797   .0325288    10.33   0.000     .2721119    .3996475
         14  |   .3384526   .0342831     9.87   0.000     .2712458    .4056595
         15  |   .3592661   .0357306    10.05   0.000     .2892216    .4293106
         16  |   .3679777   .0374538     9.82   0.000     .2945552    .4414002
         17  |   .3749527    .039178     9.57   0.000     .2981501    .4517553
         18  |   .3706216    .041014     9.04   0.000     .2902198    .4510234
         19  |   .3908226   .0430071     9.09   0.000     .3065137    .4751316
         20  |   .3978768   .0457325     8.70   0.000     .3082252    .4875284
         25  |   .4029753   .0517721     7.78   0.000     .3014839    .5044668
         30  |   .4316945   .0701366     6.16   0.000     .2942023    .5691867
         40  |   .4395139   .0771156     5.70   0.000     .2883403    .5906875
         50  |   .3816347   .0829037     4.60   0.000     .2191145    .5441549
             |
       _cons |   .1640216   .0293896     5.58   0.000     .1064076    .2216356
-------------+----------------------------------------------------------------
     sigma_u |  .40134083
     sigma_e |  .29506435
         rho |  .64913408   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0531376145045325

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    156,204
Group variable: firm_person                     Number of groups  =     16,977

R-sq:                                           Obs per group:
     within  = 0.0531                                         min =          1
     between = 0.0415                                         avg =        9.2
     overall = 0.0414                                         max =         25

                                                F(78,6146)        =      14.71
corr(u_i, Xb)  = -0.0022                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 6,147 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0364314   .0183854     1.98   0.048     .0003897    .0724732
      during |   .0038957   .0053511     0.73   0.467    -.0065943    .0143858
       after |  -.0156174   .0086046    -1.82   0.070    -.0324854    .0012505
during_expat |   .0273704   .0151324     1.81   0.071    -.0022944    .0570351
 after_expat |     .04279    .022036     1.94   0.052    -.0004082    .0859883
             |
    ind_year |
          2  |  -.0112573   .0204013    -0.55   0.581     -.051251    .0287364
          3  |   -.009808   .0245127    -0.40   0.689    -.0578615    .0382455
          4  |  -.0385691   .0248332    -1.55   0.120    -.0872509    .0101127
          5  |  -.0433957    .026507    -1.64   0.102    -.0953587    .0085674
          6  |  -.0713397   .0276807    -2.58   0.010    -.1256035   -.0170758
          7  |  -.0918387    .028535    -3.22   0.001    -.1477772   -.0359002
          8  |  -.0982275   .0298451    -3.29   0.001    -.1567344   -.0397206
          9  |  -.1070031   .0313183    -3.42   0.001    -.1683979   -.0456083
         10  |  -.1021834    .032317    -3.16   0.002     -.165536   -.0388309
         11  |  -.1144696   .0335409    -3.41   0.001    -.1802215   -.0487176
         12  |  -.1267869   .0348424    -3.64   0.000    -.1950902   -.0584837
         13  |  -.1313494   .0364525    -3.60   0.000    -.2028091   -.0598897
         14  |  -.1280667   .0380085    -3.37   0.001    -.2025766   -.0535568
         15  |  -.1175695   .0392769    -2.99   0.003     -.194566    -.040573
         16  |  -.1041634    .040626    -2.56   0.010    -.1838046   -.0245221
         17  |  -.0941958   .0421992    -2.23   0.026    -.1769209   -.0114706
         18  |  -.0842801   .0436284    -1.93   0.053    -.1698069    .0012468
         19  |  -.0868474   .0449376    -1.93   0.053    -.1749408     .001246
         20  |  -.0875733   .0463334    -1.89   0.059     -.178403    .0032563
         21  |  -.1030366   .0475745    -2.17   0.030    -.1962993   -.0097739
         22  |  -.0866498   .0487008    -1.78   0.075    -.1821204    .0088209
         23  |  -.0998569   .0497346    -2.01   0.045    -.1973542   -.0023597
         24  |  -.2027975   .0510959    -3.97   0.000    -.3029633   -.1026317
         25  |  -.2415789   .0525785    -4.59   0.000    -.3446511   -.1385067
         26  |   .0683229   .0471277     1.45   0.147    -.0240639    .1607098
         27  |   .0282568    .041746     0.68   0.499    -.0535799    .1100935
         28  |   .0594865    .039189     1.52   0.129    -.0173377    .1363107
         29  |   .0150276   .0386171     0.39   0.697    -.0606754    .0907306
         30  |   .0122322   .0370051     0.33   0.741    -.0603108    .0847751
         31  |  -.0138009   .0361873    -0.38   0.703    -.0847407    .0571388
         32  |   .0087672   .0358725     0.24   0.807    -.0615555    .0790899
         33  |   -.000426   .0355936    -0.01   0.990    -.0702018    .0693499
         34  |  -.0061021   .0367903    -0.17   0.868    -.0782241    .0660198
         35  |  -.0132177   .0374666    -0.35   0.724    -.0866653      .06023
         36  |  -.0058397   .0383408    -0.15   0.879    -.0810012    .0693217
         37  |  -.0257788   .0391953    -0.66   0.511    -.1026154    .0510577
         38  |  -.0262296   .0405263    -0.65   0.518    -.1056754    .0532163
         39  |  -.0419669   .0419418    -1.00   0.317    -.1241874    .0402536
         40  |  -.0348326   .0427815    -0.81   0.416    -.1186994    .0490342
         41  |  -.0292792   .0440889    -0.66   0.507    -.1157088    .0571504
         42  |  -.0211925   .0452433    -0.47   0.640    -.1098852    .0675002
         43  |  -.0165346   .0468033    -0.35   0.724    -.1082855    .0752164
         44  |  -.0063783   .0481439    -0.13   0.895    -.1007571    .0880006
         45  |   -.004648    .049587    -0.09   0.925    -.1018559    .0925599
         46  |   .0021565   .0512248     0.04   0.966    -.0982619     .102575
         47  |   .0157238   .0522283     0.30   0.763    -.0866619    .1181094
         48  |  -.0012765   .0529901    -0.02   0.981    -.1051557    .1026026
         49  |  -.2551919    .054771    -4.66   0.000    -.3625623   -.1478215
         50  |  -.3050486   .0564954    -5.40   0.000    -.4157994   -.1942978
             |
     age_cat |
          1  |   .0693102   .0152927     4.53   0.000     .0393312    .0992891
          2  |   .1154623   .0166462     6.94   0.000       .08283    .1480947
          3  |   .1450819   .0179762     8.07   0.000     .1098423    .1803215
          4  |   .1793333   .0192045     9.34   0.000     .1416857    .2169809
          5  |    .212799   .0203494    10.46   0.000      .172907    .2526909
          6  |   .2301958   .0216312    10.64   0.000      .187791    .2726007
          7  |   .2422119   .0230405    10.51   0.000     .1970445    .2873794
          8  |   .2742663   .0244496    11.22   0.000     .2263365     .322196
          9  |   .2862324   .0260543    10.99   0.000     .2351568    .3373079
         10  |   .2962651   .0276788    10.70   0.000     .2420049    .3505254
         11  |   .3159814    .029261    10.80   0.000     .2586196    .3733432
         12  |   .3354393    .030851    10.87   0.000     .2749605    .3959181
         13  |   .3358797   .0325288    10.33   0.000     .2721119    .3996475
         14  |   .3384526   .0342831     9.87   0.000     .2712458    .4056595
         15  |   .3592661   .0357306    10.05   0.000     .2892216    .4293106
         16  |   .3679777   .0374538     9.82   0.000     .2945552    .4414002
         17  |   .3749527    .039178     9.57   0.000     .2981501    .4517553
         18  |   .3706216    .041014     9.04   0.000     .2902198    .4510234
         19  |   .3908226   .0430071     9.09   0.000     .3065137    .4751316
         20  |   .3978768   .0457325     8.70   0.000     .3082252    .4875284
         25  |   .4029753   .0517721     7.78   0.000     .3014839    .5044668
         30  |   .4316945   .0701366     6.16   0.000     .2942023    .5691867
         40  |   .4395139   .0771156     5.70   0.000     .2883403    .5906875
         50  |   .3816347   .0829037     4.60   0.000     .2191145    .5441549
             |
       _cons |   .1640216   .0293896     5.58   0.000     .1064076    .2216356
-------------+----------------------------------------------------------------
     sigma_u |  .40134083
     sigma_e |  .29506435
         rho |  .64913408   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    144967
Group variable: firm_person                     Number of groups   =     15682

R-sq:  within  = 0.0517                         Obs per group: min =         1
       between = 0.0182                                        avg =       9.2
       overall = 0.0231                                        max =        25

                                                F(78,5715)         =     13.55
corr(u_i, Xb)  = -0.0449                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 5,716 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0201189   .0175698     1.15   0.252    -.0143246    .0545625
      during |   .0087088   .0057823     1.51   0.132    -.0026266    .0200443
       after |  -.0055207   .0092157    -0.60   0.549    -.0235869    .0125455
during_expat |       .023    .017777     1.29   0.196    -.0118496    .0578497
 after_expat |   .0200557   .0242945     0.83   0.409    -.0275707    .0676821
             |
    ind_year |
          2  |   .0022885   .0196599     0.12   0.907    -.0362524    .0408294
          3  |   .0013093   .0232967     0.06   0.955    -.0443611    .0469798
          4  |  -.0329672   .0239503    -1.38   0.169     -.079919    .0139845
          5  |  -.0162456   .0265707    -0.61   0.541    -.0683342     .035843
          6  |  -.0433021   .0281242    -1.54   0.124    -.0984362     .011832
          7  |  -.0492086    .029445    -1.67   0.095    -.1069319    .0085148
          8  |  -.0624385   .0304585    -2.05   0.040    -.1221487   -.0027283
          9  |   -.070088   .0321185    -2.18   0.029    -.1330524   -.0071236
         10  |  -.0624167    .033308    -1.87   0.061    -.1277129    .0028796
         11  |  -.0791441   .0346239    -2.29   0.022    -.1470201   -.0112681
         12  |  -.0973021   .0359873    -2.70   0.007     -.167851   -.0267533
         13  |  -.0945449   .0375555    -2.52   0.012     -.168168   -.0209218
         14  |  -.0890899   .0390768    -2.28   0.023    -.1656952   -.0124846
         15  |  -.0756928   .0403552    -1.88   0.061    -.1548043    .0034186
         16  |  -.0586228   .0418249    -1.40   0.161    -.1406155      .02337
         17  |   -.041178    .043408    -0.95   0.343    -.1262741    .0439181
         18  |  -.0340649   .0449772    -0.76   0.449    -.1222373    .0541075
         19  |  -.0344297   .0463441    -0.74   0.458    -.1252817    .0564223
         20  |  -.0292944   .0476978    -0.61   0.539    -.1228001    .0642113
         21  |  -.0440263   .0489032    -0.90   0.368     -.139895    .0518424
         22  |  -.0392065   .0500186    -0.78   0.433    -.1372619    .0588489
         23  |   -.055072     .05107    -1.08   0.281    -.1551885    .0450445
         24  |  -.1590214   .0524674    -3.03   0.002    -.2618773   -.0561654
         25  |  -.2097818   .0541648    -3.87   0.000    -.3159654   -.1035982
         26  |    .063306   .0520773     1.22   0.224    -.0387852    .1653973
         27  |   .0248724   .0461025     0.54   0.590     -.065506    .1152508
         28  |   .0563502   .0432012     1.30   0.192    -.0283406    .1410409
         29  |   .0092047   .0407195     0.23   0.821    -.0706208    .0890303
         30  |   .0412466   .0392206     1.05   0.293    -.0356407    .1181338
         31  |  -.0036258   .0386043    -0.09   0.925    -.0793048    .0720532
         32  |   .0197768   .0382786     0.52   0.605    -.0552637    .0948173
         33  |    .008807   .0373037     0.24   0.813    -.0643223    .0819364
         34  |   .0067551   .0384605     0.18   0.861    -.0686419    .0821522
         35  |  -.0078703   .0391259    -0.20   0.841    -.0845718    .0688313
         36  |    .002221   .0400921     0.06   0.956    -.0763747    .0808166
         37  |  -.0082823   .0408441    -0.20   0.839    -.0883522    .0717876
         38  |  -.0029885   .0423166    -0.07   0.944    -.0859452    .0799681
         39  |  -.0219766   .0437407    -0.50   0.615     -.107725    .0637718
         40  |  -.0071506   .0443863    -0.16   0.872    -.0941645    .0798633
         41  |   .0061456   .0458378     0.13   0.893    -.0837139    .0960051
         42  |   .0170021   .0468407     0.36   0.717    -.0748233    .1088276
         43  |   .0151999     .04836     0.31   0.753     -.079604    .1100039
         44  |   .0271851   .0499495     0.54   0.586     -.070735    .1251051
         45  |   .0257639   .0515137     0.50   0.617    -.0752224    .1267502
         46  |   .0302803   .0532664     0.57   0.570     -.074142    .1347027
         47  |   .0395984   .0542326     0.73   0.465     -.066718    .1459149
         48  |   .0336257   .0549317     0.61   0.540    -.0740613    .1413127
         49  |  -.2206992   .0567533    -3.89   0.000    -.3319573   -.1094412
         50  |   -.264806    .058694    -4.51   0.000    -.3798686   -.1497435
             |
     age_cat |
          1  |   .0803702   .0191239     4.20   0.000     .0428801    .1178602
          2  |   .1178383   .0199846     5.90   0.000     .0786609    .1570158
          3  |   .1367784   .0210826     6.49   0.000     .0954485    .1781084
          4  |    .175203   .0223309     7.85   0.000      .131426      .21898
          5  |   .2119128   .0234979     9.02   0.000      .165848    .2579776
          6  |   .2257959   .0247815     9.11   0.000     .1772148     .274377
          7  |   .2378773   .0261626     9.09   0.000     .1865888    .2891659
          8  |   .2676904   .0275551     9.71   0.000      .213672    .3217087
          9  |   .2730758    .029131     9.37   0.000     .2159681    .3301835
         10  |   .2821878   .0308496     9.15   0.000      .221711    .3426647
         11  |   .3030018   .0324542     9.34   0.000     .2393792    .3666243
         12  |   .3161132   .0339854     9.30   0.000      .249489    .3827374
         13  |   .3216703   .0356055     9.03   0.000       .25187    .3914706
         14  |   .3306443   .0373274     8.86   0.000     .2574685    .4038201
         15  |   .3438359   .0387602     8.87   0.000     .2678512    .4198206
         16  |   .3564009   .0405061     8.80   0.000     .2769936    .4358082
         17  |   .3681416   .0421478     8.73   0.000     .2855159    .4507672
         18  |   .3589517     .04406     8.15   0.000     .2725774    .4453259
         19  |   .3652264   .0459902     7.94   0.000     .2750681    .4553846
         20  |   .3850834   .0486719     7.91   0.000     .2896679    .4804989
         25  |   .4008624   .0547273     7.32   0.000     .2935761    .5081486
         30  |   .4096317   .0729682     5.61   0.000     .2665864    .5526769
         40  |   .4171844   .0798769     5.22   0.000     .2605953    .5737735
         50  |    .348935   .0853375     4.09   0.000     .1816411     .516229
             |
       _cons |   .1559753   .0312365     4.99   0.000     .0947399    .2172107
-------------+----------------------------------------------------------------
     sigma_u |  .40798647
     sigma_e |  .30271157
         rho |  .64494839   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0517418721778482

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    144,967
Group variable: firm_person                     Number of groups  =     15,682

R-sq:                                           Obs per group:
     within  = 0.0517                                         min =          1
     between = 0.0182                                         avg =        9.2
     overall = 0.0231                                         max =         25

                                                F(78,5715)        =      13.55
corr(u_i, Xb)  = -0.0449                        Prob > F          =     0.0000

                                 (Std. Err. adjusted for 5,716 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0201189   .0175698     1.15   0.252    -.0143246    .0545625
      during |   .0087088   .0057823     1.51   0.132    -.0026266    .0200443
       after |  -.0055207   .0092157    -0.60   0.549    -.0235869    .0125455
during_expat |       .023    .017777     1.29   0.196    -.0118496    .0578497
 after_expat |   .0200557   .0242945     0.83   0.409    -.0275707    .0676821
             |
    ind_year |
          2  |   .0022885   .0196599     0.12   0.907    -.0362524    .0408294
          3  |   .0013093   .0232967     0.06   0.955    -.0443611    .0469798
          4  |  -.0329672   .0239503    -1.38   0.169     -.079919    .0139845
          5  |  -.0162456   .0265707    -0.61   0.541    -.0683342     .035843
          6  |  -.0433021   .0281242    -1.54   0.124    -.0984362     .011832
          7  |  -.0492086    .029445    -1.67   0.095    -.1069319    .0085148
          8  |  -.0624385   .0304585    -2.05   0.040    -.1221487   -.0027283
          9  |   -.070088   .0321185    -2.18   0.029    -.1330524   -.0071236
         10  |  -.0624167    .033308    -1.87   0.061    -.1277129    .0028796
         11  |  -.0791441   .0346239    -2.29   0.022    -.1470201   -.0112681
         12  |  -.0973021   .0359873    -2.70   0.007     -.167851   -.0267533
         13  |  -.0945449   .0375555    -2.52   0.012     -.168168   -.0209218
         14  |  -.0890899   .0390768    -2.28   0.023    -.1656952   -.0124846
         15  |  -.0756928   .0403552    -1.88   0.061    -.1548043    .0034186
         16  |  -.0586228   .0418249    -1.40   0.161    -.1406155      .02337
         17  |   -.041178    .043408    -0.95   0.343    -.1262741    .0439181
         18  |  -.0340649   .0449772    -0.76   0.449    -.1222373    .0541075
         19  |  -.0344297   .0463441    -0.74   0.458    -.1252817    .0564223
         20  |  -.0292944   .0476978    -0.61   0.539    -.1228001    .0642113
         21  |  -.0440263   .0489032    -0.90   0.368     -.139895    .0518424
         22  |  -.0392065   .0500186    -0.78   0.433    -.1372619    .0588489
         23  |   -.055072     .05107    -1.08   0.281    -.1551885    .0450445
         24  |  -.1590214   .0524674    -3.03   0.002    -.2618773   -.0561654
         25  |  -.2097818   .0541648    -3.87   0.000    -.3159654   -.1035982
         26  |    .063306   .0520773     1.22   0.224    -.0387852    .1653973
         27  |   .0248724   .0461025     0.54   0.590     -.065506    .1152508
         28  |   .0563502   .0432012     1.30   0.192    -.0283406    .1410409
         29  |   .0092047   .0407195     0.23   0.821    -.0706208    .0890303
         30  |   .0412466   .0392206     1.05   0.293    -.0356407    .1181338
         31  |  -.0036258   .0386043    -0.09   0.925    -.0793048    .0720532
         32  |   .0197768   .0382786     0.52   0.605    -.0552637    .0948173
         33  |    .008807   .0373037     0.24   0.813    -.0643223    .0819364
         34  |   .0067551   .0384605     0.18   0.861    -.0686419    .0821522
         35  |  -.0078703   .0391259    -0.20   0.841    -.0845718    .0688313
         36  |    .002221   .0400921     0.06   0.956    -.0763747    .0808166
         37  |  -.0082823   .0408441    -0.20   0.839    -.0883522    .0717876
         38  |  -.0029885   .0423166    -0.07   0.944    -.0859452    .0799681
         39  |  -.0219766   .0437407    -0.50   0.615     -.107725    .0637718
         40  |  -.0071506   .0443863    -0.16   0.872    -.0941645    .0798633
         41  |   .0061456   .0458378     0.13   0.893    -.0837139    .0960051
         42  |   .0170021   .0468407     0.36   0.717    -.0748233    .1088276
         43  |   .0151999     .04836     0.31   0.753     -.079604    .1100039
         44  |   .0271851   .0499495     0.54   0.586     -.070735    .1251051
         45  |   .0257639   .0515137     0.50   0.617    -.0752224    .1267502
         46  |   .0302803   .0532664     0.57   0.570     -.074142    .1347027
         47  |   .0395984   .0542326     0.73   0.465     -.066718    .1459149
         48  |   .0336257   .0549317     0.61   0.540    -.0740613    .1413127
         49  |  -.2206992   .0567533    -3.89   0.000    -.3319573   -.1094412
         50  |   -.264806    .058694    -4.51   0.000    -.3798686   -.1497435
             |
     age_cat |
          1  |   .0803702   .0191239     4.20   0.000     .0428801    .1178602
          2  |   .1178383   .0199846     5.90   0.000     .0786609    .1570158
          3  |   .1367784   .0210826     6.49   0.000     .0954485    .1781084
          4  |    .175203   .0223309     7.85   0.000      .131426      .21898
          5  |   .2119128   .0234979     9.02   0.000      .165848    .2579776
          6  |   .2257959   .0247815     9.11   0.000     .1772148     .274377
          7  |   .2378773   .0261626     9.09   0.000     .1865888    .2891659
          8  |   .2676904   .0275551     9.71   0.000      .213672    .3217087
          9  |   .2730758    .029131     9.37   0.000     .2159681    .3301835
         10  |   .2821878   .0308496     9.15   0.000      .221711    .3426647
         11  |   .3030018   .0324542     9.34   0.000     .2393792    .3666243
         12  |   .3161132   .0339854     9.30   0.000      .249489    .3827374
         13  |   .3216703   .0356055     9.03   0.000       .25187    .3914706
         14  |   .3306443   .0373274     8.86   0.000     .2574685    .4038201
         15  |   .3438359   .0387602     8.87   0.000     .2678512    .4198206
         16  |   .3564009   .0405061     8.80   0.000     .2769936    .4358082
         17  |   .3681416   .0421478     8.73   0.000     .2855159    .4507672
         18  |   .3589517     .04406     8.15   0.000     .2725774    .4453259
         19  |   .3652264   .0459902     7.94   0.000     .2750681    .4553846
         20  |   .3850834   .0486719     7.91   0.000     .2896679    .4804989
         25  |   .4008624   .0547273     7.32   0.000     .2935761    .5081486
         30  |   .4096317   .0729682     5.61   0.000     .2665864    .5526769
         40  |   .4171844   .0798769     5.22   0.000     .2605953    .5737735
         50  |    .348935   .0853375     4.09   0.000     .1816411     .516229
             |
       _cons |   .1559753   .0312365     4.99   0.000     .0947399    .2172107
-------------+----------------------------------------------------------------
     sigma_u |  .40798647
     sigma_e |  .30271157
         rho |  .64494839   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    132749
Group variable: firm_person                     Number of groups   =     14465

R-sq:  within  = 0.0528                         Obs per group: min =         1
       between = 0.1332                                        avg =       9.2
       overall = 0.0805                                        max =        25

                                                F(78,4832)         =     11.67
corr(u_i, Xb)  = 0.1656                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 4,833 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .012624   .0184564     0.68   0.494    -.0235589    .0488068
      during |  -.0526989   .0062331    -8.45   0.000    -.0649186   -.0404791
       after |  -.0745669   .0099932    -7.46   0.000    -.0941581   -.0549757
during_expat |   .0436255   .0163033     2.68   0.007     .0116637    .0755874
 after_expat |   .0625923   .0211399     2.96   0.003     .0211486    .1040361
             |
    ind_year |
          2  |  -.0259048   .0194506    -1.33   0.183    -.0640368    .0122272
          3  |  -.0177482   .0247857    -0.72   0.474    -.0663394     .030843
          4  |  -.0585544   .0264525    -2.21   0.027    -.1104133   -.0066954
          5  |   -.050569    .029106    -1.74   0.082    -.1076299    .0064919
          6  |  -.0684288   .0309955    -2.21   0.027    -.1291941   -.0076634
          7  |  -.0811607   .0327547    -2.48   0.013    -.1453748   -.0169465
          8  |  -.0973225   .0340016    -2.86   0.004     -.163981   -.0306639
          9  |  -.1159733   .0357992    -3.24   0.001    -.1861561   -.0457905
         10  |  -.0906722   .0369696    -2.45   0.014    -.1631495   -.0181949
         11  |  -.1035369   .0383913    -2.70   0.007    -.1788014   -.0282725
         12  |  -.1019155   .0397756    -2.56   0.010    -.1798938   -.0239371
         13  |  -.0932557   .0413801    -2.25   0.024    -.1743795   -.0121319
         14  |  -.0912857   .0428528    -2.13   0.033    -.1752967   -.0072747
         15  |  -.0749167   .0437906    -1.71   0.087    -.1607663    .0109329
         16  |  -.0729277   .0451657    -1.61   0.106     -.161473    .0156175
         17  |  -.0467253   .0466726    -1.00   0.317    -.1382248    .0447742
         18  |  -.0316223   .0481736    -0.66   0.512    -.1260645    .0628198
         19  |  -.0346908   .0494104    -0.70   0.483    -.1315577    .0621761
         20  |  -.0254476   .0507106    -0.50   0.616    -.1248635    .0739682
         21  |  -.0483977   .0517887    -0.93   0.350    -.1499271    .0531318
         22  |  -.0270504   .0526807    -0.51   0.608    -.1303287    .0762278
         23  |  -.0447743   .0535164    -0.84   0.403    -.1496907    .0601422
         24  |  -.1567223   .0543118    -2.89   0.004    -.2631982   -.0502465
         25  |  -.1910849   .0557524    -3.43   0.001     -.300385   -.0817847
         26  |    .104095   .0450093     2.31   0.021     .0158563    .1923336
         27  |   .0746493   .0415644     1.80   0.073    -.0068359    .1561345
         28  |   .1112547   .0399298     2.79   0.005     .0329741    .1895353
         29  |   .0620408   .0397646     1.56   0.119     -.015916    .1399976
         30  |   .0734723   .0391015     1.88   0.060    -.0031845    .1501291
         31  |   .0562953   .0390372     1.44   0.149    -.0202353     .132826
         32  |   .0575062   .0390296     1.47   0.141    -.0190096    .1340219
         33  |   .0439104    .039036     1.12   0.261    -.0326179    .1204386
         34  |   .0418181   .0401753     1.04   0.298    -.0369437    .1205799
         35  |   .0371832   .0408742     0.91   0.363    -.0429488    .1173153
         36  |   .0374522   .0419517     0.89   0.372    -.0447923    .1196966
         37  |   .0330763   .0429121     0.77   0.441     -.051051    .1172037
         38  |   .0346483    .044076     0.79   0.432    -.0517607    .1210573
         39  |   .0173035   .0456024     0.38   0.704     -.072098     .106705
         40  |   .0408802   .0463666     0.88   0.378    -.0500194    .1317799
         41  |   .0398548   .0476037     0.84   0.403    -.0534702    .1331798
         42  |   .0318669   .0488536     0.65   0.514    -.0639084    .1276422
         43  |   .0412421    .050274     0.82   0.412    -.0573179    .1398021
         44  |   .0456022   .0515225     0.89   0.376    -.0554054    .1466098
         45  |   .0485404   .0530631     0.91   0.360    -.0554875    .1525683
         46  |    .062516   .0546695     1.14   0.253    -.0446612    .1696931
         47  |   .0667965   .0556487     1.20   0.230    -.0423002    .1758933
         48  |   .0580007   .0565088     1.03   0.305    -.0527823    .1687837
         49  |  -.2457238   .0583584    -4.21   0.000    -.3601328   -.1313148
         50  |  -.2963641    .060066    -4.93   0.000    -.4141208   -.1786073
             |
     age_cat |
          1  |   .0911967   .0298815     3.05   0.002     .0326153     .149778
          2  |   .1120303   .0317861     3.52   0.000      .049715    .1743456
          3  |   .1239985   .0331159     3.74   0.000     .0590763    .1889207
          4  |   .1499101   .0344191     4.36   0.000      .082433    .2173873
          5  |   .1817855   .0354015     5.13   0.000     .1123826    .2511885
          6  |   .1843772   .0365693     5.04   0.000     .1126848    .2560696
          7  |   .1892907   .0379897     4.98   0.000     .1148136    .2637677
          8  |   .2032441   .0390097     5.21   0.000     .1267674    .2797209
          9  |   .2094477   .0401208     5.22   0.000     .1307927    .2881027
         10  |   .2076587    .041448     5.01   0.000     .1264019    .2889156
         11  |   .2104751   .0425208     4.95   0.000     .1271149    .2938352
         12  |     .21231    .043724     4.86   0.000     .1265911    .2980289
         13  |    .208513   .0450344     4.63   0.000     .1202251     .296801
         14  |   .2090192   .0463439     4.51   0.000     .1181641    .2998742
         15  |     .22644   .0474559     4.77   0.000     .1334048    .3194751
         16  |   .2240313   .0488473     4.59   0.000     .1282684    .3197941
         17  |   .2338682   .0501325     4.67   0.000     .1355857    .3321508
         18  |   .2222914   .0516662     4.30   0.000     .1210021    .3235806
         19  |   .2144439   .0531969     4.03   0.000     .1101537    .3187341
         20  |   .2205892   .0556985     3.96   0.000     .1113948    .3297836
         25  |   .2279224   .0609388     3.74   0.000     .1084546    .3473902
         30  |    .241671   .0750383     3.22   0.001     .0945618    .3887802
         40  |   .2270071   .0802766     2.83   0.005     .0696284    .3843857
         50  |   .1640449   .0855092     1.92   0.055     -.003592    .3316818
             |
       _cons |   .4587521   .0415344    11.05   0.000     .3773257    .5401785
-------------+----------------------------------------------------------------
     sigma_u |  .40807565
     sigma_e |  .29647834
         rho |  .65451761   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0527556391073849

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    132,749
Group variable: firm_person                     Number of groups  =     14,465

R-sq:                                           Obs per group:
     within  = 0.0528                                         min =          1
     between = 0.1332                                         avg =        9.2
     overall = 0.0805                                         max =         25

                                                F(78,4832)        =      11.67
corr(u_i, Xb)  = 0.1656                         Prob > F          =     0.0000

                                 (Std. Err. adjusted for 4,833 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .012624   .0184564     0.68   0.494    -.0235589    .0488068
      during |  -.0526989   .0062331    -8.45   0.000    -.0649186   -.0404791
       after |  -.0745669   .0099932    -7.46   0.000    -.0941581   -.0549757
during_expat |   .0436255   .0163033     2.68   0.007     .0116637    .0755874
 after_expat |   .0625923   .0211399     2.96   0.003     .0211486    .1040361
             |
    ind_year |
          2  |  -.0259048   .0194506    -1.33   0.183    -.0640368    .0122272
          3  |  -.0177482   .0247857    -0.72   0.474    -.0663394     .030843
          4  |  -.0585544   .0264525    -2.21   0.027    -.1104133   -.0066954
          5  |   -.050569    .029106    -1.74   0.082    -.1076299    .0064919
          6  |  -.0684288   .0309955    -2.21   0.027    -.1291941   -.0076634
          7  |  -.0811607   .0327547    -2.48   0.013    -.1453748   -.0169465
          8  |  -.0973225   .0340016    -2.86   0.004     -.163981   -.0306639
          9  |  -.1159733   .0357992    -3.24   0.001    -.1861561   -.0457905
         10  |  -.0906722   .0369696    -2.45   0.014    -.1631495   -.0181949
         11  |  -.1035369   .0383913    -2.70   0.007    -.1788014   -.0282725
         12  |  -.1019155   .0397756    -2.56   0.010    -.1798938   -.0239371
         13  |  -.0932557   .0413801    -2.25   0.024    -.1743795   -.0121319
         14  |  -.0912857   .0428528    -2.13   0.033    -.1752967   -.0072747
         15  |  -.0749167   .0437906    -1.71   0.087    -.1607663    .0109329
         16  |  -.0729277   .0451657    -1.61   0.106     -.161473    .0156175
         17  |  -.0467253   .0466726    -1.00   0.317    -.1382248    .0447742
         18  |  -.0316223   .0481736    -0.66   0.512    -.1260645    .0628198
         19  |  -.0346908   .0494104    -0.70   0.483    -.1315577    .0621761
         20  |  -.0254476   .0507106    -0.50   0.616    -.1248635    .0739682
         21  |  -.0483977   .0517887    -0.93   0.350    -.1499271    .0531318
         22  |  -.0270504   .0526807    -0.51   0.608    -.1303287    .0762278
         23  |  -.0447743   .0535164    -0.84   0.403    -.1496907    .0601422
         24  |  -.1567223   .0543118    -2.89   0.004    -.2631982   -.0502465
         25  |  -.1910849   .0557524    -3.43   0.001     -.300385   -.0817847
         26  |    .104095   .0450093     2.31   0.021     .0158563    .1923336
         27  |   .0746493   .0415644     1.80   0.073    -.0068359    .1561345
         28  |   .1112547   .0399298     2.79   0.005     .0329741    .1895353
         29  |   .0620408   .0397646     1.56   0.119     -.015916    .1399976
         30  |   .0734723   .0391015     1.88   0.060    -.0031845    .1501291
         31  |   .0562953   .0390372     1.44   0.149    -.0202353     .132826
         32  |   .0575062   .0390296     1.47   0.141    -.0190096    .1340219
         33  |   .0439104    .039036     1.12   0.261    -.0326179    .1204386
         34  |   .0418181   .0401753     1.04   0.298    -.0369437    .1205799
         35  |   .0371832   .0408742     0.91   0.363    -.0429488    .1173153
         36  |   .0374522   .0419517     0.89   0.372    -.0447923    .1196966
         37  |   .0330763   .0429121     0.77   0.441     -.051051    .1172037
         38  |   .0346483    .044076     0.79   0.432    -.0517607    .1210573
         39  |   .0173035   .0456024     0.38   0.704     -.072098     .106705
         40  |   .0408802   .0463666     0.88   0.378    -.0500194    .1317799
         41  |   .0398548   .0476037     0.84   0.403    -.0534702    .1331798
         42  |   .0318669   .0488536     0.65   0.514    -.0639084    .1276422
         43  |   .0412421    .050274     0.82   0.412    -.0573179    .1398021
         44  |   .0456022   .0515225     0.89   0.376    -.0554054    .1466098
         45  |   .0485404   .0530631     0.91   0.360    -.0554875    .1525683
         46  |    .062516   .0546695     1.14   0.253    -.0446612    .1696931
         47  |   .0667965   .0556487     1.20   0.230    -.0423002    .1758933
         48  |   .0580007   .0565088     1.03   0.305    -.0527823    .1687837
         49  |  -.2457238   .0583584    -4.21   0.000    -.3601328   -.1313148
         50  |  -.2963641    .060066    -4.93   0.000    -.4141208   -.1786073
             |
     age_cat |
          1  |   .0911967   .0298815     3.05   0.002     .0326153     .149778
          2  |   .1120303   .0317861     3.52   0.000      .049715    .1743456
          3  |   .1239985   .0331159     3.74   0.000     .0590763    .1889207
          4  |   .1499101   .0344191     4.36   0.000      .082433    .2173873
          5  |   .1817855   .0354015     5.13   0.000     .1123826    .2511885
          6  |   .1843772   .0365693     5.04   0.000     .1126848    .2560696
          7  |   .1892907   .0379897     4.98   0.000     .1148136    .2637677
          8  |   .2032441   .0390097     5.21   0.000     .1267674    .2797209
          9  |   .2094477   .0401208     5.22   0.000     .1307927    .2881027
         10  |   .2076587    .041448     5.01   0.000     .1264019    .2889156
         11  |   .2104751   .0425208     4.95   0.000     .1271149    .2938352
         12  |     .21231    .043724     4.86   0.000     .1265911    .2980289
         13  |    .208513   .0450344     4.63   0.000     .1202251     .296801
         14  |   .2090192   .0463439     4.51   0.000     .1181641    .2998742
         15  |     .22644   .0474559     4.77   0.000     .1334048    .3194751
         16  |   .2240313   .0488473     4.59   0.000     .1282684    .3197941
         17  |   .2338682   .0501325     4.67   0.000     .1355857    .3321508
         18  |   .2222914   .0516662     4.30   0.000     .1210021    .3235806
         19  |   .2144439   .0531969     4.03   0.000     .1101537    .3187341
         20  |   .2205892   .0556985     3.96   0.000     .1113948    .3297836
         25  |   .2279224   .0609388     3.74   0.000     .1084546    .3473902
         30  |    .241671   .0750383     3.22   0.001     .0945618    .3887802
         40  |   .2270071   .0802766     2.83   0.005     .0696284    .3843857
         50  |   .1640449   .0855092     1.92   0.055     -.003592    .3316818
             |
       _cons |   .4587521   .0415344    11.05   0.000     .3773257    .5401785
-------------+----------------------------------------------------------------
     sigma_u |  .40807565
     sigma_e |  .29647834
         rho |  .65451761   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
. *Szelekció az akvicíziós mintában
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. areg f1.expat `outcomes' if ever_foreign==1&greenfield!=1, a(industry_year) clus
> ter(frame_id)

Linear regression, absorbing indicators         Number of obs     =     71,888
                                                F(   4,   1269)   =      10.54
                                                Prob > F          =     0.0000
                                                R-squared         =     0.0887
                                                Adj R-squared     =     0.0677
                                                Root MSE          =     0.4501

                           (Std. Err. adjusted for 1,270 clusters in frame_id)
------------------------------------------------------------------------------
             |               Robust
     F.expat |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         lnL |   .0022776   .0070016     0.33   0.745    -.0114584    .0160137
        lnKL |   .0051357   .0055255     0.93   0.353    -.0057045    .0159759
        lnQL |   .0203787   .0091385     2.23   0.026     .0024505     .038307
    exporter |     .08568   .0167817     5.11   0.000     .0527571    .1186029
       _cons |   .0263859   .0907267     0.29   0.771    -.1516048    .2043767
-------------+----------------------------------------------------------------
industry_y~r |   absorbed                                    (1619 categories)

. do regram output/regression/selection 1 1

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Linear regression, absorbing indicators         Number of obs     =     71,888
                                                F(   4,   1269)   =      10.54
                                                Prob > F          =     0.0000
                                                R-squared         =     0.0887
                                                Adj R-squared     =     0.0677
                                                Root MSE          =     0.4501

                           (Std. Err. adjusted for 1,270 clusters in frame_id)
------------------------------------------------------------------------------
             |               Robust
     F.expat |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         lnL |   .0022776   .0070016     0.33   0.745    -.0114584    .0160137
        lnKL |   .0051357   .0055255     0.93   0.353    -.0057045    .0159759
        lnQL |   .0203787   .0091385     2.23   0.026     .0024505     .038307
    exporter |     .08568   .0167817     5.11   0.000     .0527571    .1186029
       _cons |   .0263859   .0907267     0.29   0.771    -.1516048    .2043767
-------------+----------------------------------------------------------------
industry_y~r |   absorbed                                    (1619 categories)

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
. keep if ever_foreign==1
(316,102 observations deleted)

. 
. foreach X in outcomes sample_acquisitions {
  2.         global `X' ``X''
  3. }

. do event_study

. local N = Tbefore+Tduring+2

. 
. local T1 = Tbefore 

. local T2 = Tduring

. 
. foreach X in domestic expat {
  2.         gen byte `X'_p_0 = tenure==0 & (`X'==1)
  3.         forval t=1/`T1' {
  4.                 gen byte `X'_m_`t' = tenure== -`t' & (`X'==1)
  5.         }
  6.         forval t=1/`T2' {
  7.                 gen byte `X'_p_`t' = tenure== `t' & (`X'==1)
  8.         }
  9.         *replace `X'_p_`T2' = tenure>= `T2' & (`X'==1)
. }

. local X foreign

. gen byte `X'_p_0 = tenure_`X'==0

. forval t=1/`T1' {
  2.         gen byte `X'_m_`t' = tenure_`X'== -`t'
  3. }

. forval t=1/`T2' {
  2.         gen byte `X'_p_`t' = tenure_`X'== `t'
  3. }

. *replace `X'_p_`T2' = tenure_`X'>= `T2' 
. sort frame_id year

. 
. * illustrate window overlap and recoding
. l manager_id expat year tenure* if frame_id=="ft10072219"

        +---------------------------------------------------------------+
  2371. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2006 |       -5 |     -6 |       -6 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -6  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2372. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2006 |       -5 |      0 |        0 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2373. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2006 |       -5 |     -7 |       -7 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2374. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2006 |       -5 |     -7 |       -7 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -7  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2375. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2007 |       -4 |      1 |        1 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         1  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2376. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2007 |       -4 |     -5 |       -5 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -5  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2377. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2007 |       -4 |     -6 |       -6 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2378. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2007 |       -4 |     -6 |       -6 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -6  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2379. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2008 |       -3 |     -5 |       -5 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2380. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2008 |       -3 |     -5 |       -5 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -5  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2381. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2008 |       -3 |      2 |        2 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         2  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2382. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2008 |       -3 |     -4 |       -4 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -4  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2383. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2009 |       -2 |     -4 |       -4 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2384. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2009 |       -2 |     -4 |       -4 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -4  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2385. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2009 |       -2 |      3 |        3 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         3  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2386. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2009 |       -2 |     -3 |       -3 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -3  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2387. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2010 |       -1 |     -2 |       -2 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -2  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2388. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2010 |       -1 |     -3 |       -3 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -3  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2389. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2010 |       -1 |      4 |        4 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         4  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2390. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2010 |       -1 |     -3 |       -3 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2391. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2011 |        0 |      5 |        5 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         5  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2392. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2011 |        0 |     -2 |       -2 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -2  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2393. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2011 |        0 |     -1 |       -1 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -1  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2394. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2011 |        0 |     -2 |       -2 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2395. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2012 |        1 |     -1 |       -1 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        -1  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2396. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2012 |        1 |      0 |        0 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2397. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2012 |        1 |      6 |        6 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         6  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2398. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2012 |        1 |     -1 |       -1 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2399. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2013 |        2 |      1 |        1 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         1  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2400. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2013 |        2 |      7 |        7 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         7  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2401. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2013 |        2 |      0 |        0 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2402. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2013 |        2 |      0 |        0 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2403. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2014 |        3 |      2 |        2 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         2  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2404. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2014 |        3 |      1 |        1 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         1  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2405. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2014 |        3 |      1 |        1 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2406. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2014 |        3 |      8 |        8 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         8  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2407. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2015 |        4 |      2 |        2 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2408. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2015 |        4 |      9 |        9 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         9  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2409. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2015 |        4 |      2 |        2 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         2  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2410. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2015 |        4 |      3 |        3 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         3  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2411. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP18562 |     0 | 2016 |        5 |      3 |        3 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         3  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2412. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP71420 |     0 | 2016 |        5 |     10 |       10 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |        10  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2413. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        |         PP45376 |     0 | 2016 |        5 |      3 |        3 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         0  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

        +---------------------------------------------------------------+
  2414. |      manager_id | expat | year | tenure~n | tenure | tenure~c |
        | PP177715_998327 |     0 | 2016 |        5 |      4 |        4 |
        |---------------------------------------------------------------|
        | tenure~t  |  tenur~DD  |  tenur~DE  |  tenur~ED  |  tenur~EE  |
        |        0  |         4  |         0  |         0  |         0  |
        +---------------------------------------------------------------+

. 
. 
. local Tbefore = Tbefore

. local Tafter = Tduring

. 
. * keep post event and after observations for estimation of fixed effects, but du
> mmy these out
. gen byte post = (after==0) & tenure>Tduring

. gen byte post_expat = post & expat

. 
. foreach Y of var $outcomes {
  2.         * with firm FE, controls are years more than Tbefore before any event
>  happens
.         xtreg `Y' *_m_* *_p_* i.ind_year i.age_cat if $sample_acquisitions & ten
> ure<=Tduring [aw=inverse_weight], i(firm_person) fe vce(cluster id)
  3.         local title : variable label `e(depvar)'
  4. 
.         preserve
  5.         clear
  6.         set obs `N'
  7.         gen t = _n-2-`Tbefore'
  8.         label var t "Time since new manager (year)"
  9. 
.         foreach X in foreign domestic expat  {
 10.                 gen `X'_beta=0
 11.                 gen `X'_lower=0
 12.                 gen `X'_upper=0
 13.                 forval t=-`Tbefore'/`Tafter' {
 14.                         local tag "`t'"
 15.                         if (`t'<0) {
 16.                                 local tag = -`t'
 17.                                 local tag  _m_`tag'
 18.                         }
 19.                         else {
 20.                                 local tag  _p_`t'
 21.                         }
 22.                         replace `X'_beta = _b[`X'`tag'] if t==`t'
 23.                         replace `X'_lower = `X'_beta-1.69*_se[`X'`tag'] if t=
> =`t'
 24.                         replace `X'_upper = `X'_beta+1.69*_se[`X'`tag'] if t=
> =`t'
 25.                 }
 26.                 label var `X'_beta "`Y'"
 27.                 label var `X'_upper "90% CI"
 28.                 label var `X'_lower "90% CI"
 29. 
.         }
 30.         label var foreign_beta "Foreign owner"
 31.         label var expat_beta "Expat manager"
 32.         label var domestic_beta "Domestic manager"
 33. 
.         tw (line domestic_beta expat_beta  t if t>=-Tbefore-1 & t<=Tduring, sort
> ), scheme(538w) title(`title') aspect(0.67)
 34.         graph export output/figure/`Y'_event_study.png, replace width(800)
 35.         
.         restore
 36. 
. }
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs      =     42713
Group variable: firm_person                     Number of groups   =      5193

R-sq:  within  = 0.1094                         Obs per group: min =         1
       between = 0.1068                                        avg =       8.2
       overall = 0.1148                                        max =        12

                                                F(105,1292)        =      3.51
corr(u_i, Xb)  = -0.1713                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 1,293 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
domestic_m_1 |  -.1979361   .0705267    -2.81   0.005    -.3362954   -.0595767
domestic_m_2 |  -.1421114   .0562086    -2.53   0.012    -.2523816   -.0318412
domestic_m_3 |  -.0895397   .0416753    -2.15   0.032    -.1712984    -.007781
domestic_m_4 |  -.0225316   .0258332    -0.87   0.383    -.0732111     .028148
   expat_m_1 |  -.0764852   .0792948    -0.96   0.335    -.2320459    .0790756
   expat_m_2 |   -.056455   .0626915    -0.90   0.368    -.1794432    .0665333
   expat_m_3 |  -.0405193   .0479148    -0.85   0.398    -.1345187    .0534801
   expat_m_4 |  -.0280402   .0323876    -0.87   0.387    -.0915782    .0354978
 foreign_m_1 |  -.0761131   .0494667    -1.54   0.124    -.1731569    .0209307
 foreign_m_2 |  -.0706057   .0518696    -1.36   0.174    -.1723635    .0311521
 foreign_m_3 |  -.0911208   .0487505    -1.87   0.062    -.1867597    .0045181
 foreign_m_4 |  -.0666538   .0452221    -1.47   0.141    -.1553706    .0220631
domestic_p_0 |  -.2551264   .0857343    -2.98   0.003      -.42332   -.0869328
domestic_p_1 |   -.310725   .1013557    -3.07   0.002    -.5095648   -.1118853
domestic_p_2 |  -.3605422   .1159141    -3.11   0.002    -.5879427   -.1331417
domestic_p_3 |  -.3803711   .1318908    -2.88   0.004    -.6391146   -.1216276
domestic_p_4 |  -.4115916   .1480602    -2.78   0.006    -.7020563   -.1211268
domestic_p_5 |  -.4110692    .162642    -2.53   0.012    -.7301406   -.0919979
domestic_p_6 |  -.3649116   .1799566    -2.03   0.043    -.7179509   -.0118723
   expat_p_0 |  -.1922804   .0979654    -1.96   0.050    -.3844691   -.0000916
   expat_p_1 |  -.2234062   .1102137    -2.03   0.043    -.4396237   -.0071887
   expat_p_2 |  -.2812368   .1257848    -2.24   0.026    -.5280016    -.034472
   expat_p_3 |  -.3385931   .1408524    -2.40   0.016    -.6149175   -.0622687
   expat_p_4 |  -.3351129   .1542644    -2.17   0.030    -.6377491   -.0324767
   expat_p_5 |  -.3345747    .170265    -1.97   0.050    -.6686008   -.0005486
   expat_p_6 |  -.3693872   .1842311    -2.01   0.045     -.730812   -.0079624
 foreign_p_0 |  -.0460462   .0517599    -0.89   0.374    -.1475889    .0554966
 foreign_p_1 |  -.0349218    .050991    -0.68   0.494    -.1349561    .0651124
 foreign_p_2 |  -.0333337   .0491149    -0.68   0.497    -.1296873    .0630199
 foreign_p_3 |  -.0261075   .0451289    -0.58   0.563    -.1146415    .0624265
 foreign_p_4 |  -.0646414   .0434774    -1.49   0.137    -.1499354    .0206526
 foreign_p_5 |  -.0203108   .0418155    -0.49   0.627    -.1023445    .0617228
 foreign_p_6 |  -.0111663   .0352795    -0.32   0.752    -.0803776    .0580451
             |
    ind_year |
          2  |  -.0687953   .0778327    -0.88   0.377    -.2214877    .0838971
          3  |   -.232511    .098085    -2.37   0.018    -.4249343   -.0400877
          4  |  -.3200085   .1021051    -3.13   0.002    -.5203185   -.1196985
          5  |  -.4130543     .10652    -3.88   0.000    -.6220254   -.2040831
          6  |  -.4907064    .111985    -4.38   0.000    -.7103988    -.271014
          7  |  -.5644309    .114689    -4.92   0.000    -.7894279   -.3394339
          8  |  -.5394949     .11642    -4.63   0.000    -.7678879   -.3111018
          9  |  -.5880832   .1185353    -4.96   0.000     -.820626   -.3555403
         10  |  -.6075953   .1188471    -5.11   0.000    -.8407499   -.3744408
         11  |  -.6968617   .1215156    -5.73   0.000    -.9352512   -.4584722
         12  |  -.7142622   .1257863    -5.68   0.000    -.9610301   -.4674944
         13  |  -.7626977   .1322357    -5.77   0.000    -1.022118   -.5032775
         14  |  -.7944288   .1384431    -5.74   0.000    -1.066027   -.5228309
         15  |  -.8146851   .1413752    -5.76   0.000    -1.092035   -.5373349
         16  |  -.7715775   .1428542    -5.40   0.000    -1.051829   -.4913259
         17  |  -.7997125   .1445954    -5.53   0.000     -1.08338   -.5160449
         18  |  -.8659995   .1473657    -5.88   0.000    -1.155102   -.5768972
         19  |  -.8419534   .1495826    -5.63   0.000    -1.135405    -.548502
         20  |  -.8399283   .1561655    -5.38   0.000    -1.146294   -.5335624
         21  |  -.9101487   .1659788    -5.48   0.000    -1.235766   -.5845312
         22  |  -.9692186   .1705152    -5.68   0.000    -1.303736   -.6347016
         23  |  -.9837542   .1762969    -5.58   0.000    -1.329614   -.6378947
         24  |  -.9477237   .1834813    -5.17   0.000    -1.307678   -.5877697
         25  |   -.947001   .1925577    -4.92   0.000    -1.324761   -.5692409
         26  |   1.510476   .2178044     6.94   0.000     1.083187    1.937765
         27  |   1.301697   .1991753     6.54   0.000     .9109544    1.692439
         28  |    1.11505    .190518     5.85   0.000      .741291    1.488808
         29  |   .9106524   .1760643     5.17   0.000     .5652492    1.256056
         30  |   .7663726   .1708134     4.49   0.000     .4312705    1.101475
         31  |   .6759399   .1649334     4.10   0.000     .3523734    .9995065
         32  |   .5737814   .1599269     3.59   0.000     .2600366    .8875263
         33  |   .4908927   .1534486     3.20   0.001     .1898569    .7919285
         34  |   .4571119   .1528443     2.99   0.003     .1572617     .756962
         35  |   .3726519   .1503153     2.48   0.013     .0777631    .6675407
         36  |   .3121478   .1420882     2.20   0.028     .0333989    .5908967
         37  |   .2037019   .1362751     1.49   0.135    -.0636428    .4710465
         38  |   .1310752   .1273597     1.03   0.304    -.1187793    .3809296
         39  |   .0678601   .1247846     0.54   0.587    -.1769425    .3126628
         40  |   .0862681   .1187331     0.73   0.468    -.1466627    .3191989
         41  |   .0178173   .1088711     0.16   0.870    -.1957663    .2314009
         42  |  -.0309394   .1077341    -0.29   0.774    -.2422924    .1804136
         43  |   -.107029   .1009538    -1.06   0.289    -.3050803    .0910222
         44  |  -.1466027   .0931597    -1.57   0.116    -.3293635    .0361581
         45  |  -.2277024   .0906688    -2.51   0.012    -.4055767   -.0498281
         46  |  -.1389106   .0823082    -1.69   0.092     -.300383    .0225618
         47  |  -.0659751   .0692477    -0.95   0.341    -.2018254    .0698752
         48  |  -.0329181   .0658972    -0.50   0.617    -.1621953     .096359
         49  |  -.0544951    .049035    -1.11   0.267    -.1506921    .0417019
         50  |          0  (omitted)
             |
     age_cat |
          1  |   .5014513   .0990943     5.06   0.000      .307048    .6958546
          2  |   .8483764   .1148016     7.39   0.000     .6231584    1.073594
          3  |    1.08432   .1267339     8.56   0.000     .8356936    1.332947
          4  |   1.336278   .1382332     9.67   0.000     1.065092    1.607464
          5  |   1.511922   .1520442     9.94   0.000     1.213641    1.810202
          6  |   1.658438   .1602275    10.35   0.000     1.344104    1.972773
          7  |     1.7851   .1719686    10.38   0.000     1.447731    2.122468
          8  |   1.877572   .1848703    10.16   0.000     1.514893    2.240251
          9  |   1.945962   .1972776     9.86   0.000     1.558943    2.332982
         10  |      2.018   .2088322     9.66   0.000     1.608313    2.427688
         11  |   2.137035   .2195604     9.73   0.000     1.706301    2.567769
         12  |   2.177969   .2314897     9.41   0.000     1.723832    2.632106
         13  |   2.241535    .244276     9.18   0.000     1.762314    2.720756
         14  |   2.254833   .2557825     8.82   0.000     1.753039    2.756628
         15  |   2.278083   .2687235     8.48   0.000     1.750901    2.805266
         16  |    2.26663   .2823901     8.03   0.000     1.712636    2.820623
         17  |   2.324051   .2947306     7.89   0.000     1.745848    2.902254
         18  |   2.342137   .3078462     7.61   0.000     1.738203     2.94607
         19  |    2.36011    .320229     7.37   0.000     1.731884    2.988335
         20  |   2.396791    .334677     7.16   0.000     1.740221    3.053361
         25  |    2.41067   .3640658     6.62   0.000     1.696445    3.124895
         30  |   2.242397   .5278967     4.25   0.000     1.206769    3.278026
         40  |   2.625775   .5072052     5.18   0.000     1.630738    3.620811
         50  |   2.739244   .5488439     4.99   0.000     1.662521    3.815967
             |
       _cons |   2.754332   .1576688    17.47   0.000     2.445017    3.063647
-------------+----------------------------------------------------------------
     sigma_u |  1.2274311
     sigma_e |  .69457896
         rho |   .7574493   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 12
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnL_event_study.png written in PNG format)
note: 25.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs      =     39993
Group variable: firm_person                     Number of groups   =      5157

R-sq:  within  = 0.0980                         Obs per group: min =         1
       between = 0.0151                                        avg =       7.8
       overall = 0.0006                                        max =        12

                                                F(105,1279)        =      4.79
corr(u_i, Xb)  = -0.2513                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 1,280 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
domestic_m_1 |   .3309655   .0997695     3.32   0.001     .1352358    .5266953
domestic_m_2 |   .2314944    .080155     2.89   0.004     .0742447     .388744
domestic_m_3 |   .1546535   .0589777     2.62   0.009     .0389499    .2703572
domestic_m_4 |   .1087532    .037398     2.91   0.004      .035385    .1821214
   expat_m_1 |   .2386454   .1065247     2.24   0.025     .0296631    .4476277
   expat_m_2 |   .1646324   .0853576     1.93   0.054    -.0028238    .3320886
   expat_m_3 |   .0594544   .0687833     0.86   0.388     -.075486    .1943948
   expat_m_4 |   .0479379   .0454675     1.05   0.292    -.0412612     .137137
 foreign_m_1 |    .087702   .0623536     1.41   0.160    -.0346246    .2100286
 foreign_m_2 |   .0673404   .0577857     1.17   0.244    -.0460249    .1807056
 foreign_m_3 |   .0683108   .0596172     1.15   0.252    -.0486475    .1852691
 foreign_m_4 |   .0598347   .0560983     1.07   0.286    -.0502201    .1698895
domestic_p_0 |   .3972167   .1221567     3.25   0.001     .1575673    .6368661
domestic_p_1 |   .4518035   .1437308     3.14   0.002     .1698295    .7337776
domestic_p_2 |   .5052342   .1658636     3.05   0.002     .1798395    .8306289
domestic_p_3 |   .5934453   .1885887     3.15   0.002     .2234682    .9634224
domestic_p_4 |   .6589007   .2091956     3.15   0.002     .2484964    1.069305
domestic_p_5 |   .7467286   .2294114     3.25   0.001     .2966647    1.196793
domestic_p_6 |   .8715422   .2518882     3.46   0.001     .3773828    1.365702
   expat_p_0 |   .3595108   .1289467     2.79   0.005     .1065405    .6124811
   expat_p_1 |   .4674504   .1511147     3.09   0.002     .1709906    .7639102
   expat_p_2 |   .5268637   .1734232     3.04   0.002     .1866384    .8670889
   expat_p_3 |   .5909422   .1960503     3.01   0.003     .2063267    .9755576
   expat_p_4 |   .6742515   .2209291     3.05   0.002     .2408282    1.107675
   expat_p_5 |   .7166232   .2452787     2.92   0.004     .2354304    1.197816
   expat_p_6 |   .7648814   .2716839     2.82   0.005     .2318863    1.297877
 foreign_p_0 |   .0984228   .0620607     1.59   0.113    -.0233293    .2201748
 foreign_p_1 |   .1296253   .0602278     2.15   0.032     .0114692    .2477815
 foreign_p_2 |   .1043172   .0571738     1.82   0.068    -.0078476     .216482
 foreign_p_3 |   .1399937   .0571864     2.45   0.014     .0278043    .2521832
 foreign_p_4 |   .0984009   .0548635     1.79   0.073    -.0092314    .2060331
 foreign_p_5 |   .0171671   .0611741     0.28   0.779    -.1028455    .1371796
 foreign_p_6 |   .0668865   .0464978     1.44   0.151    -.0243339    .1581069
             |
    ind_year |
          2  |  -.0292167   .1259477    -0.23   0.817    -.2763036    .2178701
          3  |   .6310861    .129417     4.88   0.000     .3771932     .884979
          4  |    .694996   .1315104     5.28   0.000     .4369963    .9529958
          5  |   .8332588   .1395733     5.97   0.000      .559441    1.107077
          6  |   .9589551   .1460683     6.57   0.000     .6723954    1.245515
          7  |   1.170568   .1504127     7.78   0.000     .8754852     1.46565
          8  |   1.288484    .145918     8.83   0.000     1.002219    1.574749
          9  |   1.371014    .144967     9.46   0.000     1.086615    1.655414
         10  |   1.405274    .148865     9.44   0.000     1.113227     1.69732
         11  |   1.488237   .1532693     9.71   0.000      1.18755    1.788924
         12  |   1.468251   .1558464     9.42   0.000     1.162509    1.773994
         13  |    1.45814   .1612406     9.04   0.000     1.141815    1.774465
         14  |   1.427185   .1614201     8.84   0.000     1.110508    1.743862
         15  |   1.323108   .1610141     8.22   0.000     1.007227    1.638989
         16  |   1.288695   .1617144     7.97   0.000     .9714405     1.60595
         17  |   1.286463   .1650345     7.80   0.000     .9626952    1.610231
         18  |   1.186731   .1608876     7.38   0.000      .871098    1.502363
         19  |   1.096551     .16279     6.74   0.000      .777186    1.415915
         20  |   .9803614   .1621505     6.05   0.000     .6622512    1.298472
         21  |    .912842   .1648563     5.54   0.000     .5894237     1.23626
         22  |   .8640743   .1651995     5.23   0.000     .5399826    1.188166
         23  |   .8222177   .1717911     4.79   0.000     .4851943    1.159241
         24  |   .0710611   .1186917     0.60   0.549    -.1617908     .303913
         25  |          0  (omitted)
         26  |   .5195456   .2432277     2.14   0.033     .0423764    .9967148
         27  |   .3661295   .2353416     1.56   0.120    -.0955685    .8278275
         28  |   .4100912   .2212523     1.85   0.064    -.0239661    .8441485
         29  |   .6242506   .2137751     2.92   0.004     .2048622    1.043639
         30  |   .6433829   .2128096     3.02   0.003     .2258888    1.060877
         31  |   .7368233   .2116689     3.48   0.001      .321567     1.15208
         32  |   .8933926   .2084695     4.29   0.000      .484413    1.302372
         33  |   .9301755   .2069352     4.50   0.000     .5242057    1.336145
         34  |   .9515089    .206675     4.60   0.000     .5460497    1.356968
         35  |   .9766249   .2084007     4.69   0.000     .5677802     1.38547
         36  |    1.00508   .2048756     4.91   0.000     .6031507    1.407009
         37  |   1.051215   .2126835     4.94   0.000     .6339679    1.468462
         38  |   .9615914   .2328263     4.13   0.000      .504828    1.418355
         39  |   1.024731   .2206304     4.64   0.000     .5918942    1.457568
         40  |   1.054814   .2223714     4.74   0.000     .6185612    1.491067
         41  |   .9942733   .2259882     4.40   0.000     .5509249    1.437622
         42  |   1.063746   .2251849     4.72   0.000      .621974    1.505519
         43  |   1.149159   .2300694     4.99   0.000     .6978044    1.600514
         44  |    .954321   .2384645     4.00   0.000     .4864965    1.422146
         45  |   1.107748   .2344996     4.72   0.000      .647702    1.567794
         46  |   1.004438   .2406746     4.17   0.000      .532278    1.476599
         47  |   .9044037   .2477925     3.65   0.000     .4182792    1.390528
         48  |   .8172604   .2632258     3.10   0.002     .3008587    1.333662
         49  |   .5234897   .2818529     1.86   0.063    -.0294551    1.076434
         50  |   .5766119   .3140919     1.84   0.067    -.0395799    1.192804
             |
     age_cat |
          1  |  -.0008586   .1431593    -0.01   0.995    -.2817114    .2799941
          2  |  -.0465564   .1614511    -0.29   0.773    -.3632944    .2701815
          3  |  -.0423579   .1794993    -0.24   0.813    -.3945033    .3097875
          4  |  -.0260395   .1941274    -0.13   0.893    -.4068827    .3548036
          5  |  -.0611488   .2124559    -0.29   0.774    -.4779492    .3556515
          6  |  -.1586884   .2300613    -0.69   0.490    -.6100274    .2926506
          7  |   -.163617   .2437086    -0.67   0.502    -.6417296    .3144956
          8  |  -.1755573   .2649133    -0.66   0.508    -.6952696     .344155
          9  |  -.2105855   .2834256    -0.74   0.458    -.7666157    .3454446
         10  |   -.242176   .2975573    -0.81   0.416      -.82593     .341578
         11  |   -.215612    .314742    -0.69   0.493    -.8330794    .4018554
         12  |  -.2402613   .3319609    -0.72   0.469    -.8915089    .4109864
         13  |  -.3269765    .351983    -0.93   0.353    -1.017504     .363551
         14  |   -.310715   .3689673    -0.84   0.400    -1.034563    .4131327
         15  |  -.3821566   .3847293    -0.99   0.321    -1.136926    .3726133
         16  |  -.4524776   .4040344    -1.12   0.263    -1.245121    .3401653
         17  |  -.4746434   .4220265    -1.12   0.261    -1.302584    .3532968
         18  |  -.4579861    .439828    -1.04   0.298     -1.32085    .4048775
         19  |   -.503409    .456275    -1.10   0.270    -1.398539    .3917207
         20  |  -.5263746   .4856717    -1.08   0.279    -1.479175    .4264262
         25  |  -.5384308   .5369456    -1.00   0.316    -1.591822    .5149601
         30  |  -.1429747   .7473156    -0.19   0.848    -1.609074    1.323124
         40  |  -.2916474   .8624375    -0.34   0.735    -1.983595      1.4003
         50  |   .0149904   .9596481     0.02   0.988    -1.867667    1.897648
             |
       _cons |   5.430508   .2284761    23.77   0.000     4.982279    5.878737
-------------+----------------------------------------------------------------
     sigma_u |  1.6829379
     sigma_e |  .87889241
         rho |  .78571169   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 12
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnKL_event_study.png written in PNG format)
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs      =     42713
Group variable: firm_person                     Number of groups   =      5193

R-sq:  within  = 0.1879                         Obs per group: min =         1
       between = 0.0009                                        avg =       8.2
       overall = 0.0245                                        max =        12

                                                F(105,1292)        =     17.52
corr(u_i, Xb)  = -0.2183                        Prob > F           =    0.0000

                                 (Std. Err. adjusted for 1,293 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
domestic_m_1 |   .3105855   .0633546     4.90   0.000     .1862963    .4348747
domestic_m_2 |   .2806093   .0488904     5.74   0.000      .184696    .3765225
domestic_m_3 |   .1941451   .0354113     5.48   0.000     .1246751    .2636151
domestic_m_4 |   .1153011      .0218     5.29   0.000     .0725339    .1580683
   expat_m_1 |   .4233431    .066809     6.34   0.000      .292277    .5544092
   expat_m_2 |     .30197   .0591431     5.11   0.000     .1859431     .417997
   expat_m_3 |   .2689036   .0458259     5.87   0.000     .1790024    .3588049
   expat_m_4 |   .1542374   .0376686     4.09   0.000     .0803391    .2281358
 foreign_m_1 |   .0167174   .0382346     0.44   0.662    -.0582914    .0917261
 foreign_m_2 |   .0001171   .0379919     0.00   0.998    -.0744155    .0746497
 foreign_m_3 |    .005438   .0411431     0.13   0.895    -.0752766    .0861525
 foreign_m_4 |  -.0014895   .0349481    -0.04   0.966    -.0700507    .0670717
domestic_p_0 |   .4673215   .0771523     6.06   0.000     .3159639    .6186791
domestic_p_1 |   .5783014    .091701     6.31   0.000     .3984023    .7582005
domestic_p_2 |   .6814309   .1056423     6.45   0.000     .4741817    .8886802
domestic_p_3 |   .7943502   .1192315     6.66   0.000     .5604416    1.028259
domestic_p_4 |   .8744215   .1328999     6.58   0.000     .6136982    1.135145
domestic_p_5 |   .9803957   .1453455     6.75   0.000     .6952566    1.265535
domestic_p_6 |   1.030699   .1603502     6.43   0.000     .7161232    1.345274
   expat_p_0 |   .5682315   .0784326     7.24   0.000     .4143622    .7221007
   expat_p_1 |   .7267568   .0939311     7.74   0.000     .5424826     .911031
   expat_p_2 |    .791224   .1071631     7.38   0.000     .5809913    1.001457
   expat_p_3 |   .9345471   .1199692     7.79   0.000     .6991913    1.169903
   expat_p_4 |   1.003494   .1372336     7.31   0.000     .7342694     1.27272
   expat_p_5 |    1.15672   .1478372     7.82   0.000     .8666928    1.446747
   expat_p_6 |    1.26997   .1631863     7.78   0.000     .9498311     1.59011
 foreign_p_0 |   .0148941   .0392992     0.38   0.705    -.0622032    .0919914
 foreign_p_1 |   .0483782   .0399962     1.21   0.227    -.0300863    .1268428
 foreign_p_2 |   .0445406   .0371898     1.20   0.231    -.0284184    .1174996
 foreign_p_3 |   .0474784   .0357537     1.33   0.184    -.0226632      .11762
 foreign_p_4 |    .037549   .0358995     1.05   0.296    -.0328787    .1079767
 foreign_p_5 |   .0081734   .0366834     0.22   0.824    -.0637921     .080139
 foreign_p_6 |   .0113484   .0319573     0.36   0.723    -.0513455    .0740424
             |
    ind_year |
          2  |  -.0038978   .0665093    -0.06   0.953    -.1343758    .1265801
          3  |   .2023787   .0803682     2.52   0.012     .0447121    .3600452
          4  |   .3457333   .0811979     4.26   0.000     .1864392    .5050275
          5  |   .4479866   .0896998     4.99   0.000     .2720134    .6239599
          6  |   .5453836   .1000599     5.45   0.000     .3490859    .7416813
          7  |   .6231082    .096815     6.44   0.000     .4331763    .8130402
          8  |   .6026809   .0973094     6.19   0.000     .4117792    .7935827
          9  |   .7260715   .0959904     7.56   0.000     .5377574    .9143855
         10  |   .7489072   .0986208     7.59   0.000     .5554328    .9423817
         11  |   .8203699   .0999796     8.21   0.000     .6242298     1.01651
         12  |   .7982804    .106547     7.49   0.000     .5892563    1.007305
         13  |   .8012127   .1106802     7.24   0.000     .5840801    1.018345
         14  |   .8070004   .1087814     7.42   0.000     .5935928    1.020408
         15  |   .7678195   .1154718     6.65   0.000     .5412867    .9943522
         16  |   .7141924   .1157316     6.17   0.000       .48715    .9412348
         17  |   .7334095   .1201831     6.10   0.000      .497634     .969185
         18  |   .5698018   .1214081     4.69   0.000     .3316232    .8079804
         19  |   .5439825   .1246748     4.36   0.000     .2993953    .7885697
         20  |   .4324517   .1294779     3.34   0.001     .1784417    .6864616
         21  |   .3618831   .1383234     2.62   0.009     .0905199    .6332463
         22  |   .4220835    .142004     2.97   0.003     .1434999    .7006672
         23  |   .4133574   .1394259     2.96   0.003     .1398313    .6868834
         24  |   .3749483    .148708     2.52   0.012     .0832127    .6666838
         25  |   .2613005   .1547377     1.69   0.092    -.0422641    .5648652
         26  |   -.791615    .161049    -4.92   0.000    -1.107561   -.4756687
         27  |  -.5897291   .1560793    -3.78   0.000    -.8959257   -.2835324
         28  |  -.4944857   .1544554    -3.20   0.001    -.7974966   -.1914748
         29  |  -.2505854    .140449    -1.78   0.075    -.5261184    .0249477
         30  |   -.179671   .1367714    -1.31   0.189    -.4479894    .0886474
         31  |  -.0846331   .1328341    -0.64   0.524    -.3452273    .1759611
         32  |   .0970936   .1321827     0.73   0.463    -.1622227    .3564099
         33  |   .1494439    .121948     1.23   0.221    -.0897939    .3886817
         34  |   .2824727   .1201351     2.35   0.019     .0467915    .5181539
         35  |   .3211137   .1146708     2.80   0.005     .0961523     .546075
         36  |   .2673457   .1088285     2.46   0.014     .0538458    .4808455
         37  |   .3623053   .1019608     3.55   0.000     .1622785    .5623322
         38  |   .3320951   .0996374     3.33   0.001     .1366262     .527564
         39  |   .3399314   .0952124     3.57   0.000     .1531436    .5267193
         40  |   .4235291   .0921317     4.60   0.000     .2427849    .6042732
         41  |   .4616896   .0849323     5.44   0.000     .2950693    .6283099
         42  |   .4453094   .0848049     5.25   0.000      .278939    .6116799
         43  |   .3239489   .0850625     3.81   0.000      .157073    .4908247
         44  |   .2465611    .082222     3.00   0.003     .0852578    .4078643
         45  |   .3531144   .0758707     4.65   0.000     .2042711    .5019577
         46  |   .2173891   .0813796     2.67   0.008     .0577384    .3770398
         47  |   .2378311   .0658815     3.61   0.000     .1085846    .3670775
         48  |   .1219759   .0734038     1.66   0.097    -.0220278    .2659796
         49  |   .1710386   .0680686     2.51   0.012     .0375015    .3045757
         50  |          0  (omitted)
             |
     age_cat |
          1  |   .3160159   .0894117     3.53   0.000     .1406079    .4914239
          2  |   .2711448   .0973305     2.79   0.005     .0802016     .462088
          3  |   .2502507   .1063697     2.35   0.019     .0415744     .458927
          4  |   .2234331   .1146239     1.95   0.051    -.0014362    .4483025
          5  |   .1707262   .1263653     1.35   0.177    -.0771774    .4186299
          6  |   .0920464   .1348363     0.68   0.495    -.1724756    .3565685
          7  |    .089083   .1451775     0.61   0.540    -.1957264    .3738924
          8  |   .0556868   .1562725     0.36   0.722    -.2508889    .3622626
          9  |   .0025142   .1700192     0.01   0.988    -.3310298    .3360582
         10  |  -.0358956   .1800968    -0.20   0.842    -.3892099    .3174188
         11  |  -.0235538   .1927212    -0.12   0.903    -.4016347    .3545271
         12  |   .0001808   .2051449     0.00   0.999    -.4022727    .4026344
         13  |  -.0744041   .2194188    -0.34   0.735    -.5048604    .3560522
         14  |  -.1383254   .2314199    -0.60   0.550    -.5923253    .3156746
         15  |  -.1498958   .2451427    -0.61   0.541    -.6308172    .3310255
         16  |  -.1842999   .2599164    -0.71   0.478    -.6942043    .3256045
         17  |  -.2654699   .2720446    -0.98   0.329    -.7991675    .2682276
         18  |  -.2278223   .2866509    -0.79   0.427    -.7901745      .33453
         19  |   -.273105   .2980226    -0.92   0.360    -.8577664    .3115563
         20  |  -.3384139    .320651    -1.06   0.291    -.9674676    .2906397
         25  |  -.4485966   .3574058    -1.26   0.210    -1.149756    .2525628
         30  |  -.3211022   .4799557    -0.67   0.504     -1.26268    .6204758
         40  |  -.7870671   .5166578    -1.52   0.128    -1.800647    .2265132
         50  |  -.8818483   .5749444    -1.53   0.125    -2.009775    .2460786
             |
       _cons |   8.561894   .1397205    61.28   0.000      8.28779    8.835998
-------------+----------------------------------------------------------------
     sigma_u |  1.2895135
     sigma_e |  .61901668
         rho |  .81271914   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 12
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/lnQL_event_study.png written in PNG format)
note: 50.ind_year omitted because of collinearity

Fixed-effects (within) regression               Number of obs      =     42713
Group variable: firm_person                     Number of groups   =      5193

R-sq:  within  = 0.0358                         Obs per group: min =         1
       between = 0.1458                                        avg =       8.2
       overall = 0.1039                                        max =        12

                                                F(105,1292)        =      2.31
corr(u_i, Xb)  = 0.1233                         Prob > F           =    0.0000

                                 (Std. Err. adjusted for 1,293 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
domestic_m_1 |  -.0185064   .0235004    -0.79   0.431    -.0646096    .0275969
domestic_m_2 |  -.0065761   .0193306    -0.34   0.734    -.0444989    .0313467
domestic_m_3 |  -.0120133   .0155474    -0.77   0.440    -.0425141    .0184876
domestic_m_4 |  -.0139559   .0115362    -1.21   0.227    -.0365877    .0086759
   expat_m_1 |   .0209739    .028671     0.73   0.465    -.0352729    .0772206
   expat_m_2 |   .0172515   .0237606     0.73   0.468    -.0293622    .0638651
   expat_m_3 |   .0358153   .0198842     1.80   0.072    -.0031937    .0748242
   expat_m_4 |   .0268501   .0168379     1.59   0.111    -.0061825    .0598827
 foreign_m_1 |   -.020076   .0165628    -1.21   0.226    -.0525689     .012417
 foreign_m_2 |  -.0111623   .0168489    -0.66   0.508    -.0442166    .0218919
 foreign_m_3 |  -.0039578   .0174279    -0.23   0.820    -.0381478    .0302322
 foreign_m_4 |   -.011119   .0168985    -0.66   0.511    -.0442706    .0220326
domestic_p_0 |  -.0129558   .0276073    -0.47   0.639     -.067116    .0412043
domestic_p_1 |  -.0089268   .0319849    -0.28   0.780    -.0716748    .0538212
domestic_p_2 |  -.0173254   .0366537    -0.47   0.637    -.0892327    .0545819
domestic_p_3 |  -.0136393   .0410832    -0.33   0.740    -.0942364    .0669578
domestic_p_4 |  -.0141909   .0454387    -0.31   0.755    -.1033325    .0749507
domestic_p_5 |  -.0257113    .050628    -0.51   0.612    -.1250334    .0736109
domestic_p_6 |  -.0228642    .056055    -0.41   0.683    -.1328331    .0871046
   expat_p_0 |   .0333465   .0321272     1.04   0.299    -.0296806    .0963737
   expat_p_1 |   .0251321   .0347584     0.72   0.470     -.043057    .0933211
   expat_p_2 |    .031572   .0400982     0.79   0.431    -.0470927    .1102366
   expat_p_3 |   .0467843   .0446888     1.05   0.295    -.0408863    .1344548
   expat_p_4 |   .0434598   .0497047     0.87   0.382    -.0540509    .1409706
   expat_p_5 |   .0256373   .0537451     0.48   0.633       -.0798    .1310746
   expat_p_6 |   .0171963   .0580581     0.30   0.767    -.0967022    .1310948
 foreign_p_0 |    .016692   .0162964     1.02   0.306    -.0152784    .0486623
 foreign_p_1 |   .0163911   .0173245     0.95   0.344    -.0175963    .0503784
 foreign_p_2 |   .0182246   .0174329     1.05   0.296    -.0159752    .0524245
 foreign_p_3 |   .0165046   .0177149     0.93   0.352    -.0182486    .0512578
 foreign_p_4 |   .0202976   .0161895     1.25   0.210     -.011463    .0520583
 foreign_p_5 |   .0172983   .0168837     1.02   0.306    -.0158242    .0504208
 foreign_p_6 |   .0159573   .0152353     1.05   0.295    -.0139314     .045846
             |
    ind_year |
          2  |   .0279081   .0430746     0.65   0.517    -.0565957    .1124118
          3  |  -.0194255    .040698    -0.48   0.633    -.0992668    .0604158
          4  |  -.0080797   .0420901    -0.19   0.848    -.0906521    .0744926
          5  |  -.0479375   .0455028    -1.05   0.292    -.1372049    .0413299
          6  |  -.0523506   .0447671    -1.17   0.242    -.1401748    .0354736
          7  |  -.0505429   .0443346    -1.14   0.254    -.1375187    .0364328
          8  |   -.041854   .0438577    -0.95   0.340    -.1278941    .0441862
          9  |  -.0504079    .043917    -1.15   0.251    -.1365644    .0357486
         10  |  -.0781298   .0425651    -1.84   0.067     -.161634    .0053745
         11  |   -.079786   .0432881    -1.84   0.066    -.1647085    .0051366
         12  |  -.0718055   .0435405    -1.65   0.099    -.1572234    .0136123
         13  |   -.085022   .0440713    -1.93   0.054    -.1714812    .0014371
         14  |  -.0475413   .0443622    -1.07   0.284    -.1345712    .0394886
         15  |  -.0320454   .0451141    -0.71   0.478    -.1205502    .0564595
         16  |  -.0384862   .0469734    -0.82   0.413    -.1306388    .0536663
         17  |  -.0139526   .0468943    -0.30   0.766      -.10595    .0780448
         18  |  -.0023871   .0497438    -0.05   0.962    -.0999747    .0952004
         19  |  -.0073278   .0506621    -0.14   0.885    -.1067167    .0920612
         20  |   .0455977    .052333     0.87   0.384    -.0570692    .1482646
         21  |  -.0129337   .0533301    -0.24   0.808    -.1175569    .0916894
         22  |   -.000117   .0540714    -0.00   0.998    -.1061945    .1059604
         23  |  -.0076824   .0571222    -0.13   0.893    -.1197448      .10438
         24  |  -.0892917   .0606053    -1.47   0.141    -.2081873    .0296038
         25  |  -.1497777   .0650955    -2.30   0.022    -.2774822   -.0220732
         26  |    .178405   .0693429     2.57   0.010     .0423679    .3144421
         27  |   .1426166   .0635244     2.25   0.025     .0179944    .2672389
         28  |   .1625022   .0606433     2.68   0.007     .0435321    .2814723
         29  |   .1722502    .060499     2.85   0.004     .0535632    .2909372
         30  |   .1754804   .0567505     3.09   0.002     .0641472    .2868136
         31  |   .1508954   .0551041     2.74   0.006     .0427921    .2589986
         32  |   .1508774   .0519688     2.90   0.004      .048925    .2528299
         33  |   .1292943   .0496047     2.61   0.009     .0319797    .2266089
         34  |   .1034391   .0482989     2.14   0.032     .0086862    .1981921
         35  |    .127286   .0469672     2.71   0.007     .0351457    .2194263
         36  |   .0759156   .0472148     1.61   0.108    -.0167105    .1685417
         37  |   .0892368   .0441933     2.02   0.044     .0025382    .1759354
         38  |   .0839647   .0436586     1.92   0.055    -.0016849    .1696142
         39  |   .1293801   .0419554     3.08   0.002     .0470719    .2116884
         40  |   .1441624   .0417698     3.45   0.001     .0622184    .2261064
         41  |   .1299283   .0393226     3.30   0.001     .0527852    .2070715
         42  |   .1294396    .039593     3.27   0.001     .0517661    .2071132
         43  |   .1449799   .0371084     3.91   0.000     .0721806    .2177792
         44  |   .1073565   .0398365     2.69   0.007     .0292051    .1855078
         45  |   .1141831   .0389603     2.93   0.003     .0377506    .1906155
         46  |   .1358755   .0395335     3.44   0.001     .0583185    .2134324
         47  |     .18285   .0380248     4.81   0.000     .1082527    .2574472
         48  |   .1587311   .0396658     4.00   0.000     .0809147    .2365475
         49  |   .0260967   .0318409     0.82   0.413    -.0363688    .0885621
         50  |          0  (omitted)
             |
     age_cat |
          1  |   .0791953   .0354046     2.24   0.025     .0097384    .1486521
          2  |   .0688064     .03662     1.88   0.060    -.0030347    .1406475
          3  |   .1248533   .0402686     3.10   0.002     .0458543    .2038523
          4  |   .1629091   .0430751     3.78   0.000     .0784043    .2474139
          5  |   .1548346   .0457522     3.38   0.001     .0650777    .2445914
          6  |   .1699655   .0483144     3.52   0.000     .0751821    .2647488
          7  |    .186329   .0511124     3.65   0.000     .0860565    .2866015
          8  |   .2057774   .0535189     3.84   0.000      .100784    .3107708
          9  |   .2086318   .0569577     3.66   0.000     .0968922    .3203715
         10  |   .2321551   .0610133     3.80   0.000     .1124591    .3518511
         11  |   .2460834   .0648585     3.79   0.000     .1188439     .373323
         12  |   .2504081   .0691725     3.62   0.000     .1147054    .3861108
         13  |   .2242823   .0726481     3.09   0.002     .0817612    .3668034
         14  |   .2310987   .0769235     3.00   0.003       .08019    .3820073
         15  |   .2302603   .0806035     2.86   0.004     .0721322    .3883884
         16  |   .2242227    .084146     2.66   0.008     .0591449    .3893005
         17  |    .253016    .088665     2.85   0.004     .0790729    .4269591
         18  |   .2387435   .0932385     2.56   0.011     .0558281    .4216589
         19  |   .2429725   .0983095     2.47   0.014     .0501087    .4358363
         20  |   .2403734   .1031548     2.33   0.020      .038004    .4427427
         25  |   .2918856    .115006     2.54   0.011     .0662667    .5175046
         30  |   .2738795    .170708     1.60   0.109    -.0610158    .6087748
         40  |    .358886   .1860133     1.93   0.054    -.0060352    .7238073
         50  |   .3528957   .2207014     1.60   0.110    -.0800767    .7858681
             |
       _cons |   .3337631   .0562871     5.93   0.000      .223339    .4441872
-------------+----------------------------------------------------------------
     sigma_u |  .38752683
     sigma_e |  .28918823
         rho |  .64231235   (fraction of variance due to u_i)
------------------------------------------------------------------------------
number of observations (_N) was 0, now 12
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(file output/figure/exporter_event_study.png written in PNG format)

. 
end of do-file

. 
. log close
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/
> estimate.log
  log type:  text
 closed on:  30 Nov 2018, 22:12:11
----------------------------------------------------------------------------------
