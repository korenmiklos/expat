-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/outp
> ut/estimate_heterogeneity.log
  log type:  text
 opened on:   4 Dec 2018, 16:44:58

. 
. 
. use temp/analysis_sample

. 
. *Dinamika
. scalar Tbefore = 4

. scalar Tduring = 6

. scalar Tafter = 4

. 
. gen byte analysis_window = (tenure>=-Tbefore-1)&(year-first_exit_year<=Tafter
> )

. 
. global sample_baseline (analysis_window==1)

. global sample_manufacturing $sample_baseline & (manufacturing==1)

. global sample_acquisitions $sample_baseline & (greenfield==0)

. 
. global samples baseline acquisitions

. 
. global outcomes lnL lnKL lnQL exporter

. label var lnL "Employment (log)"

. label var lnKL "Capital per worker (log)"

. label var lnQL "Revenue per worker (log)"

. label var exporter "Firm is an exporter (dummy)"

. 
. egen person_tag = tag(frame_id manager_id)

. egen N = sum(person_tag), by(frame_id)

. gen inverse_weight = 1/N

. 
. * verify founders are not in analysis sample
. foreach X of var during* after* {
  2.         replace `X'=0 if founder==1
  3. }
(0 real changes made)
(132,464 real changes made)
(55,048 real changes made)
(73,335 real changes made)
(81,604 real changes made)
(46,715 real changes made)
(88,449 real changes made)
(96,285 real changes made)
(94,584 real changes made)
(20,057 real changes made)
(10,166 real changes made)
(13,405 real changes made)
(13,063 real changes made)
(15,361 real changes made)
(11,994 real changes made)
(13,939 real changes made)
(17,025 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(70,373 real changes made)
(35,951 real changes made)
(37,925 real changes made)
(38,899 real changes made)
(31,710 real changes made)
(44,472 real changes made)
(52,990 real changes made)
(32,396 real changes made)
(32,892 real changes made)
(19,164 real changes made)
(22,477 real changes made)
(19,915 real changes made)
(25,211 real changes made)
(20,097 real changes made)
(27,732 real changes made)
(15,077 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)

. 
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. 
. do est_`1'

. foreach X of var exporter lnQL {
  2.         local i = 1
  3.         foreach Z of var H_* {
  4.                 xtreg `X' foreign during_domestic after_domestic during_ex
> pat after_expat during_domestic_`Z' after_domestic_`Z' during_expat_`Z' after
> _expat_`Z' i.ind_year i.age_cat if $sample_acquisitions [aw=inverse_weight], 
> i(firm_person ) fe vce(cluster id)
  5.                 local r2_w = `e(r2_w)'
  6.                 test during_expat_`Z'==during_domestic_`Z'
  7.                 local p = `r(p)'        
  8.                 do regram output/regression/`X'_heterogeneity `i' `Z' R2_w
> ithin "`r2_w'" p_value "`p'"
  9.                 local i = `i'+1
 10.         }
 11. }

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.0484                         Obs per group: min =         1
       between = 0.0806                                        avg =       9.0
       overall = 0.0631                                        max =        25

                                                F(82,14528)        =     26.35
corr(u_i, Xb)  = 0.1150                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0228202   .0128181     1.78   0.075    -.0023048    .0479453
during_dom~c |   .0098674   .0054099     1.82   0.068    -.0007367    .0204716
after_dome~c |   .0009354   .0089836     0.10   0.917    -.0166737    .0185444
during_expat |   .0717856   .0212911     3.37   0.001     .0300523    .1135189
 after_expat |   .0547544   .0288063     1.90   0.057    -.0017096    .1112184
during_do~nL |  -.0323627   .0069326    -4.67   0.000    -.0459516   -.0187738
after_dom~nL |  -.0446266   .0114752    -3.89   0.000    -.0671194   -.0221338
during_ex~nL |  -.0663224   .0268304    -2.47   0.013    -.1189134   -.0137314
after_exp~nL |  -.0608364   .0359674    -1.69   0.091    -.1313371    .0096643
             |
    ind_year |
          2  |   -.016458   .0103522    -1.59   0.112    -.0367497    .0038336
          3  |  -.0332757   .0125085    -2.66   0.008    -.0577939   -.0087575
          4  |  -.0412833   .0133571    -3.09   0.002     -.067465   -.0151017
          5  |  -.0324447   .0148371    -2.19   0.029    -.0615273   -.0033622
          6  |   -.040513   .0159959    -2.53   0.011    -.0718669   -.0091591
          7  |  -.0444666   .0172579    -2.58   0.010    -.0782942    -.010639
          8  |  -.0542911   .0184163    -2.95   0.003    -.0903895   -.0181927
          9  |   -.056203   .0198985    -2.82   0.005    -.0952067   -.0171994
         10  |  -.0552878   .0212511    -2.60   0.009    -.0969427   -.0136329
         11  |  -.0619744   .0227291    -2.73   0.006    -.1065264   -.0174224
         12  |  -.0621559   .0241228    -2.58   0.010    -.1094398   -.0148721
         13  |  -.0562124   .0257179    -2.19   0.029    -.1066228    -.005802
         14  |  -.0473005   .0273258    -1.73   0.083    -.1008626    .0062615
         15  |   -.036365   .0288632    -1.26   0.208    -.0929406    .0202105
         16  |  -.0226655   .0303883    -0.75   0.456    -.0822305    .0368995
         17  |  -.0070491   .0320196    -0.22   0.826    -.0698116    .0557134
         18  |  -.0025064   .0337203    -0.07   0.941    -.0686025    .0635897
         19  |   .0030778   .0353351     0.09   0.931    -.0661835    .0723391
         20  |   .0107986   .0368235     0.29   0.769    -.0613801    .0829774
         21  |   .0057711   .0382705     0.15   0.880    -.0692439    .0807862
         22  |   .0131846   .0396083     0.33   0.739    -.0644528     .090822
         23  |   .0099034   .0410113     0.24   0.809    -.0704841    .0902908
         24  |  -.0981003   .0424417    -2.31   0.021    -.1812914   -.0149091
         25  |  -.1326538   .0440311    -3.01   0.003    -.2189604   -.0463471
         26  |  -.0189811   .0252926    -0.75   0.453    -.0685577    .0305956
         27  |  -.0130633   .0223288    -0.59   0.559    -.0568306    .0307041
         28  |   .0093927   .0216234     0.43   0.664     -.032992    .0517774
         29  |    .008089   .0213353     0.38   0.705     -.033731    .0499089
         30  |   .0281865   .0212997     1.32   0.186    -.0135636    .0699366
         31  |   .0222713   .0214942     1.04   0.300    -.0198602    .0644027
         32  |   .0295531   .0220435     1.34   0.180     -.013655    .0727612
         33  |     .02122   .0226839     0.94   0.350    -.0232433    .0656832
         34  |   .0218507   .0236246     0.92   0.355    -.0244565    .0681579
         35  |   .0335221   .0245475     1.37   0.172    -.0145942    .0816384
         36  |   .0344047   .0258939     1.33   0.184    -.0163506      .08516
         37  |   .0262247   .0271147     0.97   0.333    -.0269235     .079373
         38  |   .0233464   .0283056     0.82   0.410    -.0321362    .0788289
         39  |   .0282832   .0297978     0.95   0.343    -.0301243    .0866907
         40  |     .04068   .0310234     1.31   0.190    -.0201297    .1014898
         41  |   .0574477    .032402     1.77   0.076    -.0060643    .1209596
         42  |   .0657176   .0338171     1.94   0.052    -.0005683    .1320035
         43  |   .0677522   .0354299     1.91   0.056    -.0016949    .1371993
         44  |   .0885144   .0370655     2.39   0.017     .0158613    .1611676
         45  |   .0958162   .0385927     2.48   0.013     .0201696    .1714627
         46  |   .0984356   .0402273     2.45   0.014      .019585    .1772863
         47  |    .110438   .0414411     2.66   0.008     .0292082    .1916677
         48  |   .1011641   .0425118     2.38   0.017     .0178356    .1844925
         49  |  -.1827178   .0441551    -4.14   0.000    -.2692674   -.0961682
         50  |  -.2328584   .0457672    -5.09   0.000    -.3225679   -.1431488
             |
     age_cat |
          1  |   .0458131   .0069184     6.62   0.000     .0322522     .059374
          2  |   .0643305   .0079402     8.10   0.000     .0487667    .0798942
          3  |   .0812369   .0090856     8.94   0.000     .0634279    .0990458
          4  |    .103104   .0104504     9.87   0.000     .0826198    .1235882
          5  |   .1205052   .0118738    10.15   0.000     .0972311    .1437793
          6  |   .1314601   .0134535     9.77   0.000     .1050896    .1578306
          7  |   .1380533   .0150462     9.18   0.000     .1085608    .1675457
          8  |   .1535085   .0167182     9.18   0.000     .1207387    .1862783
          9  |   .1537465    .018368     8.37   0.000     .1177429    .1897501
         10  |   .1579277   .0200427     7.88   0.000     .1186415    .1972139
         11  |   .1660796   .0216988     7.65   0.000     .1235471    .2086121
         12  |   .1674636   .0233606     7.17   0.000     .1216739    .2132532
         13  |   .1769228   .0251148     7.04   0.000     .1276946    .2261509
         14  |   .1854129   .0268705     6.90   0.000     .1327432    .2380825
         15  |   .1930938   .0285547     6.76   0.000      .137123    .2490647
         16  |   .1976501   .0302644     6.53   0.000     .1383279    .2569722
         17  |   .2017914   .0319175     6.32   0.000      .139229    .2643538
         18  |   .2074246   .0338097     6.14   0.000     .1411534    .2736959
         19  |   .1981963   .0357031     5.55   0.000     .1282136    .2681789
         20  |   .2074825   .0387424     5.36   0.000     .1315425    .2834224
         25  |   .2270068   .0446314     5.09   0.000     .1395236    .3144899
         30  |   .2267704   .0624955     3.63   0.000     .1042713    .3492696
         40  |   .2127489   .0698196     3.05   0.002     .0758936    .3496043
         50  |   .1545045   .0734572     2.10   0.035      .010519      .29849
             |
       _cons |   .2009477   .0151082    13.30   0.000     .1713336    .2305617
-------------+----------------------------------------------------------------
     sigma_u |  .38733514
     sigma_e |  .28643001
         rho |  .64647772   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_lnL + during_expat_H_lnL = 0

       F(  1, 14528) =    1.53
            Prob > F =    0.2162

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .048369227881926
key: p_value
value: .2162488565357947

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.0484                                         min =          1
     between = 0.0806                                         avg =        9.0
     overall = 0.0631                                         max =         25

                                                F(82,14528)       =      26.35
corr(u_i, Xb)  = 0.1150                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0228202   .0128181     1.78   0.075    -.0023048    .0479453
during_dom~c |   .0098674   .0054099     1.82   0.068    -.0007367    .0204716
after_dome~c |   .0009354   .0089836     0.10   0.917    -.0166737    .0185444
during_expat |   .0717856   .0212911     3.37   0.001     .0300523    .1135189
 after_expat |   .0547544   .0288063     1.90   0.057    -.0017096    .1112184
during_do~nL |  -.0323627   .0069326    -4.67   0.000    -.0459516   -.0187738
after_dom~nL |  -.0446266   .0114752    -3.89   0.000    -.0671194   -.0221338
during_ex~nL |  -.0663224   .0268304    -2.47   0.013    -.1189134   -.0137314
after_exp~nL |  -.0608364   .0359674    -1.69   0.091    -.1313371    .0096643
             |
    ind_year |
          2  |   -.016458   .0103522    -1.59   0.112    -.0367497    .0038336
          3  |  -.0332757   .0125085    -2.66   0.008    -.0577939   -.0087575
          4  |  -.0412833   .0133571    -3.09   0.002     -.067465   -.0151017
          5  |  -.0324447   .0148371    -2.19   0.029    -.0615273   -.0033622
          6  |   -.040513   .0159959    -2.53   0.011    -.0718669   -.0091591
          7  |  -.0444666   .0172579    -2.58   0.010    -.0782942    -.010639
          8  |  -.0542911   .0184163    -2.95   0.003    -.0903895   -.0181927
          9  |   -.056203   .0198985    -2.82   0.005    -.0952067   -.0171994
         10  |  -.0552878   .0212511    -2.60   0.009    -.0969427   -.0136329
         11  |  -.0619744   .0227291    -2.73   0.006    -.1065264   -.0174224
         12  |  -.0621559   .0241228    -2.58   0.010    -.1094398   -.0148721
         13  |  -.0562124   .0257179    -2.19   0.029    -.1066228    -.005802
         14  |  -.0473005   .0273258    -1.73   0.083    -.1008626    .0062615
         15  |   -.036365   .0288632    -1.26   0.208    -.0929406    .0202105
         16  |  -.0226655   .0303883    -0.75   0.456    -.0822305    .0368995
         17  |  -.0070491   .0320196    -0.22   0.826    -.0698116    .0557134
         18  |  -.0025064   .0337203    -0.07   0.941    -.0686025    .0635897
         19  |   .0030778   .0353351     0.09   0.931    -.0661835    .0723391
         20  |   .0107986   .0368235     0.29   0.769    -.0613801    .0829774
         21  |   .0057711   .0382705     0.15   0.880    -.0692439    .0807862
         22  |   .0131846   .0396083     0.33   0.739    -.0644528     .090822
         23  |   .0099034   .0410113     0.24   0.809    -.0704841    .0902908
         24  |  -.0981003   .0424417    -2.31   0.021    -.1812914   -.0149091
         25  |  -.1326538   .0440311    -3.01   0.003    -.2189604   -.0463471
         26  |  -.0189811   .0252926    -0.75   0.453    -.0685577    .0305956
         27  |  -.0130633   .0223288    -0.59   0.559    -.0568306    .0307041
         28  |   .0093927   .0216234     0.43   0.664     -.032992    .0517774
         29  |    .008089   .0213353     0.38   0.705     -.033731    .0499089
         30  |   .0281865   .0212997     1.32   0.186    -.0135636    .0699366
         31  |   .0222713   .0214942     1.04   0.300    -.0198602    .0644027
         32  |   .0295531   .0220435     1.34   0.180     -.013655    .0727612
         33  |     .02122   .0226839     0.94   0.350    -.0232433    .0656832
         34  |   .0218507   .0236246     0.92   0.355    -.0244565    .0681579
         35  |   .0335221   .0245475     1.37   0.172    -.0145942    .0816384
         36  |   .0344047   .0258939     1.33   0.184    -.0163506      .08516
         37  |   .0262247   .0271147     0.97   0.333    -.0269235     .079373
         38  |   .0233464   .0283056     0.82   0.410    -.0321362    .0788289
         39  |   .0282832   .0297978     0.95   0.343    -.0301243    .0866907
         40  |     .04068   .0310234     1.31   0.190    -.0201297    .1014898
         41  |   .0574477    .032402     1.77   0.076    -.0060643    .1209596
         42  |   .0657176   .0338171     1.94   0.052    -.0005683    .1320035
         43  |   .0677522   .0354299     1.91   0.056    -.0016949    .1371993
         44  |   .0885144   .0370655     2.39   0.017     .0158613    .1611676
         45  |   .0958162   .0385927     2.48   0.013     .0201696    .1714627
         46  |   .0984356   .0402273     2.45   0.014      .019585    .1772863
         47  |    .110438   .0414411     2.66   0.008     .0292082    .1916677
         48  |   .1011641   .0425118     2.38   0.017     .0178356    .1844925
         49  |  -.1827178   .0441551    -4.14   0.000    -.2692674   -.0961682
         50  |  -.2328584   .0457672    -5.09   0.000    -.3225679   -.1431488
             |
     age_cat |
          1  |   .0458131   .0069184     6.62   0.000     .0322522     .059374
          2  |   .0643305   .0079402     8.10   0.000     .0487667    .0798942
          3  |   .0812369   .0090856     8.94   0.000     .0634279    .0990458
          4  |    .103104   .0104504     9.87   0.000     .0826198    .1235882
          5  |   .1205052   .0118738    10.15   0.000     .0972311    .1437793
          6  |   .1314601   .0134535     9.77   0.000     .1050896    .1578306
          7  |   .1380533   .0150462     9.18   0.000     .1085608    .1675457
          8  |   .1535085   .0167182     9.18   0.000     .1207387    .1862783
          9  |   .1537465    .018368     8.37   0.000     .1177429    .1897501
         10  |   .1579277   .0200427     7.88   0.000     .1186415    .1972139
         11  |   .1660796   .0216988     7.65   0.000     .1235471    .2086121
         12  |   .1674636   .0233606     7.17   0.000     .1216739    .2132532
         13  |   .1769228   .0251148     7.04   0.000     .1276946    .2261509
         14  |   .1854129   .0268705     6.90   0.000     .1327432    .2380825
         15  |   .1930938   .0285547     6.76   0.000      .137123    .2490647
         16  |   .1976501   .0302644     6.53   0.000     .1383279    .2569722
         17  |   .2017914   .0319175     6.32   0.000      .139229    .2643538
         18  |   .2074246   .0338097     6.14   0.000     .1411534    .2736959
         19  |   .1981963   .0357031     5.55   0.000     .1282136    .2681789
         20  |   .2074825   .0387424     5.36   0.000     .1315425    .2834224
         25  |   .2270068   .0446314     5.09   0.000     .1395236    .3144899
         30  |   .2267704   .0624955     3.63   0.000     .1042713    .3492696
         40  |   .2127489   .0698196     3.05   0.002     .0758936    .3496043
         50  |   .1545045   .0734572     2.10   0.035      .010519      .29849
             |
       _cons |   .2009477   .0151082    13.30   0.000     .1713336    .2305617
-------------+----------------------------------------------------------------
     sigma_u |  .38733514
     sigma_e |  .28643001
         rho |  .64647772   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.0483                         Obs per group: min =         1
       between = 0.0770                                        avg =       9.0
       overall = 0.0627                                        max =        25

                                                F(82,14528)        =     26.35
corr(u_i, Xb)  = 0.1062                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0223411   .0128244     1.74   0.082    -.0027964    .0474786
during_dom~c |   -.024641    .005346    -4.61   0.000    -.0351199   -.0141621
after_dome~c |  -.0451392   .0090122    -5.01   0.000    -.0628042   -.0274742
during_expat |   .0003132   .0243887     0.01   0.990    -.0474917    .0481182
 after_expat |  -.0179476   .0277723    -0.65   0.518    -.0723849    .0364897
during_do~KL |   .0310982   .0068435     4.54   0.000     .0176841    .0445122
after_dom~KL |     .03614   .0112911     3.20   0.001      .014008    .0582719
during_ex~KL |   .0470521   .0282131     1.67   0.095    -.0082491    .1023533
after_exp~KL |   .0553373   .0352939     1.57   0.117    -.0138432    .1245177
             |
    ind_year |
          2  |  -.0172332   .0103573    -1.66   0.096    -.0375349    .0030684
          3  |  -.0346895   .0125047    -2.77   0.006    -.0592002   -.0101788
          4  |  -.0435263   .0133452    -3.26   0.001    -.0696845    -.017368
          5  |  -.0355077    .014809    -2.40   0.017    -.0645352   -.0064802
          6  |   -.044166   .0159513    -2.77   0.006    -.0754325   -.0128995
          7  |  -.0489195    .017191    -2.85   0.004    -.0826159    -.015223
          8  |  -.0594565   .0183325    -3.24   0.001    -.0953905   -.0235224
          9  |  -.0619219   .0197966    -3.13   0.002    -.1007258    -.023118
         10  |  -.0616987   .0211294    -2.92   0.004    -.1031149   -.0202824
         11  |   -.069165   .0225907    -3.06   0.002    -.1134456   -.0248844
         12  |  -.0701512   .0239711    -2.93   0.003    -.1171376   -.0231647
         13  |  -.0650089   .0255491    -2.54   0.011    -.1150883   -.0149294
         14  |  -.0568924   .0271427    -2.10   0.036    -.1100956   -.0036892
         15  |  -.0468861    .028676    -1.64   0.102    -.1030948    .0093226
         16  |  -.0339344   .0301913    -1.12   0.261    -.0931132    .0252444
         17  |  -.0194719   .0317984    -0.61   0.540    -.0818008    .0428569
         18  |   -.015926    .033485    -0.48   0.634    -.0815608    .0497088
         19  |   -.011311   .0350783    -0.32   0.747     -.080069    .0574469
         20  |  -.0044397   .0365583    -0.12   0.903    -.0760986    .0672191
         21  |  -.0102701   .0379964    -0.27   0.787    -.0847479    .0642078
         22  |  -.0036163     .03933    -0.09   0.927    -.0807081    .0734754
         23  |  -.0075981   .0407268    -0.19   0.852    -.0874278    .0722315
         24  |  -.1164173   .0421482    -2.76   0.006    -.1990332   -.0338014
         25  |   -.151771   .0437357    -3.47   0.001    -.2374985   -.0660435
         26  |  -.0187067   .0252907    -0.74   0.460    -.0682797    .0308663
         27  |  -.0133768   .0223372    -0.60   0.549    -.0571606    .0304071
         28  |   .0083786   .0216331     0.39   0.699    -.0340251    .0507824
         29  |   .0059709   .0213429     0.28   0.780    -.0358639    .0478058
         30  |   .0252714    .021303     1.19   0.236    -.0164852     .067028
         31  |   .0185704   .0214889     0.86   0.387    -.0235505    .0606914
         32  |   .0251352   .0220261     1.14   0.254    -.0180388    .0683092
         33  |   .0162203   .0226423     0.72   0.474    -.0281614     .060602
         34  |   .0162499   .0235787     0.69   0.491    -.0299674    .0624671
         35  |   .0273379   .0244837     1.12   0.264    -.0206533    .0753292
         36  |   .0273984   .0257999     1.06   0.288    -.0231728    .0779695
         37  |   .0182415   .0269973     0.68   0.499    -.0346768    .0711597
         38  |   .0144091   .0281671     0.51   0.609     -.040802    .0696203
         39  |   .0184556   .0296332     0.62   0.533    -.0396293    .0765405
         40  |   .0300812   .0308435     0.98   0.329     -.030376    .0905385
         41  |   .0461325   .0322055     1.43   0.152    -.0169944    .1092594
         42  |   .0537462    .033607     1.60   0.110    -.0121279    .1196202
         43  |   .0549735   .0352122     1.56   0.118     -.014047    .1239939
         44  |   .0748673   .0368213     2.03   0.042     .0026928    .1470418
         45  |   .0813957   .0383341     2.12   0.034     .0062559    .1565355
         46  |   .0832972   .0399692     2.08   0.037     .0049524     .161642
         47  |   .0947231   .0411776     2.30   0.021     .0140097    .1754365
         48  |     .08471   .0422379     2.01   0.045     .0019183    .1675018
         49  |  -.1998631   .0438792    -4.55   0.000     -.285872   -.1138543
         50  |  -.2508849   .0454853    -5.52   0.000    -.3400419   -.1617278
             |
     age_cat |
          1  |   .0471516   .0069145     6.82   0.000     .0335982    .0607049
          2  |   .0668565   .0079263     8.43   0.000     .0513198    .0823931
          3  |   .0848747   .0090542     9.37   0.000     .0671272    .1026221
          4  |   .1077259   .0104064    10.35   0.000      .087328    .1281237
          5  |   .1260331   .0118055    10.68   0.000     .1028929    .1491733
          6  |   .1378948   .0133728    10.31   0.000     .1116825    .1641071
          7  |   .1453148   .0149426     9.72   0.000     .1160254    .1746043
          8  |   .1616177    .016598     9.74   0.000     .1290835     .194152
          9  |   .1627029   .0182278     8.93   0.000     .1269741    .1984317
         10  |   .1677116   .0198905     8.43   0.000     .1287236    .2066996
         11  |   .1766931    .021525     8.21   0.000     .1345014    .2188847
         12  |   .1789209   .0231781     7.72   0.000     .1334889    .2243528
         13  |   .1891742   .0249169     7.59   0.000      .140334    .2380144
         14  |    .198533   .0266545     7.45   0.000     .1462869    .2507792
         15  |   .2069345   .0283198     7.31   0.000      .151424     .262445
         16  |   .2122469   .0300306     7.07   0.000     .1533832    .2711107
         17  |    .217266   .0316754     6.86   0.000     .1551782    .2793537
         18  |   .2237511   .0335599     6.67   0.000     .1579695    .2895327
         19  |   .2152919   .0354413     6.07   0.000     .1458224    .2847614
         20  |   .2264569   .0384676     5.89   0.000     .1510555    .3018582
         25  |   .2480433   .0443631     5.59   0.000      .161086    .3350006
         30  |   .2468797   .0622816     3.96   0.000     .1247999    .3689594
         40  |   .2311808   .0696424     3.32   0.001     .0946729    .3676888
         50  |   .1723643   .0734424     2.35   0.019     .0284079    .3163208
             |
       _cons |   .1997561   .0151128    13.22   0.000     .1701331    .2293792
-------------+----------------------------------------------------------------
     sigma_u |  .38710495
     sigma_e |  .28643849
         rho |  .64619241   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_lnKL + during_expat_H_lnKL = 0

       F(  1, 14528) =    0.31
            Prob > F =    0.5801

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0483128552373877
key: p_value
value: .5800686235533437

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.0483                                         min =          1
     between = 0.0770                                         avg =        9.0
     overall = 0.0627                                         max =         25

                                                F(82,14528)       =      26.35
corr(u_i, Xb)  = 0.1062                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0223411   .0128244     1.74   0.082    -.0027964    .0474786
during_dom~c |   -.024641    .005346    -4.61   0.000    -.0351199   -.0141621
after_dome~c |  -.0451392   .0090122    -5.01   0.000    -.0628042   -.0274742
during_expat |   .0003132   .0243887     0.01   0.990    -.0474917    .0481182
 after_expat |  -.0179476   .0277723    -0.65   0.518    -.0723849    .0364897
during_do~KL |   .0310982   .0068435     4.54   0.000     .0176841    .0445122
after_dom~KL |     .03614   .0112911     3.20   0.001      .014008    .0582719
during_ex~KL |   .0470521   .0282131     1.67   0.095    -.0082491    .1023533
after_exp~KL |   .0553373   .0352939     1.57   0.117    -.0138432    .1245177
             |
    ind_year |
          2  |  -.0172332   .0103573    -1.66   0.096    -.0375349    .0030684
          3  |  -.0346895   .0125047    -2.77   0.006    -.0592002   -.0101788
          4  |  -.0435263   .0133452    -3.26   0.001    -.0696845    -.017368
          5  |  -.0355077    .014809    -2.40   0.017    -.0645352   -.0064802
          6  |   -.044166   .0159513    -2.77   0.006    -.0754325   -.0128995
          7  |  -.0489195    .017191    -2.85   0.004    -.0826159    -.015223
          8  |  -.0594565   .0183325    -3.24   0.001    -.0953905   -.0235224
          9  |  -.0619219   .0197966    -3.13   0.002    -.1007258    -.023118
         10  |  -.0616987   .0211294    -2.92   0.004    -.1031149   -.0202824
         11  |   -.069165   .0225907    -3.06   0.002    -.1134456   -.0248844
         12  |  -.0701512   .0239711    -2.93   0.003    -.1171376   -.0231647
         13  |  -.0650089   .0255491    -2.54   0.011    -.1150883   -.0149294
         14  |  -.0568924   .0271427    -2.10   0.036    -.1100956   -.0036892
         15  |  -.0468861    .028676    -1.64   0.102    -.1030948    .0093226
         16  |  -.0339344   .0301913    -1.12   0.261    -.0931132    .0252444
         17  |  -.0194719   .0317984    -0.61   0.540    -.0818008    .0428569
         18  |   -.015926    .033485    -0.48   0.634    -.0815608    .0497088
         19  |   -.011311   .0350783    -0.32   0.747     -.080069    .0574469
         20  |  -.0044397   .0365583    -0.12   0.903    -.0760986    .0672191
         21  |  -.0102701   .0379964    -0.27   0.787    -.0847479    .0642078
         22  |  -.0036163     .03933    -0.09   0.927    -.0807081    .0734754
         23  |  -.0075981   .0407268    -0.19   0.852    -.0874278    .0722315
         24  |  -.1164173   .0421482    -2.76   0.006    -.1990332   -.0338014
         25  |   -.151771   .0437357    -3.47   0.001    -.2374985   -.0660435
         26  |  -.0187067   .0252907    -0.74   0.460    -.0682797    .0308663
         27  |  -.0133768   .0223372    -0.60   0.549    -.0571606    .0304071
         28  |   .0083786   .0216331     0.39   0.699    -.0340251    .0507824
         29  |   .0059709   .0213429     0.28   0.780    -.0358639    .0478058
         30  |   .0252714    .021303     1.19   0.236    -.0164852     .067028
         31  |   .0185704   .0214889     0.86   0.387    -.0235505    .0606914
         32  |   .0251352   .0220261     1.14   0.254    -.0180388    .0683092
         33  |   .0162203   .0226423     0.72   0.474    -.0281614     .060602
         34  |   .0162499   .0235787     0.69   0.491    -.0299674    .0624671
         35  |   .0273379   .0244837     1.12   0.264    -.0206533    .0753292
         36  |   .0273984   .0257999     1.06   0.288    -.0231728    .0779695
         37  |   .0182415   .0269973     0.68   0.499    -.0346768    .0711597
         38  |   .0144091   .0281671     0.51   0.609     -.040802    .0696203
         39  |   .0184556   .0296332     0.62   0.533    -.0396293    .0765405
         40  |   .0300812   .0308435     0.98   0.329     -.030376    .0905385
         41  |   .0461325   .0322055     1.43   0.152    -.0169944    .1092594
         42  |   .0537462    .033607     1.60   0.110    -.0121279    .1196202
         43  |   .0549735   .0352122     1.56   0.118     -.014047    .1239939
         44  |   .0748673   .0368213     2.03   0.042     .0026928    .1470418
         45  |   .0813957   .0383341     2.12   0.034     .0062559    .1565355
         46  |   .0832972   .0399692     2.08   0.037     .0049524     .161642
         47  |   .0947231   .0411776     2.30   0.021     .0140097    .1754365
         48  |     .08471   .0422379     2.01   0.045     .0019183    .1675018
         49  |  -.1998631   .0438792    -4.55   0.000     -.285872   -.1138543
         50  |  -.2508849   .0454853    -5.52   0.000    -.3400419   -.1617278
             |
     age_cat |
          1  |   .0471516   .0069145     6.82   0.000     .0335982    .0607049
          2  |   .0668565   .0079263     8.43   0.000     .0513198    .0823931
          3  |   .0848747   .0090542     9.37   0.000     .0671272    .1026221
          4  |   .1077259   .0104064    10.35   0.000      .087328    .1281237
          5  |   .1260331   .0118055    10.68   0.000     .1028929    .1491733
          6  |   .1378948   .0133728    10.31   0.000     .1116825    .1641071
          7  |   .1453148   .0149426     9.72   0.000     .1160254    .1746043
          8  |   .1616177    .016598     9.74   0.000     .1290835     .194152
          9  |   .1627029   .0182278     8.93   0.000     .1269741    .1984317
         10  |   .1677116   .0198905     8.43   0.000     .1287236    .2066996
         11  |   .1766931    .021525     8.21   0.000     .1345014    .2188847
         12  |   .1789209   .0231781     7.72   0.000     .1334889    .2243528
         13  |   .1891742   .0249169     7.59   0.000      .140334    .2380144
         14  |    .198533   .0266545     7.45   0.000     .1462869    .2507792
         15  |   .2069345   .0283198     7.31   0.000      .151424     .262445
         16  |   .2122469   .0300306     7.07   0.000     .1533832    .2711107
         17  |    .217266   .0316754     6.86   0.000     .1551782    .2793537
         18  |   .2237511   .0335599     6.67   0.000     .1579695    .2895327
         19  |   .2152919   .0354413     6.07   0.000     .1458224    .2847614
         20  |   .2264569   .0384676     5.89   0.000     .1510555    .3018582
         25  |   .2480433   .0443631     5.59   0.000      .161086    .3350006
         30  |   .2468797   .0622816     3.96   0.000     .1247999    .3689594
         40  |   .2311808   .0696424     3.32   0.001     .0946729    .3676888
         50  |   .1723643   .0734424     2.35   0.019     .0284079    .3163208
             |
       _cons |   .1997561   .0151128    13.22   0.000     .1701331    .2293792
-------------+----------------------------------------------------------------
     sigma_u |  .38710495
     sigma_e |  .28643849
         rho |  .64619241   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.0483                         Obs per group: min =         1
       between = 0.0789                                        avg =       9.0
       overall = 0.0639                                        max =        25

                                                F(82,14528)        =     26.21
corr(u_i, Xb)  = 0.1096                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0226103   .0128279     1.76   0.078     -.002534    .0477546
during_dom~c |  -.0212613   .0053227    -3.99   0.000    -.0316944   -.0108282
after_dome~c |  -.0512965   .0089112    -5.76   0.000    -.0687636   -.0338294
during_expat |   .0076956   .0227981     0.34   0.736    -.0369916    .0523828
 after_expat |  -.0129551   .0266807    -0.49   0.627    -.0652526    .0393425
during_do~QL |   .0244058    .006839     3.57   0.000     .0110006    .0378111
after_dom~QL |   .0445937   .0112275     3.97   0.000     .0225863    .0666011
during_ex~QL |   .0358286   .0273873     1.31   0.191     -.017854    .0895113
after_exp~QL |   .0486626   .0350233     1.39   0.165    -.0199875    .1173127
             |
    ind_year |
          2  |  -.0171987   .0103579    -1.66   0.097    -.0375015    .0031042
          3  |  -.0347336   .0125052    -2.78   0.005    -.0592454   -.0102218
          4  |  -.0436115   .0133474    -3.27   0.001    -.0697742   -.0174488
          5  |  -.0356355   .0148095    -2.41   0.016     -.064664    -.006607
          6  |  -.0443716   .0159544    -2.78   0.005    -.0756443    -.013099
          7  |  -.0491435   .0171927    -2.86   0.004    -.0828433   -.0154437
          8  |  -.0596978    .018334    -3.26   0.001    -.0956349   -.0237608
          9  |  -.0621336   .0197971    -3.14   0.002    -.1009384   -.0233287
         10  |  -.0619131   .0211296    -2.93   0.003    -.1033299   -.0204963
         11  |  -.0693592   .0225898    -3.07   0.002    -.1136381   -.0250803
         12  |  -.0703041   .0239684    -2.93   0.003    -.1172852   -.0233231
         13  |  -.0650391   .0255456    -2.55   0.011    -.1151117   -.0149665
         14  |    -.05689    .027137    -2.10   0.036     -.110082   -.0036981
         15  |  -.0468203   .0286657    -1.63   0.102    -.1030086     .009368
         16  |  -.0338386   .0301791    -1.12   0.262    -.0929935    .0253163
         17  |  -.0192487   .0317829    -0.61   0.545    -.0815473    .0430499
         18  |  -.0156224   .0334678    -0.47   0.641    -.0812235    .0499787
         19  |  -.0109464   .0350578    -0.31   0.755    -.0796641    .0577713
         20  |  -.0040475   .0365356    -0.11   0.912    -.0756618    .0675669
         21  |  -.0098947   .0379715    -0.26   0.794    -.0843237    .0645343
         22  |  -.0032089    .039304    -0.08   0.935    -.0802498    .0738319
         23  |   -.007184    .040698    -0.18   0.860    -.0869572    .0725892
         24  |   -.116097   .0421178    -2.76   0.006    -.1986533   -.0335407
         25  |  -.1515234   .0437044    -3.47   0.001    -.2371896   -.0658572
         26  |  -.0187205   .0252951    -0.74   0.459     -.068302    .0308611
         27  |  -.0135045   .0223371    -0.60   0.545     -.057288     .030279
         28  |   .0082435   .0216354     0.38   0.703    -.0341646    .0506516
         29  |   .0058843   .0213423     0.28   0.783    -.0359493    .0477179
         30  |   .0252261   .0213018     1.18   0.236    -.0165282    .0669803
         31  |   .0185723   .0214874     0.86   0.387    -.0235458    .0606903
         32  |   .0251599   .0220243     1.14   0.253    -.0180105    .0683304
         33  |   .0162856   .0226388     0.72   0.472    -.0280894    .0606605
         34  |   .0163007   .0235744     0.69   0.489    -.0299082    .0625096
         35  |   .0274462   .0244787     1.12   0.262    -.0205352    .0754277
         36  |   .0275289   .0257942     1.07   0.286    -.0230311    .0780889
         37  |   .0183919   .0269903     0.68   0.496    -.0345126    .0712964
         38  |   .0145599   .0281568     0.52   0.605    -.0406311    .0697509
         39  |   .0186859   .0296207     0.63   0.528    -.0393744    .0767462
         40  |   .0303696   .0308304     0.99   0.325     -.030062    .0908011
         41  |   .0463732   .0321885     1.44   0.150    -.0167204    .1094669
         42  |   .0539218   .0335906     1.61   0.108    -.0119199    .1197636
         43  |   .0551569   .0351931     1.57   0.117    -.0138261    .1241398
         44  |   .0750734   .0368012     2.04   0.041     .0029383    .1472085
         45  |   .0816455   .0383109     2.13   0.033     .0065513    .1567396
         46  |    .083522   .0399449     2.09   0.037     .0052249    .1618191
         47  |   .0949784   .0411519     2.31   0.021     .0143155    .1756413
         48  |   .0850112   .0422112     2.01   0.044     .0022719    .1677506
         49  |  -.1995855   .0438528    -4.55   0.000    -.2855427   -.1136283
         50  |  -.2506429   .0454563    -5.51   0.000     -.339743   -.1615428
             |
     age_cat |
          1  |    .047328   .0069159     6.84   0.000     .0337719    .0608841
          2  |   .0669291   .0079244     8.45   0.000     .0513963    .0824619
          3  |   .0848701   .0090487     9.38   0.000     .0671335    .1026066
          4  |   .1076839   .0103998    10.35   0.000      .087299    .1280688
          5  |   .1259616   .0117969    10.68   0.000     .1028382    .1490851
          6  |   .1378015   .0133607    10.31   0.000     .1116128    .1639902
          7  |   .1452412   .0149301     9.73   0.000     .1159763    .1745061
          8  |   .1615147   .0165833     9.74   0.000     .1290093      .19402
          9  |    .162585   .0182136     8.93   0.000     .1268839    .1982861
         10  |   .1675722   .0198743     8.43   0.000     .1286161    .2065283
         11  |   .1765605   .0215078     8.21   0.000     .1344024    .2187185
         12  |   .1787387   .0231601     7.72   0.000      .133342    .2241354
         13  |    .188921   .0248956     7.59   0.000     .1401225    .2377194
         14  |    .198232   .0266326     7.44   0.000     .1460288    .2504352
         15  |   .2066654   .0282953     7.30   0.000     .1512029    .2621278
         16  |   .2119935   .0300046     7.07   0.000     .1531807    .2708063
         17  |   .2169672   .0316501     6.86   0.000     .1549289    .2790054
         18  |   .2233583   .0335354     6.66   0.000     .1576246     .289092
         19  |   .2148344   .0354171     6.07   0.000     .1454124    .2842563
         20  |   .2259096   .0384404     5.88   0.000     .1505615    .3012577
         25  |   .2474371   .0443345     5.58   0.000     .1605359    .3343383
         30  |   .2461776   .0622495     3.95   0.000     .1241607    .3681944
         40  |   .2305598   .0696095     3.31   0.001     .0941163    .3670032
         50  |   .1718522   .0733933     2.34   0.019     .0279921    .3157123
             |
       _cons |    .200018   .0151298    13.22   0.000     .1703616    .2296744
-------------+----------------------------------------------------------------
     sigma_u |  .38691122
     sigma_e |   .2864426
         rho |  .64595692   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_lnQL + during_expat_H_lnQL = 0

       F(  1, 14528) =    0.17
            Prob > F =    0.6839

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0482855715334343
key: p_value
value: .6838721170689089

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.0483                                         min =          1
     between = 0.0789                                         avg =        9.0
     overall = 0.0639                                         max =         25

                                                F(82,14528)       =      26.21
corr(u_i, Xb)  = 0.1096                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0226103   .0128279     1.76   0.078     -.002534    .0477546
during_dom~c |  -.0212613   .0053227    -3.99   0.000    -.0316944   -.0108282
after_dome~c |  -.0512965   .0089112    -5.76   0.000    -.0687636   -.0338294
during_expat |   .0076956   .0227981     0.34   0.736    -.0369916    .0523828
 after_expat |  -.0129551   .0266807    -0.49   0.627    -.0652526    .0393425
during_do~QL |   .0244058    .006839     3.57   0.000     .0110006    .0378111
after_dom~QL |   .0445937   .0112275     3.97   0.000     .0225863    .0666011
during_ex~QL |   .0358286   .0273873     1.31   0.191     -.017854    .0895113
after_exp~QL |   .0486626   .0350233     1.39   0.165    -.0199875    .1173127
             |
    ind_year |
          2  |  -.0171987   .0103579    -1.66   0.097    -.0375015    .0031042
          3  |  -.0347336   .0125052    -2.78   0.005    -.0592454   -.0102218
          4  |  -.0436115   .0133474    -3.27   0.001    -.0697742   -.0174488
          5  |  -.0356355   .0148095    -2.41   0.016     -.064664    -.006607
          6  |  -.0443716   .0159544    -2.78   0.005    -.0756443    -.013099
          7  |  -.0491435   .0171927    -2.86   0.004    -.0828433   -.0154437
          8  |  -.0596978    .018334    -3.26   0.001    -.0956349   -.0237608
          9  |  -.0621336   .0197971    -3.14   0.002    -.1009384   -.0233287
         10  |  -.0619131   .0211296    -2.93   0.003    -.1033299   -.0204963
         11  |  -.0693592   .0225898    -3.07   0.002    -.1136381   -.0250803
         12  |  -.0703041   .0239684    -2.93   0.003    -.1172852   -.0233231
         13  |  -.0650391   .0255456    -2.55   0.011    -.1151117   -.0149665
         14  |    -.05689    .027137    -2.10   0.036     -.110082   -.0036981
         15  |  -.0468203   .0286657    -1.63   0.102    -.1030086     .009368
         16  |  -.0338386   .0301791    -1.12   0.262    -.0929935    .0253163
         17  |  -.0192487   .0317829    -0.61   0.545    -.0815473    .0430499
         18  |  -.0156224   .0334678    -0.47   0.641    -.0812235    .0499787
         19  |  -.0109464   .0350578    -0.31   0.755    -.0796641    .0577713
         20  |  -.0040475   .0365356    -0.11   0.912    -.0756618    .0675669
         21  |  -.0098947   .0379715    -0.26   0.794    -.0843237    .0645343
         22  |  -.0032089    .039304    -0.08   0.935    -.0802498    .0738319
         23  |   -.007184    .040698    -0.18   0.860    -.0869572    .0725892
         24  |   -.116097   .0421178    -2.76   0.006    -.1986533   -.0335407
         25  |  -.1515234   .0437044    -3.47   0.001    -.2371896   -.0658572
         26  |  -.0187205   .0252951    -0.74   0.459     -.068302    .0308611
         27  |  -.0135045   .0223371    -0.60   0.545     -.057288     .030279
         28  |   .0082435   .0216354     0.38   0.703    -.0341646    .0506516
         29  |   .0058843   .0213423     0.28   0.783    -.0359493    .0477179
         30  |   .0252261   .0213018     1.18   0.236    -.0165282    .0669803
         31  |   .0185723   .0214874     0.86   0.387    -.0235458    .0606903
         32  |   .0251599   .0220243     1.14   0.253    -.0180105    .0683304
         33  |   .0162856   .0226388     0.72   0.472    -.0280894    .0606605
         34  |   .0163007   .0235744     0.69   0.489    -.0299082    .0625096
         35  |   .0274462   .0244787     1.12   0.262    -.0205352    .0754277
         36  |   .0275289   .0257942     1.07   0.286    -.0230311    .0780889
         37  |   .0183919   .0269903     0.68   0.496    -.0345126    .0712964
         38  |   .0145599   .0281568     0.52   0.605    -.0406311    .0697509
         39  |   .0186859   .0296207     0.63   0.528    -.0393744    .0767462
         40  |   .0303696   .0308304     0.99   0.325     -.030062    .0908011
         41  |   .0463732   .0321885     1.44   0.150    -.0167204    .1094669
         42  |   .0539218   .0335906     1.61   0.108    -.0119199    .1197636
         43  |   .0551569   .0351931     1.57   0.117    -.0138261    .1241398
         44  |   .0750734   .0368012     2.04   0.041     .0029383    .1472085
         45  |   .0816455   .0383109     2.13   0.033     .0065513    .1567396
         46  |    .083522   .0399449     2.09   0.037     .0052249    .1618191
         47  |   .0949784   .0411519     2.31   0.021     .0143155    .1756413
         48  |   .0850112   .0422112     2.01   0.044     .0022719    .1677506
         49  |  -.1995855   .0438528    -4.55   0.000    -.2855427   -.1136283
         50  |  -.2506429   .0454563    -5.51   0.000     -.339743   -.1615428
             |
     age_cat |
          1  |    .047328   .0069159     6.84   0.000     .0337719    .0608841
          2  |   .0669291   .0079244     8.45   0.000     .0513963    .0824619
          3  |   .0848701   .0090487     9.38   0.000     .0671335    .1026066
          4  |   .1076839   .0103998    10.35   0.000      .087299    .1280688
          5  |   .1259616   .0117969    10.68   0.000     .1028382    .1490851
          6  |   .1378015   .0133607    10.31   0.000     .1116128    .1639902
          7  |   .1452412   .0149301     9.73   0.000     .1159763    .1745061
          8  |   .1615147   .0165833     9.74   0.000     .1290093      .19402
          9  |    .162585   .0182136     8.93   0.000     .1268839    .1982861
         10  |   .1675722   .0198743     8.43   0.000     .1286161    .2065283
         11  |   .1765605   .0215078     8.21   0.000     .1344024    .2187185
         12  |   .1787387   .0231601     7.72   0.000      .133342    .2241354
         13  |    .188921   .0248956     7.59   0.000     .1401225    .2377194
         14  |    .198232   .0266326     7.44   0.000     .1460288    .2504352
         15  |   .2066654   .0282953     7.30   0.000     .1512029    .2621278
         16  |   .2119935   .0300046     7.07   0.000     .1531807    .2708063
         17  |   .2169672   .0316501     6.86   0.000     .1549289    .2790054
         18  |   .2233583   .0335354     6.66   0.000     .1576246     .289092
         19  |   .2148344   .0354171     6.07   0.000     .1454124    .2842563
         20  |   .2259096   .0384404     5.88   0.000     .1505615    .3012577
         25  |   .2474371   .0443345     5.58   0.000     .1605359    .3343383
         30  |   .2461776   .0622495     3.95   0.000     .1241607    .3681944
         40  |   .2305598   .0696095     3.31   0.001     .0941163    .3670032
         50  |   .1718522   .0733933     2.34   0.019     .0279921    .3157123
             |
       _cons |    .200018   .0151298    13.22   0.000     .1703616    .2296744
-------------+----------------------------------------------------------------
     sigma_u |  .38691122
     sigma_e |   .2864426
         rho |  .64595692   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.0509                         Obs per group: min =         1
       between = 0.0207                                        avg =       9.0
       overall = 0.0234                                        max =        25

                                                F(82,14528)        =     29.01
corr(u_i, Xb)  = -0.0150                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .023634   .0127751     1.85   0.064    -.0014068    .0486748
during_dom~c |   .0320163   .0042818     7.48   0.000     .0236234    .0404092
after_dome~c |   .0410798   .0071121     5.78   0.000     .0271392    .0550204
during_expat |   .1444308   .0248724     5.81   0.000     .0956778    .1931839
 after_expat |   .1645595   .0339007     4.85   0.000     .0981099    .2310092
during_dom~r |  -.1006332   .0071754   -14.02   0.000    -.1146979   -.0865684
after_dome~r |  -.1511607   .0113669   -13.30   0.000    -.1734414     -.12888
during_exp~r |  -.1741325   .0285346    -6.10   0.000    -.2300639   -.1182011
after_expa~r |  -.2205526   .0388388    -5.68   0.000    -.2966817   -.1444235
             |
    ind_year |
          2  |  -.0151066   .0103418    -1.46   0.144    -.0353777    .0051646
          3  |  -.0303494   .0124984    -2.43   0.015     -.054848   -.0058509
          4  |  -.0365666   .0133335    -2.74   0.006    -.0627019   -.0104314
          5  |  -.0261329   .0148187    -1.76   0.078    -.0551796    .0029137
          6  |  -.0327018   .0159768    -2.05   0.041    -.0640183   -.0013852
          7  |  -.0348778    .017247    -2.02   0.043    -.0686842   -.0010714
          8  |  -.0432001   .0184123    -2.35   0.019    -.0792905   -.0071097
          9  |   -.043967   .0198846    -2.21   0.027    -.0829433   -.0049907
         10  |  -.0417694   .0212362    -1.97   0.049    -.0833951   -.0001437
         11  |  -.0473595   .0227087    -2.09   0.037    -.0918714   -.0028475
         12  |   -.045917   .0241086    -1.90   0.057    -.0931729    .0013388
         13  |   -.039074   .0257028    -1.52   0.128    -.0894548    .0113067
         14  |  -.0291789   .0273176    -1.07   0.285    -.0827249    .0243671
         15  |  -.0168517   .0288517    -0.58   0.559    -.0734047    .0397014
         16  |  -.0017081   .0303936    -0.06   0.955    -.0612834    .0578671
         17  |   .0153055   .0320248     0.48   0.633    -.0474671     .078078
         18  |   .0211491   .0337254     0.63   0.531    -.0449569    .0872552
         19  |   .0279512    .035345     0.79   0.429    -.0413295     .097232
         20  |   .0366493   .0368372     0.99   0.320    -.0355563    .1088549
         21  |   .0325014   .0382885     0.85   0.396    -.0425489    .1075516
         22  |   .0408827   .0396345     1.03   0.302    -.0368059    .1185713
         23  |   .0387381   .0410412     0.94   0.345    -.0417078     .119184
         24  |  -.0682984   .0424724    -1.61   0.108    -.1515497    .0149529
         25  |  -.1019243   .0440653    -2.31   0.021    -.1882979   -.0155507
         26  |  -.0250463   .0252403    -0.99   0.321    -.0745205    .0244279
         27  |  -.0169337   .0222797    -0.76   0.447    -.0606048    .0267375
         28  |   .0075399   .0215702     0.35   0.727    -.0347405    .0498202
         29  |   .0083964   .0212897     0.39   0.693    -.0333341    .0501269
         30  |   .0302952   .0212483     1.43   0.154    -.0113541    .0719446
         31  |   .0264193   .0214395     1.23   0.218    -.0156048    .0684433
         32  |    .035197   .0219905     1.60   0.109    -.0079072    .0783013
         33  |   .0285774   .0226322     1.26   0.207    -.0157846    .0729394
         34  |   .0309634   .0235877     1.31   0.189    -.0152716    .0771984
         35  |   .0444492   .0245149     1.81   0.070    -.0036032    .0925015
         36  |   .0474795   .0258686     1.84   0.066    -.0032263    .0981854
         37  |   .0409906   .0271042     1.51   0.130    -.0121371    .0941183
         38  |   .0403085   .0282994     1.42   0.154     -.015162    .0957789
         39  |   .0473227   .0297871     1.59   0.112    -.0110639    .1057092
         40  |   .0616703   .0310419     1.99   0.047     .0008242    .1225163
         41  |   .0802131   .0324395     2.47   0.013     .0166275    .1437987
         42  |   .0903427   .0338802     2.67   0.008     .0239333    .1567522
         43  |   .0941557   .0354903     2.65   0.008     .0245902    .1637212
         44  |   .1165329    .037142     3.14   0.002       .04373    .1893359
         45  |   .1256502   .0386872     3.25   0.001     .0498184     .201482
         46  |   .1300071    .040355     3.22   0.001     .0509062    .2091081
         47  |   .1436814    .041573     3.46   0.001     .0621929    .2251698
         48  |   .1360846   .0426674     3.19   0.001      .052451    .2197182
         49  |  -.1462184   .0442997    -3.30   0.001    -.2330515   -.0593854
         50  |  -.1945264   .0459144    -4.24   0.000    -.2845244   -.1045283
             |
     age_cat |
          1  |   .0433572    .006923     6.26   0.000     .0297872    .0569272
          2  |    .059764   .0079527     7.51   0.000     .0441758    .0753523
          3  |   .0745528   .0091077     8.19   0.000     .0567006    .0924051
          4  |   .0945554   .0104933     9.01   0.000     .0739871    .1151236
          5  |   .1102137   .0119211     9.25   0.000     .0868468    .1335807
          6  |   .1194743   .0135162     8.84   0.000     .0929808    .1459679
          7  |    .124407   .0151193     8.23   0.000     .0947712    .1540428
          8  |   .1383322   .0167997     8.23   0.000     .1054026    .1712619
          9  |   .1370605   .0184607     7.42   0.000     .1008752    .1732457
         10  |   .1398107   .0201381     6.94   0.000     .1003375     .179284
         11  |   .1464486   .0217927     6.72   0.000      .103732    .1891651
         12  |   .1462915   .0234666     6.23   0.000     .1002939     .192289
         13  |   .1542952   .0252233     6.12   0.000     .1048544    .2037361
         14  |   .1613827   .0269747     5.98   0.000     .1085089    .2142564
         15  |   .1676446   .0286551     5.85   0.000      .111477    .2238122
         16  |   .1709069   .0303837     5.62   0.000     .1113509    .2304629
         17  |   .1736302   .0320503     5.42   0.000     .1108075    .2364528
         18  |   .1782161   .0339476     5.25   0.000     .1116745    .2447577
         19  |    .167748   .0358363     4.68   0.000     .0975043    .2379916
         20  |    .174597   .0389066     4.49   0.000      .098335    .2508589
         25  |   .1912967   .0448301     4.27   0.000     .1034241    .2791694
         30  |   .1910678   .0625493     3.05   0.002     .0684632    .3136724
         40  |   .1781896   .0698696     2.55   0.011     .0412363    .3151428
         50  |   .1198131   .0733763     1.63   0.103    -.0240137      .26364
             |
       _cons |    .202958   .0150857    13.45   0.000      .173388    .2325279
-------------+----------------------------------------------------------------
     sigma_u |  .39647307
     sigma_e |  .28605376
         rho |  .65765392   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_exporter + during_expat_H_exporter = 0

       F(  1, 14528) =    6.33
            Prob > F =    0.0119

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .050867669910479
key: p_value
value: .0118657038725331

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.0509                                         min =          1
     between = 0.0207                                         avg =        9.0
     overall = 0.0234                                         max =         25

                                                F(82,14528)       =      29.01
corr(u_i, Xb)  = -0.0150                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .023634   .0127751     1.85   0.064    -.0014068    .0486748
during_dom~c |   .0320163   .0042818     7.48   0.000     .0236234    .0404092
after_dome~c |   .0410798   .0071121     5.78   0.000     .0271392    .0550204
during_expat |   .1444308   .0248724     5.81   0.000     .0956778    .1931839
 after_expat |   .1645595   .0339007     4.85   0.000     .0981099    .2310092
during_dom~r |  -.1006332   .0071754   -14.02   0.000    -.1146979   -.0865684
after_dome~r |  -.1511607   .0113669   -13.30   0.000    -.1734414     -.12888
during_exp~r |  -.1741325   .0285346    -6.10   0.000    -.2300639   -.1182011
after_expa~r |  -.2205526   .0388388    -5.68   0.000    -.2966817   -.1444235
             |
    ind_year |
          2  |  -.0151066   .0103418    -1.46   0.144    -.0353777    .0051646
          3  |  -.0303494   .0124984    -2.43   0.015     -.054848   -.0058509
          4  |  -.0365666   .0133335    -2.74   0.006    -.0627019   -.0104314
          5  |  -.0261329   .0148187    -1.76   0.078    -.0551796    .0029137
          6  |  -.0327018   .0159768    -2.05   0.041    -.0640183   -.0013852
          7  |  -.0348778    .017247    -2.02   0.043    -.0686842   -.0010714
          8  |  -.0432001   .0184123    -2.35   0.019    -.0792905   -.0071097
          9  |   -.043967   .0198846    -2.21   0.027    -.0829433   -.0049907
         10  |  -.0417694   .0212362    -1.97   0.049    -.0833951   -.0001437
         11  |  -.0473595   .0227087    -2.09   0.037    -.0918714   -.0028475
         12  |   -.045917   .0241086    -1.90   0.057    -.0931729    .0013388
         13  |   -.039074   .0257028    -1.52   0.128    -.0894548    .0113067
         14  |  -.0291789   .0273176    -1.07   0.285    -.0827249    .0243671
         15  |  -.0168517   .0288517    -0.58   0.559    -.0734047    .0397014
         16  |  -.0017081   .0303936    -0.06   0.955    -.0612834    .0578671
         17  |   .0153055   .0320248     0.48   0.633    -.0474671     .078078
         18  |   .0211491   .0337254     0.63   0.531    -.0449569    .0872552
         19  |   .0279512    .035345     0.79   0.429    -.0413295     .097232
         20  |   .0366493   .0368372     0.99   0.320    -.0355563    .1088549
         21  |   .0325014   .0382885     0.85   0.396    -.0425489    .1075516
         22  |   .0408827   .0396345     1.03   0.302    -.0368059    .1185713
         23  |   .0387381   .0410412     0.94   0.345    -.0417078     .119184
         24  |  -.0682984   .0424724    -1.61   0.108    -.1515497    .0149529
         25  |  -.1019243   .0440653    -2.31   0.021    -.1882979   -.0155507
         26  |  -.0250463   .0252403    -0.99   0.321    -.0745205    .0244279
         27  |  -.0169337   .0222797    -0.76   0.447    -.0606048    .0267375
         28  |   .0075399   .0215702     0.35   0.727    -.0347405    .0498202
         29  |   .0083964   .0212897     0.39   0.693    -.0333341    .0501269
         30  |   .0302952   .0212483     1.43   0.154    -.0113541    .0719446
         31  |   .0264193   .0214395     1.23   0.218    -.0156048    .0684433
         32  |    .035197   .0219905     1.60   0.109    -.0079072    .0783013
         33  |   .0285774   .0226322     1.26   0.207    -.0157846    .0729394
         34  |   .0309634   .0235877     1.31   0.189    -.0152716    .0771984
         35  |   .0444492   .0245149     1.81   0.070    -.0036032    .0925015
         36  |   .0474795   .0258686     1.84   0.066    -.0032263    .0981854
         37  |   .0409906   .0271042     1.51   0.130    -.0121371    .0941183
         38  |   .0403085   .0282994     1.42   0.154     -.015162    .0957789
         39  |   .0473227   .0297871     1.59   0.112    -.0110639    .1057092
         40  |   .0616703   .0310419     1.99   0.047     .0008242    .1225163
         41  |   .0802131   .0324395     2.47   0.013     .0166275    .1437987
         42  |   .0903427   .0338802     2.67   0.008     .0239333    .1567522
         43  |   .0941557   .0354903     2.65   0.008     .0245902    .1637212
         44  |   .1165329    .037142     3.14   0.002       .04373    .1893359
         45  |   .1256502   .0386872     3.25   0.001     .0498184     .201482
         46  |   .1300071    .040355     3.22   0.001     .0509062    .2091081
         47  |   .1436814    .041573     3.46   0.001     .0621929    .2251698
         48  |   .1360846   .0426674     3.19   0.001      .052451    .2197182
         49  |  -.1462184   .0442997    -3.30   0.001    -.2330515   -.0593854
         50  |  -.1945264   .0459144    -4.24   0.000    -.2845244   -.1045283
             |
     age_cat |
          1  |   .0433572    .006923     6.26   0.000     .0297872    .0569272
          2  |    .059764   .0079527     7.51   0.000     .0441758    .0753523
          3  |   .0745528   .0091077     8.19   0.000     .0567006    .0924051
          4  |   .0945554   .0104933     9.01   0.000     .0739871    .1151236
          5  |   .1102137   .0119211     9.25   0.000     .0868468    .1335807
          6  |   .1194743   .0135162     8.84   0.000     .0929808    .1459679
          7  |    .124407   .0151193     8.23   0.000     .0947712    .1540428
          8  |   .1383322   .0167997     8.23   0.000     .1054026    .1712619
          9  |   .1370605   .0184607     7.42   0.000     .1008752    .1732457
         10  |   .1398107   .0201381     6.94   0.000     .1003375     .179284
         11  |   .1464486   .0217927     6.72   0.000      .103732    .1891651
         12  |   .1462915   .0234666     6.23   0.000     .1002939     .192289
         13  |   .1542952   .0252233     6.12   0.000     .1048544    .2037361
         14  |   .1613827   .0269747     5.98   0.000     .1085089    .2142564
         15  |   .1676446   .0286551     5.85   0.000      .111477    .2238122
         16  |   .1709069   .0303837     5.62   0.000     .1113509    .2304629
         17  |   .1736302   .0320503     5.42   0.000     .1108075    .2364528
         18  |   .1782161   .0339476     5.25   0.000     .1116745    .2447577
         19  |    .167748   .0358363     4.68   0.000     .0975043    .2379916
         20  |    .174597   .0389066     4.49   0.000      .098335    .2508589
         25  |   .1912967   .0448301     4.27   0.000     .1034241    .2791694
         30  |   .1910678   .0625493     3.05   0.002     .0684632    .3136724
         40  |   .1781896   .0698696     2.55   0.011     .0412363    .3151428
         50  |   .1198131   .0733763     1.63   0.103    -.0240137      .26364
             |
       _cons |    .202958   .0150857    13.45   0.000      .173388    .2325279
-------------+----------------------------------------------------------------
     sigma_u |  .39647307
     sigma_e |  .28605376
         rho |  .65765392   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.0481                         Obs per group: min =         1
       between = 0.0808                                        avg =       9.0
       overall = 0.0640                                        max =        25

                                                F(82,14528)        =     26.19
corr(u_i, Xb)  = 0.1144                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0222152   .0128263     1.73   0.083     -.002926    .0473564
during_dom~c |   -.004085   .0056609    -0.72   0.471    -.0151812    .0070111
after_dome~c |  -.0099151    .009358    -1.06   0.289     -.028258    .0084277
during_expat |   .0438201   .0177242     2.47   0.013     .0090785    .0785617
 after_expat |   .0055115   .0239869     0.23   0.818    -.0415058    .0525288
during_dom~w |  -.0051691   .0070183    -0.74   0.461     -.018926    .0085877
after_dome~w |  -.0222649   .0115439    -1.93   0.054    -.0448923    .0003625
during_exp~w |  -.0235295   .0251634    -0.94   0.350    -.0728529     .025794
after_expa~w |   .0129529   .0337201     0.38   0.701    -.0531428    .0790486
             |
    ind_year |
          2  |  -.0171189   .0103641    -1.65   0.099    -.0374339    .0031961
          3  |  -.0344785   .0125152    -2.75   0.006    -.0590098   -.0099472
          4  |  -.0431462   .0133641    -3.23   0.001    -.0693415   -.0169509
          5  |   -.034828   .0148375    -2.35   0.019    -.0639113   -.0057446
          6  |    -.04339     .01599    -2.71   0.007    -.0747323   -.0120476
          7  |  -.0478983   .0172353    -2.78   0.005    -.0816817   -.0141149
          8  |  -.0581364   .0183824    -3.16   0.002    -.0941682   -.0221045
          9  |  -.0605063   .0198618    -3.05   0.002     -.099438   -.0215747
         10  |  -.0600393   .0212023    -2.83   0.005    -.1015985   -.0184802
         11  |  -.0671921   .0226699    -2.96   0.003    -.1116279   -.0227562
         12  |  -.0678156   .0240549    -2.82   0.005    -.1149664   -.0206649
         13  |  -.0622987   .0256407    -2.43   0.015    -.1125577   -.0120397
         14  |  -.0537676   .0272443    -1.97   0.048    -.1071698   -.0003653
         15  |  -.0432273   .0287834    -1.50   0.133    -.0996463    .0131918
         16  |  -.0298715   .0303002    -0.99   0.324    -.0892637    .0295207
         17  |  -.0147372   .0319143    -0.46   0.644    -.0772932    .0478189
         18  |  -.0105689   .0336048    -0.31   0.753    -.0764385    .0553008
         19  |  -.0053979   .0352075    -0.15   0.878    -.0744092    .0636133
         20  |   .0019303   .0366912     0.05   0.958    -.0699892    .0738497
         21  |  -.0034674   .0381296    -0.09   0.928    -.0782062    .0712714
         22  |    .003615   .0394687     0.09   0.927    -.0737487    .0809786
         23  |   .0000792   .0408668     0.00   0.998    -.0800249    .0801833
         24  |  -.1083319   .0422922    -2.56   0.010    -.1912299   -.0254338
         25  |   -.143278   .0438782    -3.27   0.001    -.2292847   -.0572712
         26  |  -.0180862   .0253089    -0.71   0.475    -.0676948    .0315224
         27  |  -.0128004   .0223539    -0.57   0.567    -.0566169    .0310162
         28  |   .0091573   .0216538     0.42   0.672    -.0332869    .0516014
         29  |   .0071707   .0213739     0.34   0.737    -.0347249    .0490664
         30  |   .0266105   .0213385     1.25   0.212    -.0152156    .0684365
         31  |   .0201622    .021529     0.94   0.349    -.0220374    .0623618
         32  |   .0268426   .0220794     1.22   0.224    -.0164358     .070121
         33  |    .018075   .0227139     0.80   0.426    -.0264472    .0625972
         34  |   .0182576   .0236599     0.77   0.440    -.0281188     .064634
         35  |   .0295036   .0245707     1.20   0.230     -.018658    .0776653
         36  |    .029826   .0259002     1.15   0.250    -.0209417    .0805937
         37  |   .0210814   .0271045     0.78   0.437     -.032047    .0742097
         38  |   .0175355   .0282638     0.62   0.535    -.0378652    .0729363
         39  |   .0219965   .0297265     0.74   0.459    -.0362712    .0802642
         40  |   .0339857    .030946     1.10   0.272    -.0266724    .0946438
         41  |   .0503616   .0323121     1.56   0.119    -.0129743    .1136974
         42  |   .0582487   .0337189     1.73   0.084    -.0078446    .1243421
         43  |   .0598811    .035321     1.70   0.090    -.0093525    .1291147
         44  |   .0802192   .0369352     2.17   0.030     .0078215    .1526169
         45  |   .0871839   .0384431     2.27   0.023     .0118306    .1625373
         46  |   .0894596   .0400783     2.23   0.026      .010901    .1680181
         47  |   .1012506   .0412795     2.45   0.014     .0203374    .1821637
         48  |   .0916358   .0423387     2.16   0.030     .0086466     .174625
         49  |  -.1925004   .0439769    -4.38   0.000    -.2787008      -.1063
         50  |  -.2430964   .0455851    -5.33   0.000    -.3324491   -.1537437
             |
     age_cat |
          1  |   .0467106   .0069174     6.75   0.000     .0331517    .0602695
          2  |   .0658642   .0079309     8.30   0.000     .0503187    .0814097
          3  |   .0833708   .0090627     9.20   0.000     .0656068    .1011348
          4  |   .1058075   .0104207    10.15   0.000     .0853815    .1262335
          5  |    .123722   .0118328    10.46   0.000     .1005281    .1469158
          6  |   .1351995   .0134046    10.09   0.000     .1089249    .1614742
          7  |   .1422988   .0149832     9.50   0.000     .1129299    .1716677
          8  |   .1582976   .0166451     9.51   0.000     .1256711     .190924
          9  |   .1590696   .0182839     8.70   0.000     .1232307    .1949085
         10  |   .1637684   .0199486     8.21   0.000     .1246665    .2028703
         11  |   .1723863   .0215898     7.98   0.000     .1300675    .2147051
         12  |   .1742279   .0232437     7.50   0.000     .1286672    .2197886
         13  |   .1840842   .0249795     7.37   0.000     .1351212    .2330472
         14  |   .1930342   .0267314     7.22   0.000     .1406373     .245431
         15  |   .2010548    .028401     7.08   0.000     .1453853    .2567243
         16  |   .2059834   .0301145     6.84   0.000     .1469551    .2650116
         17  |   .2105747   .0317628     6.63   0.000     .1483155    .2728339
         18  |   .2165978   .0336488     6.44   0.000     .1506419    .2825537
         19  |   .2077325   .0355321     5.85   0.000      .138085      .27738
         20  |   .2179388   .0385542     5.65   0.000     .1423677    .2935098
         25  |   .2385143   .0444306     5.37   0.000     .1514246    .3256039
         30  |   .2379453   .0623283     3.82   0.000     .1157739    .3601168
         40  |    .223152   .0696652     3.20   0.001     .0865993    .3597048
         50  |   .1642867   .0734071     2.24   0.025     .0203994    .3081741
             |
       _cons |    .201128   .0151238    13.30   0.000     .1714834    .2307727
-------------+----------------------------------------------------------------
     sigma_u |  .38697015
     sigma_e |  .28646632
         rho |   .6459887   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_slow + during_expat_H_slow = 0

       F(  1, 14528) =    0.51
            Prob > F =    0.4767

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0481279514478909
key: p_value
value: .4767214769028478

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.0481                                         min =          1
     between = 0.0808                                         avg =        9.0
     overall = 0.0640                                         max =         25

                                                F(82,14528)       =      26.19
corr(u_i, Xb)  = 0.1144                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0222152   .0128263     1.73   0.083     -.002926    .0473564
during_dom~c |   -.004085   .0056609    -0.72   0.471    -.0151812    .0070111
after_dome~c |  -.0099151    .009358    -1.06   0.289     -.028258    .0084277
during_expat |   .0438201   .0177242     2.47   0.013     .0090785    .0785617
 after_expat |   .0055115   .0239869     0.23   0.818    -.0415058    .0525288
during_dom~w |  -.0051691   .0070183    -0.74   0.461     -.018926    .0085877
after_dome~w |  -.0222649   .0115439    -1.93   0.054    -.0448923    .0003625
during_exp~w |  -.0235295   .0251634    -0.94   0.350    -.0728529     .025794
after_expa~w |   .0129529   .0337201     0.38   0.701    -.0531428    .0790486
             |
    ind_year |
          2  |  -.0171189   .0103641    -1.65   0.099    -.0374339    .0031961
          3  |  -.0344785   .0125152    -2.75   0.006    -.0590098   -.0099472
          4  |  -.0431462   .0133641    -3.23   0.001    -.0693415   -.0169509
          5  |   -.034828   .0148375    -2.35   0.019    -.0639113   -.0057446
          6  |    -.04339     .01599    -2.71   0.007    -.0747323   -.0120476
          7  |  -.0478983   .0172353    -2.78   0.005    -.0816817   -.0141149
          8  |  -.0581364   .0183824    -3.16   0.002    -.0941682   -.0221045
          9  |  -.0605063   .0198618    -3.05   0.002     -.099438   -.0215747
         10  |  -.0600393   .0212023    -2.83   0.005    -.1015985   -.0184802
         11  |  -.0671921   .0226699    -2.96   0.003    -.1116279   -.0227562
         12  |  -.0678156   .0240549    -2.82   0.005    -.1149664   -.0206649
         13  |  -.0622987   .0256407    -2.43   0.015    -.1125577   -.0120397
         14  |  -.0537676   .0272443    -1.97   0.048    -.1071698   -.0003653
         15  |  -.0432273   .0287834    -1.50   0.133    -.0996463    .0131918
         16  |  -.0298715   .0303002    -0.99   0.324    -.0892637    .0295207
         17  |  -.0147372   .0319143    -0.46   0.644    -.0772932    .0478189
         18  |  -.0105689   .0336048    -0.31   0.753    -.0764385    .0553008
         19  |  -.0053979   .0352075    -0.15   0.878    -.0744092    .0636133
         20  |   .0019303   .0366912     0.05   0.958    -.0699892    .0738497
         21  |  -.0034674   .0381296    -0.09   0.928    -.0782062    .0712714
         22  |    .003615   .0394687     0.09   0.927    -.0737487    .0809786
         23  |   .0000792   .0408668     0.00   0.998    -.0800249    .0801833
         24  |  -.1083319   .0422922    -2.56   0.010    -.1912299   -.0254338
         25  |   -.143278   .0438782    -3.27   0.001    -.2292847   -.0572712
         26  |  -.0180862   .0253089    -0.71   0.475    -.0676948    .0315224
         27  |  -.0128004   .0223539    -0.57   0.567    -.0566169    .0310162
         28  |   .0091573   .0216538     0.42   0.672    -.0332869    .0516014
         29  |   .0071707   .0213739     0.34   0.737    -.0347249    .0490664
         30  |   .0266105   .0213385     1.25   0.212    -.0152156    .0684365
         31  |   .0201622    .021529     0.94   0.349    -.0220374    .0623618
         32  |   .0268426   .0220794     1.22   0.224    -.0164358     .070121
         33  |    .018075   .0227139     0.80   0.426    -.0264472    .0625972
         34  |   .0182576   .0236599     0.77   0.440    -.0281188     .064634
         35  |   .0295036   .0245707     1.20   0.230     -.018658    .0776653
         36  |    .029826   .0259002     1.15   0.250    -.0209417    .0805937
         37  |   .0210814   .0271045     0.78   0.437     -.032047    .0742097
         38  |   .0175355   .0282638     0.62   0.535    -.0378652    .0729363
         39  |   .0219965   .0297265     0.74   0.459    -.0362712    .0802642
         40  |   .0339857    .030946     1.10   0.272    -.0266724    .0946438
         41  |   .0503616   .0323121     1.56   0.119    -.0129743    .1136974
         42  |   .0582487   .0337189     1.73   0.084    -.0078446    .1243421
         43  |   .0598811    .035321     1.70   0.090    -.0093525    .1291147
         44  |   .0802192   .0369352     2.17   0.030     .0078215    .1526169
         45  |   .0871839   .0384431     2.27   0.023     .0118306    .1625373
         46  |   .0894596   .0400783     2.23   0.026      .010901    .1680181
         47  |   .1012506   .0412795     2.45   0.014     .0203374    .1821637
         48  |   .0916358   .0423387     2.16   0.030     .0086466     .174625
         49  |  -.1925004   .0439769    -4.38   0.000    -.2787008      -.1063
         50  |  -.2430964   .0455851    -5.33   0.000    -.3324491   -.1537437
             |
     age_cat |
          1  |   .0467106   .0069174     6.75   0.000     .0331517    .0602695
          2  |   .0658642   .0079309     8.30   0.000     .0503187    .0814097
          3  |   .0833708   .0090627     9.20   0.000     .0656068    .1011348
          4  |   .1058075   .0104207    10.15   0.000     .0853815    .1262335
          5  |    .123722   .0118328    10.46   0.000     .1005281    .1469158
          6  |   .1351995   .0134046    10.09   0.000     .1089249    .1614742
          7  |   .1422988   .0149832     9.50   0.000     .1129299    .1716677
          8  |   .1582976   .0166451     9.51   0.000     .1256711     .190924
          9  |   .1590696   .0182839     8.70   0.000     .1232307    .1949085
         10  |   .1637684   .0199486     8.21   0.000     .1246665    .2028703
         11  |   .1723863   .0215898     7.98   0.000     .1300675    .2147051
         12  |   .1742279   .0232437     7.50   0.000     .1286672    .2197886
         13  |   .1840842   .0249795     7.37   0.000     .1351212    .2330472
         14  |   .1930342   .0267314     7.22   0.000     .1406373     .245431
         15  |   .2010548    .028401     7.08   0.000     .1453853    .2567243
         16  |   .2059834   .0301145     6.84   0.000     .1469551    .2650116
         17  |   .2105747   .0317628     6.63   0.000     .1483155    .2728339
         18  |   .2165978   .0336488     6.44   0.000     .1506419    .2825537
         19  |   .2077325   .0355321     5.85   0.000      .138085      .27738
         20  |   .2179388   .0385542     5.65   0.000     .1423677    .2935098
         25  |   .2385143   .0444306     5.37   0.000     .1514246    .3256039
         30  |   .2379453   .0623283     3.82   0.000     .1157739    .3601168
         40  |    .223152   .0696652     3.20   0.001     .0865993    .3597048
         50  |   .1642867   .0734071     2.24   0.025     .0203994    .3081741
             |
       _cons |    .201128   .0151238    13.30   0.000     .1714834    .2307727
-------------+----------------------------------------------------------------
     sigma_u |  .38697015
     sigma_e |  .28646632
         rho |   .6459887   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.0482                         Obs per group: min =         1
       between = 0.0782                                        avg =       9.0
       overall = 0.0630                                        max =        25

                                                F(82,14528)        =     26.13
corr(u_i, Xb)  = 0.1095                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0225909   .0128217     1.76   0.078    -.0025411     .047723
during_dom~c |  -.0075593   .0038604    -1.96   0.050    -.0151261    7.58e-06
after_dome~c |  -.0141942   .0065458    -2.17   0.030    -.0270249   -.0013636
during_expat |    .026778   .0142163     1.88   0.060    -.0010878    .0546439
 after_expat |    .019897   .0214044     0.93   0.353    -.0220583    .0618524
during_dom~y |  -.0021221   .0092041    -0.23   0.818    -.0201633     .015919
after_dome~y |  -.0421168   .0128018    -3.29   0.001    -.0672101   -.0170236
during_exp~y |   .0021643   .0317861     0.07   0.946    -.0601405    .0644691
after_expa~y |  -.0133295   .0384855    -0.35   0.729    -.0887659     .062107
             |
    ind_year |
          2  |  -.0172029   .0103614    -1.66   0.097    -.0375127    .0031068
          3  |  -.0346441   .0125086    -2.77   0.006    -.0591625   -.0101258
          4  |  -.0434069   .0133441    -3.25   0.001    -.0695631   -.0172507
          5  |  -.0350603   .0148102    -2.37   0.018    -.0640903   -.0060304
          6  |  -.0435803   .0159605    -2.73   0.006     -.074865   -.0122957
          7  |  -.0479857   .0172021    -2.79   0.005     -.081704   -.0142674
          8  |  -.0581002   .0183467    -3.17   0.002    -.0940621   -.0221383
          9  |  -.0602676   .0198134    -3.04   0.002    -.0991045   -.0214307
         10  |  -.0596471   .0211577    -2.82   0.005    -.1011189   -.0181752
         11  |  -.0668617   .0226089    -2.96   0.003    -.1111781   -.0225453
         12  |  -.0676266   .0239871    -2.82   0.005    -.1146443   -.0206088
         13  |    -.06225     .02556    -2.44   0.015    -.1123508   -.0121492
         14  |  -.0540174   .0271422    -1.99   0.047    -.1072194   -.0008153
         15  |  -.0438093   .0286668    -1.53   0.126    -.0999999    .0123813
         16  |  -.0307583   .0301718    -1.02   0.308    -.0898989    .0283823
         17  |  -.0159866   .0317691    -0.50   0.615    -.0782582     .046285
         18  |  -.0121131   .0334493    -0.36   0.717     -.077678    .0534518
         19  |  -.0072749   .0350303    -0.21   0.835    -.0759388    .0613889
         20  |  -.0002947   .0365018    -0.01   0.994    -.0718429    .0712536
         21  |  -.0060494    .037931    -0.16   0.873    -.0803989    .0683001
         22  |   .0006709   .0392584     0.02   0.986    -.0762804    .0776223
         23  |  -.0031701   .0406474    -0.08   0.938    -.0828441     .076504
         24  |  -.1118758   .0420649    -2.66   0.008    -.1943283   -.0294233
         25  |  -.1470684   .0436454    -3.37   0.001    -.2326189   -.0615178
         26  |  -.0186295   .0253019    -0.74   0.462    -.0682245    .0309655
         27  |  -.0133878   .0223426    -0.60   0.549    -.0571821    .0304065
         28  |   .0085491   .0216315     0.40   0.693    -.0338514    .0509496
         29  |   .0065037   .0213423     0.30   0.761    -.0353298    .0483373
         30  |   .0260565   .0212966     1.22   0.221    -.0156875    .0678006
         31  |     .01973   .0214954     0.92   0.359    -.0224037    .0618637
         32  |    .026494   .0220377     1.20   0.229    -.0167027    .0696907
         33  |   .0178713   .0226701     0.79   0.431     -.026565    .0623076
         34  |    .018229   .0236108     0.77   0.440    -.0280512    .0645091
         35  |   .0295972   .0245129     1.21   0.227    -.0184512    .0776456
         36  |   .0298198   .0258356     1.15   0.248    -.0208212    .0804609
         37  |   .0209304   .0270276     0.77   0.439    -.0320471    .0739079
         38  |   .0172887   .0281827     0.61   0.540     -.037953    .0725304
         39  |   .0216012   .0296371     0.73   0.466    -.0364912    .0796937
         40  |   .0333274   .0308341     1.08   0.280    -.0271114    .0937661
         41  |    .049507   .0321859     1.54   0.124    -.0135814    .1125955
         42  |   .0571693   .0335743     1.70   0.089    -.0086406    .1229791
         43  |   .0585751    .035176     1.67   0.096    -.0103742    .1275245
         44  |   .0786348   .0367766     2.14   0.033     .0065481    .1507216
         45  |   .0853397   .0382744     2.23   0.026     .0103169    .1603625
         46  |   .0873329   .0399052     2.19   0.029     .0091135    .1655522
         47  |   .0988434   .0411095     2.40   0.016     .0182636    .1794232
         48  |    .089057   .0421633     2.11   0.035     .0064116    .1717025
         49  |  -.1952918   .0437965    -4.46   0.000    -.2811384   -.1094451
         50  |  -.2461093   .0453991    -5.42   0.000    -.3350974   -.1571212
             |
     age_cat |
          1  |   .0468395   .0069157     6.77   0.000     .0332838    .0603952
          2  |   .0661895   .0079231     8.35   0.000     .0506592    .0817198
          3  |   .0838904    .009047     9.27   0.000     .0661572    .1016237
          4  |   .1064808   .0103939    10.24   0.000     .0861074    .1268542
          5  |   .1245935   .0117909    10.57   0.000     .1014818    .1477051
          6  |   .1362537    .013352    10.20   0.000     .1100821    .1624254
          7  |   .1435322   .0149207     9.62   0.000     .1142858    .1727786
          8  |   .1596621   .0165704     9.64   0.000     .1271821    .1921421
          9  |   .1605934   .0181941     8.83   0.000     .1249307    .1962561
         10  |   .1654763   .0198541     8.33   0.000     .1265598    .2043929
         11  |   .1743442   .0214868     8.11   0.000     .1322273    .2164611
         12  |    .176417   .0231356     7.63   0.000     .1310683    .2217656
         13  |   .1864308    .024869     7.50   0.000     .1376844    .2351772
         14  |   .1956188    .026604     7.35   0.000     .1434715    .2477661
         15  |     .20383   .0282644     7.21   0.000     .1484283    .2592318
         16  |   .2089671   .0299683     6.97   0.000     .1502254    .2677088
         17  |   .2137898    .031613     6.76   0.000     .1518244    .2757553
         18  |   .2200175   .0334908     6.57   0.000     .1543713    .2856637
         19  |   .2113725   .0353664     5.98   0.000     .1420497    .2806952
         20  |   .2220324   .0383768     5.79   0.000     .1468089    .2972559
         25  |   .2432322   .0442547     5.50   0.000     .1564873    .3299771
         30  |   .2426981   .0621976     3.90   0.000      .120783    .3646133
         40  |   .2272754   .0695558     3.27   0.001     .0909372    .3636137
         50  |   .1686039   .0733363     2.30   0.022     .0248554    .3123524
             |
       _cons |   .2004282   .0151235    13.25   0.000     .1707842    .2300723
-------------+----------------------------------------------------------------
     sigma_u |    .387134
     sigma_e |  .28645644
         rho |  .64619806   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_early + during_expat_H_early = 0

       F(  1, 14528) =    0.02
            Prob > F =    0.8956

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0481935535194422
key: p_value
value: .8956453036767038

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.0482                                         min =          1
     between = 0.0782                                         avg =        9.0
     overall = 0.0630                                         max =         25

                                                F(82,14528)       =      26.13
corr(u_i, Xb)  = 0.1095                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0225909   .0128217     1.76   0.078    -.0025411     .047723
during_dom~c |  -.0075593   .0038604    -1.96   0.050    -.0151261    7.58e-06
after_dome~c |  -.0141942   .0065458    -2.17   0.030    -.0270249   -.0013636
during_expat |    .026778   .0142163     1.88   0.060    -.0010878    .0546439
 after_expat |    .019897   .0214044     0.93   0.353    -.0220583    .0618524
during_dom~y |  -.0021221   .0092041    -0.23   0.818    -.0201633     .015919
after_dome~y |  -.0421168   .0128018    -3.29   0.001    -.0672101   -.0170236
during_exp~y |   .0021643   .0317861     0.07   0.946    -.0601405    .0644691
after_expa~y |  -.0133295   .0384855    -0.35   0.729    -.0887659     .062107
             |
    ind_year |
          2  |  -.0172029   .0103614    -1.66   0.097    -.0375127    .0031068
          3  |  -.0346441   .0125086    -2.77   0.006    -.0591625   -.0101258
          4  |  -.0434069   .0133441    -3.25   0.001    -.0695631   -.0172507
          5  |  -.0350603   .0148102    -2.37   0.018    -.0640903   -.0060304
          6  |  -.0435803   .0159605    -2.73   0.006     -.074865   -.0122957
          7  |  -.0479857   .0172021    -2.79   0.005     -.081704   -.0142674
          8  |  -.0581002   .0183467    -3.17   0.002    -.0940621   -.0221383
          9  |  -.0602676   .0198134    -3.04   0.002    -.0991045   -.0214307
         10  |  -.0596471   .0211577    -2.82   0.005    -.1011189   -.0181752
         11  |  -.0668617   .0226089    -2.96   0.003    -.1111781   -.0225453
         12  |  -.0676266   .0239871    -2.82   0.005    -.1146443   -.0206088
         13  |    -.06225     .02556    -2.44   0.015    -.1123508   -.0121492
         14  |  -.0540174   .0271422    -1.99   0.047    -.1072194   -.0008153
         15  |  -.0438093   .0286668    -1.53   0.126    -.0999999    .0123813
         16  |  -.0307583   .0301718    -1.02   0.308    -.0898989    .0283823
         17  |  -.0159866   .0317691    -0.50   0.615    -.0782582     .046285
         18  |  -.0121131   .0334493    -0.36   0.717     -.077678    .0534518
         19  |  -.0072749   .0350303    -0.21   0.835    -.0759388    .0613889
         20  |  -.0002947   .0365018    -0.01   0.994    -.0718429    .0712536
         21  |  -.0060494    .037931    -0.16   0.873    -.0803989    .0683001
         22  |   .0006709   .0392584     0.02   0.986    -.0762804    .0776223
         23  |  -.0031701   .0406474    -0.08   0.938    -.0828441     .076504
         24  |  -.1118758   .0420649    -2.66   0.008    -.1943283   -.0294233
         25  |  -.1470684   .0436454    -3.37   0.001    -.2326189   -.0615178
         26  |  -.0186295   .0253019    -0.74   0.462    -.0682245    .0309655
         27  |  -.0133878   .0223426    -0.60   0.549    -.0571821    .0304065
         28  |   .0085491   .0216315     0.40   0.693    -.0338514    .0509496
         29  |   .0065037   .0213423     0.30   0.761    -.0353298    .0483373
         30  |   .0260565   .0212966     1.22   0.221    -.0156875    .0678006
         31  |     .01973   .0214954     0.92   0.359    -.0224037    .0618637
         32  |    .026494   .0220377     1.20   0.229    -.0167027    .0696907
         33  |   .0178713   .0226701     0.79   0.431     -.026565    .0623076
         34  |    .018229   .0236108     0.77   0.440    -.0280512    .0645091
         35  |   .0295972   .0245129     1.21   0.227    -.0184512    .0776456
         36  |   .0298198   .0258356     1.15   0.248    -.0208212    .0804609
         37  |   .0209304   .0270276     0.77   0.439    -.0320471    .0739079
         38  |   .0172887   .0281827     0.61   0.540     -.037953    .0725304
         39  |   .0216012   .0296371     0.73   0.466    -.0364912    .0796937
         40  |   .0333274   .0308341     1.08   0.280    -.0271114    .0937661
         41  |    .049507   .0321859     1.54   0.124    -.0135814    .1125955
         42  |   .0571693   .0335743     1.70   0.089    -.0086406    .1229791
         43  |   .0585751    .035176     1.67   0.096    -.0103742    .1275245
         44  |   .0786348   .0367766     2.14   0.033     .0065481    .1507216
         45  |   .0853397   .0382744     2.23   0.026     .0103169    .1603625
         46  |   .0873329   .0399052     2.19   0.029     .0091135    .1655522
         47  |   .0988434   .0411095     2.40   0.016     .0182636    .1794232
         48  |    .089057   .0421633     2.11   0.035     .0064116    .1717025
         49  |  -.1952918   .0437965    -4.46   0.000    -.2811384   -.1094451
         50  |  -.2461093   .0453991    -5.42   0.000    -.3350974   -.1571212
             |
     age_cat |
          1  |   .0468395   .0069157     6.77   0.000     .0332838    .0603952
          2  |   .0661895   .0079231     8.35   0.000     .0506592    .0817198
          3  |   .0838904    .009047     9.27   0.000     .0661572    .1016237
          4  |   .1064808   .0103939    10.24   0.000     .0861074    .1268542
          5  |   .1245935   .0117909    10.57   0.000     .1014818    .1477051
          6  |   .1362537    .013352    10.20   0.000     .1100821    .1624254
          7  |   .1435322   .0149207     9.62   0.000     .1142858    .1727786
          8  |   .1596621   .0165704     9.64   0.000     .1271821    .1921421
          9  |   .1605934   .0181941     8.83   0.000     .1249307    .1962561
         10  |   .1654763   .0198541     8.33   0.000     .1265598    .2043929
         11  |   .1743442   .0214868     8.11   0.000     .1322273    .2164611
         12  |    .176417   .0231356     7.63   0.000     .1310683    .2217656
         13  |   .1864308    .024869     7.50   0.000     .1376844    .2351772
         14  |   .1956188    .026604     7.35   0.000     .1434715    .2477661
         15  |     .20383   .0282644     7.21   0.000     .1484283    .2592318
         16  |   .2089671   .0299683     6.97   0.000     .1502254    .2677088
         17  |   .2137898    .031613     6.76   0.000     .1518244    .2757553
         18  |   .2200175   .0334908     6.57   0.000     .1543713    .2856637
         19  |   .2113725   .0353664     5.98   0.000     .1420497    .2806952
         20  |   .2220324   .0383768     5.79   0.000     .1468089    .2972559
         25  |   .2432322   .0442547     5.50   0.000     .1564873    .3299771
         30  |   .2426981   .0621976     3.90   0.000      .120783    .3646133
         40  |   .2272754   .0695558     3.27   0.001     .0909372    .3636137
         50  |   .1686039   .0733363     2.30   0.022     .0248554    .3123524
             |
       _cons |   .2004282   .0151235    13.25   0.000     .1707842    .2300723
-------------+----------------------------------------------------------------
     sigma_u |    .387134
     sigma_e |  .28645644
         rho |  .64619806   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.0481                         Obs per group: min =         1
       between = 0.0808                                        avg =       9.0
       overall = 0.0641                                        max =        25

                                                F(82,14528)        =     26.10
corr(u_i, Xb)  = 0.1144                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .022278   .0128297     1.74   0.083    -.0028699     .047426
during_dom~c |  -.0078566   .0047886    -1.64   0.101    -.0172427    .0015296
after_dome~c |    -.02621   .0071662    -3.66   0.000    -.0402567   -.0121633
during_expat |   .0246252   .0143049     1.72   0.085    -.0034143    .0526647
 after_expat |   .0134526   .0185596     0.72   0.469    -.0229267    .0498319
during_dom~m |   .0013882    .006016     0.23   0.818    -.0104038    .0131803
after_dome~m |   .0054609   .0098608     0.55   0.580    -.0138676    .0247894
during_exp~m |   .0091395   .0181893     0.50   0.615     -.026514    .0447929
after_expa~m |   .0051822   .0275787     0.19   0.851    -.0488757      .05924
             |
    ind_year |
          2  |  -.0172729   .0103628    -1.67   0.096    -.0375852    .0030394
          3  |  -.0347814   .0125141    -2.78   0.005    -.0593105   -.0102522
          4  |  -.0436211   .0133616    -3.26   0.001    -.0698116   -.0174306
          5  |  -.0354654   .0148379    -2.39   0.017    -.0645496   -.0063813
          6  |  -.0441756    .015993    -2.76   0.006     -.075524   -.0128273
          7  |  -.0487943   .0172459    -2.83   0.005    -.0825984   -.0149902
          8  |  -.0591831   .0183949    -3.22   0.001    -.0952395   -.0231266
          9  |  -.0616683   .0198715    -3.10   0.002     -.100619   -.0227176
         10  |  -.0613395   .0212108    -2.89   0.004    -.1029153   -.0197637
         11  |  -.0686559   .0226785    -3.03   0.002    -.1131086   -.0242031
         12  |  -.0694299   .0240599    -2.89   0.004    -.1165904   -.0222693
         13  |  -.0640522   .0256461    -2.50   0.013    -.1143218   -.0137826
         14  |  -.0556847   .0272492    -2.04   0.041    -.1090967   -.0022727
         15  |  -.0453201   .0287833    -1.57   0.115    -.1017389    .0110988
         16  |  -.0320852   .0303058    -1.06   0.290    -.0914885     .027318
         17  |  -.0171089   .0319261    -0.54   0.592    -.0796883    .0454704
         18  |  -.0130976   .0336247    -0.39   0.697    -.0790062    .0528111
         19  |  -.0080589   .0352256    -0.23   0.819    -.0771054    .0609877
         20  |  -.0008133   .0367153    -0.02   0.982      -.07278    .0711534
         21  |  -.0063247   .0381606    -0.17   0.868    -.0811243    .0684749
         22  |   .0006455   .0394972     0.02   0.987    -.0767741    .0780651
         23  |  -.0029795   .0409029    -0.07   0.942    -.0831545    .0771954
         24  |  -.1114933   .0423293    -2.63   0.008    -.1944641   -.0285226
         25  |  -.1465234   .0439184    -3.34   0.001     -.232609   -.0604378
         26  |  -.0182325   .0253032    -0.72   0.471      -.06783    .0313649
         27  |  -.0131367   .0223439    -0.59   0.557    -.0569336    .0306603
         28  |    .008612   .0216396     0.40   0.691    -.0338042    .0510283
         29  |   .0064438   .0213535     0.30   0.763    -.0354118    .0482993
         30  |   .0257986   .0213126     1.21   0.226    -.0159767    .0675739
         31  |   .0191966   .0215079     0.89   0.372    -.0229617    .0613548
         32  |   .0257338   .0220535     1.17   0.243    -.0174938    .0689613
         33  |    .016857   .0226733     0.74   0.457    -.0275856    .0612995
         34  |   .0169096   .0236241     0.72   0.474    -.0293966    .0632159
         35  |   .0280289   .0245343     1.14   0.253    -.0200615    .0761193
         36  |   .0282171   .0258642     1.09   0.275    -.0224799    .0789142
         37  |   .0193492   .0270652     0.71   0.475    -.0337021    .0724004
         38  |   .0157037   .0282451     0.56   0.578    -.0396603    .0710678
         39  |   .0200822   .0297188     0.68   0.499    -.0381705    .0783349
         40  |   .0319718   .0309374     1.03   0.301    -.0286694    .0926131
         41  |     .04828   .0323094     1.49   0.135    -.0150506    .1116106
         42  |   .0560829    .033724     1.66   0.096    -.0100204    .1221862
         43  |   .0576245   .0353272     1.63   0.103    -.0116214    .1268704
         44  |   .0778577    .036949     2.11   0.035     .0054329    .1502825
         45  |   .0847593   .0384709     2.20   0.028     .0093514    .1601671
         46  |   .0869718   .0401124     2.17   0.030     .0083464    .1655973
         47  |   .0986634   .0413178     2.39   0.017     .0176753    .1796515
         48  |   .0890246   .0423868     2.10   0.036      .005941    .1721082
         49  |  -.1951689   .0440434    -4.43   0.000    -.2814996   -.1088382
         50  |  -.2458131   .0456514    -5.38   0.000    -.3352956   -.1563306
             |
     age_cat |
          1  |    .046784   .0069252     6.76   0.000     .0332099    .0603582
          2  |   .0660513   .0079539     8.30   0.000     .0504606    .0816419
          3  |   .0836591   .0091048     9.19   0.000     .0658126    .1015056
          4  |   .1061802   .0104791    10.13   0.000     .0856398    .1267206
          5  |   .1241809   .0119109    10.43   0.000      .100834    .1475277
          6  |   .1357355   .0135013    10.05   0.000     .1092712    .1621998
          7  |   .1429169   .0151042     9.46   0.000     .1133107    .1725231
          8  |   .1589707   .0167839     9.47   0.000      .126072    .1918694
          9  |   .1597828    .018447     8.66   0.000     .1236243    .1959413
         10  |   .1645494   .0201331     8.17   0.000     .1250859    .2040128
         11  |   .1739927   .0215788     8.06   0.000     .1316954    .2162899
         12  |   .1759455   .0232364     7.57   0.000     .1303992    .2214919
         13  |   .1859103   .0249753     7.44   0.000     .1369555    .2348651
         14  |   .1949974   .0267087     7.30   0.000      .142645    .2473497
         15  |    .203151   .0283719     7.16   0.000     .1475385    .2587634
         16  |   .2082274   .0300776     6.92   0.000     .1492715    .2671834
         17  |   .2129449   .0317244     6.71   0.000     .1507611    .2751287
         18  |   .2190979   .0336051     6.52   0.000     .1532276    .2849683
         19  |   .2103353   .0354824     5.93   0.000     .1407853    .2798853
         20  |    .220757   .0385032     5.73   0.000     .1452858    .2962283
         25  |    .241552   .0443972     5.44   0.000     .1545277    .3285762
         30  |   .2409571   .0623088     3.87   0.000     .1188239    .3630902
         40  |   .2261612   .0696706     3.25   0.001     .0895979    .3627245
         50  |    .167422   .0734206     2.28   0.023     .0235082    .3113358
             |
       _cons |   .2016106   .0151144    13.34   0.000     .1719844    .2312368
-------------+----------------------------------------------------------------
     sigma_u |  .38692332
     sigma_e |  .28647185
         rho |  .64592452   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_young_firm + during_expat_H_young_firm = 0

       F(  1, 14528) =    0.17
            Prob > F =    0.6759

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0480911843776499
key: p_value
value: .675896885918652

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.0481                                         min =          1
     between = 0.0808                                         avg =        9.0
     overall = 0.0641                                         max =         25

                                                F(82,14528)       =      26.10
corr(u_i, Xb)  = 0.1144                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |    .022278   .0128297     1.74   0.083    -.0028699     .047426
during_dom~c |  -.0078566   .0047886    -1.64   0.101    -.0172427    .0015296
after_dome~c |    -.02621   .0071662    -3.66   0.000    -.0402567   -.0121633
during_expat |   .0246252   .0143049     1.72   0.085    -.0034143    .0526647
 after_expat |   .0134526   .0185596     0.72   0.469    -.0229267    .0498319
during_dom~m |   .0013882    .006016     0.23   0.818    -.0104038    .0131803
after_dome~m |   .0054609   .0098608     0.55   0.580    -.0138676    .0247894
during_exp~m |   .0091395   .0181893     0.50   0.615     -.026514    .0447929
after_expa~m |   .0051822   .0275787     0.19   0.851    -.0488757      .05924
             |
    ind_year |
          2  |  -.0172729   .0103628    -1.67   0.096    -.0375852    .0030394
          3  |  -.0347814   .0125141    -2.78   0.005    -.0593105   -.0102522
          4  |  -.0436211   .0133616    -3.26   0.001    -.0698116   -.0174306
          5  |  -.0354654   .0148379    -2.39   0.017    -.0645496   -.0063813
          6  |  -.0441756    .015993    -2.76   0.006     -.075524   -.0128273
          7  |  -.0487943   .0172459    -2.83   0.005    -.0825984   -.0149902
          8  |  -.0591831   .0183949    -3.22   0.001    -.0952395   -.0231266
          9  |  -.0616683   .0198715    -3.10   0.002     -.100619   -.0227176
         10  |  -.0613395   .0212108    -2.89   0.004    -.1029153   -.0197637
         11  |  -.0686559   .0226785    -3.03   0.002    -.1131086   -.0242031
         12  |  -.0694299   .0240599    -2.89   0.004    -.1165904   -.0222693
         13  |  -.0640522   .0256461    -2.50   0.013    -.1143218   -.0137826
         14  |  -.0556847   .0272492    -2.04   0.041    -.1090967   -.0022727
         15  |  -.0453201   .0287833    -1.57   0.115    -.1017389    .0110988
         16  |  -.0320852   .0303058    -1.06   0.290    -.0914885     .027318
         17  |  -.0171089   .0319261    -0.54   0.592    -.0796883    .0454704
         18  |  -.0130976   .0336247    -0.39   0.697    -.0790062    .0528111
         19  |  -.0080589   .0352256    -0.23   0.819    -.0771054    .0609877
         20  |  -.0008133   .0367153    -0.02   0.982      -.07278    .0711534
         21  |  -.0063247   .0381606    -0.17   0.868    -.0811243    .0684749
         22  |   .0006455   .0394972     0.02   0.987    -.0767741    .0780651
         23  |  -.0029795   .0409029    -0.07   0.942    -.0831545    .0771954
         24  |  -.1114933   .0423293    -2.63   0.008    -.1944641   -.0285226
         25  |  -.1465234   .0439184    -3.34   0.001     -.232609   -.0604378
         26  |  -.0182325   .0253032    -0.72   0.471      -.06783    .0313649
         27  |  -.0131367   .0223439    -0.59   0.557    -.0569336    .0306603
         28  |    .008612   .0216396     0.40   0.691    -.0338042    .0510283
         29  |   .0064438   .0213535     0.30   0.763    -.0354118    .0482993
         30  |   .0257986   .0213126     1.21   0.226    -.0159767    .0675739
         31  |   .0191966   .0215079     0.89   0.372    -.0229617    .0613548
         32  |   .0257338   .0220535     1.17   0.243    -.0174938    .0689613
         33  |    .016857   .0226733     0.74   0.457    -.0275856    .0612995
         34  |   .0169096   .0236241     0.72   0.474    -.0293966    .0632159
         35  |   .0280289   .0245343     1.14   0.253    -.0200615    .0761193
         36  |   .0282171   .0258642     1.09   0.275    -.0224799    .0789142
         37  |   .0193492   .0270652     0.71   0.475    -.0337021    .0724004
         38  |   .0157037   .0282451     0.56   0.578    -.0396603    .0710678
         39  |   .0200822   .0297188     0.68   0.499    -.0381705    .0783349
         40  |   .0319718   .0309374     1.03   0.301    -.0286694    .0926131
         41  |     .04828   .0323094     1.49   0.135    -.0150506    .1116106
         42  |   .0560829    .033724     1.66   0.096    -.0100204    .1221862
         43  |   .0576245   .0353272     1.63   0.103    -.0116214    .1268704
         44  |   .0778577    .036949     2.11   0.035     .0054329    .1502825
         45  |   .0847593   .0384709     2.20   0.028     .0093514    .1601671
         46  |   .0869718   .0401124     2.17   0.030     .0083464    .1655973
         47  |   .0986634   .0413178     2.39   0.017     .0176753    .1796515
         48  |   .0890246   .0423868     2.10   0.036      .005941    .1721082
         49  |  -.1951689   .0440434    -4.43   0.000    -.2814996   -.1088382
         50  |  -.2458131   .0456514    -5.38   0.000    -.3352956   -.1563306
             |
     age_cat |
          1  |    .046784   .0069252     6.76   0.000     .0332099    .0603582
          2  |   .0660513   .0079539     8.30   0.000     .0504606    .0816419
          3  |   .0836591   .0091048     9.19   0.000     .0658126    .1015056
          4  |   .1061802   .0104791    10.13   0.000     .0856398    .1267206
          5  |   .1241809   .0119109    10.43   0.000      .100834    .1475277
          6  |   .1357355   .0135013    10.05   0.000     .1092712    .1621998
          7  |   .1429169   .0151042     9.46   0.000     .1133107    .1725231
          8  |   .1589707   .0167839     9.47   0.000      .126072    .1918694
          9  |   .1597828    .018447     8.66   0.000     .1236243    .1959413
         10  |   .1645494   .0201331     8.17   0.000     .1250859    .2040128
         11  |   .1739927   .0215788     8.06   0.000     .1316954    .2162899
         12  |   .1759455   .0232364     7.57   0.000     .1303992    .2214919
         13  |   .1859103   .0249753     7.44   0.000     .1369555    .2348651
         14  |   .1949974   .0267087     7.30   0.000      .142645    .2473497
         15  |    .203151   .0283719     7.16   0.000     .1475385    .2587634
         16  |   .2082274   .0300776     6.92   0.000     .1492715    .2671834
         17  |   .2129449   .0317244     6.71   0.000     .1507611    .2751287
         18  |   .2190979   .0336051     6.52   0.000     .1532276    .2849683
         19  |   .2103353   .0354824     5.93   0.000     .1407853    .2798853
         20  |    .220757   .0385032     5.73   0.000     .1452858    .2962283
         25  |    .241552   .0443972     5.44   0.000     .1545277    .3285762
         30  |   .2409571   .0623088     3.87   0.000     .1188239    .3630902
         40  |   .2261612   .0696706     3.25   0.001     .0895979    .3627245
         50  |    .167422   .0734206     2.28   0.023     .0235082    .3113358
             |
       _cons |   .2016106   .0151144    13.34   0.000     .1719844    .2312368
-------------+----------------------------------------------------------------
     sigma_u |  .38692332
     sigma_e |  .28647185
         rho |  .64592452   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.2322                         Obs per group: min =         1
       between = 0.1460                                        avg =       9.0
       overall = 0.1274                                        max =        25

                                                F(82,14528)        =    113.24
corr(u_i, Xb)  = 0.0254                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0705948   .0270169     2.61   0.009     .0176382    .1235513
during_dom~c |  -.0081075   .0119929    -0.68   0.499    -.0316152    .0154002
after_dome~c |  -.0412755    .023085    -1.79   0.074     -.086525     .003974
during_expat |    .179202   .0536427     3.34   0.001     .0740555    .2843484
 after_expat |   .1596872   .0685725     2.33   0.020     .0252764     .294098
during_do~nL |   .0843067   .0153158     5.50   0.000     .0542858    .1143276
after_dom~nL |   .1787692   .0284751     6.28   0.000     .1229543    .2345841
during_ex~nL |   .0036445   .0626705     0.06   0.954    -.1191976    .1264866
after_exp~nL |   .1694473    .080755     2.10   0.036     .0111572    .3277375
             |
    ind_year |
          2  |   .0968456   .0213063     4.55   0.000     .0550825    .1386086
          3  |   .2862262   .0259299    11.04   0.000     .2354003    .3370521
          4  |   .4821184    .027534    17.51   0.000     .4281482    .5360885
          5  |   .6451677   .0303139    21.28   0.000     .5857485    .7045868
          6  |   .8305659   .0336111    24.71   0.000     .7646839    .8964479
          7  |   .9576923   .0362295    26.43   0.000     .8866778    1.028707
          8  |   1.026179   .0389722    26.33   0.000     .9497886     1.10257
          9  |   1.147963   .0417801    27.48   0.000     1.066069    1.229858
         10  |   1.261453   .0450985    27.97   0.000     1.173054    1.349852
         11  |   1.326459   .0481921    27.52   0.000     1.231996    1.420921
         12  |   1.353558   .0514252    26.32   0.000     1.252758    1.454358
         13  |   1.398321   .0545112    25.65   0.000     1.291472     1.50517
         14  |   1.437662   .0575858    24.97   0.000     1.324786    1.550537
         15  |   1.508346   .0611299    24.67   0.000     1.388523    1.628168
         16  |   1.544769   .0637581    24.23   0.000     1.419795    1.669743
         17  |   1.599104   .0671702    23.81   0.000     1.467442    1.730766
         18  |    1.52781   .0703718    21.71   0.000     1.389872    1.665747
         19  |   1.552935   .0735155    21.12   0.000     1.408835    1.697035
         20  |   1.598219   .0765858    20.87   0.000     1.448102    1.748337
         21  |    1.61761   .0794506    20.36   0.000     1.461876    1.773343
         22  |   1.670836   .0821663    20.33   0.000      1.50978    1.831893
         23  |   1.721437   .0848072    20.30   0.000     1.555204     1.88767
         24  |   1.752264   .0877949    19.96   0.000     1.580175    1.924353
         25  |   1.744161   .0904152    19.29   0.000     1.566936    1.921386
         26  |  -.2539444   .0475756    -5.34   0.000    -.3471985   -.1606903
         27  |   -.116574   .0450178    -2.59   0.010    -.2048146   -.0283334
         28  |   .0524897   .0432823     1.21   0.225    -.0323491    .1373286
         29  |    .284879   .0431533     6.60   0.000      .200293     .369465
         30  |   .4625585   .0432169    10.70   0.000     .3778479     .547269
         31  |   .6152763   .0443684    13.87   0.000     .5283085     .702244
         32  |   .7646612   .0457119    16.73   0.000     .6750601    .8542624
         33  |    .825235   .0473288    17.44   0.000     .7324646    .9180054
         34  |   .9760856   .0494936    19.72   0.000     .8790718    1.073099
         35  |   1.064464   .0513131    20.74   0.000     .9638838    1.165044
         36  |   1.113901   .0539158    20.66   0.000     1.008219    1.219582
         37  |   1.176677   .0565267    20.82   0.000     1.065877    1.287476
         38  |   1.256045   .0591712    21.23   0.000     1.140062    1.372028
         39  |   1.294282   .0619895    20.88   0.000     1.172775    1.415789
         40  |   1.388814   .0655684    21.18   0.000     1.260292    1.517337
         41  |    1.46277   .0678582    21.56   0.000     1.329759     1.59578
         42  |   1.539661   .0706237    21.80   0.000      1.40123    1.678093
         43  |   1.513561   .0738091    20.51   0.000     1.368886    1.658237
         44  |   1.551129   .0769689    20.15   0.000      1.40026    1.701998
         45  |   1.621097   .0799282    20.28   0.000     1.464428    1.777767
         46  |   1.621244     .08286    19.57   0.000     1.458828     1.78366
         47  |   1.647884   .0851294    19.36   0.000      1.48102    1.814749
         48  |   1.706062   .0875609    19.48   0.000     1.534431    1.877693
         49  |   1.714489   .0908349    18.87   0.000     1.536441    1.892537
         50  |   1.751059   .0934101    18.75   0.000     1.567963    1.934155
             |
     age_cat |
          1  |   .2581828   .0174119    14.83   0.000     .2240532    .2923124
          2  |   .2617693   .0193733    13.51   0.000     .2237952    .2997434
          3  |   .2414114   .0216598    11.15   0.000     .1989554    .2838674
          4  |   .2325597   .0240211     9.68   0.000     .1854754     .279644
          5  |   .2254776   .0266886     8.45   0.000     .1731646    .2777906
          6  |   .2124075   .0296653     7.16   0.000     .1542598    .2705553
          7  |   .2218843   .0327794     6.77   0.000     .1576325    .2861361
          8  |   .2108538   .0359507     5.87   0.000     .1403858    .2813218
          9  |   .2064333   .0391348     5.27   0.000     .1297242    .2831425
         10  |   .1956061   .0424291     4.61   0.000     .1124397    .2787726
         11  |   .1994906   .0458002     4.36   0.000     .1097165    .2892648
         12  |   .1931163   .0491611     3.93   0.000     .0967544    .2894783
         13  |   .1842836   .0524589     3.51   0.000     .0814575    .2871098
         14  |   .1892947   .0558519     3.39   0.001     .0798179    .2987714
         15  |   .1860064   .0592867     3.14   0.002     .0697969    .3022159
         16  |   .1860742   .0626744     2.97   0.003     .0632245    .3089239
         17  |   .1738566   .0662788     2.62   0.009     .0439417    .3037715
         18  |   .1736051   .0697289     2.49   0.013     .0369275    .3102826
         19  |   .1543112   .0735161     2.10   0.036     .0102103    .2984121
         20  |   .1263554    .080375     1.57   0.116    -.0311898    .2839005
         25  |   .0925967   .0916359     1.01   0.312    -.0870213    .2722148
         30  |   .0871128   .1210057     0.72   0.472    -.1500738    .3242994
         40  |   .1150041   .1348902     0.85   0.394    -.1493979    .3794061
         50  |   .0969797   .1476268     0.66   0.511    -.1923876     .386347
             |
       _cons |   7.510187   .0336203   223.38   0.000     7.444287    7.576087
-------------+----------------------------------------------------------------
     sigma_u |  1.1582031
     sigma_e |  .53363524
         rho |  .82488846   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_lnL + during_expat_H_lnL = 0

       F(  1, 14528) =    1.60
            Prob > F =    0.2063

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2322206940691732
key: p_value
value: .2063397691421043

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.2322                                         min =          1
     between = 0.1460                                         avg =        9.0
     overall = 0.1274                                         max =         25

                                                F(82,14528)       =     113.24
corr(u_i, Xb)  = 0.0254                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0705948   .0270169     2.61   0.009     .0176382    .1235513
during_dom~c |  -.0081075   .0119929    -0.68   0.499    -.0316152    .0154002
after_dome~c |  -.0412755    .023085    -1.79   0.074     -.086525     .003974
during_expat |    .179202   .0536427     3.34   0.001     .0740555    .2843484
 after_expat |   .1596872   .0685725     2.33   0.020     .0252764     .294098
during_do~nL |   .0843067   .0153158     5.50   0.000     .0542858    .1143276
after_dom~nL |   .1787692   .0284751     6.28   0.000     .1229543    .2345841
during_ex~nL |   .0036445   .0626705     0.06   0.954    -.1191976    .1264866
after_exp~nL |   .1694473    .080755     2.10   0.036     .0111572    .3277375
             |
    ind_year |
          2  |   .0968456   .0213063     4.55   0.000     .0550825    .1386086
          3  |   .2862262   .0259299    11.04   0.000     .2354003    .3370521
          4  |   .4821184    .027534    17.51   0.000     .4281482    .5360885
          5  |   .6451677   .0303139    21.28   0.000     .5857485    .7045868
          6  |   .8305659   .0336111    24.71   0.000     .7646839    .8964479
          7  |   .9576923   .0362295    26.43   0.000     .8866778    1.028707
          8  |   1.026179   .0389722    26.33   0.000     .9497886     1.10257
          9  |   1.147963   .0417801    27.48   0.000     1.066069    1.229858
         10  |   1.261453   .0450985    27.97   0.000     1.173054    1.349852
         11  |   1.326459   .0481921    27.52   0.000     1.231996    1.420921
         12  |   1.353558   .0514252    26.32   0.000     1.252758    1.454358
         13  |   1.398321   .0545112    25.65   0.000     1.291472     1.50517
         14  |   1.437662   .0575858    24.97   0.000     1.324786    1.550537
         15  |   1.508346   .0611299    24.67   0.000     1.388523    1.628168
         16  |   1.544769   .0637581    24.23   0.000     1.419795    1.669743
         17  |   1.599104   .0671702    23.81   0.000     1.467442    1.730766
         18  |    1.52781   .0703718    21.71   0.000     1.389872    1.665747
         19  |   1.552935   .0735155    21.12   0.000     1.408835    1.697035
         20  |   1.598219   .0765858    20.87   0.000     1.448102    1.748337
         21  |    1.61761   .0794506    20.36   0.000     1.461876    1.773343
         22  |   1.670836   .0821663    20.33   0.000      1.50978    1.831893
         23  |   1.721437   .0848072    20.30   0.000     1.555204     1.88767
         24  |   1.752264   .0877949    19.96   0.000     1.580175    1.924353
         25  |   1.744161   .0904152    19.29   0.000     1.566936    1.921386
         26  |  -.2539444   .0475756    -5.34   0.000    -.3471985   -.1606903
         27  |   -.116574   .0450178    -2.59   0.010    -.2048146   -.0283334
         28  |   .0524897   .0432823     1.21   0.225    -.0323491    .1373286
         29  |    .284879   .0431533     6.60   0.000      .200293     .369465
         30  |   .4625585   .0432169    10.70   0.000     .3778479     .547269
         31  |   .6152763   .0443684    13.87   0.000     .5283085     .702244
         32  |   .7646612   .0457119    16.73   0.000     .6750601    .8542624
         33  |    .825235   .0473288    17.44   0.000     .7324646    .9180054
         34  |   .9760856   .0494936    19.72   0.000     .8790718    1.073099
         35  |   1.064464   .0513131    20.74   0.000     .9638838    1.165044
         36  |   1.113901   .0539158    20.66   0.000     1.008219    1.219582
         37  |   1.176677   .0565267    20.82   0.000     1.065877    1.287476
         38  |   1.256045   .0591712    21.23   0.000     1.140062    1.372028
         39  |   1.294282   .0619895    20.88   0.000     1.172775    1.415789
         40  |   1.388814   .0655684    21.18   0.000     1.260292    1.517337
         41  |    1.46277   .0678582    21.56   0.000     1.329759     1.59578
         42  |   1.539661   .0706237    21.80   0.000      1.40123    1.678093
         43  |   1.513561   .0738091    20.51   0.000     1.368886    1.658237
         44  |   1.551129   .0769689    20.15   0.000      1.40026    1.701998
         45  |   1.621097   .0799282    20.28   0.000     1.464428    1.777767
         46  |   1.621244     .08286    19.57   0.000     1.458828     1.78366
         47  |   1.647884   .0851294    19.36   0.000      1.48102    1.814749
         48  |   1.706062   .0875609    19.48   0.000     1.534431    1.877693
         49  |   1.714489   .0908349    18.87   0.000     1.536441    1.892537
         50  |   1.751059   .0934101    18.75   0.000     1.567963    1.934155
             |
     age_cat |
          1  |   .2581828   .0174119    14.83   0.000     .2240532    .2923124
          2  |   .2617693   .0193733    13.51   0.000     .2237952    .2997434
          3  |   .2414114   .0216598    11.15   0.000     .1989554    .2838674
          4  |   .2325597   .0240211     9.68   0.000     .1854754     .279644
          5  |   .2254776   .0266886     8.45   0.000     .1731646    .2777906
          6  |   .2124075   .0296653     7.16   0.000     .1542598    .2705553
          7  |   .2218843   .0327794     6.77   0.000     .1576325    .2861361
          8  |   .2108538   .0359507     5.87   0.000     .1403858    .2813218
          9  |   .2064333   .0391348     5.27   0.000     .1297242    .2831425
         10  |   .1956061   .0424291     4.61   0.000     .1124397    .2787726
         11  |   .1994906   .0458002     4.36   0.000     .1097165    .2892648
         12  |   .1931163   .0491611     3.93   0.000     .0967544    .2894783
         13  |   .1842836   .0524589     3.51   0.000     .0814575    .2871098
         14  |   .1892947   .0558519     3.39   0.001     .0798179    .2987714
         15  |   .1860064   .0592867     3.14   0.002     .0697969    .3022159
         16  |   .1860742   .0626744     2.97   0.003     .0632245    .3089239
         17  |   .1738566   .0662788     2.62   0.009     .0439417    .3037715
         18  |   .1736051   .0697289     2.49   0.013     .0369275    .3102826
         19  |   .1543112   .0735161     2.10   0.036     .0102103    .2984121
         20  |   .1263554    .080375     1.57   0.116    -.0311898    .2839005
         25  |   .0925967   .0916359     1.01   0.312    -.0870213    .2722148
         30  |   .0871128   .1210057     0.72   0.472    -.1500738    .3242994
         40  |   .1150041   .1348902     0.85   0.394    -.1493979    .3794061
         50  |   .0969797   .1476268     0.66   0.511    -.1923876     .386347
             |
       _cons |   7.510187   .0336203   223.38   0.000     7.444287    7.576087
-------------+----------------------------------------------------------------
     sigma_u |  1.1582031
     sigma_e |  .53363524
         rho |  .82488846   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.2317                         Obs per group: min =         1
       between = 0.1416                                        avg =       9.0
       overall = 0.1244                                        max =        25

                                                F(82,14528)        =    109.91
corr(u_i, Xb)  = 0.0162                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0719992    .027086     2.66   0.008     .0189072    .1250912
during_dom~c |   .0581989   .0119706     4.86   0.000     .0347351    .0816628
after_dome~c |   .1135143   .0216391     5.25   0.000      .071099    .1559296
during_expat |   .1826658   .0513175     3.56   0.000      .082077    .2832546
 after_expat |   .2777127    .063758     4.36   0.000     .1527389    .4026865
during_do~KL |  -.0414283   .0154288    -2.69   0.007    -.0716706    -.011186
after_dom~KL |  -.0823989   .0276175    -2.98   0.003    -.1365326   -.0282651
during_ex~KL |  -.0035489   .0603113    -0.06   0.953    -.1217667    .1146688
after_exp~KL |  -.0040988   .0770864    -0.05   0.958     -.155198    .1470005
             |
    ind_year |
          2  |   .0995964   .0212965     4.68   0.000     .0578526    .1413402
          3  |   .2916131   .0259166    11.25   0.000     .2408132     .342413
          4  |   .4903861   .0275138    17.82   0.000     .4364555    .5443167
          5  |   .6562891   .0302811    21.67   0.000     .5969344    .7156439
          6  |   .8441536    .033569    25.15   0.000      .778354    .9099531
          7  |   .9738949   .0361791    26.92   0.000     .9029793     1.04481
          8  |   1.044743   .0389011    26.86   0.000     .9684917    1.120994
          9  |   1.168721   .0416959    28.03   0.000     1.086991     1.25045
         10  |   1.284468   .0449814    28.56   0.000     1.196299    1.372637
         11  |   1.352037   .0480506    28.14   0.000     1.257852    1.446223
         12  |   1.381621   .0512564    26.96   0.000     1.281152     1.48209
         13  |   1.428658   .0543289    26.30   0.000     1.322166     1.53515
         14  |    1.47027   .0573934    25.62   0.000     1.357771    1.582768
         15  |   1.543696   .0609099    25.34   0.000     1.424305    1.663087
         16  |   1.582379   .0635557    24.90   0.000     1.457802    1.706956
         17  |   1.639833    .066965    24.49   0.000     1.508573    1.771093
         18  |    1.57125   .0701629    22.39   0.000     1.433722    1.708778
         19  |   1.599096   .0733022    21.82   0.000     1.455415    1.742778
         20  |   1.646837   .0763572    21.57   0.000     1.497168    1.796507
         21  |   1.668481   .0792267    21.06   0.000     1.513186    1.823775
         22  |   1.723998   .0819243    21.04   0.000     1.563416     1.88458
         23  |   1.776486   .0845946    21.00   0.000      1.61067    1.942302
         24  |   1.809796   .0876122    20.66   0.000     1.638065    1.981527
         25  |   1.803982    .090235    19.99   0.000      1.62711    1.980854
         26  |  -.2554102   .0476308    -5.36   0.000    -.3487726   -.1620477
         27  |  -.1150824   .0450554    -2.55   0.011    -.2033967   -.0267681
         28  |   .0565565   .0433143     1.31   0.192     -.028345    .1414581
         29  |   .2921688   .0431664     6.77   0.000     .2075572    .3767804
         30  |   .4724839   .0432043    10.94   0.000     .3877979    .5571698
         31  |   .6280071   .0443399    14.16   0.000     .5410952     .714919
         32  |    .779955   .0456634    17.08   0.000      .690449     .869461
         33  |   .8427714   .0472501    17.84   0.000     .7501552    .9353877
         34  |   .9958791   .0493948    20.16   0.000     .8990589    1.092699
         35  |   1.086393   .0511963    21.22   0.000     .9860422    1.186745
         36  |   1.138427    .053776    21.17   0.000     1.033019    1.243835
         37  |   1.204061   .0563632    21.36   0.000     1.093582     1.31454
         38  |   1.286108   .0589848    21.80   0.000      1.17049    1.401725
         39  |   1.327096    .061788    21.48   0.000     1.205983    1.448208
         40  |   1.424043   .0653807    21.78   0.000     1.295888    1.552197
         41  |   1.500243   .0676369    22.18   0.000     1.367666    1.632819
         42  |   1.579174   .0703897    22.43   0.000     1.441201    1.717147
         43  |   1.555404   .0735632    21.14   0.000     1.411211    1.699597
         44  |   1.595382   .0767266    20.79   0.000     1.444988    1.745776
         45  |   1.667603    .079667    20.93   0.000     1.511445     1.82376
         46  |   1.669698   .0826136    20.21   0.000     1.507765    1.831632
         47  |   1.697964    .084898    20.00   0.000     1.531554    1.864375
         48  |   1.758348   .0873401    20.13   0.000     1.587151    1.929546
         49  |   1.768656   .0905844    19.52   0.000     1.591099    1.946213
         50  |   1.807648   .0931604    19.40   0.000     1.625042    1.990255
             |
     age_cat |
          1  |   .2544033   .0174066    14.62   0.000     .2202842    .2885223
          2  |   .2547272   .0193538    13.16   0.000     .2167913     .292663
          3  |    .231121   .0216373    10.68   0.000     .1887091    .2735328
          4  |   .2193163   .0239967     9.14   0.000     .1722798    .2663529
          5  |   .2094483   .0266574     7.86   0.000     .1571965    .2617001
          6  |   .1934631   .0296368     6.53   0.000     .1353712     .251555
          7  |   .2003729   .0327302     6.12   0.000     .1362175    .2645283
          8  |   .1867449   .0358923     5.20   0.000     .1163915    .2570982
          9  |   .1795719   .0390763     4.60   0.000     .1029774    .2561663
         10  |   .1662273   .0423319     3.93   0.000     .0832515    .2492032
         11  |   .1675361   .0456934     3.67   0.000     .0779713    .2571009
         12  |   .1586033   .0490474     3.23   0.001     .0624641    .2547424
         13  |   .1474729   .0523493     2.82   0.005     .0448615    .2500842
         14  |   .1498238   .0557311     2.69   0.007     .0405838    .2590638
         15  |   .1443869   .0591511     2.44   0.015     .0284432    .2603306
         16  |   .1421505   .0625151     2.27   0.023     .0196129    .2646881
         17  |   .1273636   .0661138     1.93   0.054    -.0022279    .2569551
         18  |   .1247279   .0696076     1.79   0.073    -.0117118    .2611675
         19  |   .1032772     .07339     1.41   0.159    -.0405765    .2471308
         20  |   .0700704   .0802547     0.87   0.383    -.0872391      .22738
         25  |   .0299299    .091519     0.33   0.744    -.1494591    .2093188
         30  |   .0264718   .1211007     0.22   0.827     -.210901    .2638446
         40  |   .0587002   .1349344     0.44   0.664    -.2057885    .3231888
         50  |   .0423659   .1475754     0.29   0.774    -.2469007    .3316324
             |
       _cons |   7.508767   .0336156   223.37   0.000     7.442876    7.574657
-------------+----------------------------------------------------------------
     sigma_u |   1.160466
     sigma_e |  .53381212
         rho |  .82535612   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_lnKL + during_expat_H_lnKL = 0

       F(  1, 14528) =    0.38
            Prob > F =    0.5379

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2317116234080827
key: p_value
value: .5378708422705553

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.2317                                         min =          1
     between = 0.1416                                         avg =        9.0
     overall = 0.1244                                         max =         25

                                                F(82,14528)       =     109.91
corr(u_i, Xb)  = 0.0162                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0719992    .027086     2.66   0.008     .0189072    .1250912
during_dom~c |   .0581989   .0119706     4.86   0.000     .0347351    .0816628
after_dome~c |   .1135143   .0216391     5.25   0.000      .071099    .1559296
during_expat |   .1826658   .0513175     3.56   0.000      .082077    .2832546
 after_expat |   .2777127    .063758     4.36   0.000     .1527389    .4026865
during_do~KL |  -.0414283   .0154288    -2.69   0.007    -.0716706    -.011186
after_dom~KL |  -.0823989   .0276175    -2.98   0.003    -.1365326   -.0282651
during_ex~KL |  -.0035489   .0603113    -0.06   0.953    -.1217667    .1146688
after_exp~KL |  -.0040988   .0770864    -0.05   0.958     -.155198    .1470005
             |
    ind_year |
          2  |   .0995964   .0212965     4.68   0.000     .0578526    .1413402
          3  |   .2916131   .0259166    11.25   0.000     .2408132     .342413
          4  |   .4903861   .0275138    17.82   0.000     .4364555    .5443167
          5  |   .6562891   .0302811    21.67   0.000     .5969344    .7156439
          6  |   .8441536    .033569    25.15   0.000      .778354    .9099531
          7  |   .9738949   .0361791    26.92   0.000     .9029793     1.04481
          8  |   1.044743   .0389011    26.86   0.000     .9684917    1.120994
          9  |   1.168721   .0416959    28.03   0.000     1.086991     1.25045
         10  |   1.284468   .0449814    28.56   0.000     1.196299    1.372637
         11  |   1.352037   .0480506    28.14   0.000     1.257852    1.446223
         12  |   1.381621   .0512564    26.96   0.000     1.281152     1.48209
         13  |   1.428658   .0543289    26.30   0.000     1.322166     1.53515
         14  |    1.47027   .0573934    25.62   0.000     1.357771    1.582768
         15  |   1.543696   .0609099    25.34   0.000     1.424305    1.663087
         16  |   1.582379   .0635557    24.90   0.000     1.457802    1.706956
         17  |   1.639833    .066965    24.49   0.000     1.508573    1.771093
         18  |    1.57125   .0701629    22.39   0.000     1.433722    1.708778
         19  |   1.599096   .0733022    21.82   0.000     1.455415    1.742778
         20  |   1.646837   .0763572    21.57   0.000     1.497168    1.796507
         21  |   1.668481   .0792267    21.06   0.000     1.513186    1.823775
         22  |   1.723998   .0819243    21.04   0.000     1.563416     1.88458
         23  |   1.776486   .0845946    21.00   0.000      1.61067    1.942302
         24  |   1.809796   .0876122    20.66   0.000     1.638065    1.981527
         25  |   1.803982    .090235    19.99   0.000      1.62711    1.980854
         26  |  -.2554102   .0476308    -5.36   0.000    -.3487726   -.1620477
         27  |  -.1150824   .0450554    -2.55   0.011    -.2033967   -.0267681
         28  |   .0565565   .0433143     1.31   0.192     -.028345    .1414581
         29  |   .2921688   .0431664     6.77   0.000     .2075572    .3767804
         30  |   .4724839   .0432043    10.94   0.000     .3877979    .5571698
         31  |   .6280071   .0443399    14.16   0.000     .5410952     .714919
         32  |    .779955   .0456634    17.08   0.000      .690449     .869461
         33  |   .8427714   .0472501    17.84   0.000     .7501552    .9353877
         34  |   .9958791   .0493948    20.16   0.000     .8990589    1.092699
         35  |   1.086393   .0511963    21.22   0.000     .9860422    1.186745
         36  |   1.138427    .053776    21.17   0.000     1.033019    1.243835
         37  |   1.204061   .0563632    21.36   0.000     1.093582     1.31454
         38  |   1.286108   .0589848    21.80   0.000      1.17049    1.401725
         39  |   1.327096    .061788    21.48   0.000     1.205983    1.448208
         40  |   1.424043   .0653807    21.78   0.000     1.295888    1.552197
         41  |   1.500243   .0676369    22.18   0.000     1.367666    1.632819
         42  |   1.579174   .0703897    22.43   0.000     1.441201    1.717147
         43  |   1.555404   .0735632    21.14   0.000     1.411211    1.699597
         44  |   1.595382   .0767266    20.79   0.000     1.444988    1.745776
         45  |   1.667603    .079667    20.93   0.000     1.511445     1.82376
         46  |   1.669698   .0826136    20.21   0.000     1.507765    1.831632
         47  |   1.697964    .084898    20.00   0.000     1.531554    1.864375
         48  |   1.758348   .0873401    20.13   0.000     1.587151    1.929546
         49  |   1.768656   .0905844    19.52   0.000     1.591099    1.946213
         50  |   1.807648   .0931604    19.40   0.000     1.625042    1.990255
             |
     age_cat |
          1  |   .2544033   .0174066    14.62   0.000     .2202842    .2885223
          2  |   .2547272   .0193538    13.16   0.000     .2167913     .292663
          3  |    .231121   .0216373    10.68   0.000     .1887091    .2735328
          4  |   .2193163   .0239967     9.14   0.000     .1722798    .2663529
          5  |   .2094483   .0266574     7.86   0.000     .1571965    .2617001
          6  |   .1934631   .0296368     6.53   0.000     .1353712     .251555
          7  |   .2003729   .0327302     6.12   0.000     .1362175    .2645283
          8  |   .1867449   .0358923     5.20   0.000     .1163915    .2570982
          9  |   .1795719   .0390763     4.60   0.000     .1029774    .2561663
         10  |   .1662273   .0423319     3.93   0.000     .0832515    .2492032
         11  |   .1675361   .0456934     3.67   0.000     .0779713    .2571009
         12  |   .1586033   .0490474     3.23   0.001     .0624641    .2547424
         13  |   .1474729   .0523493     2.82   0.005     .0448615    .2500842
         14  |   .1498238   .0557311     2.69   0.007     .0405838    .2590638
         15  |   .1443869   .0591511     2.44   0.015     .0284432    .2603306
         16  |   .1421505   .0625151     2.27   0.023     .0196129    .2646881
         17  |   .1273636   .0661138     1.93   0.054    -.0022279    .2569551
         18  |   .1247279   .0696076     1.79   0.073    -.0117118    .2611675
         19  |   .1032772     .07339     1.41   0.159    -.0405765    .2471308
         20  |   .0700704   .0802547     0.87   0.383    -.0872391      .22738
         25  |   .0299299    .091519     0.33   0.744    -.1494591    .2093188
         30  |   .0264718   .1211007     0.22   0.827     -.210901    .2638446
         40  |   .0587002   .1349344     0.44   0.664    -.2057885    .3231888
         50  |   .0423659   .1475754     0.29   0.774    -.2469007    .3316324
             |
       _cons |   7.508767   .0336156   223.37   0.000     7.442876    7.574657
-------------+----------------------------------------------------------------
     sigma_u |   1.160466
     sigma_e |  .53381212
         rho |  .82535612   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.2330                         Obs per group: min =         1
       between = 0.1305                                        avg =       9.0
       overall = 0.1136                                        max =        25

                                                F(82,14528)        =    111.94
corr(u_i, Xb)  = -0.0036                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0706053   .0270086     2.61   0.009     .0176649    .1235457
during_dom~c |   .1213329   .0122812     9.88   0.000     .0972601    .1454057
after_dome~c |   .2024644   .0220031     9.20   0.000     .1593356    .2455932
during_expat |   .2892141   .0458719     6.30   0.000     .1992992    .3791289
 after_expat |   .4105641   .0584322     7.03   0.000     .2960296    .5250987
during_do~QL |  -.1482721   .0155346    -9.54   0.000    -.1787219   -.1178222
after_dom~QL |  -.2319941   .0275871    -8.41   0.000    -.2860683   -.1779199
during_ex~QL |  -.1903815   .0570934    -3.33   0.001    -.3022918   -.0784711
after_exp~QL |  -.2410496   .0740177    -3.26   0.001    -.3861336   -.0959655
             |
    ind_year |
          2  |   .0987422   .0212994     4.64   0.000     .0569926    .1404917
          3  |   .2904391   .0259283    11.20   0.000     .2396163    .3412618
          4  |   .4889801   .0275367    17.76   0.000     .4350047    .5429556
          5  |   .6551714   .0302959    21.63   0.000     .5957876    .7145552
          6  |   .8428282   .0335915    25.09   0.000     .7769845    .9086719
          7  |   .9728764   .0362034    26.87   0.000     .9019133     1.04384
          8  |   1.044095   .0389257    26.82   0.000     .9677954    1.120394
          9  |   1.167456   .0417312    27.98   0.000     1.085657    1.249254
         10  |   1.283375   .0450239    28.50   0.000     1.195122    1.371627
         11  |   1.351175   .0480994    28.09   0.000     1.256894    1.445456
         12  |   1.381155   .0513106    26.92   0.000      1.28058     1.48173
         13  |    1.42824   .0543921    26.26   0.000     1.321624    1.534855
         14  |   1.470445   .0574584    25.59   0.000     1.357819    1.583071
         15  |   1.544626   .0609753    25.33   0.000     1.425107    1.664146
         16  |   1.583919   .0636281    24.89   0.000     1.459199    1.708638
         17  |   1.642401   .0670396    24.50   0.000     1.510995    1.773807
         18  |   1.574912   .0702314    22.42   0.000     1.437249    1.712574
         19  |   1.603703   .0733779    21.86   0.000     1.459873    1.747533
         20  |   1.652381   .0764434    21.62   0.000     1.502542     1.80222
         21  |   1.675075   .0793187    21.12   0.000       1.5196     1.83055
         22  |   1.731314   .0820182    21.11   0.000     1.570548    1.892081
         23  |   1.784863   .0846864    21.08   0.000     1.618867     1.95086
         24  |   1.819566   .0877098    20.75   0.000     1.647643    1.991488
         25  |   1.815176   .0903359    20.09   0.000     1.638106    1.992245
         26  |  -.2532226   .0476003    -5.32   0.000    -.3465253   -.1599199
         27  |  -.1139842    .045012    -2.53   0.011    -.2022135   -.0257549
         28  |   .0571899   .0432662     1.32   0.186    -.0276173    .1419972
         29  |   .2932278   .0431208     6.80   0.000     .2087055    .3777501
         30  |   .4731305   .0431567    10.96   0.000     .3885378    .5577231
         31  |   .6283387   .0443015    14.18   0.000     .5415021    .7151753
         32  |   .7796265   .0456369    17.08   0.000     .6901723    .8690808
         33  |   .8420361   .0472367    17.83   0.000     .7494461     .934626
         34  |   .9948374    .049384    20.14   0.000     .8980385    1.091636
         35  |   1.084805   .0512034    21.19   0.000     .9844401     1.18517
         36  |   1.137049   .0537936    21.14   0.000     1.031607    1.242492
         37  |   1.203395   .0563843    21.34   0.000     1.092875    1.313916
         38  |   1.285987   .0590005    21.80   0.000     1.170338    1.401635
         39  |   1.327549   .0618124    21.48   0.000     1.206388    1.448709
         40  |   1.424996   .0654054    21.79   0.000     1.296793    1.553199
         41  |   1.502138    .067665    22.20   0.000     1.369506     1.63477
         42  |   1.581867    .070422    22.46   0.000     1.443831    1.719903
         43  |    1.55897   .0736101    21.18   0.000     1.414685    1.703255
         44  |   1.599869   .0767813    20.84   0.000     1.449368     1.75037
         45  |   1.673148   .0797274    20.99   0.000     1.516872    1.829424
         46  |   1.676203   .0826625    20.28   0.000     1.514173    1.838232
         47  |   1.705031   .0849546    20.07   0.000     1.538509    1.871553
         48  |   1.766365   .0874022    20.21   0.000     1.595046    1.937685
         49  |   1.777982   .0906588    19.61   0.000     1.600279    1.955685
         50  |   1.818437   .0932305    19.50   0.000     1.635693     2.00118
             |
     age_cat |
          1  |   .2523447   .0173591    14.54   0.000     .2183186    .2863708
          2  |   .2519736   .0193021    13.05   0.000     .2141389    .2898083
          3  |   .2277417   .0215844    10.55   0.000     .1854335    .2700499
          4  |   .2154264    .023941     9.00   0.000     .1684989    .2623539
          5  |   .2050939    .026607     7.71   0.000     .1529409     .257247
          6  |   .1886425   .0295901     6.38   0.000      .130642    .2466429
          7  |   .1950658   .0326867     5.97   0.000     .1309958    .2591359
          8  |   .1811367   .0358645     5.05   0.000     .1108378    .2514356
          9  |   .1736142   .0390607     4.44   0.000     .0970502    .2501782
         10  |   .1599613   .0423253     3.78   0.000     .0769983    .2429242
         11  |   .1606947   .0456943     3.52   0.000      .071128    .2502614
         12  |   .1512338   .0490557     3.08   0.002     .0550784    .2473893
         13  |   .1395992   .0523695     2.67   0.008     .0369484      .24225
         14  |   .1414397   .0557679     2.54   0.011     .0321276    .2507518
         15  |   .1350873    .059202     2.28   0.023     .0190438    .2511308
         16  |   .1320981   .0625697     2.11   0.035     .0094535    .2547427
         17  |   .1165816    .066183     1.76   0.078    -.0131455    .2463086
         18  |   .1133859   .0696759     1.63   0.104    -.0231878    .2499595
         19  |   .0912768   .0734686     1.24   0.214    -.0527311    .2352846
         20  |   .0561531   .0803573     0.70   0.485    -.1013573    .2136636
         25  |   .0139211   .0916916     0.15   0.879    -.1658062    .1936483
         30  |   .0134665   .1212579     0.11   0.912    -.2242143    .2511474
         40  |   .0485994   .1351633     0.36   0.719    -.2163379    .3135368
         50  |    .031878    .147867     0.22   0.829    -.2579602    .3217161
             |
       _cons |   7.516388   .0336554   223.33   0.000     7.450419    7.582357
-------------+----------------------------------------------------------------
     sigma_u |  1.1673919
     sigma_e |    .533369
         rho |  .82730233   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_lnQL + during_expat_H_lnQL = 0

       F(  1, 14528) =    0.52
            Prob > F =    0.4713

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2329866268355768
key: p_value
value: .4713491037158622

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.2330                                         min =          1
     between = 0.1305                                         avg =        9.0
     overall = 0.1136                                         max =         25

                                                F(82,14528)       =     111.94
corr(u_i, Xb)  = -0.0036                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0706053   .0270086     2.61   0.009     .0176649    .1235457
during_dom~c |   .1213329   .0122812     9.88   0.000     .0972601    .1454057
after_dome~c |   .2024644   .0220031     9.20   0.000     .1593356    .2455932
during_expat |   .2892141   .0458719     6.30   0.000     .1992992    .3791289
 after_expat |   .4105641   .0584322     7.03   0.000     .2960296    .5250987
during_do~QL |  -.1482721   .0155346    -9.54   0.000    -.1787219   -.1178222
after_dom~QL |  -.2319941   .0275871    -8.41   0.000    -.2860683   -.1779199
during_ex~QL |  -.1903815   .0570934    -3.33   0.001    -.3022918   -.0784711
after_exp~QL |  -.2410496   .0740177    -3.26   0.001    -.3861336   -.0959655
             |
    ind_year |
          2  |   .0987422   .0212994     4.64   0.000     .0569926    .1404917
          3  |   .2904391   .0259283    11.20   0.000     .2396163    .3412618
          4  |   .4889801   .0275367    17.76   0.000     .4350047    .5429556
          5  |   .6551714   .0302959    21.63   0.000     .5957876    .7145552
          6  |   .8428282   .0335915    25.09   0.000     .7769845    .9086719
          7  |   .9728764   .0362034    26.87   0.000     .9019133     1.04384
          8  |   1.044095   .0389257    26.82   0.000     .9677954    1.120394
          9  |   1.167456   .0417312    27.98   0.000     1.085657    1.249254
         10  |   1.283375   .0450239    28.50   0.000     1.195122    1.371627
         11  |   1.351175   .0480994    28.09   0.000     1.256894    1.445456
         12  |   1.381155   .0513106    26.92   0.000      1.28058     1.48173
         13  |    1.42824   .0543921    26.26   0.000     1.321624    1.534855
         14  |   1.470445   .0574584    25.59   0.000     1.357819    1.583071
         15  |   1.544626   .0609753    25.33   0.000     1.425107    1.664146
         16  |   1.583919   .0636281    24.89   0.000     1.459199    1.708638
         17  |   1.642401   .0670396    24.50   0.000     1.510995    1.773807
         18  |   1.574912   .0702314    22.42   0.000     1.437249    1.712574
         19  |   1.603703   .0733779    21.86   0.000     1.459873    1.747533
         20  |   1.652381   .0764434    21.62   0.000     1.502542     1.80222
         21  |   1.675075   .0793187    21.12   0.000       1.5196     1.83055
         22  |   1.731314   .0820182    21.11   0.000     1.570548    1.892081
         23  |   1.784863   .0846864    21.08   0.000     1.618867     1.95086
         24  |   1.819566   .0877098    20.75   0.000     1.647643    1.991488
         25  |   1.815176   .0903359    20.09   0.000     1.638106    1.992245
         26  |  -.2532226   .0476003    -5.32   0.000    -.3465253   -.1599199
         27  |  -.1139842    .045012    -2.53   0.011    -.2022135   -.0257549
         28  |   .0571899   .0432662     1.32   0.186    -.0276173    .1419972
         29  |   .2932278   .0431208     6.80   0.000     .2087055    .3777501
         30  |   .4731305   .0431567    10.96   0.000     .3885378    .5577231
         31  |   .6283387   .0443015    14.18   0.000     .5415021    .7151753
         32  |   .7796265   .0456369    17.08   0.000     .6901723    .8690808
         33  |   .8420361   .0472367    17.83   0.000     .7494461     .934626
         34  |   .9948374    .049384    20.14   0.000     .8980385    1.091636
         35  |   1.084805   .0512034    21.19   0.000     .9844401     1.18517
         36  |   1.137049   .0537936    21.14   0.000     1.031607    1.242492
         37  |   1.203395   .0563843    21.34   0.000     1.092875    1.313916
         38  |   1.285987   .0590005    21.80   0.000     1.170338    1.401635
         39  |   1.327549   .0618124    21.48   0.000     1.206388    1.448709
         40  |   1.424996   .0654054    21.79   0.000     1.296793    1.553199
         41  |   1.502138    .067665    22.20   0.000     1.369506     1.63477
         42  |   1.581867    .070422    22.46   0.000     1.443831    1.719903
         43  |    1.55897   .0736101    21.18   0.000     1.414685    1.703255
         44  |   1.599869   .0767813    20.84   0.000     1.449368     1.75037
         45  |   1.673148   .0797274    20.99   0.000     1.516872    1.829424
         46  |   1.676203   .0826625    20.28   0.000     1.514173    1.838232
         47  |   1.705031   .0849546    20.07   0.000     1.538509    1.871553
         48  |   1.766365   .0874022    20.21   0.000     1.595046    1.937685
         49  |   1.777982   .0906588    19.61   0.000     1.600279    1.955685
         50  |   1.818437   .0932305    19.50   0.000     1.635693     2.00118
             |
     age_cat |
          1  |   .2523447   .0173591    14.54   0.000     .2183186    .2863708
          2  |   .2519736   .0193021    13.05   0.000     .2141389    .2898083
          3  |   .2277417   .0215844    10.55   0.000     .1854335    .2700499
          4  |   .2154264    .023941     9.00   0.000     .1684989    .2623539
          5  |   .2050939    .026607     7.71   0.000     .1529409     .257247
          6  |   .1886425   .0295901     6.38   0.000      .130642    .2466429
          7  |   .1950658   .0326867     5.97   0.000     .1309958    .2591359
          8  |   .1811367   .0358645     5.05   0.000     .1108378    .2514356
          9  |   .1736142   .0390607     4.44   0.000     .0970502    .2501782
         10  |   .1599613   .0423253     3.78   0.000     .0769983    .2429242
         11  |   .1606947   .0456943     3.52   0.000      .071128    .2502614
         12  |   .1512338   .0490557     3.08   0.002     .0550784    .2473893
         13  |   .1395992   .0523695     2.67   0.008     .0369484      .24225
         14  |   .1414397   .0557679     2.54   0.011     .0321276    .2507518
         15  |   .1350873    .059202     2.28   0.023     .0190438    .2511308
         16  |   .1320981   .0625697     2.11   0.035     .0094535    .2547427
         17  |   .1165816    .066183     1.76   0.078    -.0131455    .2463086
         18  |   .1133859   .0696759     1.63   0.104    -.0231878    .2499595
         19  |   .0912768   .0734686     1.24   0.214    -.0527311    .2352846
         20  |   .0561531   .0803573     0.70   0.485    -.1013573    .2136636
         25  |   .0139211   .0916916     0.15   0.879    -.1658062    .1936483
         30  |   .0134665   .1212579     0.11   0.912    -.2242143    .2511474
         40  |   .0485994   .1351633     0.36   0.719    -.2163379    .3135368
         50  |    .031878    .147867     0.22   0.829    -.2579602    .3217161
             |
       _cons |   7.516388   .0336554   223.33   0.000     7.450419    7.582357
-------------+----------------------------------------------------------------
     sigma_u |  1.1673919
     sigma_e |    .533369
         rho |  .82730233   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.2316                         Obs per group: min =         1
       between = 0.1433                                        avg =       9.0
       overall = 0.1258                                        max =        25

                                                F(82,14528)        =    110.22
corr(u_i, Xb)  = 0.0186                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0722569   .0270868     2.67   0.008     .0191634    .1253504
during_dom~c |   .0478607   .0102245     4.68   0.000     .0278193    .0679021
after_dome~c |   .0539825   .0196901     2.74   0.006     .0153873    .0925777
during_expat |   .2102021   .0566583     3.71   0.000     .0991447    .3212595
 after_expat |   .2396249   .0731355     3.28   0.001     .0962701    .3829798
during_dom~r |  -.0284253   .0150366    -1.89   0.059     -.057899    .0010484
after_dome~r |   .0165836    .027301     0.61   0.544    -.0369297     .070097
during_exp~r |    -.04302   .0647744    -0.66   0.507     -.169986    .0839461
after_expa~r |   .0492013   .0842153     0.58   0.559    -.1158715     .214274
             |
    ind_year |
          2  |    .099633    .021299     4.68   0.000     .0578842    .1413818
          3  |   .2916427   .0259148    11.25   0.000     .2408465    .3424389
          4  |   .4904075   .0275221    17.82   0.000     .4364608    .5443542
          5  |   .6559662   .0302986    21.65   0.000      .596577    .7153554
          6  |   .8438645   .0335975    25.12   0.000     .7780091    .9097199
          7  |   .9734738   .0362214    26.88   0.000     .9024752    1.044472
          8  |   1.044143     .03896    26.80   0.000     .9677761    1.120509
          9  |   1.168093   .0417842    27.96   0.000     1.086191    1.249996
         10  |   1.283711   .0450785    28.48   0.000     1.195352    1.372071
         11  |   1.351031   .0481653    28.05   0.000     1.256621    1.445441
         12  |   1.380268   .0513964    26.86   0.000     1.279525    1.481012
         13  |   1.426975   .0544924    26.19   0.000     1.320163    1.533787
         14  |   1.468141   .0575838    25.50   0.000      1.35527    1.581013
         15  |   1.540937   .0611093    25.22   0.000     1.421155    1.660719
         16  |   1.579118   .0637592    24.77   0.000     1.454142    1.704094
         17  |   1.635758   .0671757    24.35   0.000     1.504085     1.76743
         18  |   1.566457   .0703812    22.26   0.000     1.428501    1.704413
         19  |   1.593611    .073528    21.67   0.000     1.449487    1.737736
         20  |    1.64078   .0766033    21.42   0.000     1.490628    1.790933
         21  |   1.661979   .0794629    20.92   0.000     1.506222    1.817737
         22  |   1.717015   .0821588    20.90   0.000     1.555973    1.878057
         23  |   1.769033   .0848319    20.85   0.000     1.602752    1.935315
         24  |   1.801696   .0878376    20.51   0.000     1.629523    1.973869
         25  |    1.79534   .0904677    19.85   0.000     1.618012    1.972668
         26  |  -.2566606    .047689    -5.38   0.000    -.3501371   -.1631841
         27  |  -.1162027   .0450899    -2.58   0.010    -.2045846   -.0278209
         28  |   .0553669   .0433238     1.28   0.201    -.0295532    .1402871
         29  |   .2906877   .0431603     6.74   0.000     .2060879    .3752875
         30  |   .4710418   .0431971    10.90   0.000       .38637    .5557137
         31  |   .6263678   .0443336    14.13   0.000     .5394683    .7132674
         32  |   .7783111   .0456663    17.04   0.000     .6887994    .8678229
         33  |   .8410588   .0472573    17.80   0.000     .7484286     .933689
         34  |    .994093    .049413    20.12   0.000     .8972372    1.090949
         35  |   1.084548   .0512545    21.16   0.000     .9840828    1.185014
         36  |   1.136549    .053859    21.10   0.000     1.030979     1.24212
         37  |    1.20179   .0564704    21.28   0.000     1.091101    1.312479
         38  |   1.283777   .0591176    21.72   0.000     1.167899    1.399655
         39  |   1.324258   .0619083    21.39   0.000      1.20291    1.445607
         40  |   1.420775    .065523    21.68   0.000     1.292341    1.549208
         41  |   1.496499   .0678037    22.07   0.000     1.363595    1.629403
         42  |   1.575238   .0705748    22.32   0.000     1.436902    1.713573
         43  |   1.551116   .0737749    21.02   0.000     1.406508    1.695725
         44  |    1.59065   .0769769    20.66   0.000     1.439766    1.741535
         45  |   1.662406   .0799292    20.80   0.000     1.505734    1.819077
         46  |   1.664077    .082875    20.08   0.000     1.501631    1.826522
         47  |    1.69184    .085163    19.87   0.000      1.52491    1.858771
         48  |   1.751634   .0876181    19.99   0.000     1.579892    1.923377
         49  |   1.761431   .0909088    19.38   0.000     1.583239    1.939624
         50  |   1.799987   .0934743    19.26   0.000     1.616765    1.983208
             |
     age_cat |
          1  |   .2545973   .0174123    14.62   0.000      .220467    .2887275
          2  |   .2552726    .019382    13.17   0.000     .2172813    .2932638
          3  |   .2320777   .0216913    10.70   0.000     .1895599    .2745954
          4  |   .2206377   .0240756     9.16   0.000     .1734464     .267829
          5  |   .2111008   .0267592     7.89   0.000     .1586494    .2635522
          6  |   .1955068   .0297588     6.57   0.000     .1371757    .2538379
          7  |   .2026473   .0328766     6.16   0.000      .138205    .2670895
          8  |   .1892546   .0360522     5.25   0.000     .1185878    .2599214
          9  |   .1824623   .0392613     4.65   0.000     .1055051    .2594195
         10  |   .1692957   .0425497     3.98   0.000     .0858929    .2526985
         11  |   .1709459   .0459248     3.72   0.000     .0809274    .2609643
         12  |   .1623879   .0492715     3.30   0.001     .0658094    .2589664
         13  |   .1516292    .052602     2.88   0.004     .0485227    .2547358
         14  |   .1544303   .0560137     2.76   0.006     .0446363    .2642243
         15  |   .1493744   .0594508     2.51   0.012     .0328433    .2659055
         16  |    .147559   .0628401     2.35   0.019     .0243845    .2707335
         17  |   .1332954   .0664323     2.01   0.045     .0030798    .2635111
         18  |   .1312725   .0699041     1.88   0.060    -.0057485    .2682934
         19  |   .1102068   .0736775     1.50   0.135    -.0342104    .2546241
         20  |   .0781779   .0805459     0.97   0.332    -.0797023    .2360582
         25  |   .0396398   .0918434     0.43   0.666     -.140385    .2196645
         30  |   .0354567   .1213549     0.29   0.770    -.2024144    .2733277
         40  |   .0667376   .1348507     0.49   0.621    -.1975869    .3310622
         50  |   .0502051   .1473579     0.34   0.733    -.2386352    .3390453
             |
       _cons |    7.50826   .0336305   223.26   0.000      7.44234     7.57418
-------------+----------------------------------------------------------------
     sigma_u |  1.1594214
     sigma_e |  .53383721
         rho |  .82508278   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_exporter + during_expat_H_exporter = 0

       F(  1, 14528) =    0.05
            Prob > F =    0.8244

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2316394161730809
key: p_value
value: .8244435225093493

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.2316                                         min =          1
     between = 0.1433                                         avg =        9.0
     overall = 0.1258                                         max =         25

                                                F(82,14528)       =     110.22
corr(u_i, Xb)  = 0.0186                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0722569   .0270868     2.67   0.008     .0191634    .1253504
during_dom~c |   .0478607   .0102245     4.68   0.000     .0278193    .0679021
after_dome~c |   .0539825   .0196901     2.74   0.006     .0153873    .0925777
during_expat |   .2102021   .0566583     3.71   0.000     .0991447    .3212595
 after_expat |   .2396249   .0731355     3.28   0.001     .0962701    .3829798
during_dom~r |  -.0284253   .0150366    -1.89   0.059     -.057899    .0010484
after_dome~r |   .0165836    .027301     0.61   0.544    -.0369297     .070097
during_exp~r |    -.04302   .0647744    -0.66   0.507     -.169986    .0839461
after_expa~r |   .0492013   .0842153     0.58   0.559    -.1158715     .214274
             |
    ind_year |
          2  |    .099633    .021299     4.68   0.000     .0578842    .1413818
          3  |   .2916427   .0259148    11.25   0.000     .2408465    .3424389
          4  |   .4904075   .0275221    17.82   0.000     .4364608    .5443542
          5  |   .6559662   .0302986    21.65   0.000      .596577    .7153554
          6  |   .8438645   .0335975    25.12   0.000     .7780091    .9097199
          7  |   .9734738   .0362214    26.88   0.000     .9024752    1.044472
          8  |   1.044143     .03896    26.80   0.000     .9677761    1.120509
          9  |   1.168093   .0417842    27.96   0.000     1.086191    1.249996
         10  |   1.283711   .0450785    28.48   0.000     1.195352    1.372071
         11  |   1.351031   .0481653    28.05   0.000     1.256621    1.445441
         12  |   1.380268   .0513964    26.86   0.000     1.279525    1.481012
         13  |   1.426975   .0544924    26.19   0.000     1.320163    1.533787
         14  |   1.468141   .0575838    25.50   0.000      1.35527    1.581013
         15  |   1.540937   .0611093    25.22   0.000     1.421155    1.660719
         16  |   1.579118   .0637592    24.77   0.000     1.454142    1.704094
         17  |   1.635758   .0671757    24.35   0.000     1.504085     1.76743
         18  |   1.566457   .0703812    22.26   0.000     1.428501    1.704413
         19  |   1.593611    .073528    21.67   0.000     1.449487    1.737736
         20  |    1.64078   .0766033    21.42   0.000     1.490628    1.790933
         21  |   1.661979   .0794629    20.92   0.000     1.506222    1.817737
         22  |   1.717015   .0821588    20.90   0.000     1.555973    1.878057
         23  |   1.769033   .0848319    20.85   0.000     1.602752    1.935315
         24  |   1.801696   .0878376    20.51   0.000     1.629523    1.973869
         25  |    1.79534   .0904677    19.85   0.000     1.618012    1.972668
         26  |  -.2566606    .047689    -5.38   0.000    -.3501371   -.1631841
         27  |  -.1162027   .0450899    -2.58   0.010    -.2045846   -.0278209
         28  |   .0553669   .0433238     1.28   0.201    -.0295532    .1402871
         29  |   .2906877   .0431603     6.74   0.000     .2060879    .3752875
         30  |   .4710418   .0431971    10.90   0.000       .38637    .5557137
         31  |   .6263678   .0443336    14.13   0.000     .5394683    .7132674
         32  |   .7783111   .0456663    17.04   0.000     .6887994    .8678229
         33  |   .8410588   .0472573    17.80   0.000     .7484286     .933689
         34  |    .994093    .049413    20.12   0.000     .8972372    1.090949
         35  |   1.084548   .0512545    21.16   0.000     .9840828    1.185014
         36  |   1.136549    .053859    21.10   0.000     1.030979     1.24212
         37  |    1.20179   .0564704    21.28   0.000     1.091101    1.312479
         38  |   1.283777   .0591176    21.72   0.000     1.167899    1.399655
         39  |   1.324258   .0619083    21.39   0.000      1.20291    1.445607
         40  |   1.420775    .065523    21.68   0.000     1.292341    1.549208
         41  |   1.496499   .0678037    22.07   0.000     1.363595    1.629403
         42  |   1.575238   .0705748    22.32   0.000     1.436902    1.713573
         43  |   1.551116   .0737749    21.02   0.000     1.406508    1.695725
         44  |    1.59065   .0769769    20.66   0.000     1.439766    1.741535
         45  |   1.662406   .0799292    20.80   0.000     1.505734    1.819077
         46  |   1.664077    .082875    20.08   0.000     1.501631    1.826522
         47  |    1.69184    .085163    19.87   0.000      1.52491    1.858771
         48  |   1.751634   .0876181    19.99   0.000     1.579892    1.923377
         49  |   1.761431   .0909088    19.38   0.000     1.583239    1.939624
         50  |   1.799987   .0934743    19.26   0.000     1.616765    1.983208
             |
     age_cat |
          1  |   .2545973   .0174123    14.62   0.000      .220467    .2887275
          2  |   .2552726    .019382    13.17   0.000     .2172813    .2932638
          3  |   .2320777   .0216913    10.70   0.000     .1895599    .2745954
          4  |   .2206377   .0240756     9.16   0.000     .1734464     .267829
          5  |   .2111008   .0267592     7.89   0.000     .1586494    .2635522
          6  |   .1955068   .0297588     6.57   0.000     .1371757    .2538379
          7  |   .2026473   .0328766     6.16   0.000      .138205    .2670895
          8  |   .1892546   .0360522     5.25   0.000     .1185878    .2599214
          9  |   .1824623   .0392613     4.65   0.000     .1055051    .2594195
         10  |   .1692957   .0425497     3.98   0.000     .0858929    .2526985
         11  |   .1709459   .0459248     3.72   0.000     .0809274    .2609643
         12  |   .1623879   .0492715     3.30   0.001     .0658094    .2589664
         13  |   .1516292    .052602     2.88   0.004     .0485227    .2547358
         14  |   .1544303   .0560137     2.76   0.006     .0446363    .2642243
         15  |   .1493744   .0594508     2.51   0.012     .0328433    .2659055
         16  |    .147559   .0628401     2.35   0.019     .0243845    .2707335
         17  |   .1332954   .0664323     2.01   0.045     .0030798    .2635111
         18  |   .1312725   .0699041     1.88   0.060    -.0057485    .2682934
         19  |   .1102068   .0736775     1.50   0.135    -.0342104    .2546241
         20  |   .0781779   .0805459     0.97   0.332    -.0797023    .2360582
         25  |   .0396398   .0918434     0.43   0.666     -.140385    .2196645
         30  |   .0354567   .1213549     0.29   0.770    -.2024144    .2733277
         40  |   .0667376   .1348507     0.49   0.621    -.1975869    .3310622
         50  |   .0502051   .1473579     0.34   0.733    -.2386352    .3390453
             |
       _cons |    7.50826   .0336305   223.26   0.000      7.44234     7.57418
-------------+----------------------------------------------------------------
     sigma_u |  1.1594214
     sigma_e |  .53383721
         rho |  .82508278   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.2316                         Obs per group: min =         1
       between = 0.1430                                        avg =       9.0
       overall = 0.1256                                        max =        25

                                                F(82,14528)        =    109.68
corr(u_i, Xb)  = 0.0178                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0718648   .0270963     2.65   0.008     .0187526     .124977
during_dom~c |   .0464818   .0135819     3.42   0.001     .0198596    .0731039
after_dome~c |   .0840002   .0234526     3.58   0.000     .0380302    .1299703
during_expat |    .179383   .0503908     3.56   0.000     .0806107    .2781553
 after_expat |   .2957714   .0636975     4.64   0.000     .1709162    .4206267
during_dom~w |  -.0167139   .0163871    -1.02   0.308    -.0488347     .015407
after_dome~w |   -.029506   .0286029    -1.03   0.302    -.0855714    .0265593
during_exp~w |   .0006129   .0604563     0.01   0.992    -.1178892    .1191149
after_expa~w |  -.0325641   .0775871    -0.42   0.675    -.1846446    .1195164
             |
    ind_year |
          2  |   .0999563   .0212991     4.69   0.000     .0582074    .1417051
          3  |   .2922566   .0259123    11.28   0.000     .2414652    .3430479
          4  |   .4912925   .0275124    17.86   0.000     .4373647    .5452202
          5  |   .6572366   .0302849    21.70   0.000     .5978744    .7165989
          6  |   .8454721   .0335832    25.18   0.000     .7796447    .9112995
          7  |      .9753   .0362106    26.93   0.000     .9043227    1.046277
          8  |   1.046235   .0389382    26.87   0.000     .9699106    1.122558
          9  |   1.170474   .0417369    28.04   0.000     1.088664    1.252284
         10  |   1.286344    .045027    28.57   0.000     1.198085    1.374603
         11  |   1.354001   .0481101    28.14   0.000     1.259699    1.448303
         12  |   1.383445   .0513069    26.96   0.000     1.282877    1.484014
         13  |   1.430412   .0544074    26.29   0.000     1.323767    1.537058
         14  |   1.471951   .0574769    25.61   0.000     1.359289    1.584613
         15  |   1.545098    .061017    25.32   0.000     1.425497    1.664699
         16  |   1.583569    .063662    24.87   0.000     1.458783    1.708355
         17  |   1.640528   .0670692    24.46   0.000     1.509064    1.771992
         18  |   1.571522   .0702813    22.36   0.000     1.433762    1.709282
         19  |   1.599026   .0734118    21.78   0.000     1.455129    1.742922
         20  |    1.64637   .0764657    21.53   0.000     1.496487    1.796252
         21  |   1.667748   .0793195    21.03   0.000     1.512272    1.823225
         22  |   1.723042   .0820364    21.00   0.000      1.56224    1.883843
         23  |   1.775165   .0846904    20.96   0.000     1.609161    1.941169
         24  |   1.808133   .0877284    20.61   0.000     1.636174    1.980092
         25  |   1.802002   .0903727    19.94   0.000      1.62486    1.979144
         26  |  -.2554661   .0476356    -5.36   0.000    -.3488379   -.1620944
         27  |  -.1146269   .0450531    -2.54   0.011    -.2029367   -.0263171
         28  |   .0571841   .0433206     1.32   0.187    -.0277298    .1420981
         29  |   .2926433     .04317     6.78   0.000     .2080246    .3772621
         30  |    .473122    .043208    10.95   0.000     .3884289    .5578151
         31  |   .6287467   .0443556    14.18   0.000      .541804    .7156893
         32  |   .7809953   .0456681    17.10   0.000       .69148    .8705105
         33  |   .8439218    .047281    17.85   0.000      .751245    .9365985
         34  |   .9971636   .0494497    20.17   0.000     .9002359    1.094091
         35  |   1.087872   .0512654    21.22   0.000     .9873856    1.188359
         36  |   1.139954   .0538387    21.17   0.000     1.034423    1.245484
         37  |   1.205403   .0564526    21.35   0.000     1.094749    1.316058
         38  |   1.287399    .059066    21.80   0.000     1.171623    1.403176
         39  |   1.328038   .0618578    21.47   0.000     1.206789    1.449287
         40  |   1.424778   .0654719    21.76   0.000     1.296445    1.553111
         41  |   1.500631   .0677097    22.16   0.000     1.367911    1.633351
         42  |     1.5795   .0704727    22.41   0.000     1.441364    1.717635
         43  |    1.55543   .0736368    21.12   0.000     1.411092    1.699767
         44  |   1.595098   .0768096    20.77   0.000     1.444542    1.745655
         45  |   1.666993   .0797562    20.90   0.000     1.510661    1.823326
         46  |   1.668764   .0826816    20.18   0.000     1.506698    1.830831
         47  |   1.696697   .0849676    19.97   0.000     1.530149    1.863244
         48  |   1.756586   .0873979    20.10   0.000     1.585275    1.927897
         49  |   1.766396   .0906606    19.48   0.000      1.58869    1.944103
         50  |   1.804963   .0932142    19.36   0.000     1.622251    1.987675
             |
     age_cat |
          1  |   .2546545   .0174026    14.63   0.000     .2205432    .2887658
          2  |   .2551999   .0193435    13.19   0.000     .2172843    .2931156
          3  |   .2317922   .0216344    10.71   0.000     .1893861    .2741984
          4  |   .2201068   .0239923     9.17   0.000     .1730789    .2671346
          5  |   .2103099   .0266599     7.89   0.000      .158053    .2625668
          6  |   .1944115   .0296463     6.56   0.000     .1363009     .252522
          7  |   .2013249     .03274     6.15   0.000     .1371504    .2654994
          8  |   .1877159   .0359012     5.23   0.000      .117345    .2580867
          9  |   .1806609   .0390931     4.62   0.000     .1040334    .2572883
         10  |   .1673346   .0423564     3.95   0.000     .0843107    .2503586
         11  |   .1687537   .0457164     3.69   0.000     .0791438    .2583637
         12  |   .1599789   .0490739     3.26   0.001     .0637878    .2561699
         13  |   .1490604   .0523784     2.85   0.004      .046392    .2517288
         14  |   .1516655   .0557624     2.72   0.007     .0423642    .2609668
         15  |   .1464152   .0591998     2.47   0.013     .0303762    .2624543
         16  |   .1443783   .0625525     2.31   0.021     .0217676    .2669891
         17  |   .1298283   .0661675     1.96   0.050     .0001316    .2595249
         18  |   .1275246   .0696463     1.83   0.067     -.008991    .2640402
         19  |   .1063234   .0734141     1.45   0.148    -.0375775    .2502242
         20  |   .0739908    .080287     0.92   0.357     -.083382    .2313637
         25  |   .0348982   .0915876     0.38   0.703    -.1446252    .2144216
         30  |   .0306003   .1211476     0.25   0.801    -.2068644     .268065
         40  |   .0614459    .134869     0.46   0.649    -.2029145    .3258064
         50  |    .044795   .1474645     0.30   0.761    -.2442541    .3338441
             |
       _cons |   7.505861   .0336237   223.23   0.000     7.439955    7.571768
-------------+----------------------------------------------------------------
     sigma_u |  1.1596059
     sigma_e |   .5338526
         rho |  .82512038   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_slow + during_expat_H_slow = 0

       F(  1, 14528) =    0.08
            Prob > F =    0.7796

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2315951177601178
key: p_value
value: .7795716340546497

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.2316                                         min =          1
     between = 0.1430                                         avg =        9.0
     overall = 0.1256                                         max =         25

                                                F(82,14528)       =     109.68
corr(u_i, Xb)  = 0.0178                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0718648   .0270963     2.65   0.008     .0187526     .124977
during_dom~c |   .0464818   .0135819     3.42   0.001     .0198596    .0731039
after_dome~c |   .0840002   .0234526     3.58   0.000     .0380302    .1299703
during_expat |    .179383   .0503908     3.56   0.000     .0806107    .2781553
 after_expat |   .2957714   .0636975     4.64   0.000     .1709162    .4206267
during_dom~w |  -.0167139   .0163871    -1.02   0.308    -.0488347     .015407
after_dome~w |   -.029506   .0286029    -1.03   0.302    -.0855714    .0265593
during_exp~w |   .0006129   .0604563     0.01   0.992    -.1178892    .1191149
after_expa~w |  -.0325641   .0775871    -0.42   0.675    -.1846446    .1195164
             |
    ind_year |
          2  |   .0999563   .0212991     4.69   0.000     .0582074    .1417051
          3  |   .2922566   .0259123    11.28   0.000     .2414652    .3430479
          4  |   .4912925   .0275124    17.86   0.000     .4373647    .5452202
          5  |   .6572366   .0302849    21.70   0.000     .5978744    .7165989
          6  |   .8454721   .0335832    25.18   0.000     .7796447    .9112995
          7  |      .9753   .0362106    26.93   0.000     .9043227    1.046277
          8  |   1.046235   .0389382    26.87   0.000     .9699106    1.122558
          9  |   1.170474   .0417369    28.04   0.000     1.088664    1.252284
         10  |   1.286344    .045027    28.57   0.000     1.198085    1.374603
         11  |   1.354001   .0481101    28.14   0.000     1.259699    1.448303
         12  |   1.383445   .0513069    26.96   0.000     1.282877    1.484014
         13  |   1.430412   .0544074    26.29   0.000     1.323767    1.537058
         14  |   1.471951   .0574769    25.61   0.000     1.359289    1.584613
         15  |   1.545098    .061017    25.32   0.000     1.425497    1.664699
         16  |   1.583569    .063662    24.87   0.000     1.458783    1.708355
         17  |   1.640528   .0670692    24.46   0.000     1.509064    1.771992
         18  |   1.571522   .0702813    22.36   0.000     1.433762    1.709282
         19  |   1.599026   .0734118    21.78   0.000     1.455129    1.742922
         20  |    1.64637   .0764657    21.53   0.000     1.496487    1.796252
         21  |   1.667748   .0793195    21.03   0.000     1.512272    1.823225
         22  |   1.723042   .0820364    21.00   0.000      1.56224    1.883843
         23  |   1.775165   .0846904    20.96   0.000     1.609161    1.941169
         24  |   1.808133   .0877284    20.61   0.000     1.636174    1.980092
         25  |   1.802002   .0903727    19.94   0.000      1.62486    1.979144
         26  |  -.2554661   .0476356    -5.36   0.000    -.3488379   -.1620944
         27  |  -.1146269   .0450531    -2.54   0.011    -.2029367   -.0263171
         28  |   .0571841   .0433206     1.32   0.187    -.0277298    .1420981
         29  |   .2926433     .04317     6.78   0.000     .2080246    .3772621
         30  |    .473122    .043208    10.95   0.000     .3884289    .5578151
         31  |   .6287467   .0443556    14.18   0.000      .541804    .7156893
         32  |   .7809953   .0456681    17.10   0.000       .69148    .8705105
         33  |   .8439218    .047281    17.85   0.000      .751245    .9365985
         34  |   .9971636   .0494497    20.17   0.000     .9002359    1.094091
         35  |   1.087872   .0512654    21.22   0.000     .9873856    1.188359
         36  |   1.139954   .0538387    21.17   0.000     1.034423    1.245484
         37  |   1.205403   .0564526    21.35   0.000     1.094749    1.316058
         38  |   1.287399    .059066    21.80   0.000     1.171623    1.403176
         39  |   1.328038   .0618578    21.47   0.000     1.206789    1.449287
         40  |   1.424778   .0654719    21.76   0.000     1.296445    1.553111
         41  |   1.500631   .0677097    22.16   0.000     1.367911    1.633351
         42  |     1.5795   .0704727    22.41   0.000     1.441364    1.717635
         43  |    1.55543   .0736368    21.12   0.000     1.411092    1.699767
         44  |   1.595098   .0768096    20.77   0.000     1.444542    1.745655
         45  |   1.666993   .0797562    20.90   0.000     1.510661    1.823326
         46  |   1.668764   .0826816    20.18   0.000     1.506698    1.830831
         47  |   1.696697   .0849676    19.97   0.000     1.530149    1.863244
         48  |   1.756586   .0873979    20.10   0.000     1.585275    1.927897
         49  |   1.766396   .0906606    19.48   0.000      1.58869    1.944103
         50  |   1.804963   .0932142    19.36   0.000     1.622251    1.987675
             |
     age_cat |
          1  |   .2546545   .0174026    14.63   0.000     .2205432    .2887658
          2  |   .2551999   .0193435    13.19   0.000     .2172843    .2931156
          3  |   .2317922   .0216344    10.71   0.000     .1893861    .2741984
          4  |   .2201068   .0239923     9.17   0.000     .1730789    .2671346
          5  |   .2103099   .0266599     7.89   0.000      .158053    .2625668
          6  |   .1944115   .0296463     6.56   0.000     .1363009     .252522
          7  |   .2013249     .03274     6.15   0.000     .1371504    .2654994
          8  |   .1877159   .0359012     5.23   0.000      .117345    .2580867
          9  |   .1806609   .0390931     4.62   0.000     .1040334    .2572883
         10  |   .1673346   .0423564     3.95   0.000     .0843107    .2503586
         11  |   .1687537   .0457164     3.69   0.000     .0791438    .2583637
         12  |   .1599789   .0490739     3.26   0.001     .0637878    .2561699
         13  |   .1490604   .0523784     2.85   0.004      .046392    .2517288
         14  |   .1516655   .0557624     2.72   0.007     .0423642    .2609668
         15  |   .1464152   .0591998     2.47   0.013     .0303762    .2624543
         16  |   .1443783   .0625525     2.31   0.021     .0217676    .2669891
         17  |   .1298283   .0661675     1.96   0.050     .0001316    .2595249
         18  |   .1275246   .0696463     1.83   0.067     -.008991    .2640402
         19  |   .1063234   .0734141     1.45   0.148    -.0375775    .2502242
         20  |   .0739908    .080287     0.92   0.357     -.083382    .2313637
         25  |   .0348982   .0915876     0.38   0.703    -.1446252    .2144216
         30  |   .0306003   .1211476     0.25   0.801    -.2068644     .268065
         40  |   .0614459    .134869     0.46   0.649    -.2029145    .3258064
         50  |    .044795   .1474645     0.30   0.761    -.2442541    .3338441
             |
       _cons |   7.505861   .0336237   223.23   0.000     7.439955    7.571768
-------------+----------------------------------------------------------------
     sigma_u |  1.1596059
     sigma_e |   .5338526
         rho |  .82512038   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.2316                         Obs per group: min =         1
       between = 0.1436                                        avg =       9.0
       overall = 0.1262                                        max =        25

                                                F(82,14528)        =    110.12
corr(u_i, Xb)  = 0.0227                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0719168   .0271176     2.65   0.008     .0187629    .1250708
during_dom~c |   .0314607   .0081861     3.84   0.000      .015415    .0475064
after_dome~c |   .0491813    .015312     3.21   0.001     .0191678    .0791948
during_expat |   .1547949   .0339838     4.55   0.000     .0881824    .2214074
 after_expat |   .2426714   .0438638     5.53   0.000     .1566928    .3286501
during_dom~y |   .0271744   .0202183     1.34   0.179    -.0124561    .0668049
after_dome~y |   .0691809   .0297646     2.32   0.020     .0108384    .1275234
during_exp~y |   .0928351   .0585033     1.59   0.113    -.0218387     .207509
after_expa~y |   .1026796   .0727111     1.41   0.158    -.0398434    .2452025
             |
    ind_year |
          2  |   .0988711   .0213022     4.64   0.000     .0571161    .1406262
          3  |   .2903911   .0259262    11.20   0.000     .2395725    .3412098
          4  |   .4886101   .0275299    17.75   0.000     .4346479    .5425723
          5  |   .6533845   .0302978    21.57   0.000      .593997    .7127721
          6  |   .8403955   .0336024    25.01   0.000     .7745306    .9062605
          7  |   .9690055   .0362276    26.75   0.000     .8979948    1.040016
          8  |    1.03853   .0389741    26.65   0.000     .9621358    1.114924
          9  |   1.161339   .0417573    27.81   0.000     1.079489    1.243189
         10  |    1.27679    .045034    28.35   0.000     1.188517    1.365062
         11  |   1.344235   .0480954    27.95   0.000     1.249962    1.438508
         12  |    1.37357   .0512976    26.78   0.000      1.27302     1.47412
         13  |    1.42047   .0543462    26.14   0.000     1.313944    1.526995
         14  |   1.462076   .0573951    25.47   0.000     1.349574    1.574578
         15  |   1.535223   .0608899    25.21   0.000     1.415871    1.654575
         16  |   1.573753   .0635165    24.78   0.000     1.449252    1.698253
         17  |   1.630828   .0669067    24.37   0.000     1.499682    1.761973
         18  |   1.561817   .0700803    22.29   0.000     1.424451    1.699184
         19  |   1.589365   .0731993    21.71   0.000     1.445885    1.732845
         20  |   1.636945   .0762378    21.47   0.000     1.487509    1.786381
         21  |   1.658501   .0790958    20.97   0.000     1.503463    1.813539
         22  |   1.713933   .0817699    20.96   0.000     1.553654    1.874213
         23  |   1.766209   .0844229    20.92   0.000     1.600729    1.931688
         24  |    1.79936   .0874445    20.58   0.000     1.627958    1.970763
         25  |   1.793383   .0900584    19.91   0.000     1.616858    1.969909
         26  |  -.2548929   .0476311    -5.35   0.000    -.3482559   -.1615299
         27  |  -.1152866   .0450402    -2.56   0.010    -.2035711   -.0270022
         28  |   .0554213   .0432978     1.28   0.201     -.029448    .1402905
         29  |   .2899408   .0431579     6.72   0.000     .2053458    .3745357
         30  |   .4691942   .0431934    10.86   0.000     .3845296    .5538587
         31  |    .623365   .0443373    14.06   0.000     .5364583    .7102717
         32  |    .774228   .0456709    16.95   0.000     .6847072    .8637487
         33  |   .8358317   .0472794    17.68   0.000      .743158    .9285054
         34  |    .987607   .0494345    19.98   0.000     .8907092    1.084505
         35  |   1.078023    .051229    21.04   0.000      .977608    1.178439
         36  |   1.130116   .0538268    21.00   0.000     1.024608    1.235623
         37  |   1.195459   .0564058    21.19   0.000     1.084896    1.306021
         38  |   1.277538   .0590135    21.65   0.000     1.161864    1.393211
         39  |   1.318297   .0617958    21.33   0.000     1.197169    1.439424
         40  |   1.415183    .065379    21.65   0.000     1.287032    1.543334
         41  |   1.491172   .0676165    22.05   0.000     1.358635    1.623709
         42  |    1.57016    .070348    22.32   0.000     1.432269    1.708051
         43  |   1.546183   .0735157    21.03   0.000     1.402083    1.690283
         44  |   1.585945   .0766637    20.69   0.000     1.435675    1.736216
         45  |   1.658068   .0795948    20.83   0.000     1.502052    1.814084
         46  |    1.66009     .08252    20.12   0.000      1.49834     1.82184
         47  |   1.688193   .0847888    19.91   0.000     1.521996     1.85439
         48  |   1.748315   .0872219    20.04   0.000     1.577349    1.919281
         49  |   1.758392   .0904707    19.44   0.000     1.581057    1.935726
         50  |   1.797152     .09302    19.32   0.000     1.614821    1.979483
             |
     age_cat |
          1  |   .2547988   .0174066    14.64   0.000     .2206797     .288918
          2  |   .2555714   .0193499    13.21   0.000     .2176432    .2934997
          3  |   .2324312   .0216295    10.75   0.000     .1900346    .2748278
          4  |   .2210683   .0239769     9.22   0.000     .1740705    .2680661
          5  |   .2115453   .0266278     7.94   0.000     .1593515    .2637391
          6  |   .1958813   .0295995     6.62   0.000     .1378625    .2539001
          7  |   .2030636   .0326848     6.21   0.000     .1389972      .26713
          8  |   .1896761   .0358425     5.29   0.000     .1194202    .2599321
          9  |   .1827768   .0390175     4.68   0.000     .1062976     .259256
         10  |   .1695874    .042264     4.01   0.000     .0867445    .2524302
         11  |   .1711303   .0456162     3.75   0.000     .0817167    .2605439
         12  |   .1624705   .0489631     3.32   0.001     .0664966    .2584444
         13  |   .1516848   .0522521     2.90   0.004      .049264    .2541056
         14  |   .1543784   .0556274     2.78   0.006     .0453416    .2634152
         15  |   .1492544   .0590409     2.53   0.011     .0335267     .264982
         16  |   .1473695   .0623996     2.36   0.018     .0250583    .2696807
         17  |   .1328954   .0659889     2.01   0.044     .0035488    .2622419
         18  |   .1306955   .0694547     1.88   0.060    -.0054447    .2668356
         19  |   .1095216   .0732311     1.50   0.135    -.0340206    .2530638
         20  |   .0772942    .080065     0.97   0.334    -.0796434    .2342318
         25  |    .038152    .091316     0.42   0.676    -.1408391     .217143
         30  |   .0338484   .1208949     0.28   0.779     -.203121    .2708179
         40  |    .065693   .1348097     0.49   0.626    -.1985512    .3299372
         50  |   .0488815   .1474486     0.33   0.740    -.2401364    .3378995
             |
       _cons |   7.510044   .0336637   223.09   0.000     7.444059    7.576029
-------------+----------------------------------------------------------------
     sigma_u |  1.1594229
     sigma_e |  .53383488
         rho |   .8250844   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_early + during_expat_H_early = 0

       F(  1, 14528) =    1.17
            Prob > F =    0.2789

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2316461250572114
key: p_value
value: .2789408826489259

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.2316                                         min =          1
     between = 0.1436                                         avg =        9.0
     overall = 0.1262                                         max =         25

                                                F(82,14528)       =     110.12
corr(u_i, Xb)  = 0.0227                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0719168   .0271176     2.65   0.008     .0187629    .1250708
during_dom~c |   .0314607   .0081861     3.84   0.000      .015415    .0475064
after_dome~c |   .0491813    .015312     3.21   0.001     .0191678    .0791948
during_expat |   .1547949   .0339838     4.55   0.000     .0881824    .2214074
 after_expat |   .2426714   .0438638     5.53   0.000     .1566928    .3286501
during_dom~y |   .0271744   .0202183     1.34   0.179    -.0124561    .0668049
after_dome~y |   .0691809   .0297646     2.32   0.020     .0108384    .1275234
during_exp~y |   .0928351   .0585033     1.59   0.113    -.0218387     .207509
after_expa~y |   .1026796   .0727111     1.41   0.158    -.0398434    .2452025
             |
    ind_year |
          2  |   .0988711   .0213022     4.64   0.000     .0571161    .1406262
          3  |   .2903911   .0259262    11.20   0.000     .2395725    .3412098
          4  |   .4886101   .0275299    17.75   0.000     .4346479    .5425723
          5  |   .6533845   .0302978    21.57   0.000      .593997    .7127721
          6  |   .8403955   .0336024    25.01   0.000     .7745306    .9062605
          7  |   .9690055   .0362276    26.75   0.000     .8979948    1.040016
          8  |    1.03853   .0389741    26.65   0.000     .9621358    1.114924
          9  |   1.161339   .0417573    27.81   0.000     1.079489    1.243189
         10  |    1.27679    .045034    28.35   0.000     1.188517    1.365062
         11  |   1.344235   .0480954    27.95   0.000     1.249962    1.438508
         12  |    1.37357   .0512976    26.78   0.000      1.27302     1.47412
         13  |    1.42047   .0543462    26.14   0.000     1.313944    1.526995
         14  |   1.462076   .0573951    25.47   0.000     1.349574    1.574578
         15  |   1.535223   .0608899    25.21   0.000     1.415871    1.654575
         16  |   1.573753   .0635165    24.78   0.000     1.449252    1.698253
         17  |   1.630828   .0669067    24.37   0.000     1.499682    1.761973
         18  |   1.561817   .0700803    22.29   0.000     1.424451    1.699184
         19  |   1.589365   .0731993    21.71   0.000     1.445885    1.732845
         20  |   1.636945   .0762378    21.47   0.000     1.487509    1.786381
         21  |   1.658501   .0790958    20.97   0.000     1.503463    1.813539
         22  |   1.713933   .0817699    20.96   0.000     1.553654    1.874213
         23  |   1.766209   .0844229    20.92   0.000     1.600729    1.931688
         24  |    1.79936   .0874445    20.58   0.000     1.627958    1.970763
         25  |   1.793383   .0900584    19.91   0.000     1.616858    1.969909
         26  |  -.2548929   .0476311    -5.35   0.000    -.3482559   -.1615299
         27  |  -.1152866   .0450402    -2.56   0.010    -.2035711   -.0270022
         28  |   .0554213   .0432978     1.28   0.201     -.029448    .1402905
         29  |   .2899408   .0431579     6.72   0.000     .2053458    .3745357
         30  |   .4691942   .0431934    10.86   0.000     .3845296    .5538587
         31  |    .623365   .0443373    14.06   0.000     .5364583    .7102717
         32  |    .774228   .0456709    16.95   0.000     .6847072    .8637487
         33  |   .8358317   .0472794    17.68   0.000      .743158    .9285054
         34  |    .987607   .0494345    19.98   0.000     .8907092    1.084505
         35  |   1.078023    .051229    21.04   0.000      .977608    1.178439
         36  |   1.130116   .0538268    21.00   0.000     1.024608    1.235623
         37  |   1.195459   .0564058    21.19   0.000     1.084896    1.306021
         38  |   1.277538   .0590135    21.65   0.000     1.161864    1.393211
         39  |   1.318297   .0617958    21.33   0.000     1.197169    1.439424
         40  |   1.415183    .065379    21.65   0.000     1.287032    1.543334
         41  |   1.491172   .0676165    22.05   0.000     1.358635    1.623709
         42  |    1.57016    .070348    22.32   0.000     1.432269    1.708051
         43  |   1.546183   .0735157    21.03   0.000     1.402083    1.690283
         44  |   1.585945   .0766637    20.69   0.000     1.435675    1.736216
         45  |   1.658068   .0795948    20.83   0.000     1.502052    1.814084
         46  |    1.66009     .08252    20.12   0.000      1.49834     1.82184
         47  |   1.688193   .0847888    19.91   0.000     1.521996     1.85439
         48  |   1.748315   .0872219    20.04   0.000     1.577349    1.919281
         49  |   1.758392   .0904707    19.44   0.000     1.581057    1.935726
         50  |   1.797152     .09302    19.32   0.000     1.614821    1.979483
             |
     age_cat |
          1  |   .2547988   .0174066    14.64   0.000     .2206797     .288918
          2  |   .2555714   .0193499    13.21   0.000     .2176432    .2934997
          3  |   .2324312   .0216295    10.75   0.000     .1900346    .2748278
          4  |   .2210683   .0239769     9.22   0.000     .1740705    .2680661
          5  |   .2115453   .0266278     7.94   0.000     .1593515    .2637391
          6  |   .1958813   .0295995     6.62   0.000     .1378625    .2539001
          7  |   .2030636   .0326848     6.21   0.000     .1389972      .26713
          8  |   .1896761   .0358425     5.29   0.000     .1194202    .2599321
          9  |   .1827768   .0390175     4.68   0.000     .1062976     .259256
         10  |   .1695874    .042264     4.01   0.000     .0867445    .2524302
         11  |   .1711303   .0456162     3.75   0.000     .0817167    .2605439
         12  |   .1624705   .0489631     3.32   0.001     .0664966    .2584444
         13  |   .1516848   .0522521     2.90   0.004      .049264    .2541056
         14  |   .1543784   .0556274     2.78   0.006     .0453416    .2634152
         15  |   .1492544   .0590409     2.53   0.011     .0335267     .264982
         16  |   .1473695   .0623996     2.36   0.018     .0250583    .2696807
         17  |   .1328954   .0659889     2.01   0.044     .0035488    .2622419
         18  |   .1306955   .0694547     1.88   0.060    -.0054447    .2668356
         19  |   .1095216   .0732311     1.50   0.135    -.0340206    .2530638
         20  |   .0772942    .080065     0.97   0.334    -.0796434    .2342318
         25  |    .038152    .091316     0.42   0.676    -.1408391     .217143
         30  |   .0338484   .1208949     0.28   0.779     -.203121    .2708179
         40  |    .065693   .1348097     0.49   0.626    -.1985512    .3299372
         50  |   .0488815   .1474486     0.33   0.740    -.2401364    .3378995
             |
       _cons |   7.510044   .0336637   223.09   0.000     7.444059    7.576029
-------------+----------------------------------------------------------------
     sigma_u |  1.1594229
     sigma_e |  .53383488
         rho |   .8250844   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.2316                         Obs per group: min =         1
       between = 0.1442                                        avg =       9.0
       overall = 0.1266                                        max =        25

                                                F(82,14528)        =    110.74
corr(u_i, Xb)  = 0.0202                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0722551   .0271025     2.67   0.008     .0191308    .1253795
during_dom~c |   .0358328   .0095247     3.76   0.000     .0171632    .0545024
after_dome~c |    .069246   .0157706     4.39   0.000     .0383337    .1001584
during_expat |   .2054648   .0339267     6.06   0.000     .1389641    .2719654
 after_expat |   .2792449   .0393018     7.11   0.000     .2022084    .3562814
during_dom~m |  -.0002814    .011642    -0.02   0.981    -.0231012    .0225383
after_dome~m |  -.0151176   .0224157    -0.67   0.500    -.0590552    .0288199
during_exp~m |  -.0666589   .0469978    -1.42   0.156    -.1587806    .0254627
after_expa~m |  -.0322416   .0592683    -0.54   0.586    -.1484151    .0839318
             |
    ind_year |
          2  |   .0994672   .0212981     4.67   0.000     .0577201    .1412143
          3  |   .2912964   .0259171    11.24   0.000     .2404955    .3420973
          4  |   .4898886   .0275206    17.80   0.000     .4359447    .5438326
          5  |   .6553439   .0303035    21.63   0.000     .5959453    .7147426
          6  |    .843103   .0336093    25.09   0.000     .7772245    .9089815
          7  |   .9725137   .0362444    26.83   0.000       .90147    1.043557
          8  |    1.04299   .0389834    26.75   0.000     .9665781    1.119403
          9  |   1.166797   .0417968    27.92   0.000      1.08487    1.248724
         10  |   1.282239   .0450843    28.44   0.000     1.193868     1.37061
         11  |   1.349452   .0481701    28.01   0.000     1.255032    1.443871
         12  |   1.378545   .0513779    26.83   0.000     1.277838    1.479252
         13  |   1.425114   .0544573    26.17   0.000     1.318371    1.531858
         14  |   1.466241   .0575371    25.48   0.000     1.353461    1.579021
         15  |   1.538946   .0610622    25.20   0.000     1.419257    1.658636
         16  |   1.577041   .0637056    24.76   0.000      1.45217    1.701912
         17  |   1.633559   .0671152    24.34   0.000     1.502005    1.765114
         18  |   1.564107   .0703258    22.24   0.000     1.426259    1.701954
         19  |   1.591132   .0734763    21.66   0.000     1.447109    1.735155
         20  |   1.638119   .0765374    21.40   0.000     1.488096    1.788142
         21  |   1.659141   .0794141    20.89   0.000     1.503479    1.814803
         22  |   1.713986   .0821196    20.87   0.000     1.553021    1.874951
         23  |   1.765783   .0847862    20.83   0.000     1.599591    1.931974
         24  |   1.798443   .0878306    20.48   0.000     1.626284    1.970602
         25  |   1.791965   .0904523    19.81   0.000     1.614667    1.969263
         26  |  -.2559377    .047631    -5.37   0.000    -.3493006   -.1625748
         27  |  -.1156996   .0450613    -2.57   0.010    -.2040256   -.0273737
         28  |   .0557488   .0433231     1.29   0.198      -.02917    .1406677
         29  |   .2910378   .0431865     6.74   0.000     .2063868    .3756887
         30  |   .4710603    .043242    10.89   0.000     .3863005      .55582
         31  |   .6262023   .0444043    14.10   0.000     .5391642    .7132404
         32  |   .7780216   .0457455    17.01   0.000     .6883547    .8676886
         33  |   .8405989   .0473473    17.75   0.000     .7477922    .9334056
         34  |   .9933924   .0495097    20.06   0.000     .8963472    1.090438
         35  |    1.08367   .0513208    21.12   0.000     .9830749    1.184266
         36  |   1.135404   .0539032    21.06   0.000     1.029747    1.241061
         37  |    1.20039   .0565033    21.24   0.000     1.089636    1.311143
         38  |   1.282031   .0591366    21.68   0.000     1.166116    1.397947
         39  |   1.322347   .0619554    21.34   0.000     1.200906    1.443787
         40  |   1.418803   .0655616    21.64   0.000     1.290294    1.547313
         41  |   1.494433   .0678126    22.04   0.000     1.361512    1.627354
         42  |   1.572957   .0705655    22.29   0.000      1.43464    1.711275
         43  |   1.548545   .0737449    21.00   0.000     1.403996    1.693094
         44  |   1.587857   .0769128    20.64   0.000     1.437098    1.738616
         45  |   1.659452   .0798769    20.78   0.000     1.502883    1.816021
         46  |    1.66085   .0828272    20.05   0.000     1.498498    1.823201
         47  |   1.688536   .0851184    19.84   0.000     1.521693    1.855379
         48  |   1.748206   .0875734    19.96   0.000     1.576551    1.919861
         49  |    1.75779   .0908608    19.35   0.000     1.579691    1.935888
         50  |   1.796059   .0934183    19.23   0.000     1.612947    1.979171
             |
     age_cat |
          1  |   .2550834   .0174145    14.65   0.000     .2209488     .289218
          2  |   .2562287   .0193803    13.22   0.000     .2182409    .2942165
          3  |   .2334622   .0216927    10.76   0.000     .1909417    .2759826
          4  |   .2223795   .0240712     9.24   0.000     .1751969    .2695621
          5  |    .213206   .0267549     7.97   0.000     .1607631     .265649
          6  |   .1979282    .029768     6.65   0.000      .139579    .2562773
          7  |   .2053836   .0329043     6.24   0.000      .140887    .2698801
          8  |   .1923242   .0360874     5.33   0.000     .1215882    .2630601
          9  |   .1858295   .0393173     4.73   0.000     .1087626    .2628963
         10  |   .1730461     .04264     4.06   0.000     .0894662    .2566259
         11  |   .1734906   .0457186     3.79   0.000     .0838763    .2631049
         12  |     .16516   .0490698     3.37   0.001     .0689769     .261343
         13  |    .154624   .0523669     2.95   0.003     .0519782    .2572699
         14  |   .1575814   .0557526     2.83   0.005     .0482991    .2668636
         15  |   .1526513    .059174     2.58   0.010     .0366627    .2686399
         16  |   .1509416   .0625386     2.41   0.016      .028358    .2735251
         17  |   .1367098   .0661204     2.07   0.039     .0071054    .2663143
         18  |   .1347027   .0695893     1.94   0.053    -.0017013    .2711066
         19  |   .1138245   .0733618     1.55   0.121    -.0299739     .257623
         20  |   .0820828   .0802125     1.02   0.306    -.0751439    .2393095
         25  |   .0436243    .091498     0.48   0.634    -.1357234     .222972
         30  |    .039402   .1210561     0.33   0.745    -.1978834    .2766874
         40  |   .0698906   .1349521     0.52   0.605    -.1946326    .3344139
         50  |   .0534263   .1475743     0.36   0.717    -.2358382    .3426907
             |
       _cons |    7.50667   .0336156   223.31   0.000     7.440779    7.572561
-------------+----------------------------------------------------------------
     sigma_u |  1.1589074
     sigma_e |  .53385306
         rho |  .82494616   (fraction of variance due to u_i)
------------------------------------------------------------------------------

 ( 1)  - during_domestic_H_young_firm + during_expat_H_young_firm = 0

       F(  1, 14528) =    1.93
            Prob > F =    0.1643

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2315937743758687
key: p_value
value: .1642669888473458

. 
. estimates

-------------------------------------------------------------------------------
active results
-------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.2316                                         min =          1
     between = 0.1442                                         avg =        9.0
     overall = 0.1266                                         max =         25

                                                F(82,14528)       =     110.74
corr(u_i, Xb)  = 0.0202                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0722551   .0271025     2.67   0.008     .0191308    .1253795
during_dom~c |   .0358328   .0095247     3.76   0.000     .0171632    .0545024
after_dome~c |    .069246   .0157706     4.39   0.000     .0383337    .1001584
during_expat |   .2054648   .0339267     6.06   0.000     .1389641    .2719654
 after_expat |   .2792449   .0393018     7.11   0.000     .2022084    .3562814
during_dom~m |  -.0002814    .011642    -0.02   0.981    -.0231012    .0225383
after_dome~m |  -.0151176   .0224157    -0.67   0.500    -.0590552    .0288199
during_exp~m |  -.0666589   .0469978    -1.42   0.156    -.1587806    .0254627
after_expa~m |  -.0322416   .0592683    -0.54   0.586    -.1484151    .0839318
             |
    ind_year |
          2  |   .0994672   .0212981     4.67   0.000     .0577201    .1412143
          3  |   .2912964   .0259171    11.24   0.000     .2404955    .3420973
          4  |   .4898886   .0275206    17.80   0.000     .4359447    .5438326
          5  |   .6553439   .0303035    21.63   0.000     .5959453    .7147426
          6  |    .843103   .0336093    25.09   0.000     .7772245    .9089815
          7  |   .9725137   .0362444    26.83   0.000       .90147    1.043557
          8  |    1.04299   .0389834    26.75   0.000     .9665781    1.119403
          9  |   1.166797   .0417968    27.92   0.000      1.08487    1.248724
         10  |   1.282239   .0450843    28.44   0.000     1.193868     1.37061
         11  |   1.349452   .0481701    28.01   0.000     1.255032    1.443871
         12  |   1.378545   .0513779    26.83   0.000     1.277838    1.479252
         13  |   1.425114   .0544573    26.17   0.000     1.318371    1.531858
         14  |   1.466241   .0575371    25.48   0.000     1.353461    1.579021
         15  |   1.538946   .0610622    25.20   0.000     1.419257    1.658636
         16  |   1.577041   .0637056    24.76   0.000      1.45217    1.701912
         17  |   1.633559   .0671152    24.34   0.000     1.502005    1.765114
         18  |   1.564107   .0703258    22.24   0.000     1.426259    1.701954
         19  |   1.591132   .0734763    21.66   0.000     1.447109    1.735155
         20  |   1.638119   .0765374    21.40   0.000     1.488096    1.788142
         21  |   1.659141   .0794141    20.89   0.000     1.503479    1.814803
         22  |   1.713986   .0821196    20.87   0.000     1.553021    1.874951
         23  |   1.765783   .0847862    20.83   0.000     1.599591    1.931974
         24  |   1.798443   .0878306    20.48   0.000     1.626284    1.970602
         25  |   1.791965   .0904523    19.81   0.000     1.614667    1.969263
         26  |  -.2559377    .047631    -5.37   0.000    -.3493006   -.1625748
         27  |  -.1156996   .0450613    -2.57   0.010    -.2040256   -.0273737
         28  |   .0557488   .0433231     1.29   0.198      -.02917    .1406677
         29  |   .2910378   .0431865     6.74   0.000     .2063868    .3756887
         30  |   .4710603    .043242    10.89   0.000     .3863005      .55582
         31  |   .6262023   .0444043    14.10   0.000     .5391642    .7132404
         32  |   .7780216   .0457455    17.01   0.000     .6883547    .8676886
         33  |   .8405989   .0473473    17.75   0.000     .7477922    .9334056
         34  |   .9933924   .0495097    20.06   0.000     .8963472    1.090438
         35  |    1.08367   .0513208    21.12   0.000     .9830749    1.184266
         36  |   1.135404   .0539032    21.06   0.000     1.029747    1.241061
         37  |    1.20039   .0565033    21.24   0.000     1.089636    1.311143
         38  |   1.282031   .0591366    21.68   0.000     1.166116    1.397947
         39  |   1.322347   .0619554    21.34   0.000     1.200906    1.443787
         40  |   1.418803   .0655616    21.64   0.000     1.290294    1.547313
         41  |   1.494433   .0678126    22.04   0.000     1.361512    1.627354
         42  |   1.572957   .0705655    22.29   0.000      1.43464    1.711275
         43  |   1.548545   .0737449    21.00   0.000     1.403996    1.693094
         44  |   1.587857   .0769128    20.64   0.000     1.437098    1.738616
         45  |   1.659452   .0798769    20.78   0.000     1.502883    1.816021
         46  |    1.66085   .0828272    20.05   0.000     1.498498    1.823201
         47  |   1.688536   .0851184    19.84   0.000     1.521693    1.855379
         48  |   1.748206   .0875734    19.96   0.000     1.576551    1.919861
         49  |    1.75779   .0908608    19.35   0.000     1.579691    1.935888
         50  |   1.796059   .0934183    19.23   0.000     1.612947    1.979171
             |
     age_cat |
          1  |   .2550834   .0174145    14.65   0.000     .2209488     .289218
          2  |   .2562287   .0193803    13.22   0.000     .2182409    .2942165
          3  |   .2334622   .0216927    10.76   0.000     .1909417    .2759826
          4  |   .2223795   .0240712     9.24   0.000     .1751969    .2695621
          5  |    .213206   .0267549     7.97   0.000     .1607631     .265649
          6  |   .1979282    .029768     6.65   0.000      .139579    .2562773
          7  |   .2053836   .0329043     6.24   0.000      .140887    .2698801
          8  |   .1923242   .0360874     5.33   0.000     .1215882    .2630601
          9  |   .1858295   .0393173     4.73   0.000     .1087626    .2628963
         10  |   .1730461     .04264     4.06   0.000     .0894662    .2566259
         11  |   .1734906   .0457186     3.79   0.000     .0838763    .2631049
         12  |     .16516   .0490698     3.37   0.001     .0689769     .261343
         13  |    .154624   .0523669     2.95   0.003     .0519782    .2572699
         14  |   .1575814   .0557526     2.83   0.005     .0482991    .2668636
         15  |   .1526513    .059174     2.58   0.010     .0366627    .2686399
         16  |   .1509416   .0625386     2.41   0.016      .028358    .2735251
         17  |   .1367098   .0661204     2.07   0.039     .0071054    .2663143
         18  |   .1347027   .0695893     1.94   0.053    -.0017013    .2711066
         19  |   .1138245   .0733618     1.55   0.121    -.0299739     .257623
         20  |   .0820828   .0802125     1.02   0.306    -.0751439    .2393095
         25  |   .0436243    .091498     0.48   0.634    -.1357234     .222972
         30  |    .039402   .1210561     0.33   0.745    -.1978834    .2766874
         40  |   .0698906   .1349521     0.52   0.605    -.1946326    .3344139
         50  |   .0534263   .1475743     0.36   0.717    -.2358382    .3426907
             |
       _cons |    7.50667   .0336156   223.31   0.000     7.440779    7.572561
-------------+----------------------------------------------------------------
     sigma_u |  1.1589074
     sigma_e |  .53385306
         rho |  .82494616   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text re
> place

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")
> ]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newl
> ine
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")
> ) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'"
> )) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coef
> s',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. 
end of do-file

. 
. log close
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/outp
> ut/estimate_heterogeneity.log
  log type:  text
 closed on:   4 Dec 2018, 16:50:05
-------------------------------------------------------------------------------
