--------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/estimate_switch.log
  log type:  text
 opened on:   4 Dec 2018, 17:02:51

. 
. 
. use temp/analysis_sample

. 
. *Dinamika
. scalar Tbefore = 4

. scalar Tduring = 6

. scalar Tafter = 4

. 
. gen byte analysis_window = (tenure>=-Tbefore-1)&(year-first_exit_year<=Tafter)

. 
. global sample_baseline (analysis_window==1)

. global sample_manufacturing $sample_baseline & (manufacturing==1)

. global sample_acquisitions $sample_baseline & (greenfield==0)

. 
. global samples baseline acquisitions

. 
. global outcomes lnL lnKL lnQL exporter

. label var lnL "Employment (log)"

. label var lnKL "Capital per worker (log)"

. label var lnQL "Revenue per worker (log)"

. label var exporter "Firm is an exporter (dummy)"

. 
. egen person_tag = tag(frame_id manager_id)

. egen N = sum(person_tag), by(frame_id)

. gen inverse_weight = 1/N

. 
. * verify founders are not in analysis sample
. foreach X of var during* after* {
  2.         replace `X'=0 if founder==1
  3. }
(0 real changes made)
(132,464 real changes made)
(55,048 real changes made)
(73,335 real changes made)
(81,604 real changes made)
(46,715 real changes made)
(88,449 real changes made)
(96,285 real changes made)
(94,584 real changes made)
(20,057 real changes made)
(10,166 real changes made)
(13,405 real changes made)
(13,063 real changes made)
(15,361 real changes made)
(11,994 real changes made)
(13,939 real changes made)
(17,025 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(70,373 real changes made)
(35,951 real changes made)
(37,925 real changes made)
(38,899 real changes made)
(31,710 real changes made)
(44,472 real changes made)
(52,990 real changes made)
(32,396 real changes made)
(32,892 real changes made)
(19,164 real changes made)
(22,477 real changes made)
(19,915 real changes made)
(25,211 real changes made)
(20,097 real changes made)
(27,732 real changes made)
(15,077 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)

. 
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. 
. do est_`1'

. local i = 1

. foreach X of var $outcomes {
  2.         xtreg `X' foreign during_?? after_?? i.ind_year i.age_cat if $sample_acquisitions [aw=inverse_weight], i(firm_perso
> n ) fe vce(cluster id)
  3.         local r2_w = `e(r2_w)'
  4.         do regram output/regression/acquisitions_change `i' `X' R2_within "`r2_w'"
  5.         do tree_graph
  6. 
.         local i = `i' + 1
  7. }

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.1015                         Obs per group: min =         1
       between = 0.0177                                        avg =       9.0
       overall = 0.0292                                        max =        25

                                                F(82,14528)        =     38.77
corr(u_i, Xb)  = -0.3239                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0375562   .0380024     0.99   0.323    -.0369332    .1120457
   during_DD |  -.0398328   .0112108    -3.55   0.000    -.0618075   -.0178581
   during_DE |  -.0134453    .057093    -0.24   0.814    -.1253548    .0984642
   during_ED |  -.0066665   .0473142    -0.14   0.888    -.0994085    .0860754
   during_EE |   -.068578   .0558034    -1.23   0.219    -.1779597    .0408038
    after_DD |  -.1876581    .020916    -8.97   0.000     -.228656   -.1466601
    after_DE |  -.0631847   .0663523    -0.95   0.341    -.1932436    .0668742
    after_ED |  -.1698433   .0651591    -2.61   0.009    -.2975635   -.0421232
    after_EE |  -.1344846   .0691412    -1.95   0.052    -.2700102     .001041
             |
    ind_year |
          2  |  -.1201199   .0249633    -4.81   0.000    -.1690511   -.0711887
          3  |  -.2681318   .0324198    -8.27   0.000    -.3316786   -.2045849
          4  |  -.4062757   .0368771   -11.02   0.000    -.4785594    -.333992
          5  |  -.5070735   .0416426   -12.18   0.000    -.5886982   -.4254487
          6  |  -.6108663   .0461955   -13.22   0.000    -.7014153   -.5203173
          7  |  -.6722358   .0505647   -13.29   0.000     -.771349   -.5731226
          8  |  -.7047819   .0544415   -12.95   0.000    -.8114942   -.5980696
          9  |   -.757084   .0586448   -12.91   0.000    -.8720351   -.6421328
         10  |  -.8219719      .0627   -13.11   0.000    -.9448718    -.699072
         11  |  -.8855433   .0665126   -13.31   0.000    -1.015916   -.7551702
         12  |  -.9327545   .0705568   -13.22   0.000    -1.071055   -.7944541
         13  |   -.969992   .0746754   -12.99   0.000    -1.116365   -.8236187
         14  |  -1.025316   .0787755   -13.02   0.000    -1.179726   -.8709062
         15  |  -1.059083   .0827485   -12.80   0.000    -1.221281   -.8968855
         16  |  -1.123581   .0866755   -12.96   0.000    -1.293476   -.9536855
         17  |  -1.175874   .0907734   -12.95   0.000    -1.353801   -.9979463
         18  |  -1.265238   .0947229   -13.36   0.000    -1.450906   -1.079569
         19  |  -1.331661   .0985027   -13.52   0.000    -1.524738   -1.138583
         20  |  -1.384126    .102026   -13.57   0.000     -1.58411   -1.184142
         21  |  -1.446917   .1054998   -13.71   0.000     -1.65371   -1.240124
         22  |  -1.500472   .1088381   -13.79   0.000    -1.713809   -1.287136
         23  |   -1.54538   .1121874   -13.77   0.000    -1.765282   -1.325479
         24  |  -1.598877   .1159696   -13.79   0.000    -1.826192   -1.371561
         25  |  -1.628872   .1198156   -13.59   0.000    -1.863726   -1.394019
         26  |   .5096764   .0718874     7.09   0.000     .3687678    .6505849
         27  |   .3451116   .0676155     5.10   0.000     .2125765    .4776467
         28  |   .2205185   .0654676     3.37   0.001     .0921937    .3488434
         29  |   .0827143   .0647868     1.28   0.202    -.0442762    .2097047
         30  |  -.0287486   .0642207    -0.45   0.654    -.1546294    .0971322
         31  |  -.0980848   .0652834    -1.50   0.133    -.2260486     .029879
         32  |  -.1799701   .0660358    -2.73   0.006    -.3094086   -.0505315
         33  |  -.2653565   .0681539    -3.89   0.000    -.3989467   -.1317662
         34  |  -.3386728   .0703653    -4.81   0.000    -.4765977   -.2007479
         35  |  -.4057856   .0729726    -5.56   0.000    -.5488211     -.26275
         36  |  -.4856785   .0754149    -6.44   0.000    -.6335013   -.3378556
         37  |  -.5639984   .0782643    -7.21   0.000    -.7174064   -.4105904
         38  |  -.6475606   .0814786    -7.95   0.000    -.8072691   -.4878521
         39  |  -.7159113   .0851376    -8.41   0.000    -.8827918   -.5490308
         40  |  -.7523477   .0889785    -8.46   0.000     -.926757   -.5779385
         41  |  -.7913397   .0923023    -8.57   0.000    -.9722641   -.6104154
         42  |  -.8546472   .0957816    -8.92   0.000    -1.042391   -.6669031
         43  |   -.983682   .0996175    -9.87   0.000    -1.178945    -.788419
         44  |  -1.034011   .1037601    -9.97   0.000    -1.237394   -.8306277
         45  |  -1.060269   .1074782    -9.86   0.000    -1.270939   -.8495975
         46  |  -1.088835   .1111527    -9.80   0.000    -1.306709   -.8709618
         47  |  -1.124711   .1144039    -9.83   0.000    -1.348957   -.9004647
         48  |   -1.14645   .1179238    -9.72   0.000    -1.377596   -.9153045
         49  |  -1.197904   .1215206    -9.86   0.000      -1.4361    -.959708
         50  |  -1.234043   .1245348    -9.91   0.000    -1.478147   -.9899385
             |
     age_cat |
          1  |   .4135665   .0188955    21.89   0.000     .3765289    .4506042
          2  |   .7106579    .022044    32.24   0.000     .6674488    .7538669
          3  |    .929381   .0257429    36.10   0.000     .8789216    .9798404
          4  |   1.111649    .029553    37.62   0.000     1.053721    1.169577
          5  |   1.269038   .0336862    37.67   0.000     1.203008    1.335067
          6  |   1.396844   .0378929    36.86   0.000     1.322569    1.471118
          7  |   1.501421   .0422601    35.53   0.000     1.418586    1.584257
          8  |    1.59954    .046722    34.24   0.000     1.507959    1.691121
          9  |   1.674778   .0510808    32.79   0.000     1.574653    1.774903
         10  |   1.745331    .055407    31.50   0.000     1.636726    1.853935
         11  |   1.817432   .0598014    30.39   0.000     1.700214     1.93465
         12  |   1.887298   .0641947    29.40   0.000     1.761469    2.013128
         13  |   1.951223   .0685649    28.46   0.000     1.816827    2.085619
         14  |   1.996718   .0731055    27.31   0.000     1.853422    2.140014
         15  |   2.044253   .0776175    26.34   0.000     1.892113    2.196393
         16  |   2.080221   .0821356    25.33   0.000     1.919225    2.241217
         17  |   2.116882   .0867582    24.40   0.000     1.946825     2.28694
         18  |   2.169709   .0910908    23.82   0.000     1.991159    2.348258
         19  |   2.208228   .0958619    23.04   0.000     2.020327     2.39613
         20  |    2.28648   .1042896    21.92   0.000     2.082059    2.490901
         25  |   2.407315     .11784    20.43   0.000     2.176334    2.638297
         30  |   2.174481   .1531644    14.20   0.000     1.874259    2.474703
         40  |   2.093298   .1717557    12.19   0.000     1.756635    2.429961
         50  |    2.04987   .1732745    11.83   0.000      1.71023     2.38951
             |
       _cons |   3.017619    .046045    65.54   0.000     2.927365    3.107873
-------------+----------------------------------------------------------------
     sigma_u |  1.1435986
     sigma_e |  .64575039
         rho |  .75823814   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1015161514075467

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.1015                                         min =          1
     between = 0.0177                                         avg =        9.0
     overall = 0.0292                                         max =         25

                                                F(82,14528)       =      38.77
corr(u_i, Xb)  = -0.3239                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0375562   .0380024     0.99   0.323    -.0369332    .1120457
   during_DD |  -.0398328   .0112108    -3.55   0.000    -.0618075   -.0178581
   during_DE |  -.0134453    .057093    -0.24   0.814    -.1253548    .0984642
   during_ED |  -.0066665   .0473142    -0.14   0.888    -.0994085    .0860754
   during_EE |   -.068578   .0558034    -1.23   0.219    -.1779597    .0408038
    after_DD |  -.1876581    .020916    -8.97   0.000     -.228656   -.1466601
    after_DE |  -.0631847   .0663523    -0.95   0.341    -.1932436    .0668742
    after_ED |  -.1698433   .0651591    -2.61   0.009    -.2975635   -.0421232
    after_EE |  -.1344846   .0691412    -1.95   0.052    -.2700102     .001041
             |
    ind_year |
          2  |  -.1201199   .0249633    -4.81   0.000    -.1690511   -.0711887
          3  |  -.2681318   .0324198    -8.27   0.000    -.3316786   -.2045849
          4  |  -.4062757   .0368771   -11.02   0.000    -.4785594    -.333992
          5  |  -.5070735   .0416426   -12.18   0.000    -.5886982   -.4254487
          6  |  -.6108663   .0461955   -13.22   0.000    -.7014153   -.5203173
          7  |  -.6722358   .0505647   -13.29   0.000     -.771349   -.5731226
          8  |  -.7047819   .0544415   -12.95   0.000    -.8114942   -.5980696
          9  |   -.757084   .0586448   -12.91   0.000    -.8720351   -.6421328
         10  |  -.8219719      .0627   -13.11   0.000    -.9448718    -.699072
         11  |  -.8855433   .0665126   -13.31   0.000    -1.015916   -.7551702
         12  |  -.9327545   .0705568   -13.22   0.000    -1.071055   -.7944541
         13  |   -.969992   .0746754   -12.99   0.000    -1.116365   -.8236187
         14  |  -1.025316   .0787755   -13.02   0.000    -1.179726   -.8709062
         15  |  -1.059083   .0827485   -12.80   0.000    -1.221281   -.8968855
         16  |  -1.123581   .0866755   -12.96   0.000    -1.293476   -.9536855
         17  |  -1.175874   .0907734   -12.95   0.000    -1.353801   -.9979463
         18  |  -1.265238   .0947229   -13.36   0.000    -1.450906   -1.079569
         19  |  -1.331661   .0985027   -13.52   0.000    -1.524738   -1.138583
         20  |  -1.384126    .102026   -13.57   0.000     -1.58411   -1.184142
         21  |  -1.446917   .1054998   -13.71   0.000     -1.65371   -1.240124
         22  |  -1.500472   .1088381   -13.79   0.000    -1.713809   -1.287136
         23  |   -1.54538   .1121874   -13.77   0.000    -1.765282   -1.325479
         24  |  -1.598877   .1159696   -13.79   0.000    -1.826192   -1.371561
         25  |  -1.628872   .1198156   -13.59   0.000    -1.863726   -1.394019
         26  |   .5096764   .0718874     7.09   0.000     .3687678    .6505849
         27  |   .3451116   .0676155     5.10   0.000     .2125765    .4776467
         28  |   .2205185   .0654676     3.37   0.001     .0921937    .3488434
         29  |   .0827143   .0647868     1.28   0.202    -.0442762    .2097047
         30  |  -.0287486   .0642207    -0.45   0.654    -.1546294    .0971322
         31  |  -.0980848   .0652834    -1.50   0.133    -.2260486     .029879
         32  |  -.1799701   .0660358    -2.73   0.006    -.3094086   -.0505315
         33  |  -.2653565   .0681539    -3.89   0.000    -.3989467   -.1317662
         34  |  -.3386728   .0703653    -4.81   0.000    -.4765977   -.2007479
         35  |  -.4057856   .0729726    -5.56   0.000    -.5488211     -.26275
         36  |  -.4856785   .0754149    -6.44   0.000    -.6335013   -.3378556
         37  |  -.5639984   .0782643    -7.21   0.000    -.7174064   -.4105904
         38  |  -.6475606   .0814786    -7.95   0.000    -.8072691   -.4878521
         39  |  -.7159113   .0851376    -8.41   0.000    -.8827918   -.5490308
         40  |  -.7523477   .0889785    -8.46   0.000     -.926757   -.5779385
         41  |  -.7913397   .0923023    -8.57   0.000    -.9722641   -.6104154
         42  |  -.8546472   .0957816    -8.92   0.000    -1.042391   -.6669031
         43  |   -.983682   .0996175    -9.87   0.000    -1.178945    -.788419
         44  |  -1.034011   .1037601    -9.97   0.000    -1.237394   -.8306277
         45  |  -1.060269   .1074782    -9.86   0.000    -1.270939   -.8495975
         46  |  -1.088835   .1111527    -9.80   0.000    -1.306709   -.8709618
         47  |  -1.124711   .1144039    -9.83   0.000    -1.348957   -.9004647
         48  |   -1.14645   .1179238    -9.72   0.000    -1.377596   -.9153045
         49  |  -1.197904   .1215206    -9.86   0.000      -1.4361    -.959708
         50  |  -1.234043   .1245348    -9.91   0.000    -1.478147   -.9899385
             |
     age_cat |
          1  |   .4135665   .0188955    21.89   0.000     .3765289    .4506042
          2  |   .7106579    .022044    32.24   0.000     .6674488    .7538669
          3  |    .929381   .0257429    36.10   0.000     .8789216    .9798404
          4  |   1.111649    .029553    37.62   0.000     1.053721    1.169577
          5  |   1.269038   .0336862    37.67   0.000     1.203008    1.335067
          6  |   1.396844   .0378929    36.86   0.000     1.322569    1.471118
          7  |   1.501421   .0422601    35.53   0.000     1.418586    1.584257
          8  |    1.59954    .046722    34.24   0.000     1.507959    1.691121
          9  |   1.674778   .0510808    32.79   0.000     1.574653    1.774903
         10  |   1.745331    .055407    31.50   0.000     1.636726    1.853935
         11  |   1.817432   .0598014    30.39   0.000     1.700214     1.93465
         12  |   1.887298   .0641947    29.40   0.000     1.761469    2.013128
         13  |   1.951223   .0685649    28.46   0.000     1.816827    2.085619
         14  |   1.996718   .0731055    27.31   0.000     1.853422    2.140014
         15  |   2.044253   .0776175    26.34   0.000     1.892113    2.196393
         16  |   2.080221   .0821356    25.33   0.000     1.919225    2.241217
         17  |   2.116882   .0867582    24.40   0.000     1.946825     2.28694
         18  |   2.169709   .0910908    23.82   0.000     1.991159    2.348258
         19  |   2.208228   .0958619    23.04   0.000     2.020327     2.39613
         20  |    2.28648   .1042896    21.92   0.000     2.082059    2.490901
         25  |   2.407315     .11784    20.43   0.000     2.176334    2.638297
         30  |   2.174481   .1531644    14.20   0.000     1.874259    2.474703
         40  |   2.093298   .1717557    12.19   0.000     1.756635    2.429961
         50  |    2.04987   .1732745    11.83   0.000      1.71023     2.38951
             |
       _cons |   3.017619    .046045    65.54   0.000     2.927365    3.107873
-------------+----------------------------------------------------------------
     sigma_u |  1.1435986
     sigma_e |  .64575039
         rho |  .75823814   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[during_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         connect(stepstair) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle("") title(`title') legend(off) aspect(.5) plotregion(style(none)) x
> size(16) ysize(10))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 14528) =   12.62
            Prob > F =    0.0004

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14528) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 14528) =    0.06
            Prob > F =    0.8138

 ( 1)  - during_DD + during_DE = 0

       F(  1, 14528) =    0.21
            Prob > F =    0.6497
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 14528) =    0.02
            Prob > F =    0.8880

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14528) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 14528) =    1.51
            Prob > F =    0.2191

 ( 1)  - during_ED + during_EE = 0

       F(  1, 14528) =    0.75
            Prob > F =    0.3858

. 
. graph export output/figure/`fname'_tree.png, width(1600) replace
(file output/figure/lnL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.1726                         Obs per group: min =         1
       between = 0.0597                                        avg =       9.0
       overall = 0.0748                                        max =        25

                                                F(82,14528)        =     75.35
corr(u_i, Xb)  = -0.0400                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0176613   .0490515     0.36   0.719    -.0784859    .1138085
   during_DD |   .0026528   .0129522     0.20   0.838    -.0227351    .0280407
   during_DE |  -.0660191   .0674761    -0.98   0.328    -.1982808    .0662426
   during_ED |  -.1490513   .0547672    -2.72   0.007    -.2564021   -.0417006
   during_EE |  -.1290826   .0678447    -1.90   0.057    -.2620669    .0039018
    after_DD |  -.0293411   .0244567    -1.20   0.230    -.0772792    .0185971
    after_DE |  -.1710703   .0833879    -2.05   0.040    -.3345211   -.0076195
    after_ED |  -.1783506   .0682257    -2.61   0.009    -.3120817   -.0446195
    after_EE |  -.2592436   .0881685    -2.94   0.003    -.4320651   -.0864221
             |
    ind_year |
          2  |   .1589602   .0352279     4.51   0.000      .089909    .2280114
          3  |   .8150451   .0434515    18.76   0.000     .7298747    .9002155
          4  |   .9926849   .0494177    20.09   0.000     .8958199     1.08955
          5  |   1.164766   .0545947    21.33   0.000     1.057754    1.271779
          6  |   1.410997   .0597718    23.61   0.000     1.293836    1.528157
          7  |   1.700613   .0651141    26.12   0.000     1.572981    1.828245
          8  |   1.913297   .0705048    27.14   0.000     1.775099    2.051496
          9  |   2.058151   .0759184    27.11   0.000     1.909342    2.206961
         10  |   2.203537   .0821953    26.81   0.000     2.042424    2.364651
         11  |   2.361981   .0880906    26.81   0.000     2.189312     2.53465
         12  |    2.42456   .0943716    25.69   0.000      2.23958     2.60954
         13  |   2.487664   .1007511    24.69   0.000     2.290179    2.685149
         14  |   2.508043   .1071776    23.40   0.000     2.297962    2.718125
         15  |   2.483529    .113709    21.84   0.000     2.260645    2.706413
         16  |   2.541668   .1199334    21.19   0.000     2.306584    2.776753
         17  |    2.57411   .1265385    20.34   0.000     2.326078    2.822142
         18  |   2.584326    .133007    19.43   0.000     2.323615    2.845037
         19  |   2.547558   .1394557    18.27   0.000     2.274207    2.820909
         20  |   2.550685   .1457123    17.50   0.000      2.26507      2.8363
         21  |   2.581704   .1511639    17.08   0.000     2.285404    2.878005
         22  |   2.621506   .1565633    16.74   0.000     2.314622     2.92839
         23  |   2.735666   .1619489    16.89   0.000     2.418226    3.053106
         24  |   2.535626   .1682617    15.07   0.000     2.205811     2.86544
         25  |   2.529577   .1744256    14.50   0.000     2.187681    2.871473
         26  |   .4652854   .0842557     5.52   0.000     .3001334    .6304373
         27  |   .5895689   .0750735     7.85   0.000     .4424152    .7367225
         28  |   .9108963   .0703181    12.95   0.000     .7730639    1.048729
         29  |   1.073693   .0695612    15.44   0.000     .9373438    1.210042
         30  |   1.199143   .0709346    16.90   0.000     1.060102    1.338183
         31  |   1.361987   .0733998    18.56   0.000     1.218114     1.50586
         32  |       1.59   .0760177    20.92   0.000     1.440995    1.739004
         33  |   1.751544   .0801617    21.85   0.000     1.594417    1.908671
         34  |   1.882263   .0847462    22.21   0.000      1.71615    2.048376
         35  |   2.000466   .0898408    22.27   0.000     1.824366    2.176565
         36  |   2.135595   .0951912    22.43   0.000     1.949009    2.322182
         37  |   2.265675   .1006242    22.52   0.000     2.068438    2.462911
         38  |   2.338882   .1062312    22.02   0.000     2.130655    2.547109
         39  |   2.369408   .1120531    21.15   0.000      2.14977    2.589047
         40  |   2.383777    .117906    20.22   0.000     2.152666    2.614888
         41  |   2.415972   .1240776    19.47   0.000     2.172764     2.65918
         42  |   2.499972   .1306587    19.13   0.000     2.243864     2.75608
         43  |   2.549606   .1373604    18.56   0.000     2.280362     2.81885
         44  |    2.54022   .1441191    17.63   0.000     2.257728    2.822711
         45  |   2.573178   .1502873    17.12   0.000     2.278596    2.867761
         46  |   2.574477   .1566205    16.44   0.000      2.26748    2.881473
         47  |   2.612951   .1620788    16.12   0.000     2.295256    2.930646
         48  |     2.6947   .1670851    16.13   0.000     2.367192    3.022208
         49  |   2.623136   .1730833    15.16   0.000     2.283871    2.962401
         50  |    2.64409   .1783768    14.82   0.000     2.294449    2.993731
             |
     age_cat |
          1  |    .092684   .0297447     3.12   0.002     .0343805    .1509874
          2  |   .1386204   .0341105     4.06   0.000     .0717596    .2054812
          3  |   .1499635   .0386324     3.88   0.000      .074239     .225688
          4  |   .1729883   .0437918     3.95   0.000     .0871507    .2588259
          5  |    .164045   .0493974     3.32   0.001     .0672198    .2608702
          6  |   .1384545   .0553429     2.50   0.012     .0299753    .2469337
          7  |   .1393187   .0615294     2.26   0.024     .0187133     .259924
          8  |   .1355354   .0679609     1.99   0.046     .0023234    .2687473
          9  |   .1404448   .0743713     1.89   0.059    -.0053324    .2862221
         10  |   .1361639   .0809525     1.68   0.093    -.0225134    .2948411
         11  |   .1292836   .0876492     1.48   0.140      -.04252    .3010873
         12  |   .1237933   .0941152     1.32   0.188    -.0606845     .308271
         13  |   .1069053   .1007848     1.06   0.289    -.0906457    .3044562
         14  |   .1126957   .1075516     1.05   0.295    -.0981191    .3235104
         15  |   .1170188   .1143645     1.02   0.306      -.10715    .3411877
         16  |   .0995094   .1214487     0.82   0.413    -.1385455    .3375643
         17  |   .0864119   .1284628     0.67   0.501    -.1653915    .3382152
         18  |   .0961664   .1353663     0.71   0.477    -.1691688    .3615016
         19  |   .0762071   .1425524     0.53   0.593    -.2032138    .3556279
         20  |   .0387439   .1564251     0.25   0.804    -.2678692    .3453571
         25  |  -.0223617   .1794549    -0.12   0.901    -.3741162    .3293927
         30  |   .0441315   .2204645     0.20   0.841    -.3880069      .47627
         40  |   .2095827   .2541338     0.82   0.410     -.288552    .7077173
         50  |   .2675391   .2785684     0.96   0.337    -.2784904    .8135686
             |
       _cons |   3.806445   .0577438    65.92   0.000      3.69326     3.91963
-------------+----------------------------------------------------------------
     sigma_u |  1.7085474
     sigma_e |   .8829132
         rho |   .7892389   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .1726427968668238

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.1726                                         min =          1
     between = 0.0597                                         avg =        9.0
     overall = 0.0748                                         max =         25

                                                F(82,14528)       =      75.35
corr(u_i, Xb)  = -0.0400                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0176613   .0490515     0.36   0.719    -.0784859    .1138085
   during_DD |   .0026528   .0129522     0.20   0.838    -.0227351    .0280407
   during_DE |  -.0660191   .0674761    -0.98   0.328    -.1982808    .0662426
   during_ED |  -.1490513   .0547672    -2.72   0.007    -.2564021   -.0417006
   during_EE |  -.1290826   .0678447    -1.90   0.057    -.2620669    .0039018
    after_DD |  -.0293411   .0244567    -1.20   0.230    -.0772792    .0185971
    after_DE |  -.1710703   .0833879    -2.05   0.040    -.3345211   -.0076195
    after_ED |  -.1783506   .0682257    -2.61   0.009    -.3120817   -.0446195
    after_EE |  -.2592436   .0881685    -2.94   0.003    -.4320651   -.0864221
             |
    ind_year |
          2  |   .1589602   .0352279     4.51   0.000      .089909    .2280114
          3  |   .8150451   .0434515    18.76   0.000     .7298747    .9002155
          4  |   .9926849   .0494177    20.09   0.000     .8958199     1.08955
          5  |   1.164766   .0545947    21.33   0.000     1.057754    1.271779
          6  |   1.410997   .0597718    23.61   0.000     1.293836    1.528157
          7  |   1.700613   .0651141    26.12   0.000     1.572981    1.828245
          8  |   1.913297   .0705048    27.14   0.000     1.775099    2.051496
          9  |   2.058151   .0759184    27.11   0.000     1.909342    2.206961
         10  |   2.203537   .0821953    26.81   0.000     2.042424    2.364651
         11  |   2.361981   .0880906    26.81   0.000     2.189312     2.53465
         12  |    2.42456   .0943716    25.69   0.000      2.23958     2.60954
         13  |   2.487664   .1007511    24.69   0.000     2.290179    2.685149
         14  |   2.508043   .1071776    23.40   0.000     2.297962    2.718125
         15  |   2.483529    .113709    21.84   0.000     2.260645    2.706413
         16  |   2.541668   .1199334    21.19   0.000     2.306584    2.776753
         17  |    2.57411   .1265385    20.34   0.000     2.326078    2.822142
         18  |   2.584326    .133007    19.43   0.000     2.323615    2.845037
         19  |   2.547558   .1394557    18.27   0.000     2.274207    2.820909
         20  |   2.550685   .1457123    17.50   0.000      2.26507      2.8363
         21  |   2.581704   .1511639    17.08   0.000     2.285404    2.878005
         22  |   2.621506   .1565633    16.74   0.000     2.314622     2.92839
         23  |   2.735666   .1619489    16.89   0.000     2.418226    3.053106
         24  |   2.535626   .1682617    15.07   0.000     2.205811     2.86544
         25  |   2.529577   .1744256    14.50   0.000     2.187681    2.871473
         26  |   .4652854   .0842557     5.52   0.000     .3001334    .6304373
         27  |   .5895689   .0750735     7.85   0.000     .4424152    .7367225
         28  |   .9108963   .0703181    12.95   0.000     .7730639    1.048729
         29  |   1.073693   .0695612    15.44   0.000     .9373438    1.210042
         30  |   1.199143   .0709346    16.90   0.000     1.060102    1.338183
         31  |   1.361987   .0733998    18.56   0.000     1.218114     1.50586
         32  |       1.59   .0760177    20.92   0.000     1.440995    1.739004
         33  |   1.751544   .0801617    21.85   0.000     1.594417    1.908671
         34  |   1.882263   .0847462    22.21   0.000      1.71615    2.048376
         35  |   2.000466   .0898408    22.27   0.000     1.824366    2.176565
         36  |   2.135595   .0951912    22.43   0.000     1.949009    2.322182
         37  |   2.265675   .1006242    22.52   0.000     2.068438    2.462911
         38  |   2.338882   .1062312    22.02   0.000     2.130655    2.547109
         39  |   2.369408   .1120531    21.15   0.000      2.14977    2.589047
         40  |   2.383777    .117906    20.22   0.000     2.152666    2.614888
         41  |   2.415972   .1240776    19.47   0.000     2.172764     2.65918
         42  |   2.499972   .1306587    19.13   0.000     2.243864     2.75608
         43  |   2.549606   .1373604    18.56   0.000     2.280362     2.81885
         44  |    2.54022   .1441191    17.63   0.000     2.257728    2.822711
         45  |   2.573178   .1502873    17.12   0.000     2.278596    2.867761
         46  |   2.574477   .1566205    16.44   0.000      2.26748    2.881473
         47  |   2.612951   .1620788    16.12   0.000     2.295256    2.930646
         48  |     2.6947   .1670851    16.13   0.000     2.367192    3.022208
         49  |   2.623136   .1730833    15.16   0.000     2.283871    2.962401
         50  |    2.64409   .1783768    14.82   0.000     2.294449    2.993731
             |
     age_cat |
          1  |    .092684   .0297447     3.12   0.002     .0343805    .1509874
          2  |   .1386204   .0341105     4.06   0.000     .0717596    .2054812
          3  |   .1499635   .0386324     3.88   0.000      .074239     .225688
          4  |   .1729883   .0437918     3.95   0.000     .0871507    .2588259
          5  |    .164045   .0493974     3.32   0.001     .0672198    .2608702
          6  |   .1384545   .0553429     2.50   0.012     .0299753    .2469337
          7  |   .1393187   .0615294     2.26   0.024     .0187133     .259924
          8  |   .1355354   .0679609     1.99   0.046     .0023234    .2687473
          9  |   .1404448   .0743713     1.89   0.059    -.0053324    .2862221
         10  |   .1361639   .0809525     1.68   0.093    -.0225134    .2948411
         11  |   .1292836   .0876492     1.48   0.140      -.04252    .3010873
         12  |   .1237933   .0941152     1.32   0.188    -.0606845     .308271
         13  |   .1069053   .1007848     1.06   0.289    -.0906457    .3044562
         14  |   .1126957   .1075516     1.05   0.295    -.0981191    .3235104
         15  |   .1170188   .1143645     1.02   0.306      -.10715    .3411877
         16  |   .0995094   .1214487     0.82   0.413    -.1385455    .3375643
         17  |   .0864119   .1284628     0.67   0.501    -.1653915    .3382152
         18  |   .0961664   .1353663     0.71   0.477    -.1691688    .3615016
         19  |   .0762071   .1425524     0.53   0.593    -.2032138    .3556279
         20  |   .0387439   .1564251     0.25   0.804    -.2678692    .3453571
         25  |  -.0223617   .1794549    -0.12   0.901    -.3741162    .3293927
         30  |   .0441315   .2204645     0.20   0.841    -.3880069      .47627
         40  |   .2095827   .2541338     0.82   0.410     -.288552    .7077173
         50  |   .2675391   .2785684     0.96   0.337    -.2784904    .8135686
             |
       _cons |   3.806445   .0577438    65.92   0.000      3.69326     3.91963
-------------+----------------------------------------------------------------
     sigma_u |  1.7085474
     sigma_e |   .8829132
         rho |   .7892389   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[during_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         connect(stepstair) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle("") title(`title') legend(off) aspect(.5) plotregion(style(none)) x
> size(16) ysize(10))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 14528) =    0.04
            Prob > F =    0.8377

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14528) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 14528) =    0.96
            Prob > F =    0.3279

 ( 1)  - during_DD + during_DE = 0

       F(  1, 14528) =    1.00
            Prob > F =    0.3178
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 14528) =    7.41
            Prob > F =    0.0065

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14528) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 14528) =    3.62
            Prob > F =    0.0571

 ( 1)  - during_ED + during_EE = 0

       F(  1, 14528) =    0.05
            Prob > F =    0.8146

. 
. graph export output/figure/`fname'_tree.png, width(1600) replace
(file output/figure/lnKL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.2314                         Obs per group: min =         1
       between = 0.1408                                        avg =       9.0
       overall = 0.1245                                        max =        25

                                                F(82,14528)        =    109.25
corr(u_i, Xb)  = 0.0151                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0730235   .0270835     2.70   0.007     .0199365    .1261105
   during_DD |   .0266992    .007676     3.48   0.001     .0116534    .0417451
   during_DE |   .1537912   .0421875     3.65   0.000     .0710983    .2364841
   during_ED |   .1193135   .0314272     3.80   0.000     .0577123    .1809148
   during_EE |    .185759   .0403506     4.60   0.000     .1066667    .2648514
    after_DD |    .031981   .0149838     2.13   0.033     .0026108    .0613512
    after_DE |   .2647894    .050607     5.23   0.000     .1655932    .3639856
    after_ED |   .2204937   .0474232     4.65   0.000     .1275381    .3134493
    after_EE |   .2558016   .0517187     4.95   0.000     .1544263    .3571769
             |
    ind_year |
          2  |   .1002916   .0212888     4.71   0.000     .0585629    .1420203
          3  |   .2930826   .0258955    11.32   0.000     .2423241    .3438411
          4  |   .4924146   .0274771    17.92   0.000      .438556    .5462731
          5  |   .6586679   .0302322    21.79   0.000     .5994089    .7179268
          6  |   .8472458   .0335024    25.29   0.000     .7815769    .9129147
          7  |   .9775751   .0361029    27.08   0.000     .9068088    1.048341
          8  |   1.048737   .0388193    27.02   0.000     .9726461    1.124828
          9  |   1.173594   .0415931    28.22   0.000     1.092066    1.255122
         10  |   1.290141   .0448607    28.76   0.000     1.202208    1.378074
         11  |   1.358693   .0479059    28.36   0.000     1.264791    1.452594
         12  |   1.388926    .051092    27.18   0.000     1.288779    1.489073
         13  |   1.436932   .0541378    26.54   0.000     1.330816    1.543049
         14  |   1.479477   .0571714    25.88   0.000     1.367414    1.591541
         15  |   1.553689   .0606526    25.62   0.000     1.434802    1.672576
         16  |   1.593247   .0632673    25.18   0.000     1.469235    1.717259
         17  |   1.651805   .0666207    24.79   0.000      1.52122     1.78239
         18  |   1.583967   .0697754    22.70   0.000     1.447199    1.720736
         19  |   1.612654   .0728704    22.13   0.000     1.469818    1.755489
         20  |   1.661389   .0758894    21.89   0.000     1.512636    1.810142
         21  |   1.683933   .0787323    21.39   0.000     1.529607    1.838258
         22  |   1.740445   .0813793    21.39   0.000     1.580931    1.899959
         23  |     1.7937    .084008    21.35   0.000     1.629033    1.958366
         24  |   1.827888   .0870194    21.01   0.000     1.657319    1.998457
         25  |   1.823115   .0896181    20.34   0.000     1.647453    1.998778
         26  |  -.2557893   .0476176    -5.37   0.000    -.3491259   -.1624527
         27  |  -.1146545   .0450456    -2.55   0.011    -.2029495   -.0263594
         28  |   .0573443   .0432907     1.32   0.185    -.0275109    .1421995
         29  |   .2933128   .0431416     6.80   0.000     .2087497    .3778758
         30  |   .4739717   .0431709    10.98   0.000     .3893513    .5585921
         31  |   .6301297   .0442947    14.23   0.000     .5433065    .7169529
         32  |   .7828154   .0456002    17.17   0.000     .6934331    .8721976
         33  |   .8461984   .0471798    17.94   0.000     .7537199    .9386768
         34  |          1     .04931    20.28   0.000     .9033463    1.096654
         35  |   1.091388   .0510944    21.36   0.000     .9912364    1.191539
         36  |   1.144433   .0536647    21.33   0.000     1.039243    1.249623
         37  |   1.210699   .0562371    21.53   0.000     1.100468    1.320931
         38  |    1.29384   .0588261    21.99   0.000     1.178533    1.409146
         39  |   1.335788   .0616025    21.68   0.000     1.215039    1.456537
         40  |   1.433695   .0651636    22.00   0.000     1.305966    1.561424
         41  |   1.510557   .0673856    22.42   0.000     1.378473    1.642642
         42  |   1.590797   .0701161    22.69   0.000      1.45336    1.728233
         43  |   1.567949   .0732697    21.40   0.000     1.424331    1.711566
         44  |   1.608649   .0763984    21.06   0.000     1.458898    1.758399
         45  |   1.681878   .0793091    21.21   0.000     1.526422    1.837334
         46  |   1.684809   .0822007    20.50   0.000     1.523685    1.845933
         47  |   1.713761   .0844589    20.29   0.000     1.548211    1.879311
         48  |   1.774872    .086879    20.43   0.000     1.604578    1.945166
         49  |   1.786162   .0901305    19.82   0.000     1.609495    1.962829
         50  |   1.825964   .0926294    19.71   0.000     1.644398    2.007529
             |
     age_cat |
          1  |    .254232   .0174058    14.61   0.000     .2201144    .2883497
          2  |   .2545934   .0193452    13.16   0.000     .2166744    .2925124
          3  |   .2309565    .021623    10.68   0.000     .1885727    .2733403
          4  |   .2189422   .0239703     9.13   0.000     .1719574     .265927
          5  |   .2087107   .0266213     7.84   0.000     .1565297    .2608918
          6  |   .1923922   .0295896     6.50   0.000     .1343929    .2503915
          7  |    .198741   .0326764     6.08   0.000     .1346911    .2627908
          8  |   .1846214   .0358273     5.15   0.000     .1143953    .2548475
          9  |   .1770558   .0390025     4.54   0.000      .100606    .2535056
         10  |    .163198   .0422461     3.86   0.000     .0803902    .2460058
         11  |   .1639605   .0455903     3.60   0.000     .0745977    .2533233
         12  |   .1545809   .0489374     3.16   0.002     .0586575    .2505044
         13  |   .1429848   .0522345     2.74   0.006     .0405986     .245371
         14  |   .1448752   .0556052     2.61   0.009     .0358819    .2538684
         15  |   .1388787    .059016     2.35   0.019     .0231998    .2545576
         16  |    .136357   .0623682     2.19   0.029     .0141075    .2586066
         17  |   .1210513   .0659695     1.83   0.067    -.0082573    .2503599
         18  |    .117935    .069432     1.70   0.089    -.0181605    .2540305
         19  |    .095909   .0732082     1.31   0.190    -.0475883    .2394064
         20  |   .0619159   .0800153     0.77   0.439    -.0949242    .2187561
         25  |   .0201604   .0912596     0.22   0.825      -.15872    .1990408
         30  |   .0151024   .1208633     0.12   0.901     -.221805    .2520099
         40  |   .0490548   .1348254     0.36   0.716    -.2152201    .3133297
         50  |   .0334867   .1474395     0.23   0.820    -.2555135    .3224869
             |
       _cons |   7.506628   .0336019   223.40   0.000     7.440764    7.572492
-------------+----------------------------------------------------------------
     sigma_u |  1.1608733
     sigma_e |  .53392907
         rho |  .82539412   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2313749453697261

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.2314                                         min =          1
     between = 0.1408                                         avg =        9.0
     overall = 0.1245                                         max =         25

                                                F(82,14528)       =     109.25
corr(u_i, Xb)  = 0.0151                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0730235   .0270835     2.70   0.007     .0199365    .1261105
   during_DD |   .0266992    .007676     3.48   0.001     .0116534    .0417451
   during_DE |   .1537912   .0421875     3.65   0.000     .0710983    .2364841
   during_ED |   .1193135   .0314272     3.80   0.000     .0577123    .1809148
   during_EE |    .185759   .0403506     4.60   0.000     .1066667    .2648514
    after_DD |    .031981   .0149838     2.13   0.033     .0026108    .0613512
    after_DE |   .2647894    .050607     5.23   0.000     .1655932    .3639856
    after_ED |   .2204937   .0474232     4.65   0.000     .1275381    .3134493
    after_EE |   .2558016   .0517187     4.95   0.000     .1544263    .3571769
             |
    ind_year |
          2  |   .1002916   .0212888     4.71   0.000     .0585629    .1420203
          3  |   .2930826   .0258955    11.32   0.000     .2423241    .3438411
          4  |   .4924146   .0274771    17.92   0.000      .438556    .5462731
          5  |   .6586679   .0302322    21.79   0.000     .5994089    .7179268
          6  |   .8472458   .0335024    25.29   0.000     .7815769    .9129147
          7  |   .9775751   .0361029    27.08   0.000     .9068088    1.048341
          8  |   1.048737   .0388193    27.02   0.000     .9726461    1.124828
          9  |   1.173594   .0415931    28.22   0.000     1.092066    1.255122
         10  |   1.290141   .0448607    28.76   0.000     1.202208    1.378074
         11  |   1.358693   .0479059    28.36   0.000     1.264791    1.452594
         12  |   1.388926    .051092    27.18   0.000     1.288779    1.489073
         13  |   1.436932   .0541378    26.54   0.000     1.330816    1.543049
         14  |   1.479477   .0571714    25.88   0.000     1.367414    1.591541
         15  |   1.553689   .0606526    25.62   0.000     1.434802    1.672576
         16  |   1.593247   .0632673    25.18   0.000     1.469235    1.717259
         17  |   1.651805   .0666207    24.79   0.000      1.52122     1.78239
         18  |   1.583967   .0697754    22.70   0.000     1.447199    1.720736
         19  |   1.612654   .0728704    22.13   0.000     1.469818    1.755489
         20  |   1.661389   .0758894    21.89   0.000     1.512636    1.810142
         21  |   1.683933   .0787323    21.39   0.000     1.529607    1.838258
         22  |   1.740445   .0813793    21.39   0.000     1.580931    1.899959
         23  |     1.7937    .084008    21.35   0.000     1.629033    1.958366
         24  |   1.827888   .0870194    21.01   0.000     1.657319    1.998457
         25  |   1.823115   .0896181    20.34   0.000     1.647453    1.998778
         26  |  -.2557893   .0476176    -5.37   0.000    -.3491259   -.1624527
         27  |  -.1146545   .0450456    -2.55   0.011    -.2029495   -.0263594
         28  |   .0573443   .0432907     1.32   0.185    -.0275109    .1421995
         29  |   .2933128   .0431416     6.80   0.000     .2087497    .3778758
         30  |   .4739717   .0431709    10.98   0.000     .3893513    .5585921
         31  |   .6301297   .0442947    14.23   0.000     .5433065    .7169529
         32  |   .7828154   .0456002    17.17   0.000     .6934331    .8721976
         33  |   .8461984   .0471798    17.94   0.000     .7537199    .9386768
         34  |          1     .04931    20.28   0.000     .9033463    1.096654
         35  |   1.091388   .0510944    21.36   0.000     .9912364    1.191539
         36  |   1.144433   .0536647    21.33   0.000     1.039243    1.249623
         37  |   1.210699   .0562371    21.53   0.000     1.100468    1.320931
         38  |    1.29384   .0588261    21.99   0.000     1.178533    1.409146
         39  |   1.335788   .0616025    21.68   0.000     1.215039    1.456537
         40  |   1.433695   .0651636    22.00   0.000     1.305966    1.561424
         41  |   1.510557   .0673856    22.42   0.000     1.378473    1.642642
         42  |   1.590797   .0701161    22.69   0.000      1.45336    1.728233
         43  |   1.567949   .0732697    21.40   0.000     1.424331    1.711566
         44  |   1.608649   .0763984    21.06   0.000     1.458898    1.758399
         45  |   1.681878   .0793091    21.21   0.000     1.526422    1.837334
         46  |   1.684809   .0822007    20.50   0.000     1.523685    1.845933
         47  |   1.713761   .0844589    20.29   0.000     1.548211    1.879311
         48  |   1.774872    .086879    20.43   0.000     1.604578    1.945166
         49  |   1.786162   .0901305    19.82   0.000     1.609495    1.962829
         50  |   1.825964   .0926294    19.71   0.000     1.644398    2.007529
             |
     age_cat |
          1  |    .254232   .0174058    14.61   0.000     .2201144    .2883497
          2  |   .2545934   .0193452    13.16   0.000     .2166744    .2925124
          3  |   .2309565    .021623    10.68   0.000     .1885727    .2733403
          4  |   .2189422   .0239703     9.13   0.000     .1719574     .265927
          5  |   .2087107   .0266213     7.84   0.000     .1565297    .2608918
          6  |   .1923922   .0295896     6.50   0.000     .1343929    .2503915
          7  |    .198741   .0326764     6.08   0.000     .1346911    .2627908
          8  |   .1846214   .0358273     5.15   0.000     .1143953    .2548475
          9  |   .1770558   .0390025     4.54   0.000      .100606    .2535056
         10  |    .163198   .0422461     3.86   0.000     .0803902    .2460058
         11  |   .1639605   .0455903     3.60   0.000     .0745977    .2533233
         12  |   .1545809   .0489374     3.16   0.002     .0586575    .2505044
         13  |   .1429848   .0522345     2.74   0.006     .0405986     .245371
         14  |   .1448752   .0556052     2.61   0.009     .0358819    .2538684
         15  |   .1388787    .059016     2.35   0.019     .0231998    .2545576
         16  |    .136357   .0623682     2.19   0.029     .0141075    .2586066
         17  |   .1210513   .0659695     1.83   0.067    -.0082573    .2503599
         18  |    .117935    .069432     1.70   0.089    -.0181605    .2540305
         19  |    .095909   .0732082     1.31   0.190    -.0475883    .2394064
         20  |   .0619159   .0800153     0.77   0.439    -.0949242    .2187561
         25  |   .0201604   .0912596     0.22   0.825      -.15872    .1990408
         30  |   .0151024   .1208633     0.12   0.901     -.221805    .2520099
         40  |   .0490548   .1348254     0.36   0.716    -.2152201    .3133297
         50  |   .0334867   .1474395     0.23   0.820    -.2555135    .3224869
             |
       _cons |   7.506628   .0336019   223.40   0.000     7.440764    7.572492
-------------+----------------------------------------------------------------
     sigma_u |  1.1608733
     sigma_e |  .53392907
         rho |  .82539412   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[during_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         connect(stepstair) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle("") title(`title') legend(off) aspect(.5) plotregion(style(none)) x
> size(16) ysize(10))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 14528) =   12.10
            Prob > F =    0.0005

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14528) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 14528) =   13.29
            Prob > F =    0.0003

 ( 1)  - during_DD + during_DE = 0

       F(  1, 14528) =    8.81
            Prob > F =    0.0030
variable label was str11 now str13
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 14528) =   14.41
            Prob > F =    0.0001

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14528) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 14528) =   21.19
            Prob > F =    0.0000

 ( 1)  - during_ED + during_EE = 0

       F(  1, 14528) =    1.79
            Prob > F =    0.1814

. 
. graph export output/figure/`fname'_tree.png, width(1600) replace
(file output/figure/lnQL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    354772
Group variable: firm_person                     Number of groups   =     39630

R-sq:  within  = 0.0480                         Obs per group: min =         1
       between = 0.0770                                        avg =       9.0
       overall = 0.0625                                        max =        25

                                                F(82,14528)        =     26.05
corr(u_i, Xb)  = 0.1072                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0221698   .0128306     1.73   0.084    -.0029798    .0473194
   during_DD |  -.0058296   .0035932    -1.62   0.105    -.0128726    .0012135
   during_DE |     .02578    .018271     1.41   0.158    -.0100335    .0615936
   during_ED |    .001791   .0164848     0.11   0.913    -.0305214    .0341034
   during_EE |   .0193781   .0190506     1.02   0.309    -.0179635    .0567198
    after_DD |  -.0201178   .0062855    -3.20   0.001    -.0324381   -.0077975
    after_DE |  -.0000498   .0200955    -0.00   0.998    -.0394396      .03934
    after_ED |   -.029995   .0189728    -1.58   0.114    -.0671841    .0071941
    after_EE |   .0133302   .0235322     0.57   0.571    -.0327959    .0594564
             |
    ind_year |
          2  |  -.0175919   .0103585    -1.70   0.089    -.0378959    .0027122
          3  |  -.0354259   .0125038    -2.83   0.005    -.0599349   -.0109169
          4  |  -.0445866   .0133419    -3.34   0.001    -.0707384   -.0184347
          5  |  -.0367618   .0148037    -2.48   0.013     -.065779   -.0077446
          6  |  -.0458231   .0159413    -2.87   0.004    -.0770701    -.014576
          7  |  -.0507619   .0171748    -2.96   0.003    -.0844267   -.0170972
          8  |  -.0614595   .0183118    -3.36   0.001    -.0973529    -.025566
          9  |  -.0642977   .0197665    -3.25   0.001    -.1030425   -.0255528
         10  |  -.0643361   .0210838    -3.05   0.002    -.1056631   -.0230091
         11  |  -.0720303   .0225292    -3.20   0.001    -.1161905   -.0278701
         12  |  -.0731651   .0238958    -3.06   0.002     -.120004   -.0263263
         13  |  -.0681583   .0254508    -2.68   0.007    -.1180451   -.0182716
         14  |  -.0601724   .0270296    -2.23   0.026    -.1131539   -.0071909
         15  |  -.0502804   .0285462    -1.76   0.078    -.1062345    .0056738
         16  |  -.0375097    .030044    -1.25   0.212    -.0963998    .0213804
         17  |  -.0231215   .0316246    -0.73   0.465    -.0851097    .0388668
         18  |  -.0195664   .0332946    -0.59   0.557    -.0848281    .0456953
         19  |  -.0150269   .0348566    -0.43   0.666    -.0833503    .0532965
         20  |  -.0083025   .0363163    -0.23   0.819    -.0794869     .062882
         21  |  -.0142535   .0377307    -0.38   0.706    -.0882104    .0597035
         22  |  -.0077589   .0390469    -0.20   0.842    -.0842959    .0687781
         23  |  -.0118149   .0404233    -0.29   0.770    -.0910498      .06742
         24  |  -.1207655   .0418325    -2.89   0.004    -.2027626   -.0387685
         25  |  -.1562798   .0434011    -3.60   0.000    -.2413515   -.0712082
         26  |  -.0180427   .0253092    -0.71   0.476    -.0676519    .0315666
         27  |  -.0133972   .0223488    -0.60   0.549    -.0572038    .0304094
         28  |   .0079815    .021644     0.37   0.712    -.0344434    .0504065
         29  |   .0055594   .0213513     0.26   0.795    -.0362919    .0474107
         30  |   .0245588   .0213068     1.15   0.249    -.0172052    .0663228
         31  |   .0175822   .0214892     0.82   0.413    -.0245394    .0597039
         32  |   .0237874   .0220261     1.08   0.280    -.0193866    .0669614
         33  |    .014613   .0226383     0.65   0.519     -.029761    .0589871
         34  |   .0142891   .0235638     0.61   0.544    -.0318989    .0604771
         35  |   .0250925   .0244543     1.03   0.305    -.0228411    .0730261
         36  |   .0248974   .0257549     0.97   0.334    -.0255854    .0753802
         37  |   .0156522   .0269431     0.58   0.561    -.0371598    .0684641
         38  |   .0116886   .0280951     0.42   0.677    -.0433814    .0667587
         39  |   .0155753   .0295383     0.53   0.598    -.0423236    .0734742
         40  |   .0270004   .0307292     0.88   0.380    -.0332328    .0872336
         41  |   .0428605   .0320674     1.34   0.181    -.0199957    .1057167
         42  |   .0501723   .0334471     1.50   0.134    -.0153883    .1157329
         43  |   .0512724    .035041     1.46   0.143    -.0174124    .1199572
         44  |    .071107   .0366275     1.94   0.052    -.0006874    .1429015
         45  |   .0775769    .038118     2.04   0.042     .0028607    .1522931
         46  |   .0793737   .0397306     2.00   0.046     .0014966    .1572508
         47  |   .0907068   .0409314     2.22   0.027     .0104762    .1709375
         48  |   .0806281   .0419718     1.92   0.055    -.0016419    .1628981
         49  |  -.2040205   .0435928    -4.68   0.000    -.2894679    -.118573
         50  |  -.2550993   .0451842    -5.65   0.000    -.3436662   -.1665325
             |
     age_cat |
          1  |   .0471156   .0069136     6.81   0.000     .0335641    .0606671
          2  |   .0667582   .0079166     8.43   0.000     .0512407    .0822757
          3  |   .0847369   .0090368     9.38   0.000     .0670237    .1024501
          4  |   .1076243   .0103804    10.37   0.000     .0872774    .1279713
          5  |   .1260228   .0117721    10.71   0.000     .1029479    .1490976
          6  |   .1379622   .0133312    10.35   0.000     .1118312    .1640931
          7  |   .1455249   .0148953     9.77   0.000     .1163282    .1747216
          8  |    .161972   .0165392     9.79   0.000     .1295531    .1943908
          9  |   .1631774   .0181552     8.99   0.000     .1275908    .1987639
         10  |   .1683075   .0198108     8.50   0.000     .1294758    .2071393
         11  |   .1774175   .0214402     8.28   0.000     .1353921     .219443
         12  |   .1797136   .0230844     7.79   0.000     .1344652     .224962
         13  |   .1899941   .0248124     7.66   0.000     .1413586    .2386297
         14  |   .1994424   .0265504     7.51   0.000     .1474002    .2514845
         15  |   .2079381   .0282075     7.37   0.000     .1526478    .2632283
         16  |   .2133195   .0299055     7.13   0.000     .1547009    .2719381
         17  |   .2183889   .0315456     6.92   0.000     .1565556    .2802223
         18  |   .2249068   .0334153     6.73   0.000     .1594085    .2904051
         19  |   .2165115   .0352908     6.14   0.000      .147337    .2856861
         20  |   .2276667   .0382881     5.95   0.000     .1526171    .3027163
         25  |   .2495233    .044161     5.65   0.000     .1629621    .3360844
         30  |   .2489145   .0621832     4.00   0.000     .1270275    .3708015
         40  |   .2331434   .0695582     3.35   0.001     .0968005    .3694863
         50  |   .1740438   .0733933     2.37   0.018     .0301837     .317904
             |
       _cons |   .2021259   .0151135    13.37   0.000     .1725015    .2317503
-------------+----------------------------------------------------------------
     sigma_u |   .3871401
     sigma_e |  .28648474
         rho |   .6461601   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0480055240476228

. 
. estimates

--------------------------------------------------------------------------------------------------------------------------------
active results
--------------------------------------------------------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    354,772
Group variable: firm_person                     Number of groups  =     39,630

R-sq:                                           Obs per group:
     within  = 0.0480                                         min =          1
     between = 0.0770                                         avg =        9.0
     overall = 0.0625                                         max =         25

                                                F(82,14528)       =      26.05
corr(u_i, Xb)  = 0.1072                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 14,529 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0221698   .0128306     1.73   0.084    -.0029798    .0473194
   during_DD |  -.0058296   .0035932    -1.62   0.105    -.0128726    .0012135
   during_DE |     .02578    .018271     1.41   0.158    -.0100335    .0615936
   during_ED |    .001791   .0164848     0.11   0.913    -.0305214    .0341034
   during_EE |   .0193781   .0190506     1.02   0.309    -.0179635    .0567198
    after_DD |  -.0201178   .0062855    -3.20   0.001    -.0324381   -.0077975
    after_DE |  -.0000498   .0200955    -0.00   0.998    -.0394396      .03934
    after_ED |   -.029995   .0189728    -1.58   0.114    -.0671841    .0071941
    after_EE |   .0133302   .0235322     0.57   0.571    -.0327959    .0594564
             |
    ind_year |
          2  |  -.0175919   .0103585    -1.70   0.089    -.0378959    .0027122
          3  |  -.0354259   .0125038    -2.83   0.005    -.0599349   -.0109169
          4  |  -.0445866   .0133419    -3.34   0.001    -.0707384   -.0184347
          5  |  -.0367618   .0148037    -2.48   0.013     -.065779   -.0077446
          6  |  -.0458231   .0159413    -2.87   0.004    -.0770701    -.014576
          7  |  -.0507619   .0171748    -2.96   0.003    -.0844267   -.0170972
          8  |  -.0614595   .0183118    -3.36   0.001    -.0973529    -.025566
          9  |  -.0642977   .0197665    -3.25   0.001    -.1030425   -.0255528
         10  |  -.0643361   .0210838    -3.05   0.002    -.1056631   -.0230091
         11  |  -.0720303   .0225292    -3.20   0.001    -.1161905   -.0278701
         12  |  -.0731651   .0238958    -3.06   0.002     -.120004   -.0263263
         13  |  -.0681583   .0254508    -2.68   0.007    -.1180451   -.0182716
         14  |  -.0601724   .0270296    -2.23   0.026    -.1131539   -.0071909
         15  |  -.0502804   .0285462    -1.76   0.078    -.1062345    .0056738
         16  |  -.0375097    .030044    -1.25   0.212    -.0963998    .0213804
         17  |  -.0231215   .0316246    -0.73   0.465    -.0851097    .0388668
         18  |  -.0195664   .0332946    -0.59   0.557    -.0848281    .0456953
         19  |  -.0150269   .0348566    -0.43   0.666    -.0833503    .0532965
         20  |  -.0083025   .0363163    -0.23   0.819    -.0794869     .062882
         21  |  -.0142535   .0377307    -0.38   0.706    -.0882104    .0597035
         22  |  -.0077589   .0390469    -0.20   0.842    -.0842959    .0687781
         23  |  -.0118149   .0404233    -0.29   0.770    -.0910498      .06742
         24  |  -.1207655   .0418325    -2.89   0.004    -.2027626   -.0387685
         25  |  -.1562798   .0434011    -3.60   0.000    -.2413515   -.0712082
         26  |  -.0180427   .0253092    -0.71   0.476    -.0676519    .0315666
         27  |  -.0133972   .0223488    -0.60   0.549    -.0572038    .0304094
         28  |   .0079815    .021644     0.37   0.712    -.0344434    .0504065
         29  |   .0055594   .0213513     0.26   0.795    -.0362919    .0474107
         30  |   .0245588   .0213068     1.15   0.249    -.0172052    .0663228
         31  |   .0175822   .0214892     0.82   0.413    -.0245394    .0597039
         32  |   .0237874   .0220261     1.08   0.280    -.0193866    .0669614
         33  |    .014613   .0226383     0.65   0.519     -.029761    .0589871
         34  |   .0142891   .0235638     0.61   0.544    -.0318989    .0604771
         35  |   .0250925   .0244543     1.03   0.305    -.0228411    .0730261
         36  |   .0248974   .0257549     0.97   0.334    -.0255854    .0753802
         37  |   .0156522   .0269431     0.58   0.561    -.0371598    .0684641
         38  |   .0116886   .0280951     0.42   0.677    -.0433814    .0667587
         39  |   .0155753   .0295383     0.53   0.598    -.0423236    .0734742
         40  |   .0270004   .0307292     0.88   0.380    -.0332328    .0872336
         41  |   .0428605   .0320674     1.34   0.181    -.0199957    .1057167
         42  |   .0501723   .0334471     1.50   0.134    -.0153883    .1157329
         43  |   .0512724    .035041     1.46   0.143    -.0174124    .1199572
         44  |    .071107   .0366275     1.94   0.052    -.0006874    .1429015
         45  |   .0775769    .038118     2.04   0.042     .0028607    .1522931
         46  |   .0793737   .0397306     2.00   0.046     .0014966    .1572508
         47  |   .0907068   .0409314     2.22   0.027     .0104762    .1709375
         48  |   .0806281   .0419718     1.92   0.055    -.0016419    .1628981
         49  |  -.2040205   .0435928    -4.68   0.000    -.2894679    -.118573
         50  |  -.2550993   .0451842    -5.65   0.000    -.3436662   -.1665325
             |
     age_cat |
          1  |   .0471156   .0069136     6.81   0.000     .0335641    .0606671
          2  |   .0667582   .0079166     8.43   0.000     .0512407    .0822757
          3  |   .0847369   .0090368     9.38   0.000     .0670237    .1024501
          4  |   .1076243   .0103804    10.37   0.000     .0872774    .1279713
          5  |   .1260228   .0117721    10.71   0.000     .1029479    .1490976
          6  |   .1379622   .0133312    10.35   0.000     .1118312    .1640931
          7  |   .1455249   .0148953     9.77   0.000     .1163282    .1747216
          8  |    .161972   .0165392     9.79   0.000     .1295531    .1943908
          9  |   .1631774   .0181552     8.99   0.000     .1275908    .1987639
         10  |   .1683075   .0198108     8.50   0.000     .1294758    .2071393
         11  |   .1774175   .0214402     8.28   0.000     .1353921     .219443
         12  |   .1797136   .0230844     7.79   0.000     .1344652     .224962
         13  |   .1899941   .0248124     7.66   0.000     .1413586    .2386297
         14  |   .1994424   .0265504     7.51   0.000     .1474002    .2514845
         15  |   .2079381   .0282075     7.37   0.000     .1526478    .2632283
         16  |   .2133195   .0299055     7.13   0.000     .1547009    .2719381
         17  |   .2183889   .0315456     6.92   0.000     .1565556    .2802223
         18  |   .2249068   .0334153     6.73   0.000     .1594085    .2904051
         19  |   .2165115   .0352908     6.14   0.000      .147337    .2856861
         20  |   .2276667   .0382881     5.95   0.000     .1526171    .3027163
         25  |   .2495233    .044161     5.65   0.000     .1629621    .3360844
         30  |   .2489145   .0621832     4.00   0.000     .1270275    .3708015
         40  |   .2331434   .0695582     3.35   0.001     .0968005    .3694863
         50  |   .1740438   .0733933     2.37   0.018     .0301837     .317904
             |
       _cons |   .2021259   .0151135    13.37   0.000     .1725015    .2317503
-------------+----------------------------------------------------------------
     sigma_u |   .3871401
     sigma_e |  .28648474
         rho |   .6461601   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text replace

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',"pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _
> newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[during_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         connect(stepstair) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle("") title(`title') legend(off) aspect(.5) plotregion(style(none)) x
> size(16) ysize(10))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 14528) =    2.63
            Prob > F =    0.1047

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14528) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 14528) =    1.99
            Prob > F =    0.1583

 ( 1)  - during_DD + during_DE = 0

       F(  1, 14528) =    2.90
            Prob > F =    0.0886
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 14528) =    0.01
            Prob > F =    0.9135

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 14528) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 14528) =    1.03
            Prob > F =    0.3091

 ( 1)  - during_ED + during_EE = 0

       F(  1, 14528) =    0.49
            Prob > F =    0.4839

. 
. graph export output/figure/`fname'_tree.png, width(1600) replace
(file output/figure/exporter_tree.png written in PNG format)

. 
end of do-file

. 
end of do-file

. 
. log close
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/estimate_switch.log
  log type:  text
 closed on:   4 Dec 2018, 17:04:57
--------------------------------------------------------------------------------------------------------------------------------
