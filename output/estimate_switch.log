----------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/
> estimate_switch.log
  log type:  text
 opened on:  12 Jan 2019, 13:09:30

. 
. 
. use temp/analysis_sample

. 
. *Dinamika
. scalar Tbefore = 4

. scalar Tduring = 6

. scalar Tafter = 4

. 
. gen byte analysis_window = (tenure>=-Tbefore-1)&(year-first_exit_year<=Tafter)

. 
. global sample_baseline (analysis_window==1)

. global sample_manufacturing $sample_baseline & (manufacturing==1)

. global sample_acquisitions $sample_baseline & (greenfield==0)

. global sample_1990s $sample_acquisitions & (enter_year>=1994 & enter_year<=1999)

. global sample_2000s $sample_acquisitions & (enter_year>=2000)

. global sample_ever_foreign $sample_acquisitions & (ever_foreign==1)

. 
. global samples baseline acquisitions

. 
. global outcomes lnL lnKL lnQL exporter

. global controls foreign i.ind_year i.age_cat

. 
. label var lnL "Employment (log)"

. label var lnKL "Capital per worker (log)"

. label var lnQL "Revenue per worker (log)"

. label var exporter "Firm is an exporter (dummy)"

. 
. egen person_tag = tag(frame_id manager_id)

. egen N = sum(person_tag), by(frame_id)

. gen inverse_weight = 1/N

. 
. * verify founders are not in analysis sample
. foreach X of var during* after* {
  2.         replace `X'=0 if founder==1
  3. }
(0 real changes made)
(156,736 real changes made)
(65,411 real changes made)
(81,861 real changes made)
(90,563 real changes made)
(55,334 real changes made)
(105,536 real changes made)
(120,373 real changes made)
(113,200 real changes made)
(17,142 real changes made)
(8,638 real changes made)
(11,993 real changes made)
(11,964 real changes made)
(13,320 real changes made)
(10,192 real changes made)
(11,047 real changes made)
(14,421 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(113,142 real changes made)
(60,285 real changes made)
(57,025 real changes made)
(57,563 real changes made)
(52,066 real changes made)
(74,086 real changes made)
(95,636 real changes made)
(49,280 real changes made)
(20,382 real changes made)
(11,540 real changes made)
(15,163 real changes made)
(13,699 real changes made)
(15,828 real changes made)
(12,017 real changes made)
(15,255 real changes made)
(9,788 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)
(0 real changes made)

. 
. xtset firm_person year
       panel variable:  firm_person (unbalanced)
        time variable:  year, 1992 to 2016, but with gaps
                delta:  1 unit

. 
. do est_`1'

. local i = 1

. foreach X of var $outcomes {
  2.         xtreg `X' foreign during_?? after_?? i.ind_year i.age_cat if $sample_
> acquisitions [aw=inverse_weight], i(firm_person ) fe vce(cluster id)
  3.         local r2_w = `e(r2_w)'
  4.         do regram output/regression/acquisitions_change `i' `X' R2_within "`r
> 2_w'"
  5.         do tree_graph
  6. 
.         local i = `i' + 1
  7. }

Fixed-effects (within) regression               Number of obs      =    455349
Group variable: firm_person                     Number of groups   =     52559

R-sq:  within  = 0.0962                         Obs per group: min =         1
       between = 0.0260                                        avg =       8.7
       overall = 0.0300                                        max =        25

                                                F(82,18612)        =     44.72
corr(u_i, Xb)  = -0.2950                        Prob > F           =    0.0000

                                (Std. Err. adjusted for 18,613 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0266907    .033277     0.80   0.423    -.0385354    .0919167
   during_DD |  -.0626048    .009524    -6.57   0.000    -.0812726   -.0439369
   during_DE |  -.0425165   .0617196    -0.69   0.491    -.1634926    .0784596
   during_ED |   .0017687   .0547582     0.03   0.974    -.1055625    .1090999
   during_EE |  -.0651757   .0484699    -1.34   0.179    -.1601813    .0298298
    after_DD |  -.2123783   .0177172   -11.99   0.000    -.2471057   -.1776509
    after_DE |  -.1021042   .0707542    -1.44   0.149    -.2407889    .0365806
    after_ED |   -.235924   .0767786    -3.07   0.002     -.386417    -.085431
    after_EE |   -.162444   .0782364    -2.08   0.038    -.3157946   -.0090935
             |
    ind_year |
          2  |  -.1530094   .0183308    -8.35   0.000    -.1889394   -.1170794
          3  |  -.3232377   .0248805   -12.99   0.000    -.3720057   -.2744697
          4  |  -.4750272   .0294376   -16.14   0.000    -.5327277   -.4173268
          5  |  -.5950761   .0337816   -17.62   0.000    -.6612911   -.5288611
          6  |  -.7012192   .0380203   -18.44   0.000    -.7757424   -.6266959
          7  |  -.7554511   .0420298   -17.97   0.000    -.8378334   -.6730688
          8  |  -.7880783   .0456852   -17.25   0.000    -.8776254   -.6985312
          9  |  -.8397035   .0495503   -16.95   0.000    -.9368266   -.7425803
         10  |  -.8986915   .0532166   -16.89   0.000    -1.003001   -.7943821
         11  |  -.9614236   .0568168   -16.92   0.000     -1.07279   -.8500576
         12  |  -1.002571   .0604978   -16.57   0.000    -1.121152   -.8839894
         13  |  -1.039009   .0642852   -16.16   0.000    -1.165014   -.9130042
         14  |   -1.08647   .0680163   -15.97   0.000    -1.219788   -.9531516
         15  |  -1.114575   .0716322   -15.56   0.000    -1.254981   -.9741691
         16  |  -1.175698   .0751542   -15.64   0.000    -1.323007   -1.028389
         17  |  -1.223375   .0788986   -15.51   0.000    -1.378023   -1.068726
         18  |  -1.311588   .0824465   -15.91   0.000     -1.47319   -1.149985
         19  |   -1.37537   .0858593   -16.02   0.000    -1.543662   -1.207078
         20  |  -1.425613   .0889909   -16.02   0.000    -1.600043   -1.251183
         21  |  -1.482803   .0920556   -16.11   0.000     -1.66324   -1.302366
         22  |  -1.530532   .0950023   -16.11   0.000    -1.716745   -1.344319
         23  |  -1.571118    .097913   -16.05   0.000    -1.763037     -1.3792
         24  |   -1.61816    .101244   -15.98   0.000    -1.816608   -1.419713
         25  |  -1.641385    .104667   -15.68   0.000    -1.846542   -1.436228
         26  |    .521435   .0585328     8.91   0.000     .4067053    .6361646
         27  |    .308271   .0556175     5.54   0.000     .1992555    .4172864
         28  |   .1502625   .0540301     2.78   0.005     .0443587    .2561664
         29  |  -.0022744   .0538794    -0.04   0.966     -.107883    .1033343
         30  |  -.1183467   .0535611    -2.21   0.027    -.2233314    -.013362
         31  |  -.2021747   .0546414    -3.70   0.000    -.3092768   -.0950726
         32  |  -.2644742   .0555333    -4.76   0.000    -.3733246   -.1556238
         33  |  -.3390121   .0573864    -5.91   0.000    -.4514948   -.2265295
         34  |  -.4141427   .0594816    -6.96   0.000     -.530732   -.2975534
         35  |    -.47786   .0621127    -7.69   0.000    -.5996065   -.3561135
         36  |  -.5559976   .0644631    -8.63   0.000    -.6823511   -.4296441
         37  |  -.6275718   .0671637    -9.34   0.000    -.7592189   -.4959248
         38  |   -.704288   .0701042   -10.05   0.000    -.8416986   -.5668773
         39  |  -.7723173   .0735214   -10.50   0.000     -.916426   -.6282086
         40  |   -.805856   .0769355   -10.47   0.000    -.9566565   -.6550554
         41  |  -.8415193   .0800427   -10.51   0.000    -.9984104   -.6846282
         42  |  -.8969238   .0831064   -10.79   0.000     -1.05982   -.7340276
         43  |  -1.024531   .0866231   -11.83   0.000    -1.194321   -.8547422
         44  |  -1.072467   .0906236   -11.83   0.000    -1.250097   -.8948359
         45  |  -1.098384   .0940158   -11.68   0.000    -1.282664   -.9141048
         46  |  -1.124197   .0972778   -11.56   0.000     -1.31487   -.9335238
         47  |  -1.156708    .100204   -11.54   0.000    -1.353117   -.9602993
         48  |  -1.175997   .1033117   -11.38   0.000    -1.378498   -.9734966
         49  |  -1.216756   .1063508   -11.44   0.000    -1.425214   -1.008299
         50  |  -1.250919   .1090845   -11.47   0.000    -1.464735   -1.037103
             |
     age_cat |
          1  |   .4168634   .0173262    24.06   0.000     .3829025    .4508242
          2  |    .705947   .0202059    34.94   0.000     .6663415    .7455525
          3  |   .9249963   .0234823    39.39   0.000     .8789688    .9710238
          4  |   1.107249   .0269271    41.12   0.000      1.05447    1.160028
          5  |   1.261936   .0305729    41.28   0.000      1.20201    1.321862
          6  |   1.390097   .0343069    40.52   0.000     1.322853    1.457342
          7  |   1.496233   .0381542    39.22   0.000     1.421447    1.571019
          8  |   1.590502   .0420912    37.79   0.000        1.508    1.673005
          9  |   1.664612    .045947    36.23   0.000     1.574551    1.754672
         10  |   1.735332     .04976    34.87   0.000     1.637798    1.832867
         11  |   1.804242   .0536261    33.64   0.000      1.69913    1.909354
         12  |   1.871385   .0574968    32.55   0.000     1.758686    1.984084
         13  |   1.928145   .0613505    31.43   0.000     1.807892    2.048397
         14  |   1.972241   .0653028    30.20   0.000     1.844241     2.10024
         15  |   2.018012    .069203    29.16   0.000     1.882367    2.153656
         16  |   2.056393   .0731319    28.12   0.000     1.913048    2.199738
         17  |   2.091787   .0771463    27.11   0.000     1.940573    2.243001
         18  |   2.140559   .0808955    26.46   0.000     1.981996    2.299121
         19  |   2.173555   .0850332    25.56   0.000     2.006882    2.340228
         20  |    2.24645    .092417    24.31   0.000     2.065304    2.427596
         25  |   2.358263   .1040739    22.66   0.000     2.154269    2.562257
         30  |   2.130874   .1340756    15.89   0.000     1.868074    2.393675
         40  |   2.029975   .1490121    13.62   0.000     1.737897    2.322052
         50  |   2.008052   .1514843    13.26   0.000     1.711129    2.304975
             |
       _cons |   3.050717   .0361645    84.36   0.000     2.979831    3.121602
-------------+----------------------------------------------------------------
     sigma_u |   1.129619
     sigma_e |  .64667559
         rho |  .75316826   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0961848985347313

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    455,349
Group variable: firm_person                     Number of groups  =     52,559

R-sq:                                           Obs per group:
     within  = 0.0962                                         min =          1
     between = 0.0260                                         avg =        8.7
     overall = 0.0300                                         max =         25

                                                F(82,18612)       =      44.72
corr(u_i, Xb)  = -0.2950                        Prob > F          =     0.0000

                                (Std. Err. adjusted for 18,613 clusters in id)
------------------------------------------------------------------------------
             |               Robust
         lnL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0266907    .033277     0.80   0.423    -.0385354    .0919167
   during_DD |  -.0626048    .009524    -6.57   0.000    -.0812726   -.0439369
   during_DE |  -.0425165   .0617196    -0.69   0.491    -.1634926    .0784596
   during_ED |   .0017687   .0547582     0.03   0.974    -.1055625    .1090999
   during_EE |  -.0651757   .0484699    -1.34   0.179    -.1601813    .0298298
    after_DD |  -.2123783   .0177172   -11.99   0.000    -.2471057   -.1776509
    after_DE |  -.1021042   .0707542    -1.44   0.149    -.2407889    .0365806
    after_ED |   -.235924   .0767786    -3.07   0.002     -.386417    -.085431
    after_EE |   -.162444   .0782364    -2.08   0.038    -.3157946   -.0090935
             |
    ind_year |
          2  |  -.1530094   .0183308    -8.35   0.000    -.1889394   -.1170794
          3  |  -.3232377   .0248805   -12.99   0.000    -.3720057   -.2744697
          4  |  -.4750272   .0294376   -16.14   0.000    -.5327277   -.4173268
          5  |  -.5950761   .0337816   -17.62   0.000    -.6612911   -.5288611
          6  |  -.7012192   .0380203   -18.44   0.000    -.7757424   -.6266959
          7  |  -.7554511   .0420298   -17.97   0.000    -.8378334   -.6730688
          8  |  -.7880783   .0456852   -17.25   0.000    -.8776254   -.6985312
          9  |  -.8397035   .0495503   -16.95   0.000    -.9368266   -.7425803
         10  |  -.8986915   .0532166   -16.89   0.000    -1.003001   -.7943821
         11  |  -.9614236   .0568168   -16.92   0.000     -1.07279   -.8500576
         12  |  -1.002571   .0604978   -16.57   0.000    -1.121152   -.8839894
         13  |  -1.039009   .0642852   -16.16   0.000    -1.165014   -.9130042
         14  |   -1.08647   .0680163   -15.97   0.000    -1.219788   -.9531516
         15  |  -1.114575   .0716322   -15.56   0.000    -1.254981   -.9741691
         16  |  -1.175698   .0751542   -15.64   0.000    -1.323007   -1.028389
         17  |  -1.223375   .0788986   -15.51   0.000    -1.378023   -1.068726
         18  |  -1.311588   .0824465   -15.91   0.000     -1.47319   -1.149985
         19  |   -1.37537   .0858593   -16.02   0.000    -1.543662   -1.207078
         20  |  -1.425613   .0889909   -16.02   0.000    -1.600043   -1.251183
         21  |  -1.482803   .0920556   -16.11   0.000     -1.66324   -1.302366
         22  |  -1.530532   .0950023   -16.11   0.000    -1.716745   -1.344319
         23  |  -1.571118    .097913   -16.05   0.000    -1.763037     -1.3792
         24  |   -1.61816    .101244   -15.98   0.000    -1.816608   -1.419713
         25  |  -1.641385    .104667   -15.68   0.000    -1.846542   -1.436228
         26  |    .521435   .0585328     8.91   0.000     .4067053    .6361646
         27  |    .308271   .0556175     5.54   0.000     .1992555    .4172864
         28  |   .1502625   .0540301     2.78   0.005     .0443587    .2561664
         29  |  -.0022744   .0538794    -0.04   0.966     -.107883    .1033343
         30  |  -.1183467   .0535611    -2.21   0.027    -.2233314    -.013362
         31  |  -.2021747   .0546414    -3.70   0.000    -.3092768   -.0950726
         32  |  -.2644742   .0555333    -4.76   0.000    -.3733246   -.1556238
         33  |  -.3390121   .0573864    -5.91   0.000    -.4514948   -.2265295
         34  |  -.4141427   .0594816    -6.96   0.000     -.530732   -.2975534
         35  |    -.47786   .0621127    -7.69   0.000    -.5996065   -.3561135
         36  |  -.5559976   .0644631    -8.63   0.000    -.6823511   -.4296441
         37  |  -.6275718   .0671637    -9.34   0.000    -.7592189   -.4959248
         38  |   -.704288   .0701042   -10.05   0.000    -.8416986   -.5668773
         39  |  -.7723173   .0735214   -10.50   0.000     -.916426   -.6282086
         40  |   -.805856   .0769355   -10.47   0.000    -.9566565   -.6550554
         41  |  -.8415193   .0800427   -10.51   0.000    -.9984104   -.6846282
         42  |  -.8969238   .0831064   -10.79   0.000     -1.05982   -.7340276
         43  |  -1.024531   .0866231   -11.83   0.000    -1.194321   -.8547422
         44  |  -1.072467   .0906236   -11.83   0.000    -1.250097   -.8948359
         45  |  -1.098384   .0940158   -11.68   0.000    -1.282664   -.9141048
         46  |  -1.124197   .0972778   -11.56   0.000     -1.31487   -.9335238
         47  |  -1.156708    .100204   -11.54   0.000    -1.353117   -.9602993
         48  |  -1.175997   .1033117   -11.38   0.000    -1.378498   -.9734966
         49  |  -1.216756   .1063508   -11.44   0.000    -1.425214   -1.008299
         50  |  -1.250919   .1090845   -11.47   0.000    -1.464735   -1.037103
             |
     age_cat |
          1  |   .4168634   .0173262    24.06   0.000     .3829025    .4508242
          2  |    .705947   .0202059    34.94   0.000     .6663415    .7455525
          3  |   .9249963   .0234823    39.39   0.000     .8789688    .9710238
          4  |   1.107249   .0269271    41.12   0.000      1.05447    1.160028
          5  |   1.261936   .0305729    41.28   0.000      1.20201    1.321862
          6  |   1.390097   .0343069    40.52   0.000     1.322853    1.457342
          7  |   1.496233   .0381542    39.22   0.000     1.421447    1.571019
          8  |   1.590502   .0420912    37.79   0.000        1.508    1.673005
          9  |   1.664612    .045947    36.23   0.000     1.574551    1.754672
         10  |   1.735332     .04976    34.87   0.000     1.637798    1.832867
         11  |   1.804242   .0536261    33.64   0.000      1.69913    1.909354
         12  |   1.871385   .0574968    32.55   0.000     1.758686    1.984084
         13  |   1.928145   .0613505    31.43   0.000     1.807892    2.048397
         14  |   1.972241   .0653028    30.20   0.000     1.844241     2.10024
         15  |   2.018012    .069203    29.16   0.000     1.882367    2.153656
         16  |   2.056393   .0731319    28.12   0.000     1.913048    2.199738
         17  |   2.091787   .0771463    27.11   0.000     1.940573    2.243001
         18  |   2.140559   .0808955    26.46   0.000     1.981996    2.299121
         19  |   2.173555   .0850332    25.56   0.000     2.006882    2.340228
         20  |    2.24645    .092417    24.31   0.000     2.065304    2.427596
         25  |   2.358263   .1040739    22.66   0.000     2.154269    2.562257
         30  |   2.130874   .1340756    15.89   0.000     1.868074    2.393675
         40  |   2.029975   .1490121    13.62   0.000     1.737897    2.322052
         50  |   2.008052   .1514843    13.26   0.000     1.711129    2.304975
             |
       _cons |   3.050717   .0361645    84.36   0.000     2.979831    3.121602
-------------+----------------------------------------------------------------
     sigma_u |   1.129619
     sigma_e |  .64667559
         rho |  .75316826   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[du
> ring_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         connect(stepstair) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle("") title(`title') le
> gend(off) aspect(.5) plotregion(style(none)) xsize(16) ysize(10))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 18612) =   43.21
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 18612) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 18612) =    0.47
            Prob > F =    0.4909

 ( 1)  - during_DD + during_DE = 0

       F(  1, 18612) =    0.10
            Prob > F =    0.7468
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 18612) =    0.00
            Prob > F =    0.9742

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 18612) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 18612) =    1.81
            Prob > F =    0.1788

 ( 1)  - during_ED + during_EE = 0

       F(  1, 18612) =    1.06
            Prob > F =    0.3028

. 
. graph export output/figure/`fname'_tree.png, width(1600) replace
(file output/figure/lnL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    455349
Group variable: firm_person                     Number of groups   =     52559

R-sq:  within  = 0.1752                         Obs per group: min =         1
       between = 0.1316                                        avg =       8.7
       overall = 0.1176                                        max =        25

                                                F(82,18612)        =     97.66
corr(u_i, Xb)  = 0.0067                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 18,613 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0236747   .0414317     0.57   0.568    -.0575351    .1048846
   during_DD |  -.0012152   .0110168    -0.11   0.912    -.0228091    .0203786
   during_DE |  -.0546012   .0725861    -0.75   0.452    -.1968766    .0876741
   during_ED |  -.2461862   .0673239    -3.66   0.000    -.3781472   -.1142252
   during_EE |  -.0871323   .0691186    -1.26   0.207    -.2226112    .0483465
    after_DD |  -.0223385   .0202605    -1.10   0.270     -.062051    .0173739
    after_DE |  -.1875877    .082862    -2.26   0.024    -.3500048   -.0251705
    after_ED |  -.2900216   .1059883    -2.74   0.006    -.4977684   -.0822748
    after_EE |  -.2290361   .1039935    -2.20   0.028    -.4328728   -.0251994
             |
    ind_year |
          2  |   .1386689   .0261659     5.30   0.000     .0873813    .1899565
          3  |   .7228771   .0334887    21.59   0.000     .6572361    .7885181
          4  |   .8844402   .0388958    22.74   0.000      .808201    .9606795
          5  |   1.045758   .0437743    23.89   0.000      .959956    1.131559
          6  |   1.297049   .0486421    26.67   0.000     1.201706    1.392392
          7  |   1.573787   .0537064    29.30   0.000     1.468518    1.679057
          8  |   1.783271   .0587697    30.34   0.000     1.668077    1.898465
          9  |   1.929145   .0638621    30.21   0.000      1.80397    2.054321
         10  |   2.076466   .0694486    29.90   0.000      1.94034    2.212591
         11  |   2.229924   .0747924    29.81   0.000     2.083324    2.376524
         12  |   2.295423   .0803703    28.56   0.000      2.13789    2.452956
         13  |   2.356148   .0860658    27.38   0.000     2.187451    2.524844
         14  |   2.378575   .0917395    25.93   0.000     2.198757    2.558392
         15  |   2.356818   .0974759    24.18   0.000     2.165757     2.54788
         16  |   2.411668   .1029245    23.43   0.000     2.209926    2.613409
         17  |   2.440931   .1088333    22.43   0.000     2.227608    2.654254
         18  |   2.450739   .1145512    21.39   0.000     2.226208     2.67527
         19  |   2.411233   .1201647    20.07   0.000     2.175699    2.646766
         20  |    2.41226   .1257574    19.18   0.000     2.165764    2.658756
         21  |   2.441505   .1305108    18.71   0.000     2.185692    2.697318
         22  |   2.479666   .1351692    18.34   0.000     2.214722     2.74461
         23  |   2.589893   .1397186    18.54   0.000     2.316032    2.863754
         24  |   2.386222    .145263    16.43   0.000     2.101493    2.670951
         25  |   2.382161   .1506439    15.81   0.000     2.086886    2.677437
         26  |   .4223298   .0655125     6.45   0.000     .2939194    .5507402
         27  |   .5369224   .0603143     8.90   0.000     .4187008    .6551439
         28  |   .8192815   .0574247    14.27   0.000     .7067238    .9318392
         29  |    .963586   .0572935    16.82   0.000     .8512856    1.075886
         30  |    1.08949   .0586423    18.58   0.000      .974546    1.204435
         31  |   1.257104   .0609707    20.62   0.000     1.137596    1.376612
         32  |   1.469161   .0637277    23.05   0.000     1.344249    1.594073
         33  |   1.622677   .0674167    24.07   0.000     1.490534     1.75482
         34  |   1.758539   .0714779    24.60   0.000     1.618435    1.898642
         35  |   1.869635   .0761828    24.54   0.000      1.72031    2.018961
         36  |   2.011226   .0810069    24.83   0.000     1.852445    2.170007
         37  |   2.130975   .0858061    24.83   0.000     1.962787    2.299163
         38  |    2.20389   .0908591    24.26   0.000     2.025798    2.381982
         39  |   2.242038   .0959985    23.35   0.000     2.053872    2.430204
         40  |   2.258252   .1012625    22.30   0.000     2.059768    2.456735
         41  |   2.291604   .1066119    21.49   0.000     2.082635    2.500573
         42  |   2.366611   .1124515    21.05   0.000     2.146196    2.587026
         43  |   2.406204   .1184356    20.32   0.000     2.174059    2.638349
         44  |   2.396107   .1245554    19.24   0.000     2.151967    2.640247
         45  |   2.428642   .1300959    18.67   0.000     2.173642    2.683641
         46  |   2.428019   .1353914    17.93   0.000      2.16264    2.693399
         47  |   2.463154   .1401486    17.58   0.000      2.18845    2.737858
         48  |   2.544951   .1444371    17.62   0.000     2.261841    2.828061
         49  |    2.46981   .1495484    16.52   0.000     2.176681    2.762938
         50  |   2.494455   .1542302    16.17   0.000      2.19215     2.79676
             |
     age_cat |
          1  |   .0739657   .0272411     2.72   0.007     .0205706    .1273608
          2  |   .1206921   .0311033     3.88   0.000     .0597267    .1816574
          3  |   .1448438   .0349634     4.14   0.000     .0763124    .2133753
          4  |   .1702873   .0393894     4.32   0.000     .0930804    .2474942
          5  |      .1578   .0441968     3.57   0.000     .0711702    .2444297
          6  |   .1378678   .0492826     2.80   0.005     .0412693    .2344662
          7  |   .1306536   .0546057     2.39   0.017     .0236214    .2376858
          8  |   .1284974   .0601235     2.14   0.033     .0106498     .246345
          9  |   .1342108   .0656488     2.04   0.041     .0055331    .2628884
         10  |   .1299756   .0712888     1.82   0.068     -.009757    .2697081
         11  |   .1251328   .0770247     1.62   0.104    -.0258426    .2761081
         12  |   .1280715   .0825675     1.55   0.121    -.0337683    .2899114
         13  |   .1168709   .0883152     1.32   0.186    -.0562349    .2899768
         14  |   .1211378   .0941457     1.29   0.198    -.0633965     .305672
         15  |     .12884   .0999911     1.29   0.198    -.0671517    .3248318
         16  |   .1080634   .1060776     1.02   0.308    -.0998584    .3159851
         17  |   .1028543    .112097     0.92   0.359     -.116866    .3225746
         18  |   .1129566   .1180198     0.96   0.339     -.118373    .3442862
         19  |   .0978376    .124288     0.79   0.431    -.1457783    .3414535
         20  |   .0657768   .1362514     0.48   0.629    -.2012884    .3328419
         25  |  -.0143198   .1556901    -0.09   0.927    -.3194866    .2908471
         30  |   .0381802   .1927981     0.20   0.843    -.3397217    .4160822
         40  |   .1520062   .2251959     0.67   0.500    -.2893983    .5934108
         50  |   .1830097   .2496485     0.73   0.464    -.3063241    .6723435
             |
       _cons |   3.931152   .0454659    86.46   0.000     3.842034    4.020269
-------------+----------------------------------------------------------------
     sigma_u |   1.637897
     sigma_e |  .88122578
         rho |  .77551336   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .175175098439731

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    455,349
Group variable: firm_person                     Number of groups  =     52,559

R-sq:                                           Obs per group:
     within  = 0.1752                                         min =          1
     between = 0.1316                                         avg =        8.7
     overall = 0.1176                                         max =         25

                                                F(82,18612)       =      97.66
corr(u_i, Xb)  = 0.0067                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 18,613 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnKL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0236747   .0414317     0.57   0.568    -.0575351    .1048846
   during_DD |  -.0012152   .0110168    -0.11   0.912    -.0228091    .0203786
   during_DE |  -.0546012   .0725861    -0.75   0.452    -.1968766    .0876741
   during_ED |  -.2461862   .0673239    -3.66   0.000    -.3781472   -.1142252
   during_EE |  -.0871323   .0691186    -1.26   0.207    -.2226112    .0483465
    after_DD |  -.0223385   .0202605    -1.10   0.270     -.062051    .0173739
    after_DE |  -.1875877    .082862    -2.26   0.024    -.3500048   -.0251705
    after_ED |  -.2900216   .1059883    -2.74   0.006    -.4977684   -.0822748
    after_EE |  -.2290361   .1039935    -2.20   0.028    -.4328728   -.0251994
             |
    ind_year |
          2  |   .1386689   .0261659     5.30   0.000     .0873813    .1899565
          3  |   .7228771   .0334887    21.59   0.000     .6572361    .7885181
          4  |   .8844402   .0388958    22.74   0.000      .808201    .9606795
          5  |   1.045758   .0437743    23.89   0.000      .959956    1.131559
          6  |   1.297049   .0486421    26.67   0.000     1.201706    1.392392
          7  |   1.573787   .0537064    29.30   0.000     1.468518    1.679057
          8  |   1.783271   .0587697    30.34   0.000     1.668077    1.898465
          9  |   1.929145   .0638621    30.21   0.000      1.80397    2.054321
         10  |   2.076466   .0694486    29.90   0.000      1.94034    2.212591
         11  |   2.229924   .0747924    29.81   0.000     2.083324    2.376524
         12  |   2.295423   .0803703    28.56   0.000      2.13789    2.452956
         13  |   2.356148   .0860658    27.38   0.000     2.187451    2.524844
         14  |   2.378575   .0917395    25.93   0.000     2.198757    2.558392
         15  |   2.356818   .0974759    24.18   0.000     2.165757     2.54788
         16  |   2.411668   .1029245    23.43   0.000     2.209926    2.613409
         17  |   2.440931   .1088333    22.43   0.000     2.227608    2.654254
         18  |   2.450739   .1145512    21.39   0.000     2.226208     2.67527
         19  |   2.411233   .1201647    20.07   0.000     2.175699    2.646766
         20  |    2.41226   .1257574    19.18   0.000     2.165764    2.658756
         21  |   2.441505   .1305108    18.71   0.000     2.185692    2.697318
         22  |   2.479666   .1351692    18.34   0.000     2.214722     2.74461
         23  |   2.589893   .1397186    18.54   0.000     2.316032    2.863754
         24  |   2.386222    .145263    16.43   0.000     2.101493    2.670951
         25  |   2.382161   .1506439    15.81   0.000     2.086886    2.677437
         26  |   .4223298   .0655125     6.45   0.000     .2939194    .5507402
         27  |   .5369224   .0603143     8.90   0.000     .4187008    .6551439
         28  |   .8192815   .0574247    14.27   0.000     .7067238    .9318392
         29  |    .963586   .0572935    16.82   0.000     .8512856    1.075886
         30  |    1.08949   .0586423    18.58   0.000      .974546    1.204435
         31  |   1.257104   .0609707    20.62   0.000     1.137596    1.376612
         32  |   1.469161   .0637277    23.05   0.000     1.344249    1.594073
         33  |   1.622677   .0674167    24.07   0.000     1.490534     1.75482
         34  |   1.758539   .0714779    24.60   0.000     1.618435    1.898642
         35  |   1.869635   .0761828    24.54   0.000      1.72031    2.018961
         36  |   2.011226   .0810069    24.83   0.000     1.852445    2.170007
         37  |   2.130975   .0858061    24.83   0.000     1.962787    2.299163
         38  |    2.20389   .0908591    24.26   0.000     2.025798    2.381982
         39  |   2.242038   .0959985    23.35   0.000     2.053872    2.430204
         40  |   2.258252   .1012625    22.30   0.000     2.059768    2.456735
         41  |   2.291604   .1066119    21.49   0.000     2.082635    2.500573
         42  |   2.366611   .1124515    21.05   0.000     2.146196    2.587026
         43  |   2.406204   .1184356    20.32   0.000     2.174059    2.638349
         44  |   2.396107   .1245554    19.24   0.000     2.151967    2.640247
         45  |   2.428642   .1300959    18.67   0.000     2.173642    2.683641
         46  |   2.428019   .1353914    17.93   0.000      2.16264    2.693399
         47  |   2.463154   .1401486    17.58   0.000      2.18845    2.737858
         48  |   2.544951   .1444371    17.62   0.000     2.261841    2.828061
         49  |    2.46981   .1495484    16.52   0.000     2.176681    2.762938
         50  |   2.494455   .1542302    16.17   0.000      2.19215     2.79676
             |
     age_cat |
          1  |   .0739657   .0272411     2.72   0.007     .0205706    .1273608
          2  |   .1206921   .0311033     3.88   0.000     .0597267    .1816574
          3  |   .1448438   .0349634     4.14   0.000     .0763124    .2133753
          4  |   .1702873   .0393894     4.32   0.000     .0930804    .2474942
          5  |      .1578   .0441968     3.57   0.000     .0711702    .2444297
          6  |   .1378678   .0492826     2.80   0.005     .0412693    .2344662
          7  |   .1306536   .0546057     2.39   0.017     .0236214    .2376858
          8  |   .1284974   .0601235     2.14   0.033     .0106498     .246345
          9  |   .1342108   .0656488     2.04   0.041     .0055331    .2628884
         10  |   .1299756   .0712888     1.82   0.068     -.009757    .2697081
         11  |   .1251328   .0770247     1.62   0.104    -.0258426    .2761081
         12  |   .1280715   .0825675     1.55   0.121    -.0337683    .2899114
         13  |   .1168709   .0883152     1.32   0.186    -.0562349    .2899768
         14  |   .1211378   .0941457     1.29   0.198    -.0633965     .305672
         15  |     .12884   .0999911     1.29   0.198    -.0671517    .3248318
         16  |   .1080634   .1060776     1.02   0.308    -.0998584    .3159851
         17  |   .1028543    .112097     0.92   0.359     -.116866    .3225746
         18  |   .1129566   .1180198     0.96   0.339     -.118373    .3442862
         19  |   .0978376    .124288     0.79   0.431    -.1457783    .3414535
         20  |   .0657768   .1362514     0.48   0.629    -.2012884    .3328419
         25  |  -.0143198   .1556901    -0.09   0.927    -.3194866    .2908471
         30  |   .0381802   .1927981     0.20   0.843    -.3397217    .4160822
         40  |   .1520062   .2251959     0.67   0.500    -.2893983    .5934108
         50  |   .1830097   .2496485     0.73   0.464    -.3063241    .6723435
             |
       _cons |   3.931152   .0454659    86.46   0.000     3.842034    4.020269
-------------+----------------------------------------------------------------
     sigma_u |   1.637897
     sigma_e |  .88122578
         rho |  .77551336   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[du
> ring_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         connect(stepstair) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle("") title(`title') le
> gend(off) aspect(.5) plotregion(style(none)) xsize(16) ysize(10))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 18612) =    0.01
            Prob > F =    0.9122

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 18612) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 18612) =    0.57
            Prob > F =    0.4519

 ( 1)  - during_DD + during_DE = 0

       F(  1, 18612) =    0.53
            Prob > F =    0.4652
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 18612) =   13.37
            Prob > F =    0.0003

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 18612) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 18612) =    1.59
            Prob > F =    0.2075

 ( 1)  - during_ED + during_EE = 0

       F(  1, 18612) =    3.23
            Prob > F =    0.0722

. 
. graph export output/figure/`fname'_tree.png, width(1600) replace
(file output/figure/lnKL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    455349
Group variable: firm_person                     Number of groups   =     52559

R-sq:  within  = 0.2312                         Obs per group: min =         1
       between = 0.2213                                        avg =       8.7
       overall = 0.1659                                        max =        25

                                                F(82,18612)        =    135.83
corr(u_i, Xb)  = 0.0507                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 18,613 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0621514   .0243058     2.56   0.011     .0145097    .1097931
   during_DD |   .0305035   .0065505     4.66   0.000     .0176639    .0433432
   during_DE |   .1995786   .0412674     4.84   0.000     .1186907    .2804665
   during_ED |    .160502   .0364696     4.40   0.000     .0890182    .2319858
   during_EE |   .1828603   .0377323     4.85   0.000     .1089015     .256819
    after_DD |   .0489383   .0122986     3.98   0.000     .0248319    .0730446
    after_DE |   .3019058   .0467838     6.45   0.000     .2102052    .3936063
    after_ED |   .2708389   .0591501     4.58   0.000     .1548992    .3867785
    after_EE |    .268649   .0561774     4.78   0.000     .1585362    .3787619
             |
    ind_year |
          2  |   .0801748   .0162408     4.94   0.000     .0483413    .1120083
          3  |   .2411332   .0202891    11.88   0.000     .2013648    .2809017
          4  |    .417868   .0228757    18.27   0.000     .3730294    .4627066
          5  |   .5759638   .0250679    22.98   0.000     .5268284    .6250992
          6  |   .7556165   .0280561    26.93   0.000      .700624     .810609
          7  |   .8931618   .0306098    29.18   0.000     .8331636    .9531599
          8  |   .9815351   .0329161    29.82   0.000     .9170165    1.046054
          9  |   1.106707   .0355117    31.16   0.000       1.0371    1.176313
         10  |   1.230942    .038233    32.20   0.000     1.156002    1.305883
         11  |   1.298083   .0408917    31.74   0.000     1.217932    1.378235
         12  |   1.326061   .0436772    30.36   0.000      1.24045    1.411673
         13  |   1.372494   .0463835    29.59   0.000     1.281578     1.46341
         14  |   1.416591   .0489903    28.92   0.000     1.320565    1.512616
         15  |   1.489548   .0519399    28.68   0.000     1.387741    1.591355
         16  |   1.526217   .0542871    28.11   0.000     1.419809    1.632625
         17  |   1.585177   .0572127    27.71   0.000     1.473034    1.697319
         18  |   1.524069   .0599758    25.41   0.000     1.406511    1.641627
         19  |   1.549035   .0626156    24.74   0.000     1.426302    1.671767
         20  |   1.597634   .0651987    24.50   0.000     1.469839     1.72543
         21  |   1.620851   .0676018    23.98   0.000     1.488345    1.753356
         22  |   1.677212   .0698105    24.03   0.000     1.540377    1.814047
         23  |   1.729418   .0720145    24.01   0.000     1.588263    1.870573
         24  |   1.763883    .074594    23.65   0.000     1.617672    1.910094
         25  |   1.757625   .0768421    22.87   0.000     1.607007    1.908242
         26  |  -.2566256   .0388373    -6.61   0.000    -.3327503    -.180501
         27  |  -.1455848   .0372344    -3.91   0.000    -.2185677    -.072602
         28  |   .0183362   .0363011     0.51   0.613    -.0528173    .0894897
         29  |    .252528   .0364438     6.93   0.000     .1810947    .3239612
         30  |   .4125655   .0365829    11.28   0.000     .3408598    .4842713
         31  |   .5809107   .0376346    15.44   0.000     .5071434    .6546779
         32  |   .7233931   .0386938    18.70   0.000     .6475497    .7992364
         33  |   .7933955   .0399691    19.85   0.000     .7150524    .8717386
         34  |   .9427727   .0418231    22.54   0.000     .8607957     1.02475
         35  |   1.035227   .0435581    23.77   0.000     .9498492    1.120605
         36  |   1.094768   .0458171    23.89   0.000     1.004963    1.184574
         37  |   1.154422   .0481129    23.99   0.000     1.060117    1.248728
         38  |   1.235752   .0503947    24.52   0.000     1.136974     1.33453
         39  |   1.280088   .0528463    24.22   0.000     1.176504    1.383671
         40  |   1.376782   .0559549    24.61   0.000     1.267105    1.486459
         41  |   1.452523    .057858    25.10   0.000     1.339116     1.56593
         42  |   1.529825   .0602044    25.41   0.000     1.411819    1.647831
         43  |   1.506276    .062932    23.93   0.000     1.382923    1.629628
         44  |   1.549534   .0657447    23.57   0.000     1.420668    1.678399
         45  |   1.622016   .0682827    23.75   0.000     1.488175    1.755856
         46  |   1.631492   .0707625    23.06   0.000     1.492791    1.770193
         47  |   1.658872   .0727032    22.82   0.000     1.516367    1.801377
         48  |   1.720194   .0747212    23.02   0.000     1.573733    1.866654
         49  |    1.73397   .0774198    22.40   0.000      1.58222     1.88572
         50  |   1.765642   .0795517    22.19   0.000     1.609713     1.92157
             |
     age_cat |
          1  |   .2445587   .0159112    15.37   0.000     .2133713     .275746
          2  |   .2453895   .0176792    13.88   0.000     .2107367    .2800424
          3  |   .2252864   .0196214    11.48   0.000     .1868266    .2637462
          4  |   .2144743   .0216514     9.91   0.000     .1720355     .256913
          5  |   .2027462   .0239383     8.47   0.000      .155825    .2496675
          6  |   .1858943   .0264491     7.03   0.000     .1340517    .2377369
          7  |   .1879217   .0290202     6.48   0.000     .1310395    .2448039
          8  |   .1741076   .0317061     5.49   0.000     .1119607    .2362546
          9  |    .161117   .0344132     4.68   0.000     .0936639    .2285701
         10  |    .145602   .0371644     3.92   0.000     .0727564    .2184476
         11  |   .1452663   .0400275     3.63   0.000     .0668088    .2237238
         12  |   .1424157   .0428471     3.32   0.001     .0584316    .2263999
         13  |   .1327957   .0456786     2.91   0.004     .0432615    .2223298
         14  |   .1349517   .0485583     2.78   0.005      .039773    .2301303
         15  |   .1300637   .0514499     2.53   0.011     .0292172    .2309102
         16  |   .1218817     .05428     2.25   0.025     .0154879    .2282756
         17  |   .1056098   .0574015     1.84   0.066    -.0069024    .2181221
         18  |   .1008749   .0603203     1.67   0.094    -.0173584    .2191082
         19  |   .0798657   .0635231     1.26   0.209    -.0446455    .2043768
         20  |   .0507879   .0691764     0.73   0.463    -.0848041      .18638
         25  |  -.0005405   .0784942    -0.01   0.995    -.1543962    .1533153
         30  |   .0100116   .1038227     0.10   0.923    -.1934903    .2135136
         40  |   -.009318   .1151099    -0.08   0.935    -.2349439    .2163078
         50  |  -.0198229   .1258735    -0.16   0.875    -.2665464    .2269006
             |
       _cons |   7.564689   .0275803   274.28   0.000     7.510629    7.618749
-------------+----------------------------------------------------------------
     sigma_u |  1.1442746
     sigma_e |  .53632802
         rho |  .81988379   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .2311567681969946

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    455,349
Group variable: firm_person                     Number of groups  =     52,559

R-sq:                                           Obs per group:
     within  = 0.2312                                         min =          1
     between = 0.2213                                         avg =        8.7
     overall = 0.1659                                         max =         25

                                                F(82,18612)       =     135.83
corr(u_i, Xb)  = 0.0507                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 18,613 clusters in id)
------------------------------------------------------------------------------
             |               Robust
        lnQL |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0621514   .0243058     2.56   0.011     .0145097    .1097931
   during_DD |   .0305035   .0065505     4.66   0.000     .0176639    .0433432
   during_DE |   .1995786   .0412674     4.84   0.000     .1186907    .2804665
   during_ED |    .160502   .0364696     4.40   0.000     .0890182    .2319858
   during_EE |   .1828603   .0377323     4.85   0.000     .1089015     .256819
    after_DD |   .0489383   .0122986     3.98   0.000     .0248319    .0730446
    after_DE |   .3019058   .0467838     6.45   0.000     .2102052    .3936063
    after_ED |   .2708389   .0591501     4.58   0.000     .1548992    .3867785
    after_EE |    .268649   .0561774     4.78   0.000     .1585362    .3787619
             |
    ind_year |
          2  |   .0801748   .0162408     4.94   0.000     .0483413    .1120083
          3  |   .2411332   .0202891    11.88   0.000     .2013648    .2809017
          4  |    .417868   .0228757    18.27   0.000     .3730294    .4627066
          5  |   .5759638   .0250679    22.98   0.000     .5268284    .6250992
          6  |   .7556165   .0280561    26.93   0.000      .700624     .810609
          7  |   .8931618   .0306098    29.18   0.000     .8331636    .9531599
          8  |   .9815351   .0329161    29.82   0.000     .9170165    1.046054
          9  |   1.106707   .0355117    31.16   0.000       1.0371    1.176313
         10  |   1.230942    .038233    32.20   0.000     1.156002    1.305883
         11  |   1.298083   .0408917    31.74   0.000     1.217932    1.378235
         12  |   1.326061   .0436772    30.36   0.000      1.24045    1.411673
         13  |   1.372494   .0463835    29.59   0.000     1.281578     1.46341
         14  |   1.416591   .0489903    28.92   0.000     1.320565    1.512616
         15  |   1.489548   .0519399    28.68   0.000     1.387741    1.591355
         16  |   1.526217   .0542871    28.11   0.000     1.419809    1.632625
         17  |   1.585177   .0572127    27.71   0.000     1.473034    1.697319
         18  |   1.524069   .0599758    25.41   0.000     1.406511    1.641627
         19  |   1.549035   .0626156    24.74   0.000     1.426302    1.671767
         20  |   1.597634   .0651987    24.50   0.000     1.469839     1.72543
         21  |   1.620851   .0676018    23.98   0.000     1.488345    1.753356
         22  |   1.677212   .0698105    24.03   0.000     1.540377    1.814047
         23  |   1.729418   .0720145    24.01   0.000     1.588263    1.870573
         24  |   1.763883    .074594    23.65   0.000     1.617672    1.910094
         25  |   1.757625   .0768421    22.87   0.000     1.607007    1.908242
         26  |  -.2566256   .0388373    -6.61   0.000    -.3327503    -.180501
         27  |  -.1455848   .0372344    -3.91   0.000    -.2185677    -.072602
         28  |   .0183362   .0363011     0.51   0.613    -.0528173    .0894897
         29  |    .252528   .0364438     6.93   0.000     .1810947    .3239612
         30  |   .4125655   .0365829    11.28   0.000     .3408598    .4842713
         31  |   .5809107   .0376346    15.44   0.000     .5071434    .6546779
         32  |   .7233931   .0386938    18.70   0.000     .6475497    .7992364
         33  |   .7933955   .0399691    19.85   0.000     .7150524    .8717386
         34  |   .9427727   .0418231    22.54   0.000     .8607957     1.02475
         35  |   1.035227   .0435581    23.77   0.000     .9498492    1.120605
         36  |   1.094768   .0458171    23.89   0.000     1.004963    1.184574
         37  |   1.154422   .0481129    23.99   0.000     1.060117    1.248728
         38  |   1.235752   .0503947    24.52   0.000     1.136974     1.33453
         39  |   1.280088   .0528463    24.22   0.000     1.176504    1.383671
         40  |   1.376782   .0559549    24.61   0.000     1.267105    1.486459
         41  |   1.452523    .057858    25.10   0.000     1.339116     1.56593
         42  |   1.529825   .0602044    25.41   0.000     1.411819    1.647831
         43  |   1.506276    .062932    23.93   0.000     1.382923    1.629628
         44  |   1.549534   .0657447    23.57   0.000     1.420668    1.678399
         45  |   1.622016   .0682827    23.75   0.000     1.488175    1.755856
         46  |   1.631492   .0707625    23.06   0.000     1.492791    1.770193
         47  |   1.658872   .0727032    22.82   0.000     1.516367    1.801377
         48  |   1.720194   .0747212    23.02   0.000     1.573733    1.866654
         49  |    1.73397   .0774198    22.40   0.000      1.58222     1.88572
         50  |   1.765642   .0795517    22.19   0.000     1.609713     1.92157
             |
     age_cat |
          1  |   .2445587   .0159112    15.37   0.000     .2133713     .275746
          2  |   .2453895   .0176792    13.88   0.000     .2107367    .2800424
          3  |   .2252864   .0196214    11.48   0.000     .1868266    .2637462
          4  |   .2144743   .0216514     9.91   0.000     .1720355     .256913
          5  |   .2027462   .0239383     8.47   0.000      .155825    .2496675
          6  |   .1858943   .0264491     7.03   0.000     .1340517    .2377369
          7  |   .1879217   .0290202     6.48   0.000     .1310395    .2448039
          8  |   .1741076   .0317061     5.49   0.000     .1119607    .2362546
          9  |    .161117   .0344132     4.68   0.000     .0936639    .2285701
         10  |    .145602   .0371644     3.92   0.000     .0727564    .2184476
         11  |   .1452663   .0400275     3.63   0.000     .0668088    .2237238
         12  |   .1424157   .0428471     3.32   0.001     .0584316    .2263999
         13  |   .1327957   .0456786     2.91   0.004     .0432615    .2223298
         14  |   .1349517   .0485583     2.78   0.005      .039773    .2301303
         15  |   .1300637   .0514499     2.53   0.011     .0292172    .2309102
         16  |   .1218817     .05428     2.25   0.025     .0154879    .2282756
         17  |   .1056098   .0574015     1.84   0.066    -.0069024    .2181221
         18  |   .1008749   .0603203     1.67   0.094    -.0173584    .2191082
         19  |   .0798657   .0635231     1.26   0.209    -.0446455    .2043768
         20  |   .0507879   .0691764     0.73   0.463    -.0848041      .18638
         25  |  -.0005405   .0784942    -0.01   0.995    -.1543962    .1533153
         30  |   .0100116   .1038227     0.10   0.923    -.1934903    .2135136
         40  |   -.009318   .1151099    -0.08   0.935    -.2349439    .2163078
         50  |  -.0198229   .1258735    -0.16   0.875    -.2665464    .2269006
             |
       _cons |   7.564689   .0275803   274.28   0.000     7.510629    7.618749
-------------+----------------------------------------------------------------
     sigma_u |  1.1442746
     sigma_e |  .53632802
         rho |  .81988379   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[du
> ring_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         connect(stepstair) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle("") title(`title') le
> gend(off) aspect(.5) plotregion(style(none)) xsize(16) ysize(10))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 18612) =   21.68
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 18612) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 18612) =   23.39
            Prob > F =    0.0000

 ( 1)  - during_DD + during_DE = 0

       F(  1, 18612) =   16.50
            Prob > F =    0.0000
variable label was str11 now str13
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 18612) =   19.37
            Prob > F =    0.0000

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 18612) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 18612) =   23.49
            Prob > F =    0.0000

 ( 1)  - during_ED + during_EE = 0

       F(  1, 18612) =    0.24
            Prob > F =    0.6244

. 
. graph export output/figure/`fname'_tree.png, width(1600) replace
(file output/figure/lnQL_tree.png written in PNG format)

. 
end of do-file

Fixed-effects (within) regression               Number of obs      =    455349
Group variable: firm_person                     Number of groups   =     52559

R-sq:  within  = 0.0450                         Obs per group: min =         1
       between = 0.0666                                        avg =       8.7
       overall = 0.0570                                        max =        25

                                                F(82,18612)        =     30.22
corr(u_i, Xb)  = 0.1003                         Prob > F           =    0.0000

                                (Std. Err. adjusted for 18,613 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0147551   .0115437     1.28   0.201    -.0078715    .0373818
   during_DD |  -.0102811   .0030817    -3.34   0.001    -.0163214   -.0042408
   during_DE |   .0399423   .0171429     2.33   0.020     .0063407    .0735439
   during_ED |   .0026483    .016552     0.16   0.873    -.0297951    .0350917
   during_EE |   .0302357   .0193514     1.56   0.118    -.0076948    .0681662
    after_DD |   -.024603   .0053371    -4.61   0.000    -.0350642   -.0141418
    after_DE |   .0122088   .0209399     0.58   0.560    -.0288354     .053253
    after_ED |  -.0307373   .0213695    -1.44   0.150    -.0726235     .011149
    after_EE |   .0434124    .027177     1.60   0.110    -.0098571    .0966819
             |
    ind_year |
          2  |  -.0238432    .007688    -3.10   0.002    -.0389123   -.0087741
          3  |   -.045881   .0093437    -4.91   0.000    -.0641956   -.0275665
          4  |  -.0559011   .0103827    -5.38   0.000    -.0762521     -.03555
          5  |  -.0529877   .0116279    -4.56   0.000    -.0757794   -.0301959
          6  |  -.0677106   .0127419    -5.31   0.000    -.0926858   -.0427354
          7  |  -.0699682   .0138978    -5.03   0.000     -.097209   -.0427273
          8  |  -.0833569   .0149979    -5.56   0.000    -.1127543   -.0539596
          9  |   -.082293   .0163441    -5.04   0.000     -.114329    -.050257
         10  |  -.0810994   .0175513    -4.62   0.000    -.1155015   -.0466973
         11  |  -.0872901   .0188869    -4.62   0.000    -.1243102     -.05027
         12  |  -.0908107   .0201211    -4.51   0.000    -.1302499   -.0513714
         13  |  -.0843015   .0214959    -3.92   0.000    -.1264354   -.0421676
         14  |  -.0772535   .0228903    -3.37   0.001    -.1221205   -.0323864
         15  |  -.0675793   .0242231    -2.79   0.005    -.1150589   -.0200998
         16  |  -.0540254   .0255343    -2.12   0.034    -.1040749   -.0039759
         17  |  -.0372338   .0269128    -1.38   0.167    -.0899853    .0155177
         18  |  -.0332375   .0283537    -1.17   0.241    -.0888134    .0223384
         19  |  -.0317114   .0296828    -1.07   0.285    -.0898925    .0264697
         20  |  -.0235728   .0309487    -0.76   0.446    -.0842351    .0370895
         21  |  -.0275637   .0321404    -0.86   0.391    -.0905618    .0354345
         22  |  -.0212359   .0332535    -0.64   0.523    -.0864159     .043944
         23  |  -.0259023   .0343935    -0.75   0.451    -.0933168    .0415121
         24  |    -.13078   .0355626    -3.68   0.000     -.200486    -.061074
         25  |   -.167052    .036899    -4.53   0.000    -.2393773   -.0947266
         26  |   .0109738   .0200967     0.55   0.585    -.0284175    .0503651
         27  |  -.0095956   .0181899    -0.53   0.598    -.0452495    .0260583
         28  |  -.0009368   .0178168    -0.05   0.958    -.0358594    .0339858
         29  |  -.0049068   .0176334    -0.28   0.781    -.0394698    .0296562
         30  |  -.0000315   .0176954    -0.00   0.999    -.0347161     .034653
         31  |  -.0022004   .0178848    -0.12   0.902    -.0372562    .0328555
         32  |   .0070793    .018295     0.39   0.699    -.0287805    .0429391
         33  |  -.0001265   .0188831    -0.01   0.995    -.0371391    .0368861
         34  |  -.0024375   .0197685    -0.12   0.902    -.0411857    .0363106
         35  |   .0048245   .0205551     0.23   0.814    -.0354654    .0451143
         36  |   .0035827    .021715     0.16   0.869    -.0389807    .0461461
         37  |  -.0075003   .0228087    -0.33   0.742    -.0522074    .0372068
         38  |  -.0108884   .0238482    -0.46   0.648    -.0576331    .0358563
         39  |  -.0049396   .0251801    -0.20   0.844    -.0542949    .0444157
         40  |   .0055034   .0261739     0.21   0.833       -.0458    .0568067
         41  |   .0216514   .0273909     0.79   0.429    -.0320373    .0753401
         42  |   .0278337   .0286346     0.97   0.331    -.0282928    .0839601
         43  |    .033594     .02999     1.12   0.263    -.0251891    .0923771
         44  |   .0514835   .0313424     1.64   0.100    -.0099506    .1129175
         45  |    .056908   .0326248     1.74   0.081    -.0070397    .1208557
         46  |   .0578296   .0339537     1.70   0.089    -.0087228     .124382
         47  |   .0719552    .034936     2.06   0.039     .0034775    .1404329
         48  |   .0642475   .0357812     1.80   0.073    -.0058869    .1343818
         49  |  -.2263524   .0372311    -6.08   0.000    -.2993287   -.1533761
         50  |   -.277572    .038581    -7.19   0.000    -.3531944   -.2019497
             |
     age_cat |
          1  |   .0519687   .0063062     8.24   0.000     .0396079    .0643294
          2  |   .0745435   .0071994    10.35   0.000     .0604319     .088655
          3  |   .0909657   .0081438    11.17   0.000     .0750032    .1069283
          4  |   .1155326   .0092757    12.46   0.000     .0973513    .1337138
          5  |   .1322471   .0104586    12.64   0.000     .1117473    .1527469
          6  |   .1449075   .0117899    12.29   0.000     .1217981    .1680168
          7  |   .1524634   .0131111    11.63   0.000     .1267645    .1781623
          8  |   .1685325   .0145023    11.62   0.000     .1401066    .1969584
          9  |   .1721141   .0158836    10.84   0.000     .1409808    .2032474
         10  |   .1760841   .0172854    10.19   0.000     .1422032     .209965
         11  |   .1866273   .0186748     9.99   0.000     .1500231    .2232316
         12  |   .1892176   .0200672     9.43   0.000     .1498841    .2285511
         13  |   .1965679   .0215264     9.13   0.000     .1543741    .2387617
         14  |   .2044809   .0230022     8.89   0.000     .1593945    .2495672
         15  |   .2140789   .0243966     8.77   0.000     .1662594    .2618984
         16  |    .219316   .0258315     8.49   0.000     .1686839    .2699482
         17  |    .224095   .0272077     8.24   0.000     .1707655    .2774245
         18  |   .2316037   .0287711     8.05   0.000     .1752096    .2879978
         19  |   .2259135   .0303532     7.44   0.000     .1664184    .2854085
         20  |   .2337063    .032815     7.12   0.000     .1693858    .2980268
         25  |   .2450841   .0376447     6.51   0.000     .1712972    .3188711
         30  |   .2421162   .0520393     4.65   0.000     .1401144     .344118
         40  |   .2190557   .0583858     3.75   0.000     .1046143    .3334972
         50  |   .1531397   .0620885     2.47   0.014     .0314407    .2748388
             |
       _cons |   .2132644   .0117058    18.22   0.000     .1903199    .2362089
-------------+----------------------------------------------------------------
     sigma_u |  .38931954
     sigma_e |   .2858974
         rho |  .64965769   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. args tablefile specname speclabel

. 
. local fmt "%10.5f"

. 
. * create directory if needed
. * FIXME: this only works with relative paths
. local list_of_dirs = subinstr("`tablefile'/columns","/"," ",.)

. local sofar "."

. foreach word in `list_of_dirs' {
  2.         local sofar "`sofar'/`word'"
  3.         capture mkdir "`sofar'"
  4. }

. 
. macro shift

. macro shift

. macro shift

. 
. local _others ""

. local _state "key"

. while "`1'"!="" {
  2.         if ("`_state'"=="key") {
  3.                 di "key: `1'"
  4.                 local _key `1'
  5.                 local _state "value"
  6.                 local _others "`_others' `1'"
  7.         }
  8.         else {
  9.                 di "value: `1'"
 10.                 local `_key' "`1'"
 11.                 local _state "key"
 12.         }
 13.         macro shift
 14. }
key: R2_within
value: .0449824035931622

. 
. estimates

----------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------

Fixed-effects (within) regression               Number of obs     =    455,349
Group variable: firm_person                     Number of groups  =     52,559

R-sq:                                           Obs per group:
     within  = 0.0450                                         min =          1
     between = 0.0666                                         avg =        8.7
     overall = 0.0570                                         max =         25

                                                F(82,18612)       =      30.22
corr(u_i, Xb)  = 0.1003                         Prob > F          =     0.0000

                                (Std. Err. adjusted for 18,613 clusters in id)
------------------------------------------------------------------------------
             |               Robust
    exporter |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
     foreign |   .0147551   .0115437     1.28   0.201    -.0078715    .0373818
   during_DD |  -.0102811   .0030817    -3.34   0.001    -.0163214   -.0042408
   during_DE |   .0399423   .0171429     2.33   0.020     .0063407    .0735439
   during_ED |   .0026483    .016552     0.16   0.873    -.0297951    .0350917
   during_EE |   .0302357   .0193514     1.56   0.118    -.0076948    .0681662
    after_DD |   -.024603   .0053371    -4.61   0.000    -.0350642   -.0141418
    after_DE |   .0122088   .0209399     0.58   0.560    -.0288354     .053253
    after_ED |  -.0307373   .0213695    -1.44   0.150    -.0726235     .011149
    after_EE |   .0434124    .027177     1.60   0.110    -.0098571    .0966819
             |
    ind_year |
          2  |  -.0238432    .007688    -3.10   0.002    -.0389123   -.0087741
          3  |   -.045881   .0093437    -4.91   0.000    -.0641956   -.0275665
          4  |  -.0559011   .0103827    -5.38   0.000    -.0762521     -.03555
          5  |  -.0529877   .0116279    -4.56   0.000    -.0757794   -.0301959
          6  |  -.0677106   .0127419    -5.31   0.000    -.0926858   -.0427354
          7  |  -.0699682   .0138978    -5.03   0.000     -.097209   -.0427273
          8  |  -.0833569   .0149979    -5.56   0.000    -.1127543   -.0539596
          9  |   -.082293   .0163441    -5.04   0.000     -.114329    -.050257
         10  |  -.0810994   .0175513    -4.62   0.000    -.1155015   -.0466973
         11  |  -.0872901   .0188869    -4.62   0.000    -.1243102     -.05027
         12  |  -.0908107   .0201211    -4.51   0.000    -.1302499   -.0513714
         13  |  -.0843015   .0214959    -3.92   0.000    -.1264354   -.0421676
         14  |  -.0772535   .0228903    -3.37   0.001    -.1221205   -.0323864
         15  |  -.0675793   .0242231    -2.79   0.005    -.1150589   -.0200998
         16  |  -.0540254   .0255343    -2.12   0.034    -.1040749   -.0039759
         17  |  -.0372338   .0269128    -1.38   0.167    -.0899853    .0155177
         18  |  -.0332375   .0283537    -1.17   0.241    -.0888134    .0223384
         19  |  -.0317114   .0296828    -1.07   0.285    -.0898925    .0264697
         20  |  -.0235728   .0309487    -0.76   0.446    -.0842351    .0370895
         21  |  -.0275637   .0321404    -0.86   0.391    -.0905618    .0354345
         22  |  -.0212359   .0332535    -0.64   0.523    -.0864159     .043944
         23  |  -.0259023   .0343935    -0.75   0.451    -.0933168    .0415121
         24  |    -.13078   .0355626    -3.68   0.000     -.200486    -.061074
         25  |   -.167052    .036899    -4.53   0.000    -.2393773   -.0947266
         26  |   .0109738   .0200967     0.55   0.585    -.0284175    .0503651
         27  |  -.0095956   .0181899    -0.53   0.598    -.0452495    .0260583
         28  |  -.0009368   .0178168    -0.05   0.958    -.0358594    .0339858
         29  |  -.0049068   .0176334    -0.28   0.781    -.0394698    .0296562
         30  |  -.0000315   .0176954    -0.00   0.999    -.0347161     .034653
         31  |  -.0022004   .0178848    -0.12   0.902    -.0372562    .0328555
         32  |   .0070793    .018295     0.39   0.699    -.0287805    .0429391
         33  |  -.0001265   .0188831    -0.01   0.995    -.0371391    .0368861
         34  |  -.0024375   .0197685    -0.12   0.902    -.0411857    .0363106
         35  |   .0048245   .0205551     0.23   0.814    -.0354654    .0451143
         36  |   .0035827    .021715     0.16   0.869    -.0389807    .0461461
         37  |  -.0075003   .0228087    -0.33   0.742    -.0522074    .0372068
         38  |  -.0108884   .0238482    -0.46   0.648    -.0576331    .0358563
         39  |  -.0049396   .0251801    -0.20   0.844    -.0542949    .0444157
         40  |   .0055034   .0261739     0.21   0.833       -.0458    .0568067
         41  |   .0216514   .0273909     0.79   0.429    -.0320373    .0753401
         42  |   .0278337   .0286346     0.97   0.331    -.0282928    .0839601
         43  |    .033594     .02999     1.12   0.263    -.0251891    .0923771
         44  |   .0514835   .0313424     1.64   0.100    -.0099506    .1129175
         45  |    .056908   .0326248     1.74   0.081    -.0070397    .1208557
         46  |   .0578296   .0339537     1.70   0.089    -.0087228     .124382
         47  |   .0719552    .034936     2.06   0.039     .0034775    .1404329
         48  |   .0642475   .0357812     1.80   0.073    -.0058869    .1343818
         49  |  -.2263524   .0372311    -6.08   0.000    -.2993287   -.1533761
         50  |   -.277572    .038581    -7.19   0.000    -.3531944   -.2019497
             |
     age_cat |
          1  |   .0519687   .0063062     8.24   0.000     .0396079    .0643294
          2  |   .0745435   .0071994    10.35   0.000     .0604319     .088655
          3  |   .0909657   .0081438    11.17   0.000     .0750032    .1069283
          4  |   .1155326   .0092757    12.46   0.000     .0973513    .1337138
          5  |   .1322471   .0104586    12.64   0.000     .1117473    .1527469
          6  |   .1449075   .0117899    12.29   0.000     .1217981    .1680168
          7  |   .1524634   .0131111    11.63   0.000     .1267645    .1781623
          8  |   .1685325   .0145023    11.62   0.000     .1401066    .1969584
          9  |   .1721141   .0158836    10.84   0.000     .1409808    .2032474
         10  |   .1760841   .0172854    10.19   0.000     .1422032     .209965
         11  |   .1866273   .0186748     9.99   0.000     .1500231    .2232316
         12  |   .1892176   .0200672     9.43   0.000     .1498841    .2285511
         13  |   .1965679   .0215264     9.13   0.000     .1543741    .2387617
         14  |   .2044809   .0230022     8.89   0.000     .1593945    .2495672
         15  |   .2140789   .0243966     8.77   0.000     .1662594    .2618984
         16  |    .219316   .0258315     8.49   0.000     .1686839    .2699482
         17  |    .224095   .0272077     8.24   0.000     .1707655    .2774245
         18  |   .2316037   .0287711     8.05   0.000     .1752096    .2879978
         19  |   .2259135   .0303532     7.44   0.000     .1664184    .2854085
         20  |   .2337063    .032815     7.12   0.000     .1693858    .2980268
         25  |   .2450841   .0376447     6.51   0.000     .1712972    .3188711
         30  |   .2421162   .0520393     4.65   0.000     .1401144     .344118
         40  |   .2190557   .0583858     3.75   0.000     .1046143    .3334972
         50  |   .1531397   .0620885     2.47   0.014     .0314407    .2748388
             |
       _cons |   .2132644   .0117058    18.22   0.000     .1903199    .2362089
-------------+----------------------------------------------------------------
     sigma_u |  .38931954
     sigma_e |   .2858974
         rho |  .64965769   (fraction of variance due to u_i)
------------------------------------------------------------------------------

. tempname output coefs stats variables b se

. matrix `coefs' = r(table)

. local observations `e(N)'

. local R2 `e(r2)'

. 
. local `stats' : rownames(`coefs')

. local `variables' : colnames(`coefs')

. 
. 
. file open `output' using "`tablefile'/columns/`specname'.yaml", write text repla
> ce

. 
. file write `output' "id: " "`specname'" _newline

. file write `output' "label: " "`speclabel'" _newline

. 
. file write `output' "coefficients:" _newline

. foreach X in ``variables'' {
  2.         scalar `b' = `coefs'[rownumb(`coefs',"b"),colnumb(`coefs',"`X'")]
  3.         scalar `se' = `coefs'[rownumb(`coefs',"se"),colnumb(`coefs',"`X'")]
  4.         file write `output' (" - id: `X'") _newline
  5.         file write `output' ("   estimate: " + string(`b', "`fmt'")) _newline
  6.         file write `output' ("   standard_error: " + string(`se', "`fmt'")) _
> newline
  7.         file write `output' ("   t_statistic: " + string(`b'/`se', "`fmt'")) 
> _newline
  8.         file write `output' ("   p_value: " + string(`coefs'[rownumb(`coefs',
> "pvalue"),colnumb(`coefs',"`X'")]), "`fmt'") _newline
  9. }

. file write `output' "extra_rows:" _newline

. foreach X in R2 observations `_others'{
  2.         if ("``X''"!="") {
  3.                 file write `output' (" - id: `X'") _newline
  4.                 file write `output' ("   value: ``X''") _newline
  5.         }
  6. }

. 
. file close `output'

. 
end of do-file

. local fname = e(depvar)

. local title : variable label `fname'

. 
. slopegraph, ///
>         from(0 0 0 0 1 _b[during_DE] 1 _b[during_DE]) ///
>         to(1 _b[during_DD] 1 _b[during_DE] 2 _b[during_ED]+_b[during_DE] 2 _b[du
> ring_EE]+_b[during_DE]) ///
>         style(p1 p2 p1 p2) ///
>         label(Local-Local Local-Expat Expat-Local Expat-Expat) ///
>         width_test(during_DD during_DE during_ED during_EE) ///
>         star_test(1==1 during_DE==during_DD 1==1 during_EE==during_ED) ///
>         connect(stepstair) ///
>         format(scheme(538w) xlabel(none) xtitle("") ytitle("") title(`title') le
> gend(off) aspect(.5) plotregion(style(none)) xsize(16) ysize(10))
number of observations (_N) was 0, now 8
(8 missing values generated)
(8 missing values generated)
(8 missing values generated)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
variable label was str1 now str11
(1 real change made)

 ( 1)  during_DD = 0

       F(  1, 18612) =   11.13
            Prob > F =    0.0009

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 18612) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_DE = 0

       F(  1, 18612) =    5.43
            Prob > F =    0.0198

 ( 1)  - during_DD + during_DE = 0

       F(  1, 18612) =    8.45
            Prob > F =    0.0037
variable label was str11 now str13
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_ED = 0

       F(  1, 18612) =    0.03
            Prob > F =    0.8729

 ( 1) = 0
       Constraint 1 dropped

       F(  0, 18612) =       .
            Prob > F =         .
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

 ( 1)  during_EE = 0

       F(  1, 18612) =    2.44
            Prob > F =    0.1182

 ( 1)  - during_ED + during_EE = 0

       F(  1, 18612) =    1.36
            Prob > F =    0.2437

. 
. graph export output/figure/`fname'_tree.png, width(1600) replace
(file output/figure/exporter_tree.png written in PNG format)

. 
end of do-file

. 
end of do-file

. 
. log close
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/
> estimate_switch.log
  log type:  text
 closed on:  12 Jan 2019, 13:14:46
----------------------------------------------------------------------------------
