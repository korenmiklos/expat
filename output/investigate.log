--------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /srv/sandbox/zavecz/dropbox_encrypted/darthmouth/expat-analysis//output/investigate.log
  log type:  text
 opened on:  23 Apr 2021, 00:34:26

. 
. * keep only sample from balance-small - NOTE: had to restructure as we have to keep foreign which is different in years - so no collapse this time
. use "`here'/temp/balance-small-clean.dta"

. by frame_id_numeric: egen firm_birth = min(year)

. by frame_id_numeric: egen firm_death = max(year)

. keep frame_id year firm_birth firm_death foreign

. tempfile sample

. save `sample', replace
(note: file /srv/sandbox/zavecz/St3190620.000001 not found)
file /srv/sandbox/zavecz/St3190620.000001 saved

. 
. * count expats in do - asterisk used
. use "`here'/input/ceo-panel/ceo-panel.dta", clear // QUESTION: what is owner

. rename person_id manager_id

. merge m:1 frame_id_numeric year using `sample', keep(match) nogen

    Result                           # of obs.
    -----------------------------------------
    not matched                             0
    matched                           417,692  
    -----------------------------------------

. bys frame_id_numeric: egen ever_expat = max(expat == 1)

. bys frame_id_numeri: egen ever_foreign = max(foreign == 1)

. egen firm_tag = tag(frame_id_numeric)

. count if ever_expat == 1 & ever_foreign == 0 & firm_tag == 1
  567

. 
. keep if ever_expat == 1 & ever_foreign == 0
(407,588 observations deleted)

. 
. bys frame_id_numeric year: egen expat_firm = max(expat)

. 
. duplicates drop frame_id_numeric year, force

Duplicates in terms of frame_id_numeric year

(3,754 observations deleted)

. 
. tab year expat 

           |         expat
      year |         0          1 |     Total
-----------+----------------------+----------
      1988 |        13          2 |        15 
      1989 |        13          2 |        15 
      1990 |        41          7 |        48 
      1991 |        61         16 |        77 
      1992 |        98         38 |       136 
      1993 |       114         55 |       169 
      1994 |       137         62 |       199 
      1995 |       143         63 |       206 
      1996 |       150         67 |       217 
      1997 |       152         78 |       230 
      1998 |       161         80 |       241 
      1999 |       155         79 |       234 
      2000 |       167         92 |       259 
      2001 |       163         96 |       259 
      2002 |       166         89 |       255 
      2003 |       163         95 |       258 
      2004 |       171         89 |       260 
      2005 |       175         83 |       258 
      2006 |       172         88 |       260 
      2007 |       169         84 |       253 
      2008 |       165         88 |       253 
      2009 |       169         81 |       250 
      2010 |       168         75 |       243 
      2011 |       156         73 |       229 
      2012 |       149         77 |       226 
      2013 |       148         85 |       233 
      2014 |       142         81 |       223 
      2015 |       145         69 |       214 
      2016 |       145         60 |       205 
      2017 |       143         72 |       215 
      2018 |       128         82 |       210 
-----------+----------------------+----------
     Total |     4,242      2,108 |     6,350 

. 
.  
. 
end of do-file

. exit, clear
