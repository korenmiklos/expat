-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/koren/Documents/workspace/expat//output/event_studies.log
  log type:  text
 opened on:   7 May 2022, 10:57:01

. 
. local pre 5

. local post 10

. local vars lnL lnQL lnK exporter RperK TFP_cd

. local controls lnQ lnL exporter

. 
. use "`here'/temp/analysis_sample.dta", clear

. keep if ever_foreign
(0 observations deleted)

. 
. xtset frame_id_numeric year

Panel variable: frame_id_numeric (unbalanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

. generate byte Fsurvival = F.survival
(1,588 missing values generated)

. 
. count
  36,666

. 
. rename has_expat_ceo expat_hire

. generate local_hire = foreign_hire & !expat_hire

. generate no_hire = foreign & !foreign_hire

. 
. foreach treatment in no_hire local_hire expat_hire {
  2.     attgt Fsurvival, treatment(`treatment') aggregate(e) pre(`pre') post(`
> post') notyet limitcontrol(foreign == 0) ipw(`controls')
  3.     count if e(sample) == 1
  4.     do "`here'/code/util/event_study_plot.do"
  5.     foreach outcome in Fsurvival {
  6.         graph display `outcome'
  7.         graph export "`here'/output/figure/event_study/`treatment'_`outcom
> e'.png", replace
  8.         graph drop `outcome'
  9.     }
 10. }

Panel variable: frame_id_numeric (unbalanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit
Generating weights...

                          __000001
-------------------------------------------------------------
      Percentiles      Smallest
 1%     .0071377       2.29e-06
 5%     .0192136       6.38e-06
10%     .0301218       9.69e-06       Obs              36,666
25%     .1634394       .0000149       Sum of wgt.      36,666

50%            1                      Mean           .7550099
                        Largest       Std. dev.      .4161708
75%            1              1
90%            1              1       Variance       .1731982
95%            1              1       Skewness      -1.116323
99%            1              1       Kurtosis       2.258595
Estimating Fsurvival: event_m5
Estimating Fsurvival: event_m4
Estimating Fsurvival: event_m3
Estimating Fsurvival: event_m2
Estimating Fsurvival: event_m1
Estimating Fsurvival: event_1
Estimating Fsurvival: event_2
Estimating Fsurvival: event_3
Estimating Fsurvival: event_4
Estimating Fsurvival: event_5
Estimating Fsurvival: event_6
Estimating Fsurvival: event_7
Estimating Fsurvival: event_8
Estimating Fsurvival: event_9
Estimating Fsurvival: event_10
Callaway Sant'Anna (2021)

                                                        Number of obs = 11,636

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
    event_m5 |  -.0287776   .0208209    -1.38   0.167    -.0695859    .0120306
    event_m4 |  -.0238572    .018632    -1.28   0.200    -.0603752    .0126608
    event_m3 |  -.0332906   .0155468    -2.14   0.032    -.0637618   -.0028193
    event_m2 |  -.0345564    .014926    -2.32   0.021    -.0638109   -.0053019
    event_m1 |  -.0353475   .0085937    -4.11   0.000    -.0521909   -.0185041
     event_1 |  -.1642614   .0220182    -7.46   0.000    -.2074163   -.1211065
     event_2 |  -.4694933   .0365599   -12.84   0.000    -.5411495   -.3978372
     event_3 |  -.7521437   .0535485   -14.05   0.000    -.8570968   -.6471906
     event_4 |  -.9767973   .0680913   -14.35   0.000    -1.110254   -.8433408
     event_5 |  -1.134926   .0762165   -14.89   0.000    -1.284308   -.9855447
     event_6 |  -1.296658    .083782   -15.48   0.000    -1.460867   -1.132448
     event_7 |   -1.39084    .088604   -15.70   0.000    -1.564501   -1.217179
     event_8 |  -1.478784   .0930136   -15.90   0.000    -1.661087   -1.296481
     event_9 |  -1.558168   .0990942   -15.72   0.000    -1.752389   -1.363947
    event_10 |  -1.615597    .104771   -15.42   0.000    -1.820945    -1.41025
------------------------------------------------------------------------------
  11,636

. * assume attgt estimate with aggregate(e) option has been recently produced
. preserve

. clear

. 
. local Z 1.96

. 
. local T = colsof(e(b)) 

. set obs `T'
Number of observations (_N) was 0, now 15.

. 
. generate str outcome = ""
(15 missing values generated)

. generate b = 0

. generate t = 0

. generate upper = 0

. generate lower = 0

. 
. local colnames : colnames e(b)

. local outcomes : coleq e(b)

. local treatment = e(treatment)

. 
. forvalues i = 1/`T' {
  2.     * get event time index
.     local name : word `i' of `colnames'
  3.     local outcome : word `i' of `outcomes'
  4.     replace outcome = "`outcome'" in `i'
  5.     replace t = real(subinstr(subinstr("`name'", "event_", "", .), "m", "-
> ", .)) in `i'
  6.     * get estimates from regression
.     replace b = e(b)[1, `i'] in `i'
  7.     replace upper = b + `Z' * sqrt(e(V)[`i', `i']) in `i'
  8.     replace lower = b - `Z' * sqrt(e(V)[`i', `i']) in `i'
  9. }
variable outcome was str1 now str9
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

. * create period 0 for every outcome
. expand 1+(t==1), generate(expanded)
(1 observation created)

. foreach X in t b upper lower {
  2.     replace `X' = 0 if expanded
  3. }
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

. sort outcome t

. 
. levelsof outcome, local(outcomes)
`"Fsurvival"'

. foreach X in `outcomes' {
  2.     twoway (rarea lower upper t if outcome=="`X'", fcolor(blue%30) lwidth(
> none)) ///
>         (line b t if outcome=="`X'", lcolor(blue)), ///
>         ytitle("`X'") xtitle("Year since `treatment'") ///
>         graphregion(color(white)) legend(off)
  3.     graph rename `X'
  4. }

. restore

. 
end of do-file
file /Users/koren/Documents/workspace/expat//output/figure/event_study/no_hire_
> Fsurvival.png written in PNG format

Panel variable: frame_id_numeric (unbalanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit
Generating weights...

                          __000001
-------------------------------------------------------------
      Percentiles      Smallest
 1%       .00953       .0000107
 5%     .0249024       .0000135
10%     .0341853       .0000324       Obs              36,666
25%     .1519537       .0000358       Sum of wgt.      36,666

50%            1                      Mean           .7560706
                        Largest       Std. dev.      .4151744
75%            1              1
90%            1       1.038348       Variance       .1723697
95%            1       1.942193       Skewness      -1.116762
99%            1        1.99165       Kurtosis        2.26343
Estimating Fsurvival: event_m5
Estimating Fsurvival: event_m4
Estimating Fsurvival: event_m3
Estimating Fsurvival: event_m2
Estimating Fsurvival: event_m1
Estimating Fsurvival: event_1
Estimating Fsurvival: event_2
Estimating Fsurvival: event_3
Estimating Fsurvival: event_4
Estimating Fsurvival: event_5
Estimating Fsurvival: event_6
Estimating Fsurvival: event_7
Estimating Fsurvival: event_8
Estimating Fsurvival: event_9
Estimating Fsurvival: event_10
Callaway Sant'Anna (2021)

                                                        Number of obs = 12,764

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
    event_m5 |   .0221562   .0222117     1.00   0.319    -.0213779    .0656903
    event_m4 |   .0063169   .0224202     0.28   0.778    -.0376259    .0502597
    event_m3 |   .0084016   .0206144     0.41   0.684    -.0320018     .048805
    event_m2 |  -.0081321    .015959    -0.51   0.610    -.0394112     .023147
    event_m1 |   -.042509    .009791    -4.34   0.000    -.0616991   -.0233189
     event_1 |  -.0157973   .0210431    -0.75   0.453    -.0570411    .0254465
     event_2 |   -.237933   .0296671    -8.02   0.000    -.2960795   -.1797866
     event_3 |  -.3894112   .0404986    -9.62   0.000    -.4687871   -.3100354
     event_4 |  -.5075788    .046354   -10.95   0.000    -.5984311   -.4167266
     event_5 |  -.6109079   .0525348   -11.63   0.000    -.7138743   -.5079416
     event_6 |   -.679521   .0610713   -11.13   0.000    -.7992184   -.5598235
     event_7 |    -.74991   .0669879   -11.19   0.000    -.8812038   -.6186161
     event_8 |  -.8239531   .0699739   -11.78   0.000    -.9610995   -.6868067
     event_9 |  -.9026536   .0736642   -12.25   0.000    -1.047033   -.7582743
    event_10 |  -.9135139   .0779975   -11.71   0.000    -1.066386   -.7606416
------------------------------------------------------------------------------
  12,764

. * assume attgt estimate with aggregate(e) option has been recently produced
. preserve

. clear

. 
. local Z 1.96

. 
. local T = colsof(e(b)) 

. set obs `T'
Number of observations (_N) was 0, now 15.

. 
. generate str outcome = ""
(15 missing values generated)

. generate b = 0

. generate t = 0

. generate upper = 0

. generate lower = 0

. 
. local colnames : colnames e(b)

. local outcomes : coleq e(b)

. local treatment = e(treatment)

. 
. forvalues i = 1/`T' {
  2.     * get event time index
.     local name : word `i' of `colnames'
  3.     local outcome : word `i' of `outcomes'
  4.     replace outcome = "`outcome'" in `i'
  5.     replace t = real(subinstr(subinstr("`name'", "event_", "", .), "m", "-
> ", .)) in `i'
  6.     * get estimates from regression
.     replace b = e(b)[1, `i'] in `i'
  7.     replace upper = b + `Z' * sqrt(e(V)[`i', `i']) in `i'
  8.     replace lower = b - `Z' * sqrt(e(V)[`i', `i']) in `i'
  9. }
variable outcome was str1 now str9
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

. * create period 0 for every outcome
. expand 1+(t==1), generate(expanded)
(1 observation created)

. foreach X in t b upper lower {
  2.     replace `X' = 0 if expanded
  3. }
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

. sort outcome t

. 
. levelsof outcome, local(outcomes)
`"Fsurvival"'

. foreach X in `outcomes' {
  2.     twoway (rarea lower upper t if outcome=="`X'", fcolor(blue%30) lwidth(
> none)) ///
>         (line b t if outcome=="`X'", lcolor(blue)), ///
>         ytitle("`X'") xtitle("Year since `treatment'") ///
>         graphregion(color(white)) legend(off)
  3.     graph rename `X'
  4. }

. restore

. 
end of do-file
file /Users/koren/Documents/workspace/expat//output/figure/event_study/local_hi
> re_Fsurvival.png written in PNG format

Panel variable: frame_id_numeric (unbalanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit
Generating weights...

                          __000001
-------------------------------------------------------------
      Percentiles      Smallest
 1%      .011793       .0005353
 5%     .0248065       .0005606
10%      .033545       .0027069       Obs              36,666
25%     .1637199       .0027585       Sum of wgt.      36,666

50%            1                      Mean           .7570108
                        Largest       Std. dev.      .4139278
75%            1              1
90%            1              1       Variance       .1713362
95%            1              1       Skewness      -1.122343
99%            1              1       Kurtosis       2.271071
Estimating Fsurvival: event_m5
Estimating Fsurvival: event_m4
Estimating Fsurvival: event_m3
Estimating Fsurvival: event_m2
Estimating Fsurvival: event_m1
Estimating Fsurvival: event_1
Estimating Fsurvival: event_2
Estimating Fsurvival: event_3
Estimating Fsurvival: event_4
Estimating Fsurvival: event_5
Estimating Fsurvival: event_6
Estimating Fsurvival: event_7
Estimating Fsurvival: event_8
Estimating Fsurvival: event_9
Estimating Fsurvival: event_10
Callaway Sant'Anna (2021)

                                                        Number of obs = 13,903

------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
    event_m5 |   .0401939   .0279246     1.44   0.150    -.0145374    .0949252
    event_m4 |   .0308205   .0263254     1.17   0.242    -.0207764    .0824174
    event_m3 |   .0272267   .0223075     1.22   0.222    -.0164953    .0709487
    event_m2 |   .0225204   .0184812     1.22   0.223    -.0137022    .0587429
    event_m1 |  -.0400745   .0104929    -3.82   0.000    -.0606401   -.0195089
     event_1 |  -.0124767   .0189928    -0.66   0.511    -.0497019    .0247484
     event_2 |  -.0872303   .0224317    -3.89   0.000    -.1311955    -.043265
     event_3 |  -.1447347   .0241197    -6.00   0.000    -.1920083    -.097461
     event_4 |  -.2046957     .02702    -7.58   0.000     -.257654   -.1517373
     event_5 |  -.2448919   .0308861    -7.93   0.000    -.3054274   -.1843563
     event_6 |  -.2730655   .0345434    -7.91   0.000    -.3407693   -.2053617
     event_7 |  -.3271243   .0400652    -8.16   0.000    -.4056507    -.248598
     event_8 |  -.3793281   .0440863    -8.60   0.000    -.4657356   -.2929206
     event_9 |  -.4041456   .0464844    -8.69   0.000    -.4952533    -.313038
    event_10 |  -.4202225    .048596    -8.65   0.000    -.5154689   -.3249761
------------------------------------------------------------------------------
  13,903

. * assume attgt estimate with aggregate(e) option has been recently produced
. preserve

. clear

. 
. local Z 1.96

. 
. local T = colsof(e(b)) 

. set obs `T'
Number of observations (_N) was 0, now 15.

. 
. generate str outcome = ""
(15 missing values generated)

. generate b = 0

. generate t = 0

. generate upper = 0

. generate lower = 0

. 
. local colnames : colnames e(b)

. local outcomes : coleq e(b)

. local treatment = e(treatment)

. 
. forvalues i = 1/`T' {
  2.     * get event time index
.     local name : word `i' of `colnames'
  3.     local outcome : word `i' of `outcomes'
  4.     replace outcome = "`outcome'" in `i'
  5.     replace t = real(subinstr(subinstr("`name'", "event_", "", .), "m", "-
> ", .)) in `i'
  6.     * get estimates from regression
.     replace b = e(b)[1, `i'] in `i'
  7.     replace upper = b + `Z' * sqrt(e(V)[`i', `i']) in `i'
  8.     replace lower = b - `Z' * sqrt(e(V)[`i', `i']) in `i'
  9. }
variable outcome was str1 now str9
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

. * create period 0 for every outcome
. expand 1+(t==1), generate(expanded)
(1 observation created)

. foreach X in t b upper lower {
  2.     replace `X' = 0 if expanded
  3. }
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

. sort outcome t

. 
. levelsof outcome, local(outcomes)
`"Fsurvival"'

. foreach X in `outcomes' {
  2.     twoway (rarea lower upper t if outcome=="`X'", fcolor(blue%30) lwidth(
> none)) ///
>         (line b t if outcome=="`X'", lcolor(blue)), ///
>         ytitle("`X'") xtitle("Year since `treatment'") ///
>         graphregion(color(white)) legend(off)
  3.     graph rename `X'
  4. }

. restore

. 
end of do-file
file /Users/koren/Documents/workspace/expat//output/figure/event_study/expat_hi
> re_Fsurvival.png written in PNG format

. keep if survival
(14,108 observations deleted)

. foreach treatment in no_hire local_hire expat_hire {
  2.     attgt `vars' if survival, treatment(`treatment') aggregate(e) pre(`pre
> ') post(`post') notyet limitcontrol(foreign == 0) ipw(`controls')
  3.     count if e(sample) == 1
  4.     do "`here'/code/util/event_study_plot.do"
  5.     foreach outcome in `vars' {
  6.         graph display `outcome'
  7.         graph export "`here'/output/figure/event_study/`treatment'_`outcom
> e'.png", replace
  8.         graph drop `outcome'
  9.     }
 10. }

Panel variable: frame_id_numeric (unbalanced)
 Time variable: year, 1985 to 2018, but with gaps
         Delta: 1 unit
Generating weights...
