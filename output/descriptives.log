--------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/descriptives.log
  log type:  text
 opened on:   4 Dec 2018, 17:10:45

. 
. local format scheme(538w) plotregion(style(none)) 

. 
. use temp/firm_ceo_panel

. 
. gen spell_length = first_exit_year - enter_year + 1

. label var spell_length "Length of CEO spell"

. label var expat "manager nationality"

. label def xp 0 "Local" 1 "Expat"

. label val expat xp

. 
. egen spt = tag(frame_id manager_id)

. 
. hist spell_length if spell_length <=30 & spt, by(expat) disc `format' xsize(20) ysize(8)
(note:  clockdir by_legend_position not found in scheme, default attributes used)

. graph export output/figure/CEO_tenure_histogram.png, width(1600) replace
(file output/figure/CEO_tenure_histogram.png written in PNG format)

. 
. use temp/analysis_sample, clear

. 
. label var expat "manager nationality"

. label def xp 0 "Local" 1 "Expat"

. label val expat xp

. 
. gen byte entrant = year==enter_year

. * only count managers actually at firm
. * cannot use "during" for this as that is 0 for founders
. keep if year>=enter_year & year<=first_exit_year
(443,166 observations deleted)

. 
. preserve

.         egen spt = tag(frame_id manager_id)

.         collapse (sum) N=spt, by(DD DE ED EE)

.         gen str1 from = ""
(5 missing values generated)

.         gen str1 to = ""
(5 missing values generated)

.         gen byte i = 1

.         foreach from in D E {
  2.         foreach to in D E {
  3.                 replace from = "`from'" if `from'`to'
  4.                 replace to = "`to'" if `from'`to'
  5.                 drop `from'`to'
  6.         }
  7.         }
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)
(1 real change made)

.         l

     +-----------------------+
     |     N   from   to   i |
     |-----------------------|
  1. | 31732               1 |
  2. |  4694      E    E   1 |
  3. |  2450      E    D   1 |
  4. |  1819      D    E   1 |
  5. | 15197      D    D   1 |
     +-----------------------+

.         drop if missing(from)
(1 observation deleted)

.         drop i

.         reshape wide N, i(from) j(to) string
(note: j = D E)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                        4   ->       2
Number of variables                   3   ->       3
j variable (2 values)                to   ->   (dropped)
xij variables:
                                      N   ->   ND NE
-----------------------------------------------------------------------------

.         replace from = cond(from=="D","domestic","expat")
variable from was str1 now str8
(2 real changes made)

.         ren ND to_domestic

.         ren NE to_expat

.         export delimited output/table/switches.csv, replace
file output/table/switches.csv saved

. restore

. 
. preserve

.         gen byte categ = 1+expat

.         replace categ = 0 if founder==1
(152,521 real changes made)

.         tab categ

      categ |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    152,521       49.02       49.02
          1 |    127,517       40.99       90.01
          2 |     31,081        9.99      100.00
------------+-----------------------------------
      Total |    311,119      100.00

.         collapse (count) N=entrant, by(age categ)

.         reshape wide N, i(age) j(categ)
(note: j = 0 1 2)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                      279   ->     108
Number of variables                   3   ->       4
j variable (3 values)             categ   ->   (dropped)
xij variables:
                                      N   ->   N0 N1 N2
-----------------------------------------------------------------------------

.         mvencode N*, mv(0) override
          N0: 39 missing values recoded
          N2: 6 missing values recoded

.         
.         egen total_N = rsum(N?)

.         foreach X of var N? {
  2.                 gen `X'_share = 100*`X'/total_N
  3.         }

.         replace N1_share = N2_share+N1_share
(102 real changes made)

.         replace N0_share = 100
(108 real changes made)

.         label var age "Firm age (year)"

.         tw (area N0_share N1_share N2_share age if age<=20, fintensity(inten20 inten20 inten20) ),  `format' legend(order(1 "F
> ounder" 2 "New local" 3 "New expat")) xsize(16) ysize(10) aspect(.67)

.         graph export output/figure/CEO_type_by_age.png, width(1600) replace
(file output/figure/CEO_type_by_age.png written in PNG format)

. restore

. 
. collapse (count) N=entrant (sum) entrant (firstnm) age, by(frame_id year expat)

. reshape wide N entrant, i(frame_id year) j(expat)
(note: j = 0 1)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                   216271   ->  202460
Number of variables                   6   ->       7
j variable (2 values)             expat   ->   (dropped)
xij variables:
                                      N   ->   N0 N1
                                entrant   ->   entrant0 entrant1
-----------------------------------------------------------------------------

. reshape long
(note: j = 0 1)

Data                               wide   ->   long
-----------------------------------------------------------------------------
Number of obs.                   202460   ->  404920
Number of variables                   7   ->       6
j variable (2 values)                     ->   expat
xij variables:
                                  N0 N1   ->   N
                      entrant0 entrant1   ->   entrant
-----------------------------------------------------------------------------

. 
. mvencode N entrant, mv(0) override
           N: 188649 missing values recoded
     entrant: 188649 missing values recoded

. 
. egen total_N = sum(N), by(frame_id year)

. 
. label var N "Number of CEOs"

. label var total_N "Number of CEOs"

. 
. hist total_N, disc `format' xsize(16) ysize(10) aspect(.67)
(start=1, width=1)

. graph export output/figure/CEO_N_histogram.png, width(1600) replace
(file output/figure/CEO_N_histogram.png written in PNG format)

. 
. hist N if N <=5, by(expat ) disc `format' xsize(20) ysize(8)
(note:  clockdir by_legend_position not found in scheme, default attributes used)

. graph export output/figure/CEO_N_histogram_by.png, width(1600) replace 
(file output/figure/CEO_N_histogram_by.png written in PNG format)

. 
. * only count one CEO per firm
. replace N=1 if N>1
(65,973 real changes made)

. replace entrant=1 if entrant>1
(7,877 real changes made)

. 
. reshape wide
(note: j = 0 1)

Data                               long   ->   wide
-----------------------------------------------------------------------------
Number of obs.                   404920   ->  202460
Number of variables                   7   ->       8
j variable (2 values)             expat   ->   (dropped)
xij variables:
                                      N   ->   N0 N1
                                entrant   ->   entrant0 entrant1
-----------------------------------------------------------------------------

. collapse (sum) N0 N1 entrant0 entrant1 total_N, by(year)

. 
. foreach X of var N1 entrant1 entrant0 {
  2.         gen `X'_share = `X'/total_N*100
  3. }

. 
. line N1_share entrant0_share entrant1_share year, sort lwidth(thick thick thick) `format' ytitle("Share of firms (%)") legend(
> order(1 "Expat CEO" 2 "New local CEO" 3 "New expat CEO")) xsize(16) ysize(10) aspect(.67)

. graph export output/figure/shares_over_time.png, width(1600) replace
(file output/figure/shares_over_time.png written in PNG format)

. 
. log close
      name:  <unnamed>
       log:  /Users/koren/Google Drive/Research/expat/research_design/talk/output/descriptives.log
  log type:  text
 closed on:   4 Dec 2018, 17:11:07
--------------------------------------------------------------------------------------------------------------------------------
